# Comparing `tmp/pyaibox-1.1.20.tar.gz` & `tmp/pyaibox-1.1.21.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pyaibox-1.1.20.tar", last modified: Mon May  8 23:22:51 2023, max compression
+gzip compressed data, was "pyaibox-1.1.21.tar", last modified: Tue Jun 27 14:17:53 2023, max compression
```

## Comparing `pyaibox-1.1.20.tar` & `pyaibox-1.1.21.tar`

### file list

```diff
@@ -1,384 +1,385 @@
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.599380 pyaibox-1.1.20/
--rwxrwxrwx   0 root         (0) root         (0)    35149 2022-12-11 11:55:25.000000 pyaibox-1.1.20/LICENSE
--rwxrwxrwx   0 root         (0) root         (0)      223 2022-06-23 14:01:56.000000 pyaibox-1.1.20/MANIFEST.in
--rwxrwxrwx   0 root         (0) root         (0)      552 2023-05-08 23:22:51.599042 pyaibox-1.1.20/PKG-INFO
--rwxrwxrwx   0 root         (0) root         (0)      235 2022-07-03 07:37:30.000000 pyaibox-1.1.20/README.md
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.141600 pyaibox-1.1.20/data/
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.141107 pyaibox-1.1.20/data/binary/
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.163158 pyaibox-1.1.20/data/binary/mstar/
--rwxrwxrwx   0 root         (0) root         (0)   133048 2014-07-24 06:31:32.000000 pyaibox-1.1.20/data/binary/mstar/BMP2_HB03787.000
--rwxrwxrwx   0 root         (0) root         (0)   133047 2014-07-24 06:31:40.000000 pyaibox-1.1.20/data/binary/mstar/BMP2_HB03787.001
--rwxrwxrwx   0 root         (0) root         (0)   133046 2014-07-24 06:31:48.000000 pyaibox-1.1.20/data/binary/mstar/BMP2_HB03787.002
--rwxrwxrwx   0 root         (0) root         (0)   133055 2014-07-24 06:31:56.000000 pyaibox-1.1.20/data/binary/mstar/BTR70_HB03787.004
--rwxrwxrwx   0 root         (0) root         (0)   133045 2014-07-24 06:32:04.000000 pyaibox-1.1.20/data/binary/mstar/T72_HB03787.015
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.166268 pyaibox-1.1.20/data/files/
--rwxrwxrwx   0 root         (0) root         (0)      167 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/files/english_sentence.txt
--rwxrwxrwx   0 root         (0) root         (0)      166 2022-11-27 03:30:20.000000 pyaibox-1.1.20/data/files/english_sentence_decompressed.txt
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.142599 pyaibox-1.1.20/data/images/
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.142162 pyaibox-1.1.20/data/images/dgi/
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.229354 pyaibox-1.1.20/data/images/dgi/characters/
--rwxrwxrwx   0 root         (0) root         (0)      599 2022-06-03 12:24:43.000000 pyaibox-1.1.20/data/images/dgi/characters/0_1.png
--rwxrwxrwx   0 root         (0) root         (0)      274 2022-06-03 12:25:16.000000 pyaibox-1.1.20/data/images/dgi/characters/1_1.png
--rwxrwxrwx   0 root         (0) root         (0)      555 2022-06-03 12:25:52.000000 pyaibox-1.1.20/data/images/dgi/characters/2_1.png
--rwxrwxrwx   0 root         (0) root         (0)      609 2022-06-03 12:26:20.000000 pyaibox-1.1.20/data/images/dgi/characters/3_1.png
--rwxrwxrwx   0 root         (0) root         (0)      414 2022-06-03 12:27:00.000000 pyaibox-1.1.20/data/images/dgi/characters/4_1.png
--rwxrwxrwx   0 root         (0) root         (0)      492 2022-06-03 12:28:11.000000 pyaibox-1.1.20/data/images/dgi/characters/5_1.png
--rwxrwxrwx   0 root         (0) root         (0)      634 2022-06-03 12:27:37.000000 pyaibox-1.1.20/data/images/dgi/characters/6_1.png
--rwxrwxrwx   0 root         (0) root         (0)      494 2022-06-03 12:28:50.000000 pyaibox-1.1.20/data/images/dgi/characters/7_1.png
--rwxrwxrwx   0 root         (0) root         (0)      694 2022-06-03 12:29:19.000000 pyaibox-1.1.20/data/images/dgi/characters/8_1.png
--rwxrwxrwx   0 root         (0) root         (0)      678 2022-06-03 12:29:49.000000 pyaibox-1.1.20/data/images/dgi/characters/9_1.png
--rwxrwxrwx   0 root         (0) root         (0)      613 2022-06-03 11:45:04.000000 pyaibox-1.1.20/data/images/dgi/characters/A1.png
--rwxrwxrwx   0 root         (0) root         (0)      626 2022-06-04 00:18:44.000000 pyaibox-1.1.20/data/images/dgi/characters/AI1.png
--rwxrwxrwx   0 root         (0) root         (0)      524 2022-06-03 11:46:22.000000 pyaibox-1.1.20/data/images/dgi/characters/B1.png
--rwxrwxrwx   0 root         (0) root         (0)      564 2022-06-03 11:47:38.000000 pyaibox-1.1.20/data/images/dgi/characters/C1.png
--rwxrwxrwx   0 root         (0) root         (0)      543 2022-06-04 00:31:14.000000 pyaibox-1.1.20/data/images/dgi/characters/CNN1.png
--rwxrwxrwx   0 root         (0) root         (0)      544 2022-06-03 11:48:27.000000 pyaibox-1.1.20/data/images/dgi/characters/D1.png
--rwxrwxrwx   0 root         (0) root         (0)      679 2022-06-04 01:57:21.000000 pyaibox-1.1.20/data/images/dgi/characters/DIP1.png
--rwxrwxrwx   0 root         (0) root         (0)      566 2022-06-04 00:30:29.000000 pyaibox-1.1.20/data/images/dgi/characters/DL1.png.png
--rwxrwxrwx   0 root         (0) root         (0)      613 2022-06-04 00:32:33.000000 pyaibox-1.1.20/data/images/dgi/characters/DSP1.png
--rwxrwxrwx   0 root         (0) root         (0)      241 2022-06-03 11:49:18.000000 pyaibox-1.1.20/data/images/dgi/characters/E1.png
--rwxrwxrwx   0 root         (0) root         (0)      237 2022-06-03 11:50:13.000000 pyaibox-1.1.20/data/images/dgi/characters/F1.png
--rwxrwxrwx   0 root         (0) root         (0)      605 2022-06-03 11:51:01.000000 pyaibox-1.1.20/data/images/dgi/characters/G1.png
--rwxrwxrwx   0 root         (0) root         (0)      240 2022-06-03 11:51:50.000000 pyaibox-1.1.20/data/images/dgi/characters/H1.png
--rwxrwxrwx   0 root         (0) root         (0)      248 2022-06-04 00:27:40.000000 pyaibox-1.1.20/data/images/dgi/characters/H11.png
--rwxrwxrwx   0 root         (0) root         (0)      226 2022-06-03 11:52:57.000000 pyaibox-1.1.20/data/images/dgi/characters/I1.png
--rwxrwxrwx   0 root         (0) root         (0)      329 2022-06-03 11:53:38.000000 pyaibox-1.1.20/data/images/dgi/characters/J1.png
--rwxrwxrwx   0 root         (0) root         (0)      515 2022-06-03 11:54:16.000000 pyaibox-1.1.20/data/images/dgi/characters/K1.png
--rwxrwxrwx   0 root         (0) root         (0)      234 2022-06-03 11:54:53.000000 pyaibox-1.1.20/data/images/dgi/characters/L1.png
--rwxrwxrwx   0 root         (0) root         (0)      559 2022-06-03 11:55:39.000000 pyaibox-1.1.20/data/images/dgi/characters/M1.png
--rwxrwxrwx   0 root         (0) root         (0)      570 2022-06-04 00:29:39.000000 pyaibox-1.1.20/data/images/dgi/characters/ML1.png
--rwxrwxrwx   0 root         (0) root         (0)      481 2022-06-03 11:56:18.000000 pyaibox-1.1.20/data/images/dgi/characters/N1.png
--rwxrwxrwx   0 root         (0) root         (0)      654 2022-06-03 11:56:54.000000 pyaibox-1.1.20/data/images/dgi/characters/O1.png
--rwxrwxrwx   0 root         (0) root         (0)      422 2022-06-03 11:57:31.000000 pyaibox-1.1.20/data/images/dgi/characters/P1.png
--rwxrwxrwx   0 root         (0) root         (0)      690 2022-06-03 11:58:09.000000 pyaibox-1.1.20/data/images/dgi/characters/Q1.png
--rwxrwxrwx   0 root         (0) root         (0)      511 2022-06-03 11:58:59.000000 pyaibox-1.1.20/data/images/dgi/characters/R1.png
--rwxrwxrwx   0 root         (0) root         (0)      634 2022-06-03 11:59:41.000000 pyaibox-1.1.20/data/images/dgi/characters/S1.png
--rwxrwxrwx   0 root         (0) root         (0)      724 2022-06-04 00:33:40.000000 pyaibox-1.1.20/data/images/dgi/characters/SR1.png
--rwxrwxrwx   0 root         (0) root         (0)      233 2022-06-03 12:00:15.000000 pyaibox-1.1.20/data/images/dgi/characters/T1.png
--rwxrwxrwx   0 root         (0) root         (0)      427 2022-06-03 12:00:59.000000 pyaibox-1.1.20/data/images/dgi/characters/U1.png
--rwxrwxrwx   0 root         (0) root         (0)      672 2022-06-03 12:01:41.000000 pyaibox-1.1.20/data/images/dgi/characters/V1.png
--rwxrwxrwx   0 root         (0) root         (0)      770 2022-06-03 12:02:18.000000 pyaibox-1.1.20/data/images/dgi/characters/W1.png
--rwxrwxrwx   0 root         (0) root         (0)      637 2022-06-03 12:02:52.000000 pyaibox-1.1.20/data/images/dgi/characters/X1.png
--rwxrwxrwx   0 root         (0) root         (0)      465 2022-06-03 12:03:29.000000 pyaibox-1.1.20/data/images/dgi/characters/Y1.png
--rwxrwxrwx   0 root         (0) root         (0)      479 2022-06-03 12:32:27.000000 pyaibox-1.1.20/data/images/dgi/characters/Z1.png
--rwxrwxrwx   0 root         (0) root         (0)      237 2022-06-03 12:13:41.000000 pyaibox-1.1.20/data/images/dgi/characters/add1.png
--rwxrwxrwx   0 root         (0) root         (0)      598 2022-06-03 14:20:55.000000 pyaibox-1.1.20/data/images/dgi/characters/alpha1.png
--rwxrwxrwx   0 root         (0) root         (0)      734 2022-06-03 12:08:27.000000 pyaibox-1.1.20/data/images/dgi/characters/and1.png
--rwxrwxrwx   0 root         (0) root         (0)      971 2022-06-03 12:04:42.000000 pyaibox-1.1.20/data/images/dgi/characters/at1.png
--rwxrwxrwx   0 root         (0) root         (0)      474 2022-06-03 12:21:02.000000 pyaibox-1.1.20/data/images/dgi/characters/backslash1.png
--rwxrwxrwx   0 root         (0) root         (0)      622 2022-06-03 14:21:50.000000 pyaibox-1.1.20/data/images/dgi/characters/beta1.png
--rwxrwxrwx   0 root         (0) root         (0)      437 2022-06-04 00:15:22.000000 pyaibox-1.1.20/data/images/dgi/characters/cap1.png
--rwxrwxrwx   0 root         (0) root         (0)      229 2022-06-04 00:53:04.000000 pyaibox-1.1.20/data/images/dgi/characters/colon1.png
--rwxrwxrwx   0 root         (0) root         (0)      302 2022-06-04 00:49:37.000000 pyaibox-1.1.20/data/images/dgi/characters/comma1.png
--rwxrwxrwx   0 root         (0) root         (0)      428 2022-06-04 00:17:00.000000 pyaibox-1.1.20/data/images/dgi/characters/cup1.png
--rwxrwxrwx   0 root         (0) root         (0)      687 2022-06-03 12:23:51.000000 pyaibox-1.1.20/data/images/dgi/characters/curlybracket1.png
--rwxrwxrwx   0 root         (0) root         (0)      684 2022-06-04 00:12:39.000000 pyaibox-1.1.20/data/images/dgi/characters/delta1.png
--rwxrwxrwx   0 root         (0) root         (0)      467 2022-06-03 12:19:57.000000 pyaibox-1.1.20/data/images/dgi/characters/divide1.png
--rwxrwxrwx   0 root         (0) root         (0)      602 2022-06-03 12:07:08.000000 pyaibox-1.1.20/data/images/dgi/characters/dolar1.png
--rwxrwxrwx   0 root         (0) root         (0)      230 2022-06-04 00:54:41.000000 pyaibox-1.1.20/data/images/dgi/characters/doublequotes1.png
--rwxrwxrwx   0 root         (0) root         (0)      463 2022-06-04 00:57:36.000000 pyaibox-1.1.20/data/images/dgi/characters/doublequotes2.png
--rwxrwxrwx   0 root         (0) root         (0)      223 2022-06-04 01:06:13.000000 pyaibox-1.1.20/data/images/dgi/characters/ellipsis1.png
--rwxrwxrwx   0 root         (0) root         (0)      534 2022-06-03 14:25:34.000000 pyaibox-1.1.20/data/images/dgi/characters/epsilon1.png
--rwxrwxrwx   0 root         (0) root         (0)      228 2022-06-03 12:14:18.000000 pyaibox-1.1.20/data/images/dgi/characters/equal1.png
--rwxrwxrwx   0 root         (0) root         (0)      384 2022-06-03 14:24:32.000000 pyaibox-1.1.20/data/images/dgi/characters/eta1.png
--rwxrwxrwx   0 root         (0) root         (0)      247 2022-06-03 14:16:11.000000 pyaibox-1.1.20/data/images/dgi/characters/exclamation1.png
--rwxrwxrwx   0 root         (0) root         (0)      549 2022-06-03 14:23:01.000000 pyaibox-1.1.20/data/images/dgi/characters/gamma1.png
--rwxrwxrwx   0 root         (0) root         (0)      481 2022-06-03 12:15:58.000000 pyaibox-1.1.20/data/images/dgi/characters/grater1.png
--rwxrwxrwx   0 root         (0) root         (0)      293 2022-06-04 01:07:13.000000 pyaibox-1.1.20/data/images/dgi/characters/grave1.png
--rwxrwxrwx   0 root         (0) root         (0)      526 2022-06-03 12:31:56.000000 pyaibox-1.1.20/data/images/dgi/characters/hash1.png
--rwxrwxrwx   0 root         (0) root         (0)      395 2022-06-03 12:17:55.000000 pyaibox-1.1.20/data/images/dgi/characters/hat1.png
--rwxrwxrwx   0 root         (0) root         (0)      617 2022-06-03 14:29:59.000000 pyaibox-1.1.20/data/images/dgi/characters/infty1.png
--rwxrwxrwx   0 root         (0) root         (0)      475 2022-06-03 14:26:56.000000 pyaibox-1.1.20/data/images/dgi/characters/integral1.png
--rwxrwxrwx   0 root         (0) root         (0)      582 2022-06-03 14:23:47.000000 pyaibox-1.1.20/data/images/dgi/characters/lambda1.png
--rwxrwxrwx   0 root         (0) root         (0)      499 2022-06-03 12:11:02.000000 pyaibox-1.1.20/data/images/dgi/characters/leftparentheses.png
--rwxrwxrwx   0 root         (0) root         (0)      503 2022-06-03 12:15:22.000000 pyaibox-1.1.20/data/images/dgi/characters/less1.png
--rwxrwxrwx   0 root         (0) root         (0)      701 2022-06-03 12:13:00.000000 pyaibox-1.1.20/data/images/dgi/characters/parentheses1.png
--rwxrwxrwx   0 root         (0) root         (0)      824 2022-06-03 12:07:41.000000 pyaibox-1.1.20/data/images/dgi/characters/percent1.png
--rwxrwxrwx   0 root         (0) root         (0)      224 2022-06-04 00:51:22.000000 pyaibox-1.1.20/data/images/dgi/characters/period1.png
--rwxrwxrwx   0 root         (0) root         (0)      309 2022-06-03 14:28:57.000000 pyaibox-1.1.20/data/images/dgi/characters/pi1.png
--rwxrwxrwx   0 root         (0) root         (0)      475 2022-06-03 12:18:58.000000 pyaibox-1.1.20/data/images/dgi/characters/question1.png
--rwxrwxrwx   0 root         (0) root         (0)      357 2022-06-04 00:58:35.000000 pyaibox-1.1.20/data/images/dgi/characters/quotes2.png
--rwxrwxrwx   0 root         (0) root         (0)      494 2022-06-03 12:11:39.000000 pyaibox-1.1.20/data/images/dgi/characters/rightparentheses.png
--rwxrwxrwx   0 root         (0) root         (0)      801 2022-06-03 14:18:47.000000 pyaibox-1.1.20/data/images/dgi/characters/sar1.png
--rwxrwxrwx   0 root         (0) root         (0)      301 2022-06-04 00:48:37.000000 pyaibox-1.1.20/data/images/dgi/characters/semicolon1.png
--rwxrwxrwx   0 root         (0) root         (0)      569 2022-06-04 00:13:51.000000 pyaibox-1.1.20/data/images/dgi/characters/sigma1.png
--rwxrwxrwx   0 root         (0) root         (0)      467 2022-06-03 12:20:32.000000 pyaibox-1.1.20/data/images/dgi/characters/slash1.png
--rwxrwxrwx   0 root         (0) root         (0)      246 2022-06-03 12:33:53.000000 pyaibox-1.1.20/data/images/dgi/characters/squarebrackets1.png
--rwxrwxrwx   0 root         (0) root         (0)      441 2022-06-03 12:09:16.000000 pyaibox-1.1.20/data/images/dgi/characters/star1.png
--rwxrwxrwx   0 root         (0) root         (0)      226 2022-06-03 12:22:28.000000 pyaibox-1.1.20/data/images/dgi/characters/sticks1.png
--rwxrwxrwx   0 root         (0) root         (0)      225 2022-06-03 12:12:13.000000 pyaibox-1.1.20/data/images/dgi/characters/sub1.png
--rwxrwxrwx   0 root         (0) root         (0)      539 2022-06-03 14:27:59.000000 pyaibox-1.1.20/data/images/dgi/characters/sum1.png
--rwxrwxrwx   0 root         (0) root         (0)      380 2022-06-03 12:17:21.000000 pyaibox-1.1.20/data/images/dgi/characters/tilde1.png
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.236856 pyaibox-1.1.20/data/images/dgi/shapes/
--rwxrwxrwx   0 root         (0) root         (0)     5131 2021-03-24 01:20:14.000000 pyaibox-1.1.20/data/images/dgi/shapes/Airplane.png
--rwxrwxrwx   0 root         (0) root         (0)     3786 2021-03-24 01:28:30.000000 pyaibox-1.1.20/data/images/dgi/shapes/AirplanePoints.png
--rwxrwxrwx   0 root         (0) root         (0)      236 2021-03-24 01:20:14.000000 pyaibox-1.1.20/data/images/dgi/shapes/ArrowPoints.png
--rwxrwxrwx   0 root         (0) root         (0)      241 2021-03-24 01:20:15.000000 pyaibox-1.1.20/data/images/dgi/shapes/CirclePoints.png
--rwxrwxrwx   0 root         (0) root         (0)      321 2021-03-24 01:20:15.000000 pyaibox-1.1.20/data/images/dgi/shapes/Diamond.png
--rwxrwxrwx   0 root         (0) root         (0)      239 2021-03-24 01:20:15.000000 pyaibox-1.1.20/data/images/dgi/shapes/DiamondPoints.png
--rwxrwxrwx   0 root         (0) root         (0)      291 2021-03-24 01:20:15.000000 pyaibox-1.1.20/data/images/dgi/shapes/LinePoints.png
--rwxrwxrwx   0 root         (0) root         (0)      247 2021-03-24 01:20:16.000000 pyaibox-1.1.20/data/images/dgi/shapes/OnePoint.png
--rwxrwxrwx   0 root         (0) root         (0)      493 2021-03-03 09:03:25.000000 pyaibox-1.1.20/data/images/dgi/shapes/Points64.png
--rwxrwxrwx   0 root         (0) root         (0)      179 2021-03-24 01:20:16.000000 pyaibox-1.1.20/data/images/dgi/shapes/RectanglePoints.png
--rwxrwxrwx   0 root         (0) root         (0)      218 2022-06-04 01:24:31.000000 pyaibox-1.1.20/data/images/dgi/shapes/SmilePoints.png
--rwxrwxrwx   0 root         (0) root         (0)      210 2021-03-24 01:20:16.000000 pyaibox-1.1.20/data/images/dgi/shapes/TrianglePoints.png
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.255705 pyaibox-1.1.20/data/images/oi/
--rwxrwxrwx   0 root         (0) root         (0)    14970 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/images/oi/Einstein128.png
--rwxrwxrwx   0 root         (0) root         (0)    53102 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/images/oi/Einstein256.png
--rwxrwxrwx   0 root         (0) root         (0)    11171 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/images/oi/LenaGRAY128.png
--rwxrwxrwx   0 root         (0) root         (0)    41746 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/images/oi/LenaGRAY256.png
--rwxrwxrwx   0 root         (0) root         (0)   154038 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/images/oi/LenaGRAY512.png
--rwxrwxrwx   0 root         (0) root         (0)   792056 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/images/oi/LenaRGB512.tif
--rwxrwxrwx   0 root         (0) root         (0)   484322 2022-05-30 14:44:27.000000 pyaibox-1.1.20/data/images/oi/Lighthouse.png
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.270299 pyaibox-1.1.20/data/images/rsi/
--rwxrwxrwx   0 root         (0) root         (0)     3199 2019-05-28 12:48:40.000000 pyaibox-1.1.20/data/images/rsi/000001.png
--rwxrwxrwx   0 root         (0) root         (0)     3354 2019-05-28 12:10:53.000000 pyaibox-1.1.20/data/images/rsi/000007.png
--rwxrwxrwx   0 root         (0) root         (0)     2721 2019-05-28 12:40:10.000000 pyaibox-1.1.20/data/images/rsi/000082.png
--rwxrwxrwx   0 root         (0) root         (0)     2904 2019-05-28 12:19:10.000000 pyaibox-1.1.20/data/images/rsi/000120.png
--rwxrwxrwx   0 root         (0) root         (0)     3208 2019-05-28 12:01:56.000000 pyaibox-1.1.20/data/images/rsi/000167.png
--rwxrwxrwx   0 root         (0) root         (0)     3674 2019-05-28 12:01:57.000000 pyaibox-1.1.20/data/images/rsi/000170.png
--rwxrwxrwx   0 root         (0) root         (0)     2945 2019-05-28 12:01:57.000000 pyaibox-1.1.20/data/images/rsi/000174.png
--rwxrwxrwx   0 root         (0) root         (0)     2865 2019-05-28 12:28:31.000000 pyaibox-1.1.20/data/images/rsi/000296.png
--rwxrwxrwx   0 root         (0) root         (0)     2578 2022-06-04 01:34:36.000000 pyaibox-1.1.20/data/images/rsi/Ship1.png
--rwxrwxrwx   0 root         (0) root         (0)     2577 2022-06-04 01:35:34.000000 pyaibox-1.1.20/data/images/rsi/Ship2.png
--rwxrwxrwx   0 root         (0) root         (0)     2797 2022-06-04 01:36:37.000000 pyaibox-1.1.20/data/images/rsi/Ship3.png
--rwxrwxrwx   0 root         (0) root         (0)     2783 2022-06-04 01:39:02.000000 pyaibox-1.1.20/data/images/rsi/Ship4.png
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.143032 pyaibox-1.1.20/docs/
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.280436 pyaibox-1.1.20/docs/source/
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.334017 pyaibox-1.1.20/docs/source/_static/
--rwxrwxrwx   0 root         (0) root         (0)   316818 2022-07-16 13:58:15.000000 pyaibox-1.1.20/docs/source/_static/CT2RTRT2CTdemo.png
--rwxrwxrwx   0 root         (0) root         (0)    77782 2022-12-17 01:18:35.000000 pyaibox-1.1.20/docs/source/_static/ConfusionMatrixRich.png
--rwxrwxrwx   0 root         (0) root         (0)    66750 2022-12-17 01:02:05.000000 pyaibox-1.1.20/docs/source/_static/ConfusionMatrixSimple.png
--rwxrwxrwx   0 root         (0) root         (0)   373154 2022-06-18 14:19:10.000000 pyaibox-1.1.20/docs/source/_static/DemoIMNOISE.png
--rwxrwxrwx   0 root         (0) root         (0)   440570 2022-06-18 14:10:10.000000 pyaibox-1.1.20/docs/source/_static/DemoNoiseAWGNS.png
--rwxrwxrwx   0 root         (0) root         (0)   122255 2022-06-14 15:02:25.000000 pyaibox-1.1.20/docs/source/_static/FFTIFFTdemo.png
--rwxrwxrwx   0 root         (0) root         (0)   138288 2022-12-18 10:38:43.000000 pyaibox-1.1.20/docs/source/_static/MNISTPCA_K70.png
--rwxrwxrwx   0 root         (0) root         (0)   161356 2022-12-18 10:38:29.000000 pyaibox-1.1.20/docs/source/_static/MNISTPCA_K90.png
--rwxrwxrwx   0 root         (0) root         (0)    98883 2022-12-18 10:38:14.000000 pyaibox-1.1.20/docs/source/_static/MNISTPCA_ORIG.png
--rwxrwxrwx   0 root         (0) root         (0)   184961 2022-06-04 13:52:03.000000 pyaibox-1.1.20/docs/source/_static/SHOW1_BTR70_HB03787.png
--rwxrwxrwx   0 root         (0) root         (0)   278320 2022-06-04 14:02:23.000000 pyaibox-1.1.20/docs/source/_static/SHOW_BTR70_HB03787.png
--rwxrwxrwx   0 root         (0) root         (0)   223839 2022-04-04 05:17:04.000000 pyaibox-1.1.20/docs/source/_static/demo_draw_rectangles.png
--rwxrwxrwx   0 root         (0) root         (0)   231175 2022-04-04 05:17:52.000000 pyaibox-1.1.20/docs/source/_static/demo_plot_bboxes.png
--rwxrwxrwx   0 root         (0) root         (0)    23564 2022-04-04 05:19:12.000000 pyaibox-1.1.20/docs/source/_static/demo_randgrid.png
--rwxrwxrwx   0 root         (0) root         (0)   605281 2022-04-04 06:15:15.000000 pyaibox-1.1.20/docs/source/_static/demo_sample_patch.png
--rwxrwxrwx   0 root         (0) root         (0)   114848 2022-12-11 04:07:44.000000 pyaibox-1.1.20/docs/source/_static/fashionmnist.png
--rwxrwxrwx   0 root         (0) root         (0)    67635 2022-12-11 04:12:56.000000 pyaibox-1.1.20/docs/source/_static/mnist.png
--rwxrwxrwx   0 root         (0) root         (0)     6313 2022-12-04 05:59:40.000000 pyaibox-1.1.20/docs/source/conf.py
--rwxrwxrwx   0 root         (0) root         (0)      446 2022-05-30 13:55:36.000000 pyaibox-1.1.20/docs/source/getstarted.rst
--rwxrwxrwx   0 root         (0) root         (0)      466 2022-05-30 13:55:36.000000 pyaibox-1.1.20/docs/source/index.rst
--rwxrwxrwx   0 root         (0) root         (0)       67 2022-05-30 14:31:19.000000 pyaibox-1.1.20/docs/source/modules.rst
--rwxrwxrwx   0 root         (0) root         (0)      945 2022-06-19 14:39:29.000000 pyaibox-1.1.20/docs/source/pyaibox.base.rst
--rwxrwxrwx   0 root         (0) root         (0)      396 2022-06-14 15:58:48.000000 pyaibox-1.1.20/docs/source/pyaibox.compression.rst
--rwxrwxrwx   0 root         (0) root         (0)      504 2022-06-14 15:58:48.000000 pyaibox-1.1.20/docs/source/pyaibox.datasets.rst
--rwxrwxrwx   0 root         (0) root         (0)     1445 2023-04-02 04:42:03.000000 pyaibox-1.1.20/docs/source/pyaibox.dsp.rst
--rwxrwxrwx   0 root         (0) root         (0)     1389 2022-12-14 15:17:20.000000 pyaibox-1.1.20/docs/source/pyaibox.evaluation.rst
--rwxrwxrwx   0 root         (0) root         (0)     1148 2022-06-19 14:39:29.000000 pyaibox-1.1.20/docs/source/pyaibox.misc.rst
--rwxrwxrwx   0 root         (0) root         (0)      526 2022-12-19 13:13:50.000000 pyaibox-1.1.20/docs/source/pyaibox.ml.rst
--rwxrwxrwx   0 root         (0) root         (0)      331 2022-06-14 15:58:48.000000 pyaibox-1.1.20/docs/source/pyaibox.nn.rst
--rwxrwxrwx   0 root         (0) root         (0)      533 2022-12-19 13:13:49.000000 pyaibox-1.1.20/docs/source/pyaibox.rst
--rwxrwxrwx   0 root         (0) root         (0)      354 2022-06-14 15:58:48.000000 pyaibox-1.1.20/docs/source/pyaibox.summary.rst
--rwxrwxrwx   0 root         (0) root         (0)     1528 2022-06-26 11:23:11.000000 pyaibox-1.1.20/docs/source/pyaibox.utils.rst
--rwxrwxrwx   0 root         (0) root         (0)      103 2022-06-14 15:58:47.000000 pyaibox-1.1.20/docs/source/setup.rst
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.145592 pyaibox-1.1.20/examples/
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.335471 pyaibox-1.1.20/examples/base/
--rwxrwxrwx   0 root         (0) root         (0)      828 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/base/demo_random.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.336048 pyaibox-1.1.20/examples/compression/
--rwxrwxrwx   0 root         (0) root         (0)      253 2022-11-27 03:30:18.000000 pyaibox-1.1.20/examples/compression/demo_huffman_coding.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.337149 pyaibox-1.1.20/examples/datasets/
--rwxrwxrwx   0 root         (0) root         (0)     1416 2022-12-11 13:03:16.000000 pyaibox-1.1.20/examples/datasets/demo_read_fashionmnist.py
--rwxrwxrwx   0 root         (0) root         (0)     1572 2022-12-11 13:03:01.000000 pyaibox-1.1.20/examples/datasets/demo_read_mnist.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.341248 pyaibox-1.1.20/examples/dsp/
--rwxrwxrwx   0 root         (0) root         (0)      884 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/dsp/demo_fft.py
--rwxrwxrwx   0 root         (0) root         (0)      576 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/dsp/demo_fft_image.py
--rwxrwxrwx   0 root         (0) root         (0)     2604 2022-06-14 14:58:53.000000 pyaibox-1.1.20/examples/dsp/demo_fft_sincos.py
--rwxrwxrwx   0 root         (0) root         (0)      952 2023-04-22 11:15:27.000000 pyaibox-1.1.20/examples/dsp/demo_fftshift.py
--rwxrwxrwx   0 root         (0) root         (0)     1044 2022-06-14 15:04:36.000000 pyaibox-1.1.20/examples/dsp/demo_freq.py
--rwxrwxrwx   0 root         (0) root         (0)      869 2021-03-03 09:03:26.000000 pyaibox-1.1.20/examples/dsp/demo_interp_complex.py
--rwxrwxrwx   0 root         (0) root         (0)      558 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/dsp/demo_polyfit.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.343434 pyaibox-1.1.20/examples/evaluation/
--rwxrwxrwx   0 root         (0) root         (0)     1778 2023-01-06 13:20:39.000000 pyaibox-1.1.20/examples/evaluation/demo_classification.py
--rwxrwxrwx   0 root         (0) root         (0)      581 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/evaluation/demo_contrast.py
--rwxrwxrwx   0 root         (0) root         (0)      400 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/evaluation/demo_entropy.py
--rwxrwxrwx   0 root         (0) root         (0)      401 2022-05-30 14:20:25.000000 pyaibox-1.1.20/examples/evaluation/demo_norm.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.348623 pyaibox-1.1.20/examples/misc/
--rwxrwxrwx   0 root         (0) root         (0)     1511 2022-06-19 13:17:54.000000 pyaibox-1.1.20/examples/misc/demo_awgns.py
--rwxrwxrwx   0 root         (0) root         (0)      878 2022-07-11 14:46:51.000000 pyaibox-1.1.20/examples/misc/demo_complex2real_fft.py
--rwxrwxrwx   0 root         (0) root         (0)     1199 2022-06-04 05:15:19.000000 pyaibox-1.1.20/examples/misc/demo_dnsampling.py
--rwxrwxrwx   0 root         (0) root         (0)      939 2022-06-04 05:15:25.000000 pyaibox-1.1.20/examples/misc/demo_draw_rectangles.py
--rwxrwxrwx   0 root         (0) root         (0)      944 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/misc/demo_mapping.py
--rwxrwxrwx   0 root         (0) root         (0)     1005 2022-06-04 05:15:32.000000 pyaibox-1.1.20/examples/misc/demo_plot_bboxes.py
--rwxrwxrwx   0 root         (0) root         (0)      843 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/misc/demo_readsamples.py
--rwxrwxrwx   0 root         (0) root         (0)     2760 2022-06-04 05:15:48.000000 pyaibox-1.1.20/examples/misc/demo_sample_patch.py
--rwxrwxrwx   0 root         (0) root         (0)      748 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/misc/demo_shuffle_tensor.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.349212 pyaibox-1.1.20/examples/ml/
--rwxrwxrwx   0 root         (0) root         (0)     2427 2022-12-18 11:10:32.000000 pyaibox-1.1.20/examples/ml/demo_mnist_pca.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.349773 pyaibox-1.1.20/examples/summary/
--rwxrwxrwx   0 root         (0) root         (0)      499 2022-05-30 14:21:03.000000 pyaibox-1.1.20/examples/summary/demo_loss_log.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.354295 pyaibox-1.1.20/examples/utils/
--rwxrwxrwx   0 root         (0) root         (0)      558 2022-06-04 04:25:08.000000 pyaibox-1.1.20/examples/utils/demo_bin.py
--rwxrwxrwx   0 root         (0) root         (0)      860 2022-12-14 16:05:49.000000 pyaibox-1.1.20/examples/utils/demo_colors.py
--rwxrwxrwx   0 root         (0) root         (0)     1709 2022-12-11 14:41:38.000000 pyaibox-1.1.20/examples/utils/demo_convert.py
--rwxrwxrwx   0 root         (0) root         (0)     1559 2023-05-08 23:18:15.000000 pyaibox-1.1.20/examples/utils/demo_docstring.py
--rwxrwxrwx   0 root         (0) root         (0)      499 2022-06-04 05:14:58.000000 pyaibox-1.1.20/examples/utils/demo_file.py
--rwxrwxrwx   0 root         (0) root         (0)     1221 2022-11-03 13:51:54.000000 pyaibox-1.1.20/examples/utils/demo_ios.py
--rwxrwxrwx   0 root         (0) root         (0)      682 2022-05-30 13:56:26.000000 pyaibox-1.1.20/examples/utils/demo_read_log.py
--rwxrwxrwx   0 root         (0) root         (0)      563 2022-06-11 08:53:57.000000 pyaibox-1.1.20/examples/utils/demo_typevalue.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.357423 pyaibox-1.1.20/pyaibox/
--rwxrwxrwx   0 root         (0) root         (0)     3019 2023-05-08 23:13:03.000000 pyaibox-1.1.20/pyaibox/__init__.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.390179 pyaibox-1.1.20/pyaibox/base/
--rwxrwxrwx   0 root         (0) root         (0)        0 2022-04-04 07:47:50.000000 pyaibox-1.1.20/pyaibox/base/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   326607 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/base/arrayops.c
--rwxrwxrwx   0 root         (0) root         (0)     6128 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/base/arrayops.py
--rwxrwxrwx   0 root         (0) root         (0)     2379 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/base/arrayops.pyi
--rwxrwxrwx   0 root         (0) root         (0)   259717 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/base/baseops.c
--rwxrwxrwx   0 root         (0) root         (0)     4002 2023-05-08 23:11:32.000000 pyaibox-1.1.20/pyaibox/base/baseops.py
--rwxrwxrwx   0 root         (0) root         (0)     1663 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/base/baseops.pyi
--rwxrwxrwx   0 root         (0) root         (0)   610553 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/base/mathops.c
--rwxrwxrwx   0 root         (0) root         (0)    19080 2023-04-10 15:25:01.000000 pyaibox-1.1.20/pyaibox/base/mathops.py
--rwxrwxrwx   0 root         (0) root         (0)    12890 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/base/mathops.pyi
--rwxrwxrwx   0 root         (0) root         (0)   354425 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/base/randomfunc.c
--rwxrwxrwx   0 root         (0) root         (0)     8400 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/base/randomfunc.py
--rwxrwxrwx   0 root         (0) root         (0)     4093 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/base/randomfunc.pyi
--rwxrwxrwx   0 root         (0) root         (0)   238446 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/base/typevalue.c
--rwxrwxrwx   0 root         (0) root         (0)     2402 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/base/typevalue.py
--rwxrwxrwx   0 root         (0) root         (0)      277 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/base/typevalue.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.397045 pyaibox-1.1.20/pyaibox/compression/
--rwxrwxrwx   0 root         (0) root         (0)       40 2021-03-03 09:03:26.000000 pyaibox-1.1.20/pyaibox/compression/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   454824 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/compression/huffman_coding.c
--rwxrwxrwx   0 root         (0) root         (0)     5195 2022-12-14 15:14:10.000000 pyaibox-1.1.20/pyaibox/compression/huffman_coding.py
--rwxrwxrwx   0 root         (0) root         (0)      140 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/compression/huffman_coding.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.407369 pyaibox-1.1.20/pyaibox/datasets/
--rwxrwxrwx   0 root         (0) root         (0)        0 2022-06-04 07:38:12.000000 pyaibox-1.1.20/pyaibox/datasets/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   267870 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/datasets/mnist.c
--rwxrwxrwx   0 root         (0) root         (0)     5100 2022-12-14 15:29:19.000000 pyaibox-1.1.20/pyaibox/datasets/mnist.py
--rwxrwxrwx   0 root         (0) root         (0)     2395 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/datasets/mnist.pyi
--rwxrwxrwx   0 root         (0) root         (0)   332134 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/datasets/mstar.c
--rwxrwxrwx   0 root         (0) root         (0)     6722 2022-12-14 15:06:04.000000 pyaibox-1.1.20/pyaibox/datasets/mstar.py
--rwxrwxrwx   0 root         (0) root         (0)     3175 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/datasets/mstar.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.451728 pyaibox-1.1.20/pyaibox/dsp/
--rwxrwxrwx   0 root         (0) root         (0)        0 2022-04-04 07:47:55.000000 pyaibox-1.1.20/pyaibox/dsp/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   410223 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/dsp/convolution.c
--rwxrwxrwx   0 root         (0) root         (0)     8690 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/dsp/convolution.py
--rwxrwxrwx   0 root         (0) root         (0)     3630 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/convolution.pyi
--rwxrwxrwx   0 root         (0) root         (0)   590014 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/dsp/correlation.c
--rwxrwxrwx   0 root         (0) root         (0)    13108 2023-04-02 04:35:01.000000 pyaibox-1.1.20/pyaibox/dsp/correlation.py
--rwxrwxrwx   0 root         (0) root         (0)     5120 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/correlation.pyi
--rwxrwxrwx   0 root         (0) root         (0)   500093 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/dsp/ffts.c
--rwxrwxrwx   0 root         (0) root         (0)    17912 2023-04-22 11:08:46.000000 pyaibox-1.1.20/pyaibox/dsp/ffts.py
--rwxrwxrwx   0 root         (0) root         (0)    10665 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/ffts.pyi
--rwxrwxrwx   0 root         (0) root         (0)   171298 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/dsp/frffts.c
--rwxrwxrwx   0 root         (0) root         (0)    10948 2023-04-02 07:26:23.000000 pyaibox-1.1.20/pyaibox/dsp/frffts.py
--rwxrwxrwx   0 root         (0) root         (0)     9838 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/frffts.pyi
--rwxrwxrwx   0 root         (0) root         (0)   225227 2023-05-08 23:21:11.000000 pyaibox-1.1.20/pyaibox/dsp/function_base.c
--rwxrwxrwx   0 root         (0) root         (0)     4149 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/dsp/function_base.py
--rwxrwxrwx   0 root         (0) root         (0)     2361 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/function_base.pyi
--rwxrwxrwx   0 root         (0) root         (0)   375887 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/dsp/interpolation1d.c
--rwxrwxrwx   0 root         (0) root         (0)     5276 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/dsp/interpolation1d.py
--rwxrwxrwx   0 root         (0) root         (0)      867 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/interpolation1d.pyi
--rwxrwxrwx   0 root         (0) root         (0)   220920 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/dsp/interpolation2d.c
--rwxrwxrwx   0 root         (0) root         (0)     2012 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/dsp/interpolation2d.py
--rwxrwxrwx   0 root         (0) root         (0)       61 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/interpolation2d.pyi
--rwxrwxrwx   0 root         (0) root         (0)   363905 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/dsp/normalsignals.c
--rwxrwxrwx   0 root         (0) root         (0)     5500 2023-04-02 04:43:58.000000 pyaibox-1.1.20/pyaibox/dsp/normalsignals.py
--rwxrwxrwx   0 root         (0) root         (0)      513 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/dsp/normalsignals.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.495712 pyaibox-1.1.20/pyaibox/evaluation/
--rwxrwxrwx   0 root         (0) root         (0)        0 2022-03-10 12:24:12.000000 pyaibox-1.1.20/pyaibox/evaluation/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   766785 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/evaluation/classification.c
--rwxrwxrwx   0 root         (0) root         (0)    23312 2023-05-01 13:11:42.000000 pyaibox-1.1.20/pyaibox/evaluation/classification.py
--rwxrwxrwx   0 root         (0) root         (0)     7030 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/evaluation/classification.pyi
--rwxrwxrwx   0 root         (0) root         (0)   252715 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/evaluation/contrast.c
--rwxrwxrwx   0 root         (0) root         (0)     5640 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/evaluation/contrast.py
--rwxrwxrwx   0 root         (0) root         (0)     2865 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/evaluation/contrast.pyi
--rwxrwxrwx   0 root         (0) root         (0)   416999 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/evaluation/detection_voc.c
--rwxrwxrwx   0 root         (0) root         (0)    15039 2022-12-14 15:05:40.000000 pyaibox-1.1.20/pyaibox/evaluation/detection_voc.py
--rwxrwxrwx   0 root         (0) root         (0)     8649 2023-05-08 23:18:09.000000 pyaibox-1.1.20/pyaibox/evaluation/detection_voc.pyi
--rwxrwxrwx   0 root         (0) root         (0)   246611 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/evaluation/entropy.c
--rwxrwxrwx   0 root         (0) root         (0)     5458 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/evaluation/entropy.py
--rwxrwxrwx   0 root         (0) root         (0)     2747 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/evaluation/entropy.pyi
--rwxrwxrwx   0 root         (0) root         (0)   901320 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/evaluation/error.c
--rwxrwxrwx   0 root         (0) root         (0)    38534 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/evaluation/error.py
--rwxrwxrwx   0 root         (0) root         (0)    20564 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/evaluation/error.pyi
--rwxrwxrwx   0 root         (0) root         (0)   366144 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/evaluation/norm.c
--rwxrwxrwx   0 root         (0) root         (0)     9840 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/evaluation/norm.py
--rwxrwxrwx   0 root         (0) root         (0)     5068 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/evaluation/norm.pyi
--rwxrwxrwx   0 root         (0) root         (0)   285194 2023-05-08 23:21:12.000000 pyaibox-1.1.20/pyaibox/evaluation/snrs.c
--rwxrwxrwx   0 root         (0) root         (0)     9177 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/evaluation/snrs.py
--rwxrwxrwx   0 root         (0) root         (0)     4347 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/evaluation/snrs.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.531541 pyaibox-1.1.20/pyaibox/misc/
--rwxrwxrwx   0 root         (0) root         (0)        0 2021-02-08 00:18:02.000000 pyaibox-1.1.20/pyaibox/misc/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   397464 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/misc/bounding_box.c
--rwxrwxrwx   0 root         (0) root         (0)    24112 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/misc/bounding_box.py
--rwxrwxrwx   0 root         (0) root         (0)    10077 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/misc/bounding_box.pyi
--rwxrwxrwx   0 root         (0) root         (0)   289984 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/misc/draw_shapes.c
--rwxrwxrwx   0 root         (0) root         (0)     4896 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/misc/draw_shapes.py
--rwxrwxrwx   0 root         (0) root         (0)     1995 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/misc/draw_shapes.pyi
--rwxrwxrwx   0 root         (0) root         (0)   247824 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/misc/mapping_operation.c
--rwxrwxrwx   0 root         (0) root         (0)     3608 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/misc/mapping_operation.py
--rwxrwxrwx   0 root         (0) root         (0)      961 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/misc/mapping_operation.pyi
--rwxrwxrwx   0 root         (0) root         (0)   490613 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/misc/noising.c
--rwxrwxrwx   0 root         (0) root         (0)    17271 2023-05-07 14:53:10.000000 pyaibox-1.1.20/pyaibox/misc/noising.py
--rwxrwxrwx   0 root         (0) root         (0)     9307 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/misc/noising.pyi
--rwxrwxrwx   0 root         (0) root         (0)   841399 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/misc/sampling.c
--rwxrwxrwx   0 root         (0) root         (0)    26634 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/misc/sampling.py
--rwxrwxrwx   0 root         (0) root         (0)    11138 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/misc/sampling.pyi
--rwxrwxrwx   0 root         (0) root         (0)   420679 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/misc/transform.c
--rwxrwxrwx   0 root         (0) root         (0)    10247 2022-12-11 12:50:34.000000 pyaibox-1.1.20/pyaibox/misc/transform.py
--rwxrwxrwx   0 root         (0) root         (0)     5151 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/misc/transform.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.541514 pyaibox-1.1.20/pyaibox/ml/
--rwxrwxrwx   0 root         (0) root         (0)        0 2022-12-18 07:14:07.000000 pyaibox-1.1.20/pyaibox/ml/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   372482 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/ml/dataset_visualization.c
--rwxrwxrwx   0 root         (0) root         (0)     6371 2023-01-07 04:34:54.000000 pyaibox-1.1.20/pyaibox/ml/dataset_visualization.py
--rwxrwxrwx   0 root         (0) root         (0)       74 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/ml/dataset_visualization.pyi
--rwxrwxrwx   0 root         (0) root         (0)   345453 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/ml/reduction_pca.c
--rwxrwxrwx   0 root         (0) root         (0)     6279 2022-12-18 11:19:29.000000 pyaibox-1.1.20/pyaibox/ml/reduction_pca.py
--rwxrwxrwx   0 root         (0) root         (0)     2555 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/ml/reduction_pca.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.546034 pyaibox-1.1.20/pyaibox/nn/
--rwxrwxrwx   0 root         (0) root         (0)        0 2022-06-04 05:23:15.000000 pyaibox-1.1.20/pyaibox/nn/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   302965 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/nn/activations.c
--rwxrwxrwx   0 root         (0) root         (0)     6961 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/nn/activations.py
--rwxrwxrwx   0 root         (0) root         (0)     4166 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/nn/activations.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.550848 pyaibox-1.1.20/pyaibox/summary/
--rwxrwxrwx   0 root         (0) root         (0)        0 2022-05-19 23:15:11.000000 pyaibox-1.1.20/pyaibox/summary/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   336835 2023-05-08 23:21:13.000000 pyaibox-1.1.20/pyaibox/summary/loss_log.c
--rwxrwxrwx   0 root         (0) root         (0)     4031 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/summary/loss_log.py
--rwxrwxrwx   0 root         (0) root         (0)       18 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/summary/loss_log.pyi
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.598391 pyaibox-1.1.20/pyaibox/utils/
--rwxrwxrwx   0 root         (0) root         (0)        0 2021-03-03 09:03:26.000000 pyaibox-1.1.20/pyaibox/utils/__init__.py
--rwxrwxrwx   0 root         (0) root         (0)   610751 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/colormaps.c
--rwxrwxrwx   0 root         (0) root         (0)    17214 2022-03-10 11:55:07.000000 pyaibox-1.1.20/pyaibox/utils/colormaps.py
--rwxrwxrwx   0 root         (0) root         (0)        1 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/colormaps.pyi
--rwxrwxrwx   0 root         (0) root         (0)   339387 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/colors.c
--rwxrwxrwx   0 root         (0) root         (0)     8227 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/utils/colors.py
--rwxrwxrwx   0 root         (0) root         (0)     2273 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/colors.pyi
--rwxrwxrwx   0 root         (0) root         (0)   111631 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/const.c
--rwxrwxrwx   0 root         (0) root         (0)     1402 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/utils/const.py
--rwxrwxrwx   0 root         (0) root         (0)        1 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/const.pyi
--rwxrwxrwx   0 root         (0) root         (0)   445283 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/convert.c
--rwxrwxrwx   0 root         (0) root         (0)    11568 2023-04-26 14:18:29.000000 pyaibox-1.1.20/pyaibox/utils/convert.py
--rwxrwxrwx   0 root         (0) root         (0)     6415 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/convert.pyi
--rwxrwxrwx   0 root         (0) root         (0)   297010 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/docstr.c
--rwxrwxrwx   0 root         (0) root         (0)     5625 2022-12-14 15:10:32.000000 pyaibox-1.1.20/pyaibox/utils/docstr.py
--rwxrwxrwx   0 root         (0) root         (0)      428 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/docstr.pyi
--rwxrwxrwx   0 root         (0) root         (0)   452991 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/file.c
--rwxrwxrwx   0 root         (0) root         (0)    10680 2022-12-15 15:16:10.000000 pyaibox-1.1.20/pyaibox/utils/file.py
--rwxrwxrwx   0 root         (0) root         (0)     5176 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/file.pyi
--rwxrwxrwx   0 root         (0) root         (0)   224137 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/image.c
--rwxrwxrwx   0 root         (0) root         (0)     4175 2022-12-11 12:50:33.000000 pyaibox-1.1.20/pyaibox/utils/image.py
--rwxrwxrwx   0 root         (0) root         (0)     2281 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/image.pyi
--rwxrwxrwx   0 root         (0) root         (0)   528430 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/ios.c
--rwxrwxrwx   0 root         (0) root         (0)    13433 2023-05-08 23:17:44.000000 pyaibox-1.1.20/pyaibox/utils/ios.py
--rwxrwxrwx   0 root         (0) root         (0)     6557 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/ios.pyi
--rwxrwxrwx   0 root         (0) root         (0)   660780 2023-05-08 23:21:14.000000 pyaibox-1.1.20/pyaibox/utils/plot_show.c
--rwxrwxrwx   0 root         (0) root         (0)    17643 2023-04-10 15:21:55.000000 pyaibox-1.1.20/pyaibox/utils/plot_show.py
--rwxrwxrwx   0 root         (0) root         (0)     7026 2023-05-08 23:18:10.000000 pyaibox-1.1.20/pyaibox/utils/plot_show.pyi
--rwxrwxrwx   0 root         (0) root         (0)   107304 2023-05-08 23:22:50.000000 pyaibox-1.1.20/pyaibox/version.c
--rwxrwxrwx   0 root         (0) root         (0)       82 2023-05-08 23:22:37.000000 pyaibox-1.1.20/pyaibox/version.py
-drwxrwxrwx   0 root         (0) root         (0)        0 2023-05-08 23:22:51.360335 pyaibox-1.1.20/pyaibox.egg-info/
--rwxrwxrwx   0 root         (0) root         (0)      552 2023-05-08 23:22:50.000000 pyaibox-1.1.20/pyaibox.egg-info/PKG-INFO
--rwxrwxrwx   0 root         (0) root         (0)    10877 2023-05-08 23:22:51.000000 pyaibox-1.1.20/pyaibox.egg-info/SOURCES.txt
--rwxrwxrwx   0 root         (0) root         (0)        1 2023-05-08 23:22:50.000000 pyaibox-1.1.20/pyaibox.egg-info/dependency_links.txt
--rwxrwxrwx   0 root         (0) root         (0)       86 2023-05-08 23:22:50.000000 pyaibox-1.1.20/pyaibox.egg-info/requires.txt
--rwxrwxrwx   0 root         (0) root         (0)        8 2023-05-08 23:22:50.000000 pyaibox-1.1.20/pyaibox.egg-info/top_level.txt
--rwxrwxrwx   0 root         (0) root         (0)      104 2022-07-03 03:51:09.000000 pyaibox-1.1.20/requirements.txt
--rwxrwxrwx   0 root         (0) root         (0)       38 2023-05-08 23:22:51.599499 pyaibox-1.1.20/setup.cfg
--rwxrwxrwx   0 root         (0) root         (0)     3221 2023-01-05 10:35:13.000000 pyaibox-1.1.20/setup.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.982623 pyaibox-1.1.21/
+-rwxrwxrwx   0 root         (0) root         (0)    35149 2022-12-11 11:55:25.000000 pyaibox-1.1.21/LICENSE
+-rwxrwxrwx   0 root         (0) root         (0)      223 2022-06-23 14:01:56.000000 pyaibox-1.1.21/MANIFEST.in
+-rwxrwxrwx   0 root         (0) root         (0)      552 2023-06-27 14:17:53.982082 pyaibox-1.1.21/PKG-INFO
+-rwxrwxrwx   0 root         (0) root         (0)      235 2022-07-03 07:37:30.000000 pyaibox-1.1.21/README.md
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.433048 pyaibox-1.1.21/data/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.432447 pyaibox-1.1.21/data/binary/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.456175 pyaibox-1.1.21/data/binary/mstar/
+-rwxrwxrwx   0 root         (0) root         (0)   133048 2014-07-24 06:31:32.000000 pyaibox-1.1.21/data/binary/mstar/BMP2_HB03787.000
+-rwxrwxrwx   0 root         (0) root         (0)   133047 2014-07-24 06:31:40.000000 pyaibox-1.1.21/data/binary/mstar/BMP2_HB03787.001
+-rwxrwxrwx   0 root         (0) root         (0)   133046 2014-07-24 06:31:48.000000 pyaibox-1.1.21/data/binary/mstar/BMP2_HB03787.002
+-rwxrwxrwx   0 root         (0) root         (0)   133055 2014-07-24 06:31:56.000000 pyaibox-1.1.21/data/binary/mstar/BTR70_HB03787.004
+-rwxrwxrwx   0 root         (0) root         (0)   133045 2014-07-24 06:32:04.000000 pyaibox-1.1.21/data/binary/mstar/T72_HB03787.015
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.459593 pyaibox-1.1.21/data/files/
+-rwxrwxrwx   0 root         (0) root         (0)      167 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/files/english_sentence.txt
+-rwxrwxrwx   0 root         (0) root         (0)      166 2022-11-27 03:30:20.000000 pyaibox-1.1.21/data/files/english_sentence_decompressed.txt
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.434100 pyaibox-1.1.21/data/images/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.433631 pyaibox-1.1.21/data/images/dgi/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.522992 pyaibox-1.1.21/data/images/dgi/characters/
+-rwxrwxrwx   0 root         (0) root         (0)      599 2022-06-03 12:24:43.000000 pyaibox-1.1.21/data/images/dgi/characters/0_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      274 2022-06-03 12:25:16.000000 pyaibox-1.1.21/data/images/dgi/characters/1_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      555 2022-06-03 12:25:52.000000 pyaibox-1.1.21/data/images/dgi/characters/2_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      609 2022-06-03 12:26:20.000000 pyaibox-1.1.21/data/images/dgi/characters/3_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      414 2022-06-03 12:27:00.000000 pyaibox-1.1.21/data/images/dgi/characters/4_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      492 2022-06-03 12:28:11.000000 pyaibox-1.1.21/data/images/dgi/characters/5_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      634 2022-06-03 12:27:37.000000 pyaibox-1.1.21/data/images/dgi/characters/6_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      494 2022-06-03 12:28:50.000000 pyaibox-1.1.21/data/images/dgi/characters/7_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      694 2022-06-03 12:29:19.000000 pyaibox-1.1.21/data/images/dgi/characters/8_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      678 2022-06-03 12:29:49.000000 pyaibox-1.1.21/data/images/dgi/characters/9_1.png
+-rwxrwxrwx   0 root         (0) root         (0)      613 2022-06-03 11:45:04.000000 pyaibox-1.1.21/data/images/dgi/characters/A1.png
+-rwxrwxrwx   0 root         (0) root         (0)      626 2022-06-04 00:18:44.000000 pyaibox-1.1.21/data/images/dgi/characters/AI1.png
+-rwxrwxrwx   0 root         (0) root         (0)      524 2022-06-03 11:46:22.000000 pyaibox-1.1.21/data/images/dgi/characters/B1.png
+-rwxrwxrwx   0 root         (0) root         (0)      564 2022-06-03 11:47:38.000000 pyaibox-1.1.21/data/images/dgi/characters/C1.png
+-rwxrwxrwx   0 root         (0) root         (0)      543 2022-06-04 00:31:14.000000 pyaibox-1.1.21/data/images/dgi/characters/CNN1.png
+-rwxrwxrwx   0 root         (0) root         (0)      544 2022-06-03 11:48:27.000000 pyaibox-1.1.21/data/images/dgi/characters/D1.png
+-rwxrwxrwx   0 root         (0) root         (0)      679 2022-06-04 01:57:21.000000 pyaibox-1.1.21/data/images/dgi/characters/DIP1.png
+-rwxrwxrwx   0 root         (0) root         (0)      566 2022-06-04 00:30:29.000000 pyaibox-1.1.21/data/images/dgi/characters/DL1.png.png
+-rwxrwxrwx   0 root         (0) root         (0)      613 2022-06-04 00:32:33.000000 pyaibox-1.1.21/data/images/dgi/characters/DSP1.png
+-rwxrwxrwx   0 root         (0) root         (0)      241 2022-06-03 11:49:18.000000 pyaibox-1.1.21/data/images/dgi/characters/E1.png
+-rwxrwxrwx   0 root         (0) root         (0)      237 2022-06-03 11:50:13.000000 pyaibox-1.1.21/data/images/dgi/characters/F1.png
+-rwxrwxrwx   0 root         (0) root         (0)      605 2022-06-03 11:51:01.000000 pyaibox-1.1.21/data/images/dgi/characters/G1.png
+-rwxrwxrwx   0 root         (0) root         (0)      240 2022-06-03 11:51:50.000000 pyaibox-1.1.21/data/images/dgi/characters/H1.png
+-rwxrwxrwx   0 root         (0) root         (0)      248 2022-06-04 00:27:40.000000 pyaibox-1.1.21/data/images/dgi/characters/H11.png
+-rwxrwxrwx   0 root         (0) root         (0)      226 2022-06-03 11:52:57.000000 pyaibox-1.1.21/data/images/dgi/characters/I1.png
+-rwxrwxrwx   0 root         (0) root         (0)      329 2022-06-03 11:53:38.000000 pyaibox-1.1.21/data/images/dgi/characters/J1.png
+-rwxrwxrwx   0 root         (0) root         (0)      515 2022-06-03 11:54:16.000000 pyaibox-1.1.21/data/images/dgi/characters/K1.png
+-rwxrwxrwx   0 root         (0) root         (0)      234 2022-06-03 11:54:53.000000 pyaibox-1.1.21/data/images/dgi/characters/L1.png
+-rwxrwxrwx   0 root         (0) root         (0)      559 2022-06-03 11:55:39.000000 pyaibox-1.1.21/data/images/dgi/characters/M1.png
+-rwxrwxrwx   0 root         (0) root         (0)      570 2022-06-04 00:29:39.000000 pyaibox-1.1.21/data/images/dgi/characters/ML1.png
+-rwxrwxrwx   0 root         (0) root         (0)      481 2022-06-03 11:56:18.000000 pyaibox-1.1.21/data/images/dgi/characters/N1.png
+-rwxrwxrwx   0 root         (0) root         (0)      654 2022-06-03 11:56:54.000000 pyaibox-1.1.21/data/images/dgi/characters/O1.png
+-rwxrwxrwx   0 root         (0) root         (0)      422 2022-06-03 11:57:31.000000 pyaibox-1.1.21/data/images/dgi/characters/P1.png
+-rwxrwxrwx   0 root         (0) root         (0)      690 2022-06-03 11:58:09.000000 pyaibox-1.1.21/data/images/dgi/characters/Q1.png
+-rwxrwxrwx   0 root         (0) root         (0)      511 2022-06-03 11:58:59.000000 pyaibox-1.1.21/data/images/dgi/characters/R1.png
+-rwxrwxrwx   0 root         (0) root         (0)      634 2022-06-03 11:59:41.000000 pyaibox-1.1.21/data/images/dgi/characters/S1.png
+-rwxrwxrwx   0 root         (0) root         (0)      724 2022-06-04 00:33:40.000000 pyaibox-1.1.21/data/images/dgi/characters/SR1.png
+-rwxrwxrwx   0 root         (0) root         (0)      233 2022-06-03 12:00:15.000000 pyaibox-1.1.21/data/images/dgi/characters/T1.png
+-rwxrwxrwx   0 root         (0) root         (0)      427 2022-06-03 12:00:59.000000 pyaibox-1.1.21/data/images/dgi/characters/U1.png
+-rwxrwxrwx   0 root         (0) root         (0)      672 2022-06-03 12:01:41.000000 pyaibox-1.1.21/data/images/dgi/characters/V1.png
+-rwxrwxrwx   0 root         (0) root         (0)      770 2022-06-03 12:02:18.000000 pyaibox-1.1.21/data/images/dgi/characters/W1.png
+-rwxrwxrwx   0 root         (0) root         (0)      637 2022-06-03 12:02:52.000000 pyaibox-1.1.21/data/images/dgi/characters/X1.png
+-rwxrwxrwx   0 root         (0) root         (0)      465 2022-06-03 12:03:29.000000 pyaibox-1.1.21/data/images/dgi/characters/Y1.png
+-rwxrwxrwx   0 root         (0) root         (0)      479 2022-06-03 12:32:27.000000 pyaibox-1.1.21/data/images/dgi/characters/Z1.png
+-rwxrwxrwx   0 root         (0) root         (0)      237 2022-06-03 12:13:41.000000 pyaibox-1.1.21/data/images/dgi/characters/add1.png
+-rwxrwxrwx   0 root         (0) root         (0)      598 2022-06-03 14:20:55.000000 pyaibox-1.1.21/data/images/dgi/characters/alpha1.png
+-rwxrwxrwx   0 root         (0) root         (0)      734 2022-06-03 12:08:27.000000 pyaibox-1.1.21/data/images/dgi/characters/and1.png
+-rwxrwxrwx   0 root         (0) root         (0)      971 2022-06-03 12:04:42.000000 pyaibox-1.1.21/data/images/dgi/characters/at1.png
+-rwxrwxrwx   0 root         (0) root         (0)      474 2022-06-03 12:21:02.000000 pyaibox-1.1.21/data/images/dgi/characters/backslash1.png
+-rwxrwxrwx   0 root         (0) root         (0)      622 2022-06-03 14:21:50.000000 pyaibox-1.1.21/data/images/dgi/characters/beta1.png
+-rwxrwxrwx   0 root         (0) root         (0)      437 2022-06-04 00:15:22.000000 pyaibox-1.1.21/data/images/dgi/characters/cap1.png
+-rwxrwxrwx   0 root         (0) root         (0)      229 2022-06-04 00:53:04.000000 pyaibox-1.1.21/data/images/dgi/characters/colon1.png
+-rwxrwxrwx   0 root         (0) root         (0)      302 2022-06-04 00:49:37.000000 pyaibox-1.1.21/data/images/dgi/characters/comma1.png
+-rwxrwxrwx   0 root         (0) root         (0)      428 2022-06-04 00:17:00.000000 pyaibox-1.1.21/data/images/dgi/characters/cup1.png
+-rwxrwxrwx   0 root         (0) root         (0)      687 2022-06-03 12:23:51.000000 pyaibox-1.1.21/data/images/dgi/characters/curlybracket1.png
+-rwxrwxrwx   0 root         (0) root         (0)      684 2022-06-04 00:12:39.000000 pyaibox-1.1.21/data/images/dgi/characters/delta1.png
+-rwxrwxrwx   0 root         (0) root         (0)      467 2022-06-03 12:19:57.000000 pyaibox-1.1.21/data/images/dgi/characters/divide1.png
+-rwxrwxrwx   0 root         (0) root         (0)      602 2022-06-03 12:07:08.000000 pyaibox-1.1.21/data/images/dgi/characters/dolar1.png
+-rwxrwxrwx   0 root         (0) root         (0)      230 2022-06-04 00:54:41.000000 pyaibox-1.1.21/data/images/dgi/characters/doublequotes1.png
+-rwxrwxrwx   0 root         (0) root         (0)      463 2022-06-04 00:57:36.000000 pyaibox-1.1.21/data/images/dgi/characters/doublequotes2.png
+-rwxrwxrwx   0 root         (0) root         (0)      223 2022-06-04 01:06:13.000000 pyaibox-1.1.21/data/images/dgi/characters/ellipsis1.png
+-rwxrwxrwx   0 root         (0) root         (0)      534 2022-06-03 14:25:34.000000 pyaibox-1.1.21/data/images/dgi/characters/epsilon1.png
+-rwxrwxrwx   0 root         (0) root         (0)      228 2022-06-03 12:14:18.000000 pyaibox-1.1.21/data/images/dgi/characters/equal1.png
+-rwxrwxrwx   0 root         (0) root         (0)      384 2022-06-03 14:24:32.000000 pyaibox-1.1.21/data/images/dgi/characters/eta1.png
+-rwxrwxrwx   0 root         (0) root         (0)      247 2022-06-03 14:16:11.000000 pyaibox-1.1.21/data/images/dgi/characters/exclamation1.png
+-rwxrwxrwx   0 root         (0) root         (0)      549 2022-06-03 14:23:01.000000 pyaibox-1.1.21/data/images/dgi/characters/gamma1.png
+-rwxrwxrwx   0 root         (0) root         (0)      481 2022-06-03 12:15:58.000000 pyaibox-1.1.21/data/images/dgi/characters/grater1.png
+-rwxrwxrwx   0 root         (0) root         (0)      293 2022-06-04 01:07:13.000000 pyaibox-1.1.21/data/images/dgi/characters/grave1.png
+-rwxrwxrwx   0 root         (0) root         (0)      526 2022-06-03 12:31:56.000000 pyaibox-1.1.21/data/images/dgi/characters/hash1.png
+-rwxrwxrwx   0 root         (0) root         (0)      395 2022-06-03 12:17:55.000000 pyaibox-1.1.21/data/images/dgi/characters/hat1.png
+-rwxrwxrwx   0 root         (0) root         (0)      617 2022-06-03 14:29:59.000000 pyaibox-1.1.21/data/images/dgi/characters/infty1.png
+-rwxrwxrwx   0 root         (0) root         (0)      475 2022-06-03 14:26:56.000000 pyaibox-1.1.21/data/images/dgi/characters/integral1.png
+-rwxrwxrwx   0 root         (0) root         (0)      582 2022-06-03 14:23:47.000000 pyaibox-1.1.21/data/images/dgi/characters/lambda1.png
+-rwxrwxrwx   0 root         (0) root         (0)      499 2022-06-03 12:11:02.000000 pyaibox-1.1.21/data/images/dgi/characters/leftparentheses.png
+-rwxrwxrwx   0 root         (0) root         (0)      503 2022-06-03 12:15:22.000000 pyaibox-1.1.21/data/images/dgi/characters/less1.png
+-rwxrwxrwx   0 root         (0) root         (0)      701 2022-06-03 12:13:00.000000 pyaibox-1.1.21/data/images/dgi/characters/parentheses1.png
+-rwxrwxrwx   0 root         (0) root         (0)      824 2022-06-03 12:07:41.000000 pyaibox-1.1.21/data/images/dgi/characters/percent1.png
+-rwxrwxrwx   0 root         (0) root         (0)      224 2022-06-04 00:51:22.000000 pyaibox-1.1.21/data/images/dgi/characters/period1.png
+-rwxrwxrwx   0 root         (0) root         (0)      309 2022-06-03 14:28:57.000000 pyaibox-1.1.21/data/images/dgi/characters/pi1.png
+-rwxrwxrwx   0 root         (0) root         (0)      475 2022-06-03 12:18:58.000000 pyaibox-1.1.21/data/images/dgi/characters/question1.png
+-rwxrwxrwx   0 root         (0) root         (0)      357 2022-06-04 00:58:35.000000 pyaibox-1.1.21/data/images/dgi/characters/quotes2.png
+-rwxrwxrwx   0 root         (0) root         (0)      494 2022-06-03 12:11:39.000000 pyaibox-1.1.21/data/images/dgi/characters/rightparentheses.png
+-rwxrwxrwx   0 root         (0) root         (0)      801 2022-06-03 14:18:47.000000 pyaibox-1.1.21/data/images/dgi/characters/sar1.png
+-rwxrwxrwx   0 root         (0) root         (0)      301 2022-06-04 00:48:37.000000 pyaibox-1.1.21/data/images/dgi/characters/semicolon1.png
+-rwxrwxrwx   0 root         (0) root         (0)      569 2022-06-04 00:13:51.000000 pyaibox-1.1.21/data/images/dgi/characters/sigma1.png
+-rwxrwxrwx   0 root         (0) root         (0)      467 2022-06-03 12:20:32.000000 pyaibox-1.1.21/data/images/dgi/characters/slash1.png
+-rwxrwxrwx   0 root         (0) root         (0)      246 2022-06-03 12:33:53.000000 pyaibox-1.1.21/data/images/dgi/characters/squarebrackets1.png
+-rwxrwxrwx   0 root         (0) root         (0)      441 2022-06-03 12:09:16.000000 pyaibox-1.1.21/data/images/dgi/characters/star1.png
+-rwxrwxrwx   0 root         (0) root         (0)      226 2022-06-03 12:22:28.000000 pyaibox-1.1.21/data/images/dgi/characters/sticks1.png
+-rwxrwxrwx   0 root         (0) root         (0)      225 2022-06-03 12:12:13.000000 pyaibox-1.1.21/data/images/dgi/characters/sub1.png
+-rwxrwxrwx   0 root         (0) root         (0)      539 2022-06-03 14:27:59.000000 pyaibox-1.1.21/data/images/dgi/characters/sum1.png
+-rwxrwxrwx   0 root         (0) root         (0)      380 2022-06-03 12:17:21.000000 pyaibox-1.1.21/data/images/dgi/characters/tilde1.png
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.530970 pyaibox-1.1.21/data/images/dgi/shapes/
+-rwxrwxrwx   0 root         (0) root         (0)     5131 2021-03-24 01:20:14.000000 pyaibox-1.1.21/data/images/dgi/shapes/Airplane.png
+-rwxrwxrwx   0 root         (0) root         (0)     3786 2021-03-24 01:28:30.000000 pyaibox-1.1.21/data/images/dgi/shapes/AirplanePoints.png
+-rwxrwxrwx   0 root         (0) root         (0)      236 2021-03-24 01:20:14.000000 pyaibox-1.1.21/data/images/dgi/shapes/ArrowPoints.png
+-rwxrwxrwx   0 root         (0) root         (0)      241 2021-03-24 01:20:15.000000 pyaibox-1.1.21/data/images/dgi/shapes/CirclePoints.png
+-rwxrwxrwx   0 root         (0) root         (0)      321 2021-03-24 01:20:15.000000 pyaibox-1.1.21/data/images/dgi/shapes/Diamond.png
+-rwxrwxrwx   0 root         (0) root         (0)      239 2021-03-24 01:20:15.000000 pyaibox-1.1.21/data/images/dgi/shapes/DiamondPoints.png
+-rwxrwxrwx   0 root         (0) root         (0)      291 2021-03-24 01:20:15.000000 pyaibox-1.1.21/data/images/dgi/shapes/LinePoints.png
+-rwxrwxrwx   0 root         (0) root         (0)      247 2021-03-24 01:20:16.000000 pyaibox-1.1.21/data/images/dgi/shapes/OnePoint.png
+-rwxrwxrwx   0 root         (0) root         (0)      493 2021-03-03 09:03:25.000000 pyaibox-1.1.21/data/images/dgi/shapes/Points64.png
+-rwxrwxrwx   0 root         (0) root         (0)      179 2021-03-24 01:20:16.000000 pyaibox-1.1.21/data/images/dgi/shapes/RectanglePoints.png
+-rwxrwxrwx   0 root         (0) root         (0)      218 2022-06-04 01:24:31.000000 pyaibox-1.1.21/data/images/dgi/shapes/SmilePoints.png
+-rwxrwxrwx   0 root         (0) root         (0)      210 2021-03-24 01:20:16.000000 pyaibox-1.1.21/data/images/dgi/shapes/TrianglePoints.png
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.558625 pyaibox-1.1.21/data/images/oi/
+-rwxrwxrwx   0 root         (0) root         (0)    14970 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/images/oi/Einstein128.png
+-rwxrwxrwx   0 root         (0) root         (0)    53102 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/images/oi/Einstein256.png
+-rwxrwxrwx   0 root         (0) root         (0)    11171 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/images/oi/LenaGRAY128.png
+-rwxrwxrwx   0 root         (0) root         (0)    41746 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/images/oi/LenaGRAY256.png
+-rwxrwxrwx   0 root         (0) root         (0)   154038 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/images/oi/LenaGRAY512.png
+-rwxrwxrwx   0 root         (0) root         (0)   792056 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/images/oi/LenaRGB512.tif
+-rwxrwxrwx   0 root         (0) root         (0)   484322 2022-05-30 14:44:27.000000 pyaibox-1.1.21/data/images/oi/Lighthouse.png
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.575249 pyaibox-1.1.21/data/images/rsi/
+-rwxrwxrwx   0 root         (0) root         (0)     3199 2019-05-28 12:48:40.000000 pyaibox-1.1.21/data/images/rsi/000001.png
+-rwxrwxrwx   0 root         (0) root         (0)     3354 2019-05-28 12:10:53.000000 pyaibox-1.1.21/data/images/rsi/000007.png
+-rwxrwxrwx   0 root         (0) root         (0)     2721 2019-05-28 12:40:10.000000 pyaibox-1.1.21/data/images/rsi/000082.png
+-rwxrwxrwx   0 root         (0) root         (0)     2904 2019-05-28 12:19:10.000000 pyaibox-1.1.21/data/images/rsi/000120.png
+-rwxrwxrwx   0 root         (0) root         (0)     3208 2019-05-28 12:01:56.000000 pyaibox-1.1.21/data/images/rsi/000167.png
+-rwxrwxrwx   0 root         (0) root         (0)     3674 2019-05-28 12:01:57.000000 pyaibox-1.1.21/data/images/rsi/000170.png
+-rwxrwxrwx   0 root         (0) root         (0)     2945 2019-05-28 12:01:57.000000 pyaibox-1.1.21/data/images/rsi/000174.png
+-rwxrwxrwx   0 root         (0) root         (0)     2865 2019-05-28 12:28:31.000000 pyaibox-1.1.21/data/images/rsi/000296.png
+-rwxrwxrwx   0 root         (0) root         (0)     2578 2022-06-04 01:34:36.000000 pyaibox-1.1.21/data/images/rsi/Ship1.png
+-rwxrwxrwx   0 root         (0) root         (0)     2577 2022-06-04 01:35:34.000000 pyaibox-1.1.21/data/images/rsi/Ship2.png
+-rwxrwxrwx   0 root         (0) root         (0)     2797 2022-06-04 01:36:37.000000 pyaibox-1.1.21/data/images/rsi/Ship3.png
+-rwxrwxrwx   0 root         (0) root         (0)     2783 2022-06-04 01:39:02.000000 pyaibox-1.1.21/data/images/rsi/Ship4.png
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.434612 pyaibox-1.1.21/docs/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.590452 pyaibox-1.1.21/docs/source/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.638234 pyaibox-1.1.21/docs/source/_static/
+-rwxrwxrwx   0 root         (0) root         (0)   316818 2022-07-16 13:58:15.000000 pyaibox-1.1.21/docs/source/_static/CT2RTRT2CTdemo.png
+-rwxrwxrwx   0 root         (0) root         (0)    77782 2022-12-17 01:18:35.000000 pyaibox-1.1.21/docs/source/_static/ConfusionMatrixRich.png
+-rwxrwxrwx   0 root         (0) root         (0)    66750 2022-12-17 01:02:05.000000 pyaibox-1.1.21/docs/source/_static/ConfusionMatrixSimple.png
+-rwxrwxrwx   0 root         (0) root         (0)   373154 2022-06-18 14:19:10.000000 pyaibox-1.1.21/docs/source/_static/DemoIMNOISE.png
+-rwxrwxrwx   0 root         (0) root         (0)   440570 2022-06-18 14:10:10.000000 pyaibox-1.1.21/docs/source/_static/DemoNoiseAWGNS.png
+-rwxrwxrwx   0 root         (0) root         (0)   122255 2022-06-14 15:02:25.000000 pyaibox-1.1.21/docs/source/_static/FFTIFFTdemo.png
+-rwxrwxrwx   0 root         (0) root         (0)   138288 2022-12-18 10:38:43.000000 pyaibox-1.1.21/docs/source/_static/MNISTPCA_K70.png
+-rwxrwxrwx   0 root         (0) root         (0)   161356 2022-12-18 10:38:29.000000 pyaibox-1.1.21/docs/source/_static/MNISTPCA_K90.png
+-rwxrwxrwx   0 root         (0) root         (0)    98883 2022-12-18 10:38:14.000000 pyaibox-1.1.21/docs/source/_static/MNISTPCA_ORIG.png
+-rwxrwxrwx   0 root         (0) root         (0)   184961 2022-06-04 13:52:03.000000 pyaibox-1.1.21/docs/source/_static/SHOW1_BTR70_HB03787.png
+-rwxrwxrwx   0 root         (0) root         (0)   278320 2022-06-04 14:02:23.000000 pyaibox-1.1.21/docs/source/_static/SHOW_BTR70_HB03787.png
+-rwxrwxrwx   0 root         (0) root         (0)   223839 2022-04-04 05:17:04.000000 pyaibox-1.1.21/docs/source/_static/demo_draw_rectangles.png
+-rwxrwxrwx   0 root         (0) root         (0)   231175 2022-04-04 05:17:52.000000 pyaibox-1.1.21/docs/source/_static/demo_plot_bboxes.png
+-rwxrwxrwx   0 root         (0) root         (0)    23564 2022-04-04 05:19:12.000000 pyaibox-1.1.21/docs/source/_static/demo_randgrid.png
+-rwxrwxrwx   0 root         (0) root         (0)   605281 2022-04-04 06:15:15.000000 pyaibox-1.1.21/docs/source/_static/demo_sample_patch.png
+-rwxrwxrwx   0 root         (0) root         (0)   114848 2022-12-11 04:07:44.000000 pyaibox-1.1.21/docs/source/_static/fashionmnist.png
+-rwxrwxrwx   0 root         (0) root         (0)    67635 2022-12-11 04:12:56.000000 pyaibox-1.1.21/docs/source/_static/mnist.png
+-rwxrwxrwx   0 root         (0) root         (0)     6313 2022-12-04 05:59:40.000000 pyaibox-1.1.21/docs/source/conf.py
+-rwxrwxrwx   0 root         (0) root         (0)      446 2022-05-30 13:55:36.000000 pyaibox-1.1.21/docs/source/getstarted.rst
+-rwxrwxrwx   0 root         (0) root         (0)      466 2022-05-30 13:55:36.000000 pyaibox-1.1.21/docs/source/index.rst
+-rwxrwxrwx   0 root         (0) root         (0)       67 2022-05-30 14:31:19.000000 pyaibox-1.1.21/docs/source/modules.rst
+-rwxrwxrwx   0 root         (0) root         (0)      945 2022-06-19 14:39:29.000000 pyaibox-1.1.21/docs/source/pyaibox.base.rst
+-rwxrwxrwx   0 root         (0) root         (0)      396 2022-06-14 15:58:48.000000 pyaibox-1.1.21/docs/source/pyaibox.compression.rst
+-rwxrwxrwx   0 root         (0) root         (0)      504 2022-06-14 15:58:48.000000 pyaibox-1.1.21/docs/source/pyaibox.datasets.rst
+-rwxrwxrwx   0 root         (0) root         (0)     1445 2023-04-02 04:42:03.000000 pyaibox-1.1.21/docs/source/pyaibox.dsp.rst
+-rwxrwxrwx   0 root         (0) root         (0)     1389 2022-12-14 15:17:20.000000 pyaibox-1.1.21/docs/source/pyaibox.evaluation.rst
+-rwxrwxrwx   0 root         (0) root         (0)     1148 2022-06-19 14:39:29.000000 pyaibox-1.1.21/docs/source/pyaibox.misc.rst
+-rwxrwxrwx   0 root         (0) root         (0)      526 2022-12-19 13:13:50.000000 pyaibox-1.1.21/docs/source/pyaibox.ml.rst
+-rwxrwxrwx   0 root         (0) root         (0)      331 2022-06-14 15:58:48.000000 pyaibox-1.1.21/docs/source/pyaibox.nn.rst
+-rwxrwxrwx   0 root         (0) root         (0)      533 2022-12-19 13:13:49.000000 pyaibox-1.1.21/docs/source/pyaibox.rst
+-rwxrwxrwx   0 root         (0) root         (0)      354 2022-06-14 15:58:48.000000 pyaibox-1.1.21/docs/source/pyaibox.summary.rst
+-rwxrwxrwx   0 root         (0) root         (0)     1528 2022-06-26 11:23:11.000000 pyaibox-1.1.21/docs/source/pyaibox.utils.rst
+-rwxrwxrwx   0 root         (0) root         (0)      103 2022-06-14 15:58:47.000000 pyaibox-1.1.21/docs/source/setup.rst
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.437639 pyaibox-1.1.21/examples/
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.639814 pyaibox-1.1.21/examples/base/
+-rwxrwxrwx   0 root         (0) root         (0)      828 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/base/demo_random.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.640580 pyaibox-1.1.21/examples/compression/
+-rwxrwxrwx   0 root         (0) root         (0)      253 2022-11-27 03:30:18.000000 pyaibox-1.1.21/examples/compression/demo_huffman_coding.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.642239 pyaibox-1.1.21/examples/datasets/
+-rwxrwxrwx   0 root         (0) root         (0)     1416 2022-12-11 13:03:16.000000 pyaibox-1.1.21/examples/datasets/demo_read_fashionmnist.py
+-rwxrwxrwx   0 root         (0) root         (0)     1572 2022-12-11 13:03:01.000000 pyaibox-1.1.21/examples/datasets/demo_read_mnist.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.650493 pyaibox-1.1.21/examples/dsp/
+-rwxrwxrwx   0 root         (0) root         (0)      884 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/dsp/demo_fft.py
+-rwxrwxrwx   0 root         (0) root         (0)      576 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/dsp/demo_fft_image.py
+-rwxrwxrwx   0 root         (0) root         (0)     2604 2022-06-14 14:58:53.000000 pyaibox-1.1.21/examples/dsp/demo_fft_sincos.py
+-rwxrwxrwx   0 root         (0) root         (0)      952 2023-04-22 11:15:27.000000 pyaibox-1.1.21/examples/dsp/demo_fftshift.py
+-rwxrwxrwx   0 root         (0) root         (0)     1044 2022-06-14 15:04:36.000000 pyaibox-1.1.21/examples/dsp/demo_freq.py
+-rwxrwxrwx   0 root         (0) root         (0)      869 2021-03-03 09:03:26.000000 pyaibox-1.1.21/examples/dsp/demo_interp_complex.py
+-rwxrwxrwx   0 root         (0) root         (0)      558 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/dsp/demo_polyfit.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.653510 pyaibox-1.1.21/examples/evaluation/
+-rwxrwxrwx   0 root         (0) root         (0)     1778 2023-01-06 13:20:39.000000 pyaibox-1.1.21/examples/evaluation/demo_classification.py
+-rwxrwxrwx   0 root         (0) root         (0)      581 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/evaluation/demo_contrast.py
+-rwxrwxrwx   0 root         (0) root         (0)      400 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/evaluation/demo_entropy.py
+-rwxrwxrwx   0 root         (0) root         (0)      401 2022-05-30 14:20:25.000000 pyaibox-1.1.21/examples/evaluation/demo_norm.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.662112 pyaibox-1.1.21/examples/misc/
+-rwxrwxrwx   0 root         (0) root         (0)     1511 2022-06-19 13:17:54.000000 pyaibox-1.1.21/examples/misc/demo_awgns.py
+-rwxrwxrwx   0 root         (0) root         (0)      878 2022-07-11 14:46:51.000000 pyaibox-1.1.21/examples/misc/demo_complex2real_fft.py
+-rwxrwxrwx   0 root         (0) root         (0)     1199 2022-06-04 05:15:19.000000 pyaibox-1.1.21/examples/misc/demo_dnsampling.py
+-rwxrwxrwx   0 root         (0) root         (0)      939 2022-06-04 05:15:25.000000 pyaibox-1.1.21/examples/misc/demo_draw_rectangles.py
+-rwxrwxrwx   0 root         (0) root         (0)      944 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/misc/demo_mapping.py
+-rwxrwxrwx   0 root         (0) root         (0)     1005 2022-06-04 05:15:32.000000 pyaibox-1.1.21/examples/misc/demo_plot_bboxes.py
+-rwxrwxrwx   0 root         (0) root         (0)      843 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/misc/demo_readsamples.py
+-rwxrwxrwx   0 root         (0) root         (0)     2760 2022-06-04 05:15:48.000000 pyaibox-1.1.21/examples/misc/demo_sample_patch.py
+-rwxrwxrwx   0 root         (0) root         (0)      748 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/misc/demo_shuffle_tensor.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.662724 pyaibox-1.1.21/examples/ml/
+-rwxrwxrwx   0 root         (0) root         (0)     2427 2023-06-05 23:29:11.000000 pyaibox-1.1.21/examples/ml/demo_mnist_pca.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.663346 pyaibox-1.1.21/examples/summary/
+-rwxrwxrwx   0 root         (0) root         (0)      499 2022-05-30 14:21:03.000000 pyaibox-1.1.21/examples/summary/demo_loss_log.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.671746 pyaibox-1.1.21/examples/utils/
+-rwxrwxrwx   0 root         (0) root         (0)      558 2022-06-04 04:25:08.000000 pyaibox-1.1.21/examples/utils/demo_bin.py
+-rwxrwxrwx   0 root         (0) root         (0)      860 2022-12-14 16:05:49.000000 pyaibox-1.1.21/examples/utils/demo_colors.py
+-rwxrwxrwx   0 root         (0) root         (0)     1709 2022-12-11 14:41:38.000000 pyaibox-1.1.21/examples/utils/demo_convert.py
+-rwxrwxrwx   0 root         (0) root         (0)     1492 2023-06-27 07:53:27.000000 pyaibox-1.1.21/examples/utils/demo_delete_c_comments.py
+-rwxrwxrwx   0 root         (0) root         (0)     1586 2023-06-27 14:03:45.000000 pyaibox-1.1.21/examples/utils/demo_docstring.py
+-rwxrwxrwx   0 root         (0) root         (0)      499 2022-06-04 05:14:58.000000 pyaibox-1.1.21/examples/utils/demo_file.py
+-rwxrwxrwx   0 root         (0) root         (0)     1221 2022-11-03 13:51:54.000000 pyaibox-1.1.21/examples/utils/demo_ios.py
+-rwxrwxrwx   0 root         (0) root         (0)      682 2022-05-30 13:56:26.000000 pyaibox-1.1.21/examples/utils/demo_read_log.py
+-rwxrwxrwx   0 root         (0) root         (0)      563 2022-06-11 08:53:57.000000 pyaibox-1.1.21/examples/utils/demo_typevalue.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.675842 pyaibox-1.1.21/pyaibox/
+-rwxrwxrwx   0 root         (0) root         (0)     3055 2023-06-11 02:34:29.000000 pyaibox-1.1.21/pyaibox/__init__.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.718707 pyaibox-1.1.21/pyaibox/base/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2022-04-04 07:47:50.000000 pyaibox-1.1.21/pyaibox/base/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   326607 2023-06-27 14:13:24.000000 pyaibox-1.1.21/pyaibox/base/arrayops.c
+-rwxrwxrwx   0 root         (0) root         (0)     6128 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/base/arrayops.py
+-rwxrwxrwx   0 root         (0) root         (0)     2379 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/base/arrayops.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   280740 2023-06-27 14:13:25.000000 pyaibox-1.1.21/pyaibox/base/baseops.c
+-rwxrwxrwx   0 root         (0) root         (0)     4405 2023-06-10 15:53:32.000000 pyaibox-1.1.21/pyaibox/base/baseops.py
+-rwxrwxrwx   0 root         (0) root         (0)     1858 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/base/baseops.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   742229 2023-06-27 14:13:25.000000 pyaibox-1.1.21/pyaibox/base/mathops.c
+-rwxrwxrwx   0 root         (0) root         (0)    24349 2023-05-11 14:13:35.000000 pyaibox-1.1.21/pyaibox/base/mathops.py
+-rwxrwxrwx   0 root         (0) root         (0)    15837 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/base/mathops.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   354425 2023-06-27 14:13:25.000000 pyaibox-1.1.21/pyaibox/base/randomfunc.c
+-rwxrwxrwx   0 root         (0) root         (0)     8400 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/base/randomfunc.py
+-rwxrwxrwx   0 root         (0) root         (0)     4093 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/base/randomfunc.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   238446 2023-06-27 14:13:25.000000 pyaibox-1.1.21/pyaibox/base/typevalue.c
+-rwxrwxrwx   0 root         (0) root         (0)     2402 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/base/typevalue.py
+-rwxrwxrwx   0 root         (0) root         (0)      277 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/base/typevalue.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.725488 pyaibox-1.1.21/pyaibox/compression/
+-rwxrwxrwx   0 root         (0) root         (0)       40 2021-03-03 09:03:26.000000 pyaibox-1.1.21/pyaibox/compression/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   454824 2023-06-27 14:13:25.000000 pyaibox-1.1.21/pyaibox/compression/huffman_coding.c
+-rwxrwxrwx   0 root         (0) root         (0)     5195 2022-12-14 15:14:10.000000 pyaibox-1.1.21/pyaibox/compression/huffman_coding.py
+-rwxrwxrwx   0 root         (0) root         (0)     1098 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/compression/huffman_coding.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.736068 pyaibox-1.1.21/pyaibox/datasets/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2022-06-04 07:38:12.000000 pyaibox-1.1.21/pyaibox/datasets/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   267870 2023-06-27 14:13:25.000000 pyaibox-1.1.21/pyaibox/datasets/mnist.c
+-rwxrwxrwx   0 root         (0) root         (0)     5100 2022-12-14 15:29:19.000000 pyaibox-1.1.21/pyaibox/datasets/mnist.py
+-rwxrwxrwx   0 root         (0) root         (0)     2395 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/datasets/mnist.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   332134 2023-06-27 14:13:25.000000 pyaibox-1.1.21/pyaibox/datasets/mstar.c
+-rwxrwxrwx   0 root         (0) root         (0)     6722 2022-12-14 15:06:04.000000 pyaibox-1.1.21/pyaibox/datasets/mstar.py
+-rwxrwxrwx   0 root         (0) root         (0)     3240 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/datasets/mstar.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.783008 pyaibox-1.1.21/pyaibox/dsp/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2022-04-04 07:47:55.000000 pyaibox-1.1.21/pyaibox/dsp/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   408400 2023-06-27 14:17:48.000000 pyaibox-1.1.21/pyaibox/dsp/convolution.c
+-rwxrwxrwx   0 root         (0) root         (0)     8571 2023-06-27 14:17:40.000000 pyaibox-1.1.21/pyaibox/dsp/convolution.py
+-rwxrwxrwx   0 root         (0) root         (0)     3630 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/convolution.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   590014 2023-06-27 14:17:48.000000 pyaibox-1.1.21/pyaibox/dsp/correlation.c
+-rwxrwxrwx   0 root         (0) root         (0)    13108 2023-04-02 04:35:01.000000 pyaibox-1.1.21/pyaibox/dsp/correlation.py
+-rwxrwxrwx   0 root         (0) root         (0)     5120 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/correlation.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   500093 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/dsp/ffts.c
+-rwxrwxrwx   0 root         (0) root         (0)    17912 2023-04-22 11:08:46.000000 pyaibox-1.1.21/pyaibox/dsp/ffts.py
+-rwxrwxrwx   0 root         (0) root         (0)    10674 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/ffts.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   171298 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/dsp/frffts.c
+-rwxrwxrwx   0 root         (0) root         (0)    10948 2023-04-02 07:26:23.000000 pyaibox-1.1.21/pyaibox/dsp/frffts.py
+-rwxrwxrwx   0 root         (0) root         (0)     9838 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/frffts.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   225227 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/dsp/function_base.c
+-rwxrwxrwx   0 root         (0) root         (0)     4149 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/dsp/function_base.py
+-rwxrwxrwx   0 root         (0) root         (0)     3074 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/function_base.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   375887 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/dsp/interpolation1d.c
+-rwxrwxrwx   0 root         (0) root         (0)     5276 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/dsp/interpolation1d.py
+-rwxrwxrwx   0 root         (0) root         (0)      876 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/interpolation1d.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   220920 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/dsp/interpolation2d.c
+-rwxrwxrwx   0 root         (0) root         (0)     2012 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/dsp/interpolation2d.py
+-rwxrwxrwx   0 root         (0) root         (0)       70 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/interpolation2d.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   363905 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/dsp/normalsignals.c
+-rwxrwxrwx   0 root         (0) root         (0)     5500 2023-04-02 04:43:58.000000 pyaibox-1.1.21/pyaibox/dsp/normalsignals.py
+-rwxrwxrwx   0 root         (0) root         (0)      513 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/dsp/normalsignals.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.835231 pyaibox-1.1.21/pyaibox/evaluation/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2022-03-10 12:24:12.000000 pyaibox-1.1.21/pyaibox/evaluation/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   766785 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/evaluation/classification.c
+-rwxrwxrwx   0 root         (0) root         (0)    23312 2023-05-01 13:11:42.000000 pyaibox-1.1.21/pyaibox/evaluation/classification.py
+-rwxrwxrwx   0 root         (0) root         (0)    17530 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/evaluation/classification.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   252715 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/evaluation/contrast.c
+-rwxrwxrwx   0 root         (0) root         (0)     5640 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/evaluation/contrast.py
+-rwxrwxrwx   0 root         (0) root         (0)     2865 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/evaluation/contrast.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   416999 2023-06-27 14:17:49.000000 pyaibox-1.1.21/pyaibox/evaluation/detection_voc.c
+-rwxrwxrwx   0 root         (0) root         (0)    15039 2022-12-14 15:05:40.000000 pyaibox-1.1.21/pyaibox/evaluation/detection_voc.py
+-rwxrwxrwx   0 root         (0) root         (0)    11445 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/evaluation/detection_voc.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   246611 2023-06-27 14:17:50.000000 pyaibox-1.1.21/pyaibox/evaluation/entropy.c
+-rwxrwxrwx   0 root         (0) root         (0)     5458 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/evaluation/entropy.py
+-rwxrwxrwx   0 root         (0) root         (0)     2747 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/evaluation/entropy.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   901320 2023-06-27 14:17:50.000000 pyaibox-1.1.21/pyaibox/evaluation/error.c
+-rwxrwxrwx   0 root         (0) root         (0)    38534 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/evaluation/error.py
+-rwxrwxrwx   0 root         (0) root         (0)    20564 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/evaluation/error.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   366144 2023-06-27 14:17:50.000000 pyaibox-1.1.21/pyaibox/evaluation/norm.c
+-rwxrwxrwx   0 root         (0) root         (0)     9840 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/evaluation/norm.py
+-rwxrwxrwx   0 root         (0) root         (0)     5068 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/evaluation/norm.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   285194 2023-06-27 14:17:50.000000 pyaibox-1.1.21/pyaibox/evaluation/snrs.c
+-rwxrwxrwx   0 root         (0) root         (0)     9177 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/evaluation/snrs.py
+-rwxrwxrwx   0 root         (0) root         (0)     4347 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/evaluation/snrs.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.882589 pyaibox-1.1.21/pyaibox/misc/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2021-02-08 00:18:02.000000 pyaibox-1.1.21/pyaibox/misc/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   397464 2023-06-27 14:17:50.000000 pyaibox-1.1.21/pyaibox/misc/bounding_box.c
+-rwxrwxrwx   0 root         (0) root         (0)    24112 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/misc/bounding_box.py
+-rwxrwxrwx   0 root         (0) root         (0)     7827 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/misc/bounding_box.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   289984 2023-06-27 14:17:50.000000 pyaibox-1.1.21/pyaibox/misc/draw_shapes.c
+-rwxrwxrwx   0 root         (0) root         (0)     4896 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/misc/draw_shapes.py
+-rwxrwxrwx   0 root         (0) root         (0)     2004 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/misc/draw_shapes.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   247824 2023-06-27 14:17:50.000000 pyaibox-1.1.21/pyaibox/misc/mapping_operation.c
+-rwxrwxrwx   0 root         (0) root         (0)     3608 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/misc/mapping_operation.py
+-rwxrwxrwx   0 root         (0) root         (0)      961 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/misc/mapping_operation.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   490613 2023-06-27 14:17:51.000000 pyaibox-1.1.21/pyaibox/misc/noising.c
+-rwxrwxrwx   0 root         (0) root         (0)    17271 2023-05-07 14:53:10.000000 pyaibox-1.1.21/pyaibox/misc/noising.py
+-rwxrwxrwx   0 root         (0) root         (0)     9307 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/misc/noising.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   841399 2023-06-27 14:17:51.000000 pyaibox-1.1.21/pyaibox/misc/sampling.c
+-rwxrwxrwx   0 root         (0) root         (0)    26634 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/misc/sampling.py
+-rwxrwxrwx   0 root         (0) root         (0)    11204 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/misc/sampling.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   420679 2023-06-27 14:17:51.000000 pyaibox-1.1.21/pyaibox/misc/transform.c
+-rwxrwxrwx   0 root         (0) root         (0)    10247 2022-12-11 12:50:34.000000 pyaibox-1.1.21/pyaibox/misc/transform.py
+-rwxrwxrwx   0 root         (0) root         (0)     5151 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/misc/transform.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.896076 pyaibox-1.1.21/pyaibox/ml/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2022-12-18 07:14:07.000000 pyaibox-1.1.21/pyaibox/ml/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   372482 2023-06-27 14:17:51.000000 pyaibox-1.1.21/pyaibox/ml/dataset_visualization.c
+-rwxrwxrwx   0 root         (0) root         (0)     6371 2023-01-07 04:34:54.000000 pyaibox-1.1.21/pyaibox/ml/dataset_visualization.py
+-rwxrwxrwx   0 root         (0) root         (0)      811 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/ml/dataset_visualization.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   345440 2023-06-27 14:17:51.000000 pyaibox-1.1.21/pyaibox/ml/reduction_pca.c
+-rwxrwxrwx   0 root         (0) root         (0)     6278 2023-06-04 13:43:45.000000 pyaibox-1.1.21/pyaibox/ml/reduction_pca.py
+-rwxrwxrwx   0 root         (0) root         (0)     2555 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/ml/reduction_pca.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.903212 pyaibox-1.1.21/pyaibox/nn/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2022-06-04 05:23:15.000000 pyaibox-1.1.21/pyaibox/nn/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   302965 2023-06-27 14:17:51.000000 pyaibox-1.1.21/pyaibox/nn/activations.c
+-rwxrwxrwx   0 root         (0) root         (0)     6961 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/nn/activations.py
+-rwxrwxrwx   0 root         (0) root         (0)     4166 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/nn/activations.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.910176 pyaibox-1.1.21/pyaibox/summary/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2022-05-19 23:15:11.000000 pyaibox-1.1.21/pyaibox/summary/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   336835 2023-06-27 14:17:51.000000 pyaibox-1.1.21/pyaibox/summary/loss_log.c
+-rwxrwxrwx   0 root         (0) root         (0)     4031 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/summary/loss_log.py
+-rwxrwxrwx   0 root         (0) root         (0)      436 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/summary/loss_log.pyi
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.981172 pyaibox-1.1.21/pyaibox/utils/
+-rwxrwxrwx   0 root         (0) root         (0)        0 2021-03-03 09:03:26.000000 pyaibox-1.1.21/pyaibox/utils/__init__.py
+-rwxrwxrwx   0 root         (0) root         (0)   610751 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/colormaps.c
+-rwxrwxrwx   0 root         (0) root         (0)    17214 2022-03-10 11:55:07.000000 pyaibox-1.1.21/pyaibox/utils/colormaps.py
+-rwxrwxrwx   0 root         (0) root         (0)        1 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/colormaps.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   339387 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/colors.c
+-rwxrwxrwx   0 root         (0) root         (0)     8227 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/utils/colors.py
+-rwxrwxrwx   0 root         (0) root         (0)     2273 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/colors.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   111631 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/const.c
+-rwxrwxrwx   0 root         (0) root         (0)     1402 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/utils/const.py
+-rwxrwxrwx   0 root         (0) root         (0)        1 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/const.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   445283 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/convert.c
+-rwxrwxrwx   0 root         (0) root         (0)    11568 2023-04-26 14:18:29.000000 pyaibox-1.1.21/pyaibox/utils/convert.py
+-rwxrwxrwx   0 root         (0) root         (0)     6415 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/convert.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   356665 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/docstr.c
+-rwxrwxrwx   0 root         (0) root         (0)     5555 2023-06-27 14:03:00.000000 pyaibox-1.1.21/pyaibox/utils/docstr.py
+-rwxrwxrwx   0 root         (0) root         (0)      703 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/docstr.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   452991 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/file.c
+-rwxrwxrwx   0 root         (0) root         (0)    10680 2022-12-15 15:16:10.000000 pyaibox-1.1.21/pyaibox/utils/file.py
+-rwxrwxrwx   0 root         (0) root         (0)     5176 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/file.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   224137 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/image.c
+-rwxrwxrwx   0 root         (0) root         (0)     4175 2022-12-11 12:50:33.000000 pyaibox-1.1.21/pyaibox/utils/image.py
+-rwxrwxrwx   0 root         (0) root         (0)     2281 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/image.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   528430 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/ios.c
+-rwxrwxrwx   0 root         (0) root         (0)    13433 2023-05-08 23:17:44.000000 pyaibox-1.1.21/pyaibox/utils/ios.py
+-rwxrwxrwx   0 root         (0) root         (0)     6557 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/ios.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   660780 2023-06-27 14:17:52.000000 pyaibox-1.1.21/pyaibox/utils/plot_show.c
+-rwxrwxrwx   0 root         (0) root         (0)    17643 2023-04-10 15:21:55.000000 pyaibox-1.1.21/pyaibox/utils/plot_show.py
+-rwxrwxrwx   0 root         (0) root         (0)     7213 2023-06-27 14:03:49.000000 pyaibox-1.1.21/pyaibox/utils/plot_show.pyi
+-rwxrwxrwx   0 root         (0) root         (0)   107304 2023-06-27 14:17:53.000000 pyaibox-1.1.21/pyaibox/version.c
+-rwxrwxrwx   0 root         (0) root         (0)       82 2023-06-27 14:12:29.000000 pyaibox-1.1.21/pyaibox/version.py
+drwxrwxrwx   0 root         (0) root         (0)        0 2023-06-27 14:17:53.679582 pyaibox-1.1.21/pyaibox.egg-info/
+-rwxrwxrwx   0 root         (0) root         (0)      552 2023-06-27 14:17:53.000000 pyaibox-1.1.21/pyaibox.egg-info/PKG-INFO
+-rwxrwxrwx   0 root         (0) root         (0)    10918 2023-06-27 14:17:53.000000 pyaibox-1.1.21/pyaibox.egg-info/SOURCES.txt
+-rwxrwxrwx   0 root         (0) root         (0)        1 2023-06-27 14:17:53.000000 pyaibox-1.1.21/pyaibox.egg-info/dependency_links.txt
+-rwxrwxrwx   0 root         (0) root         (0)       86 2023-06-27 14:17:53.000000 pyaibox-1.1.21/pyaibox.egg-info/requires.txt
+-rwxrwxrwx   0 root         (0) root         (0)        8 2023-06-27 14:17:53.000000 pyaibox-1.1.21/pyaibox.egg-info/top_level.txt
+-rwxrwxrwx   0 root         (0) root         (0)      104 2022-07-03 03:51:09.000000 pyaibox-1.1.21/requirements.txt
+-rwxrwxrwx   0 root         (0) root         (0)       38 2023-06-27 14:17:53.982808 pyaibox-1.1.21/setup.cfg
+-rwxrwxrwx   0 root         (0) root         (0)     3221 2023-01-05 10:35:13.000000 pyaibox-1.1.21/setup.py
```

### Comparing `pyaibox-1.1.20/LICENSE` & `pyaibox-1.1.21/LICENSE`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/PKG-INFO` & `pyaibox-1.1.21/PKG-INFO`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyaibox
-Version: 1.1.20
+Version: 1.1.21
 Summary: Python Library.
 Home-page: https://iridescent.ink/pyaibox/
 Download-URL: https://github.com/antsfamily/pyaibox/
 Author: Zhi Liu
 Author-email: zhiliu.mind@gmail.com
 License: MIT
 Keywords: Python,Library,Digital signal processing,Tool
```

### Comparing `pyaibox-1.1.20/data/binary/mstar/BMP2_HB03787.000` & `pyaibox-1.1.21/data/binary/mstar/BMP2_HB03787.000`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/binary/mstar/BMP2_HB03787.001` & `pyaibox-1.1.21/data/binary/mstar/BMP2_HB03787.001`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/binary/mstar/BMP2_HB03787.002` & `pyaibox-1.1.21/data/binary/mstar/BMP2_HB03787.002`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/binary/mstar/BTR70_HB03787.004` & `pyaibox-1.1.21/data/binary/mstar/BTR70_HB03787.004`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/binary/mstar/T72_HB03787.015` & `pyaibox-1.1.21/data/binary/mstar/T72_HB03787.015`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/0_1.png` & `pyaibox-1.1.21/data/images/dgi/characters/0_1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/2_1.png` & `pyaibox-1.1.21/data/images/dgi/characters/2_1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/3_1.png` & `pyaibox-1.1.21/data/images/dgi/characters/3_1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/6_1.png` & `pyaibox-1.1.21/data/images/dgi/characters/6_1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/8_1.png` & `pyaibox-1.1.21/data/images/dgi/characters/8_1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/9_1.png` & `pyaibox-1.1.21/data/images/dgi/characters/9_1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/A1.png` & `pyaibox-1.1.21/data/images/dgi/characters/A1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/AI1.png` & `pyaibox-1.1.21/data/images/dgi/characters/AI1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/B1.png` & `pyaibox-1.1.21/data/images/dgi/characters/B1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/C1.png` & `pyaibox-1.1.21/data/images/dgi/characters/C1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/CNN1.png` & `pyaibox-1.1.21/data/images/dgi/characters/CNN1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/D1.png` & `pyaibox-1.1.21/data/images/dgi/characters/D1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/DIP1.png` & `pyaibox-1.1.21/data/images/dgi/characters/DIP1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/DL1.png.png` & `pyaibox-1.1.21/data/images/dgi/characters/DL1.png.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/DSP1.png` & `pyaibox-1.1.21/data/images/dgi/characters/DSP1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/G1.png` & `pyaibox-1.1.21/data/images/dgi/characters/G1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/K1.png` & `pyaibox-1.1.21/data/images/dgi/characters/K1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/M1.png` & `pyaibox-1.1.21/data/images/dgi/characters/M1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/ML1.png` & `pyaibox-1.1.21/data/images/dgi/characters/ML1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/O1.png` & `pyaibox-1.1.21/data/images/dgi/characters/O1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/Q1.png` & `pyaibox-1.1.21/data/images/dgi/characters/Q1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/S1.png` & `pyaibox-1.1.21/data/images/dgi/characters/S1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/SR1.png` & `pyaibox-1.1.21/data/images/dgi/characters/SR1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/V1.png` & `pyaibox-1.1.21/data/images/dgi/characters/V1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/W1.png` & `pyaibox-1.1.21/data/images/dgi/characters/W1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/X1.png` & `pyaibox-1.1.21/data/images/dgi/characters/X1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/alpha1.png` & `pyaibox-1.1.21/data/images/dgi/characters/alpha1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/and1.png` & `pyaibox-1.1.21/data/images/dgi/characters/and1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/at1.png` & `pyaibox-1.1.21/data/images/dgi/characters/at1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/beta1.png` & `pyaibox-1.1.21/data/images/dgi/characters/beta1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/curlybracket1.png` & `pyaibox-1.1.21/data/images/dgi/characters/curlybracket1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/delta1.png` & `pyaibox-1.1.21/data/images/dgi/characters/delta1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/dolar1.png` & `pyaibox-1.1.21/data/images/dgi/characters/dolar1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/epsilon1.png` & `pyaibox-1.1.21/data/images/dgi/characters/epsilon1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/gamma1.png` & `pyaibox-1.1.21/data/images/dgi/characters/gamma1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/hash1.png` & `pyaibox-1.1.21/data/images/dgi/characters/hash1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/infty1.png` & `pyaibox-1.1.21/data/images/dgi/characters/infty1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/lambda1.png` & `pyaibox-1.1.21/data/images/dgi/characters/lambda1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/parentheses1.png` & `pyaibox-1.1.21/data/images/dgi/characters/parentheses1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/percent1.png` & `pyaibox-1.1.21/data/images/dgi/characters/percent1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/sar1.png` & `pyaibox-1.1.21/data/images/dgi/characters/sar1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/sigma1.png` & `pyaibox-1.1.21/data/images/dgi/characters/sigma1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/characters/sum1.png` & `pyaibox-1.1.21/data/images/dgi/characters/sum1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/shapes/Airplane.png` & `pyaibox-1.1.21/data/images/dgi/shapes/Airplane.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/dgi/shapes/AirplanePoints.png` & `pyaibox-1.1.21/data/images/dgi/shapes/AirplanePoints.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/oi/Einstein128.png` & `pyaibox-1.1.21/data/images/oi/Einstein128.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/oi/Einstein256.png` & `pyaibox-1.1.21/data/images/oi/Einstein256.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/oi/LenaGRAY128.png` & `pyaibox-1.1.21/data/images/oi/LenaGRAY128.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/oi/LenaGRAY256.png` & `pyaibox-1.1.21/data/images/oi/LenaGRAY256.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/oi/LenaGRAY512.png` & `pyaibox-1.1.21/data/images/oi/LenaGRAY512.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/oi/LenaRGB512.tif` & `pyaibox-1.1.21/data/images/oi/LenaRGB512.tif`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/oi/Lighthouse.png` & `pyaibox-1.1.21/data/images/oi/Lighthouse.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000001.png` & `pyaibox-1.1.21/data/images/rsi/000001.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000007.png` & `pyaibox-1.1.21/data/images/rsi/000007.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000082.png` & `pyaibox-1.1.21/data/images/rsi/000082.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000120.png` & `pyaibox-1.1.21/data/images/rsi/000120.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000167.png` & `pyaibox-1.1.21/data/images/rsi/000167.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000170.png` & `pyaibox-1.1.21/data/images/rsi/000170.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000174.png` & `pyaibox-1.1.21/data/images/rsi/000174.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/000296.png` & `pyaibox-1.1.21/data/images/rsi/000296.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/Ship1.png` & `pyaibox-1.1.21/data/images/rsi/Ship1.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/Ship2.png` & `pyaibox-1.1.21/data/images/rsi/Ship2.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/Ship3.png` & `pyaibox-1.1.21/data/images/rsi/Ship3.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/data/images/rsi/Ship4.png` & `pyaibox-1.1.21/data/images/rsi/Ship4.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/CT2RTRT2CTdemo.png` & `pyaibox-1.1.21/docs/source/_static/CT2RTRT2CTdemo.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/ConfusionMatrixRich.png` & `pyaibox-1.1.21/docs/source/_static/ConfusionMatrixRich.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/ConfusionMatrixSimple.png` & `pyaibox-1.1.21/docs/source/_static/ConfusionMatrixSimple.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/DemoIMNOISE.png` & `pyaibox-1.1.21/docs/source/_static/DemoIMNOISE.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/DemoNoiseAWGNS.png` & `pyaibox-1.1.21/docs/source/_static/DemoNoiseAWGNS.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/FFTIFFTdemo.png` & `pyaibox-1.1.21/docs/source/_static/FFTIFFTdemo.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/MNISTPCA_K70.png` & `pyaibox-1.1.21/docs/source/_static/MNISTPCA_K70.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/MNISTPCA_K90.png` & `pyaibox-1.1.21/docs/source/_static/MNISTPCA_K90.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/MNISTPCA_ORIG.png` & `pyaibox-1.1.21/docs/source/_static/MNISTPCA_ORIG.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/SHOW1_BTR70_HB03787.png` & `pyaibox-1.1.21/docs/source/_static/SHOW1_BTR70_HB03787.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/SHOW_BTR70_HB03787.png` & `pyaibox-1.1.21/docs/source/_static/SHOW_BTR70_HB03787.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/demo_draw_rectangles.png` & `pyaibox-1.1.21/docs/source/_static/demo_draw_rectangles.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/demo_plot_bboxes.png` & `pyaibox-1.1.21/docs/source/_static/demo_plot_bboxes.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/demo_randgrid.png` & `pyaibox-1.1.21/docs/source/_static/demo_randgrid.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/demo_sample_patch.png` & `pyaibox-1.1.21/docs/source/_static/demo_sample_patch.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/fashionmnist.png` & `pyaibox-1.1.21/docs/source/_static/fashionmnist.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/_static/mnist.png` & `pyaibox-1.1.21/docs/source/_static/mnist.png`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/conf.py` & `pyaibox-1.1.21/docs/source/conf.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/pyaibox.base.rst` & `pyaibox-1.1.21/docs/source/pyaibox.base.rst`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/pyaibox.dsp.rst` & `pyaibox-1.1.21/docs/source/pyaibox.dsp.rst`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/pyaibox.evaluation.rst` & `pyaibox-1.1.21/docs/source/pyaibox.evaluation.rst`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/pyaibox.misc.rst` & `pyaibox-1.1.21/docs/source/pyaibox.misc.rst`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/pyaibox.ml.rst` & `pyaibox-1.1.21/docs/source/pyaibox.ml.rst`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/pyaibox.rst` & `pyaibox-1.1.21/docs/source/pyaibox.rst`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/docs/source/pyaibox.utils.rst` & `pyaibox-1.1.21/docs/source/pyaibox.utils.rst`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/base/demo_random.py` & `pyaibox-1.1.21/examples/base/demo_random.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/datasets/demo_read_fashionmnist.py` & `pyaibox-1.1.21/examples/datasets/demo_read_fashionmnist.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/datasets/demo_read_mnist.py` & `pyaibox-1.1.21/examples/datasets/demo_read_mnist.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/dsp/demo_fft.py` & `pyaibox-1.1.21/examples/dsp/demo_fft.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/dsp/demo_fft_image.py` & `pyaibox-1.1.21/examples/dsp/demo_fft_image.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/dsp/demo_fft_sincos.py` & `pyaibox-1.1.21/examples/dsp/demo_fft_sincos.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/dsp/demo_fftshift.py` & `pyaibox-1.1.21/examples/dsp/demo_fftshift.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/dsp/demo_freq.py` & `pyaibox-1.1.21/examples/dsp/demo_freq.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/dsp/demo_interp_complex.py` & `pyaibox-1.1.21/examples/dsp/demo_interp_complex.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/dsp/demo_polyfit.py` & `pyaibox-1.1.21/examples/dsp/demo_polyfit.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/evaluation/demo_classification.py` & `pyaibox-1.1.21/examples/evaluation/demo_classification.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/evaluation/demo_contrast.py` & `pyaibox-1.1.21/examples/evaluation/demo_contrast.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_awgns.py` & `pyaibox-1.1.21/examples/misc/demo_awgns.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_complex2real_fft.py` & `pyaibox-1.1.21/examples/misc/demo_complex2real_fft.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_dnsampling.py` & `pyaibox-1.1.21/examples/misc/demo_dnsampling.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_draw_rectangles.py` & `pyaibox-1.1.21/examples/misc/demo_draw_rectangles.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_mapping.py` & `pyaibox-1.1.21/examples/misc/demo_mapping.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_plot_bboxes.py` & `pyaibox-1.1.21/examples/misc/demo_plot_bboxes.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_readsamples.py` & `pyaibox-1.1.21/examples/misc/demo_readsamples.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_sample_patch.py` & `pyaibox-1.1.21/examples/misc/demo_sample_patch.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/misc/demo_shuffle_tensor.py` & `pyaibox-1.1.21/examples/misc/demo_shuffle_tensor.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/ml/demo_mnist_pca.py` & `pyaibox-1.1.21/examples/ml/demo_mnist_pca.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/utils/demo_bin.py` & `pyaibox-1.1.21/examples/utils/demo_bin.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/utils/demo_colors.py` & `pyaibox-1.1.21/examples/utils/demo_colors.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/utils/demo_convert.py` & `pyaibox-1.1.21/examples/utils/demo_convert.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/utils/demo_docstring.py` & `pyaibox-1.1.21/examples/utils/demo_delete_c_comments.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 #!/usr/bin/env python
 #-*- coding: utf-8 -*-
 # @file      : demo_docstring.py
 # @author    : Zhi Liu
 # @email     : zhiliu.mind@gmail.com
 # @homepage  : http://iridescent.ink
-# @date      : Sun Dec 11 2022
+# @date      : Sun May 01 2023
 # @version   : 0.0
 # @license   : The GNU General Public License (GPL) v3.0
 # @note      : 
 # 
 # The GNU General Public License (GPL) v3.0
 # Copyright (C) 2013- Zhi Liu
 #
@@ -27,16 +27,17 @@
 #
 
 import pyaibox as pb
 
 
 pkgdir = '/mnt/e/ws/github/antsfamily/torchcs/torchcs/torchcs/'
 pkgdir = '/mnt/e/ws/github/antsfamily/torchtsa/torchtsa/torchtsa/'
-pkgdir = '/mnt/e/ws/github/antsfamily/torchbox/torchbox/torchbox/'
+# pkgdir = '/mnt/e/ws/github/antsfamily/torchbox/torchbox/torchbox/'
 # pkgdir = '/mnt/e/ws/github/antsfamily/torchsar/torchsar/torchsar/'
 # pkgdir = '/mnt/e/ws/github/antsfamily/pyaibox/pyaibox/pyaibox/'
 # pkgdir = '/mnt/e/ws/github/antsfamily/torchsar/torchsar_deploy/torchsar/'
 
-pb.rmcache(pkgdir, exts='.c')
-pb.rmcache(pkgdir, exts='.so')
-pb.gpyi(pkgdir, autoskip=True)
+pb.dltccmmt(pkgdir)
+
+
+
```

### Comparing `pyaibox-1.1.20/examples/utils/demo_ios.py` & `pyaibox-1.1.21/examples/utils/demo_ios.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/utils/demo_read_log.py` & `pyaibox-1.1.21/examples/utils/demo_read_log.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/examples/utils/demo_typevalue.py` & `pyaibox-1.1.21/examples/utils/demo_typevalue.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/__init__.py` & `pyaibox-1.1.21/pyaibox/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -6,21 +6,21 @@
 from .utils.colors import rgb2gray, gray2rgb, DISTINCT_COLORS_HEX, DISTINCT_COLORS_RGB, DISTINCT_COLORS_CMYK, DISTINCT_COLORS_RGB_NORM, BASE_COLORS, TABLEAU_COLORS, CSS4_COLORS
 from .utils.colormaps import cmaps, viridis, parula
 from .utils.convert import str2hash, file2hash, dict2str, str2bool, str2list, str2tuple, str2num, str2sec, int2bstr, bstr2int
 from .utils.ios import loadyaml, saveyaml, loadjson, loadmat, savemat, loadh5, saveh5, mvkeyh5, loadbin, savebin
 from .utils.image import imread, imsave, histeq, imresize
 from .utils.file import data_path, pkg_path, copyfile, copyfiles, listxfile, pathjoin, fileparts, readtxt, readnum, readcsv, readsec
 from .utils.plot_show import cplot, plots, Plots, plot, imshow, mesh, mshow
-from .utils.docstr import rmcache, gpyi
+from .utils.docstr import rmcache, gpyi, dltccmmt
 
 
 from .base import baseops, arrayops, mathops, randomfunc
-from .base.baseops import redim, upkeys, dreplace, dmka
+from .base.baseops import redim, upkeys, dreplace, dmka, strfind
 from .base.arrayops import sl, cut, cat, arraycomb
-from .base.mathops import mag2db, db2mag, fnab, ebeo, nextpow2, prevpow2, r2c, c2r, conj, real, imag, abs, pow
+from .base.mathops import mag2db, db2mag, fnab, ebeo, nextpow2, prevpow2, ematmul, matmul, r2c, c2r, conj, real, imag, abs, pow
 from .base.randomfunc import setseed, randgrid, randperm, randperm2d
 from .base.typevalue import peakvalue, dtypes
 
 
 from .summary.loss_log import LossLog
 
 from .evaluation.classification import categorical2onehot, onehot2categorical, accuracy, confusion, kappa, plot_confusion
```

### Comparing `pyaibox-1.1.20/pyaibox/base/arrayops.c` & `pyaibox-1.1.21/pyaibox/base/arrayops.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/base/arrayops.py` & `pyaibox-1.1.21/pyaibox/base/arrayops.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/base/arrayops.pyi` & `pyaibox-1.1.21/pyaibox/base/arrayops.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/base/baseops.c` & `pyaibox-1.1.21/pyaibox/base/baseops.c`

 * *Files 2% similar despite different names*

```diff
@@ -1276,14 +1276,22 @@
 static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
 #else
 #define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 #define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
 #endif
 
+/* PyIntBinop.proto */
+#if !CYTHON_COMPILING_IN_PYPY
+static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
+#else
+#define __Pyx_PyInt_AddObjC(op1, op2, intval, inplace, zerodivision_check)\
+    (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
+#endif
+
 /* Import.proto */
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);
 
 /* FetchCommonType.proto */
 static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
 
 /* CythonFunctionShared.proto */
@@ -1461,21 +1469,25 @@
 static const char __pyx_k_k[] = "k";
 static const char __pyx_k_v[] = "v";
 static const char __pyx_k_Ds[] = "Ds";
 static const char __pyx_k__2[] = "";
 static const char __pyx_k__3[] = "+";
 static const char __pyx_k_fv[] = "fv";
 static const char __pyx_k_rv[] = "rv";
+static const char __pyx_k__16[] = "/*";
 static const char __pyx_k_dim[] = "dim";
+static const char __pyx_k_idx[] = "idx";
 static const char __pyx_k_key[] = "key";
 static const char __pyx_k_new[] = "new";
+static const char __pyx_k_pos[] = "pos";
 static const char __pyx_k_None[] = "None";
 static const char __pyx_k_cdim[] = "cdim";
 static const char __pyx_k_copy[] = "copy";
 static const char __pyx_k_dmka[] = "dmka";
+static const char __pyx_k_find[] = "find";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "__name__";
 static const char __pyx_k_ndim[] = "ndim";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_items[] = "items";
 static const char __pyx_k_print[] = "print";
@@ -1486,90 +1498,107 @@
 static const char __pyx_k_fvtype[] = "fvtype";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_module[] = "module.";
 static const char __pyx_k_newdim[] = "newdim";
 static const char __pyx_k_newkey[] = "newkey";
 static const char __pyx_k_posdim[] = "posdim";
 static const char __pyx_k_upkeys[] = "upkeys";
+static const char __pyx_k_mainstr[] = "mainstr";
+static const char __pyx_k_patnstr[] = "patnstr";
 static const char __pyx_k_poscdim[] = "poscdim";
 static const char __pyx_k_replace[] = "replace";
+static const char __pyx_k_strfind[] = "strfind";
 static const char __pyx_k_deepcopy[] = "deepcopy";
 static const char __pyx_k_dreplace[] = "dreplace";
 static const char __pyx_k_keepcdim[] = "keepcdim";
+static const char __pyx_k_asdxxs_3356[] = "/*asdxxs*/3356/*";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_pyaibox_base_baseops[] = "pyaibox.base.baseops";
 static const char __pyx_k_pyaibox_base_baseops_py[] = "pyaibox/base/baseops.py";
 static PyObject *__pyx_kp_u_;
 static PyObject *__pyx_n_s_D;
 static PyObject *__pyx_n_s_Ds;
 static PyObject *__pyx_n_u_None;
 static PyObject *__pyx_n_s_X;
+static PyObject *__pyx_kp_u__16;
 static PyObject *__pyx_kp_u__2;
 static PyObject *__pyx_kp_u__3;
 static PyObject *__pyx_n_u_a;
 static PyObject *__pyx_n_s_append;
+static PyObject *__pyx_kp_u_asdxxs_3356;
 static PyObject *__pyx_n_u_b;
 static PyObject *__pyx_n_u_c;
 static PyObject *__pyx_n_s_cdim;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_n_s_copy;
 static PyObject *__pyx_n_s_d;
 static PyObject *__pyx_n_s_deepcopy;
 static PyObject *__pyx_n_s_dim;
 static PyObject *__pyx_n_s_dmka;
 static PyObject *__pyx_n_s_dreplace;
+static PyObject *__pyx_n_s_find;
 static PyObject *__pyx_n_s_fv;
 static PyObject *__pyx_n_s_fvtype;
 static PyObject *__pyx_n_s_i;
+static PyObject *__pyx_n_s_idx;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_items;
 static PyObject *__pyx_n_s_k;
 static PyObject *__pyx_n_s_keepcdim;
 static PyObject *__pyx_n_s_key;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_u_main;
+static PyObject *__pyx_n_s_mainstr;
 static PyObject *__pyx_n_s_mode;
 static PyObject *__pyx_kp_u_module;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_ndim;
 static PyObject *__pyx_n_s_new;
 static PyObject *__pyx_n_s_newdim;
 static PyObject *__pyx_n_s_newkey;
+static PyObject *__pyx_n_s_patnstr;
+static PyObject *__pyx_n_s_pos;
 static PyObject *__pyx_n_s_poscdim;
 static PyObject *__pyx_n_s_posdim;
 static PyObject *__pyx_n_s_print;
 static PyObject *__pyx_n_s_pyaibox_base_baseops;
 static PyObject *__pyx_kp_s_pyaibox_base_baseops_py;
 static PyObject *__pyx_n_s_range;
 static PyObject *__pyx_n_s_redim;
 static PyObject *__pyx_n_s_replace;
 static PyObject *__pyx_n_s_rv;
+static PyObject *__pyx_n_s_strfind;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_n_s_upkeys;
 static PyObject *__pyx_n_s_v;
 static PyObject *__pyx_n_s_value;
 static PyObject *__pyx_pf_7pyaibox_4base_7baseops_redim(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ndim, PyObject *__pyx_v_dim, PyObject *__pyx_v_cdim, PyObject *__pyx_v_keepcdim); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7baseops_2upkeys(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_D, PyObject *__pyx_v_mode, PyObject *__pyx_v_k); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7baseops_4dreplace(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_d, PyObject *__pyx_v_fv, PyObject *__pyx_v_rv, PyObject *__pyx_v_new); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7baseops_6dmka(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_D, PyObject *__pyx_v_Ds); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7baseops_8strfind(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mainstr, PyObject *__pyx_v_patnstr); /* proto */
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_2;
 static PyObject *__pyx_int_3;
 static PyObject *__pyx_int_6;
+static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_tuple__4;
 static PyObject *__pyx_tuple__6;
 static PyObject *__pyx_tuple__8;
 static PyObject *__pyx_tuple__9;
 static PyObject *__pyx_tuple__11;
 static PyObject *__pyx_tuple__12;
+static PyObject *__pyx_tuple__14;
+static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_codeobj__5;
 static PyObject *__pyx_codeobj__7;
 static PyObject *__pyx_codeobj__10;
 static PyObject *__pyx_codeobj__13;
+static PyObject *__pyx_codeobj__15;
 /* Late includes */
 
 /* "pyaibox/base/baseops.py":32
  * 
  * 
  * def redim(ndim, dim, cdim, keepcdim):             # <<<<<<<<<<<<<<
  *     r"""re-define dimensions
@@ -2907,14 +2936,276 @@
   __Pyx_XDECREF(__pyx_v_k);
   __Pyx_XDECREF(__pyx_v_v);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
+/* "pyaibox/base/baseops.py":138
+ * 
+ * 
+ * def strfind(mainstr, patnstr):             # <<<<<<<<<<<<<<
+ *     """find all patterns in string
+ * 
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pyaibox_4base_7baseops_9strfind(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7baseops_8strfind[] = "find all patterns in string\n\n    Parameters\n    ----------\n    mainstr :  str\n        the main string\n    patnstr :  str\n        the pattern string\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7baseops_9strfind = {"strfind", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7baseops_9strfind, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7baseops_8strfind};
+static PyObject *__pyx_pw_7pyaibox_4base_7baseops_9strfind(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_mainstr = 0;
+  PyObject *__pyx_v_patnstr = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("strfind (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_mainstr,&__pyx_n_s_patnstr,0};
+    PyObject* values[2] = {0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mainstr)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_patnstr)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("strfind", 1, 2, 2, 1); __PYX_ERR(0, 138, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "strfind") < 0)) __PYX_ERR(0, 138, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+    }
+    __pyx_v_mainstr = values[0];
+    __pyx_v_patnstr = values[1];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("strfind", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 138, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyaibox.base.baseops.strfind", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pyaibox_4base_7baseops_8strfind(__pyx_self, __pyx_v_mainstr, __pyx_v_patnstr);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pyaibox_4base_7baseops_8strfind(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mainstr, PyObject *__pyx_v_patnstr) {
+  PyObject *__pyx_v_pos = NULL;
+  CYTHON_UNUSED long __pyx_v_i;
+  PyObject *__pyx_v_idx = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  int __pyx_t_5;
+  PyObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
+  PyObject *__pyx_t_8 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("strfind", 0);
+
+  /* "pyaibox/base/baseops.py":149
+ *     """
+ * 
+ *     pos = []             # <<<<<<<<<<<<<<
+ *     i = 0
+ *     idx = mainstr.find(patnstr)
+ */
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_v_pos = ((PyObject*)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "pyaibox/base/baseops.py":150
+ * 
+ *     pos = []
+ *     i = 0             # <<<<<<<<<<<<<<
+ *     idx = mainstr.find(patnstr)
+ *     while idx > -1:
+ */
+  __pyx_v_i = 0;
+
+  /* "pyaibox/base/baseops.py":151
+ *     pos = []
+ *     i = 0
+ *     idx = mainstr.find(patnstr)             # <<<<<<<<<<<<<<
+ *     while idx > -1:
+ *         pos.append(idx)
+ */
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mainstr, __pyx_n_s_find); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 151, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
+    }
+  }
+  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_patnstr) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_patnstr);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_idx = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "pyaibox/base/baseops.py":152
+ *     i = 0
+ *     idx = mainstr.find(patnstr)
+ *     while idx > -1:             # <<<<<<<<<<<<<<
+ *         pos.append(idx)
+ *         idx = mainstr.find(patnstr, idx+1)
+ */
+  while (1) {
+    __pyx_t_1 = PyObject_RichCompare(__pyx_v_idx, __pyx_int_neg_1, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 152, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (!__pyx_t_4) break;
+
+    /* "pyaibox/base/baseops.py":153
+ *     idx = mainstr.find(patnstr)
+ *     while idx > -1:
+ *         pos.append(idx)             # <<<<<<<<<<<<<<
+ *         idx = mainstr.find(patnstr, idx+1)
+ * 
+ */
+    __pyx_t_5 = __Pyx_PyList_Append(__pyx_v_pos, __pyx_v_idx); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 153, __pyx_L1_error)
+
+    /* "pyaibox/base/baseops.py":154
+ *     while idx > -1:
+ *         pos.append(idx)
+ *         idx = mainstr.find(patnstr, idx+1)             # <<<<<<<<<<<<<<
+ * 
+ *     return pos
+ */
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mainstr, __pyx_n_s_find); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_idx, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = NULL;
+    __pyx_t_7 = 0;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
+      if (likely(__pyx_t_6)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+        __Pyx_INCREF(__pyx_t_6);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __pyx_t_7 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_patnstr, __pyx_t_3};
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_patnstr, __pyx_t_3};
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 154, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      if (__pyx_t_6) {
+        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
+      }
+      __Pyx_INCREF(__pyx_v_patnstr);
+      __Pyx_GIVEREF(__pyx_v_patnstr);
+      PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_patnstr);
+      __Pyx_GIVEREF(__pyx_t_3);
+      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_3);
+      __pyx_t_3 = 0;
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF_SET(__pyx_v_idx, __pyx_t_1);
+    __pyx_t_1 = 0;
+  }
+
+  /* "pyaibox/base/baseops.py":156
+ *         idx = mainstr.find(patnstr, idx+1)
+ * 
+ *     return pos             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(__pyx_v_pos);
+  __pyx_r = __pyx_v_pos;
+  goto __pyx_L0;
+
+  /* "pyaibox/base/baseops.py":138
+ * 
+ * 
+ * def strfind(mainstr, patnstr):             # <<<<<<<<<<<<<<
+ *     """find all patterns in string
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_AddTraceback("pyaibox.base.baseops.strfind", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_pos);
+  __Pyx_XDECREF(__pyx_v_idx);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
@@ -2958,62 +3249,70 @@
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_kp_u_, __pyx_k_, sizeof(__pyx_k_), 0, 1, 0, 0},
   {&__pyx_n_s_D, __pyx_k_D, sizeof(__pyx_k_D), 0, 0, 1, 1},
   {&__pyx_n_s_Ds, __pyx_k_Ds, sizeof(__pyx_k_Ds), 0, 0, 1, 1},
   {&__pyx_n_u_None, __pyx_k_None, sizeof(__pyx_k_None), 0, 1, 0, 1},
   {&__pyx_n_s_X, __pyx_k_X, sizeof(__pyx_k_X), 0, 0, 1, 1},
+  {&__pyx_kp_u__16, __pyx_k__16, sizeof(__pyx_k__16), 0, 1, 0, 0},
   {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
   {&__pyx_kp_u__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 1, 0, 0},
   {&__pyx_n_u_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 1, 0, 1},
   {&__pyx_n_s_append, __pyx_k_append, sizeof(__pyx_k_append), 0, 0, 1, 1},
+  {&__pyx_kp_u_asdxxs_3356, __pyx_k_asdxxs_3356, sizeof(__pyx_k_asdxxs_3356), 0, 1, 0, 0},
   {&__pyx_n_u_b, __pyx_k_b, sizeof(__pyx_k_b), 0, 1, 0, 1},
   {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
   {&__pyx_n_s_cdim, __pyx_k_cdim, sizeof(__pyx_k_cdim), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_n_s_copy, __pyx_k_copy, sizeof(__pyx_k_copy), 0, 0, 1, 1},
   {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
   {&__pyx_n_s_deepcopy, __pyx_k_deepcopy, sizeof(__pyx_k_deepcopy), 0, 0, 1, 1},
   {&__pyx_n_s_dim, __pyx_k_dim, sizeof(__pyx_k_dim), 0, 0, 1, 1},
   {&__pyx_n_s_dmka, __pyx_k_dmka, sizeof(__pyx_k_dmka), 0, 0, 1, 1},
   {&__pyx_n_s_dreplace, __pyx_k_dreplace, sizeof(__pyx_k_dreplace), 0, 0, 1, 1},
+  {&__pyx_n_s_find, __pyx_k_find, sizeof(__pyx_k_find), 0, 0, 1, 1},
   {&__pyx_n_s_fv, __pyx_k_fv, sizeof(__pyx_k_fv), 0, 0, 1, 1},
   {&__pyx_n_s_fvtype, __pyx_k_fvtype, sizeof(__pyx_k_fvtype), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
+  {&__pyx_n_s_idx, __pyx_k_idx, sizeof(__pyx_k_idx), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_items, __pyx_k_items, sizeof(__pyx_k_items), 0, 0, 1, 1},
   {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
   {&__pyx_n_s_keepcdim, __pyx_k_keepcdim, sizeof(__pyx_k_keepcdim), 0, 0, 1, 1},
   {&__pyx_n_s_key, __pyx_k_key, sizeof(__pyx_k_key), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_u_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 1, 0, 1},
+  {&__pyx_n_s_mainstr, __pyx_k_mainstr, sizeof(__pyx_k_mainstr), 0, 0, 1, 1},
   {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
   {&__pyx_kp_u_module, __pyx_k_module, sizeof(__pyx_k_module), 0, 1, 0, 0},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
   {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
   {&__pyx_n_s_newdim, __pyx_k_newdim, sizeof(__pyx_k_newdim), 0, 0, 1, 1},
   {&__pyx_n_s_newkey, __pyx_k_newkey, sizeof(__pyx_k_newkey), 0, 0, 1, 1},
+  {&__pyx_n_s_patnstr, __pyx_k_patnstr, sizeof(__pyx_k_patnstr), 0, 0, 1, 1},
+  {&__pyx_n_s_pos, __pyx_k_pos, sizeof(__pyx_k_pos), 0, 0, 1, 1},
   {&__pyx_n_s_poscdim, __pyx_k_poscdim, sizeof(__pyx_k_poscdim), 0, 0, 1, 1},
   {&__pyx_n_s_posdim, __pyx_k_posdim, sizeof(__pyx_k_posdim), 0, 0, 1, 1},
   {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
   {&__pyx_n_s_pyaibox_base_baseops, __pyx_k_pyaibox_base_baseops, sizeof(__pyx_k_pyaibox_base_baseops), 0, 0, 1, 1},
   {&__pyx_kp_s_pyaibox_base_baseops_py, __pyx_k_pyaibox_base_baseops_py, sizeof(__pyx_k_pyaibox_base_baseops_py), 0, 0, 1, 0},
   {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
   {&__pyx_n_s_redim, __pyx_k_redim, sizeof(__pyx_k_redim), 0, 0, 1, 1},
   {&__pyx_n_s_replace, __pyx_k_replace, sizeof(__pyx_k_replace), 0, 0, 1, 1},
   {&__pyx_n_s_rv, __pyx_k_rv, sizeof(__pyx_k_rv), 0, 0, 1, 1},
+  {&__pyx_n_s_strfind, __pyx_k_strfind, sizeof(__pyx_k_strfind), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_n_s_upkeys, __pyx_k_upkeys, sizeof(__pyx_k_upkeys), 0, 0, 1, 1},
   {&__pyx_n_s_v, __pyx_k_v, sizeof(__pyx_k_v), 0, 0, 1, 1},
   {&__pyx_n_s_value, __pyx_k_value, sizeof(__pyx_k_value), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 142, __pyx_L1_error)
+  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 163, __pyx_L1_error)
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 71, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
@@ -3069,28 +3368,50 @@
  *     """Multi-key value assign
  * 
  */
   __pyx_tuple__12 = PyTuple_Pack(4, __pyx_n_s_D, __pyx_n_s_Ds, __pyx_n_s_k, __pyx_n_s_v); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 120, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__12);
   __Pyx_GIVEREF(__pyx_tuple__12);
   __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__12, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_baseops_py, __pyx_n_s_dmka, 120, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 120, __pyx_L1_error)
+
+  /* "pyaibox/base/baseops.py":138
+ * 
+ * 
+ * def strfind(mainstr, patnstr):             # <<<<<<<<<<<<<<
+ *     """find all patterns in string
+ * 
+ */
+  __pyx_tuple__14 = PyTuple_Pack(5, __pyx_n_s_mainstr, __pyx_n_s_patnstr, __pyx_n_s_pos, __pyx_n_s_i, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 138, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__14);
+  __Pyx_GIVEREF(__pyx_tuple__14);
+  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__14, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_baseops_py, __pyx_n_s_strfind, 138, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 138, __pyx_L1_error)
+
+  /* "pyaibox/base/baseops.py":166
+ *     dmka(D, Ds)
+ *     print(D)
+ *     print(strfind('/[inserted by cython to avoid comment start]*asdxxs*[inserted by cython to avoid comment closer]/3356/[inserted by cython to avoid comment start]*', '/[inserted by cython to avoid comment start]*'))             # <<<<<<<<<<<<<<
+ */
+  __pyx_tuple__17 = PyTuple_Pack(2, __pyx_kp_u_asdxxs_3356, __pyx_kp_u__16); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 166, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__17);
+  __Pyx_GIVEREF(__pyx_tuple__17);
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
   if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_6 = PyInt_FromLong(6); if (unlikely(!__pyx_int_6)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(void); /*proto*/
 static CYTHON_SMALL_CODE int __Pyx_modinit_variable_export_code(void); /*proto*/
@@ -3421,105 +3742,134 @@
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_dmka, __pyx_t_1) < 0) __PYX_ERR(0, 120, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "pyaibox/base/baseops.py":138
  * 
  * 
+ * def strfind(mainstr, patnstr):             # <<<<<<<<<<<<<<
+ *     """find all patterns in string
+ * 
+ */
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7baseops_9strfind, 0, __pyx_n_s_strfind, NULL, __pyx_n_s_pyaibox_base_baseops, __pyx_d, ((PyObject *)__pyx_codeobj__15)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_strfind, __pyx_t_1) < 0) __PYX_ERR(0, 138, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pyaibox/base/baseops.py":159
+ * 
+ * 
  * if __name__ == '__main__':             # <<<<<<<<<<<<<<
  * 
  *     D = {'a': 1, 'b': 2, 'c': 3}
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 159, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_main, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 138, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_main, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 159, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "pyaibox/base/baseops.py":140
+    /* "pyaibox/base/baseops.py":161
  * if __name__ == '__main__':
  * 
  *     D = {'a': 1, 'b': 2, 'c': 3}             # <<<<<<<<<<<<<<
  *     Ds = {'b': 6}
  *     print(D)
  */
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, __pyx_int_1) < 0) __PYX_ERR(0, 140, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_b, __pyx_int_2) < 0) __PYX_ERR(0, 140, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_c, __pyx_int_3) < 0) __PYX_ERR(0, 140, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_D, __pyx_t_1) < 0) __PYX_ERR(0, 140, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, __pyx_int_1) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_b, __pyx_int_2) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_c, __pyx_int_3) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_D, __pyx_t_1) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/baseops.py":141
+    /* "pyaibox/base/baseops.py":162
  * 
  *     D = {'a': 1, 'b': 2, 'c': 3}
  *     Ds = {'b': 6}             # <<<<<<<<<<<<<<
  *     print(D)
  *     dmka(D, Ds)
  */
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_b, __pyx_int_6) < 0) __PYX_ERR(0, 141, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Ds, __pyx_t_1) < 0) __PYX_ERR(0, 141, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_b, __pyx_int_6) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Ds, __pyx_t_1) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/baseops.py":142
+    /* "pyaibox/base/baseops.py":163
  *     D = {'a': 1, 'b': 2, 'c': 3}
  *     Ds = {'b': 6}
  *     print(D)             # <<<<<<<<<<<<<<
  *     dmka(D, Ds)
  *     print(D)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_D); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 142, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_D); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 142, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 163, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "pyaibox/base/baseops.py":143
+    /* "pyaibox/base/baseops.py":164
  *     Ds = {'b': 6}
  *     print(D)
  *     dmka(D, Ds)             # <<<<<<<<<<<<<<
  *     print(D)
+ *     print(strfind('/[inserted by cython to avoid comment start]*asdxxs*[inserted by cython to avoid comment closer]/3356/[inserted by cython to avoid comment start]*', '/[inserted by cython to avoid comment start]*'))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_dmka); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_dmka); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 164, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_D); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_D); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Ds); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Ds); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 164, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/baseops.py":144
+    /* "pyaibox/base/baseops.py":165
  *     print(D)
  *     dmka(D, Ds)
  *     print(D)             # <<<<<<<<<<<<<<
+ *     print(strfind('/[inserted by cython to avoid comment start]*asdxxs*[inserted by cython to avoid comment closer]/3356/[inserted by cython to avoid comment start]*', '/[inserted by cython to avoid comment start]*'))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_D); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_D); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 144, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 165, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/baseops.py":138
+    /* "pyaibox/base/baseops.py":166
+ *     dmka(D, Ds)
+ *     print(D)
+ *     print(strfind('/[inserted by cython to avoid comment start]*asdxxs*[inserted by cython to avoid comment closer]/3356/[inserted by cython to avoid comment start]*', '/[inserted by cython to avoid comment start]*'))             # <<<<<<<<<<<<<<
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_strfind); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 166, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 166, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 166, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+    /* "pyaibox/base/baseops.py":159
  * 
  * 
  * if __name__ == '__main__':             # <<<<<<<<<<<<<<
  * 
  *     D = {'a': 1, 'b': 2, 'c': 3}
  */
   }
@@ -4877,14 +5227,138 @@
         return __Pyx_NewRef(result);
     }
     PyErr_Clear();
 #endif
     return __Pyx_GetBuiltinName(name);
 }
 
+/* PyIntBinop */
+#if !CYTHON_COMPILING_IN_PYPY
+static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, int inplace, int zerodivision_check) {
+    (void)inplace;
+    (void)zerodivision_check;
+    #if PY_MAJOR_VERSION < 3
+    if (likely(PyInt_CheckExact(op1))) {
+        const long b = intval;
+        long x;
+        long a = PyInt_AS_LONG(op1);
+            x = (long)((unsigned long)a + b);
+            if (likely((x^a) >= 0 || (x^b) >= 0))
+                return PyInt_FromLong(x);
+            return PyLong_Type.tp_as_number->nb_add(op1, op2);
+    }
+    #endif
+    #if CYTHON_USE_PYLONG_INTERNALS
+    if (likely(PyLong_CheckExact(op1))) {
+        const long b = intval;
+        long a, x;
+#ifdef HAVE_LONG_LONG
+        const PY_LONG_LONG llb = intval;
+        PY_LONG_LONG lla, llx;
+#endif
+        const digit* digits = ((PyLongObject*)op1)->ob_digit;
+        const Py_ssize_t size = Py_SIZE(op1);
+        if (likely(__Pyx_sst_abs(size) <= 1)) {
+            a = likely(size) ? digits[0] : 0;
+            if (size == -1) a = -a;
+        } else {
+            switch (size) {
+                case -2:
+                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
+                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
+                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case 2:
+                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
+                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
+                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case -3:
+                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
+                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
+                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case 3:
+                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
+                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
+                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case -4:
+                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
+                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
+                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case 4:
+                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
+                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
+                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                default: return PyLong_Type.tp_as_number->nb_add(op1, op2);
+            }
+        }
+                x = a + b;
+            return PyLong_FromLong(x);
+#ifdef HAVE_LONG_LONG
+        long_long:
+                llx = lla + llb;
+            return PyLong_FromLongLong(llx);
+#endif
+        
+        
+    }
+    #endif
+    if (PyFloat_CheckExact(op1)) {
+        const long b = intval;
+        double a = PyFloat_AS_DOUBLE(op1);
+            double result;
+            PyFPE_START_PROTECT("add", return NULL)
+            result = ((double)a) + (double)b;
+            PyFPE_END_PROTECT(result)
+            return PyFloat_FromDouble(result);
+    }
+    return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
+}
+#endif
+
 /* Import */
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
     PyObject *empty_list = 0;
     PyObject *module = 0;
     PyObject *global_dict = 0;
     PyObject *empty_dict = 0;
     PyObject *list;
```

### Comparing `pyaibox-1.1.20/pyaibox/base/baseops.py` & `pyaibox-1.1.21/pyaibox/base/baseops.py`

 * *Files 7% similar despite different names*

```diff
@@ -131,14 +131,36 @@
     """
 
     for k, v in Ds.items():
         D[k] = v
     return D
 
 
+def strfind(mainstr, patnstr):
+    """find all patterns in string
+
+    Parameters
+    ----------
+    mainstr :  str
+        the main string
+    patnstr :  str
+        the pattern string
+    """
+    
+    pos = []
+    i = 0
+    idx = mainstr.find(patnstr)
+    while idx > -1:
+        pos.append(idx)
+        idx = mainstr.find(patnstr, idx+1)
+
+    return pos
+
+
 if __name__ == '__main__':
 
     D = {'a': 1, 'b': 2, 'c': 3}
     Ds = {'b': 6}
     print(D)
     dmka(D, Ds)
     print(D)
+    print(strfind('/*asdxxs*/3356/*', '/*'))
```

### Comparing `pyaibox-1.1.20/pyaibox/base/baseops.pyi` & `pyaibox-1.1.21/pyaibox/base/baseops.pyi`

 * *Files 20% similar despite different names*

```diff
@@ -55,8 +55,19 @@
     ----------
     D : dict
         main dict.
     Ds : dict
         sub dict
     """
 
+def strfind(mainstr, patnstr):
+    """find all patterns in string
+
+    Parameters
+    ----------
+    mainstr :  str
+        the main string
+    patnstr :  str
+        the pattern string
+    """
+
```

### Comparing `pyaibox-1.1.20/pyaibox/base/mathops.c` & `pyaibox-1.1.21/pyaibox/base/mathops.c`

 * *Files 11% similar despite different names*

```diff
@@ -1378,14 +1378,46 @@
 #if !CYTHON_COMPILING_IN_PYPY
 static PyObject* __Pyx_PyFloat_AddObjC(PyObject *op1, PyObject *op2, double floatval, int inplace, int zerodivision_check);
 #else
 #define __Pyx_PyFloat_AddObjC(op1, op2, floatval, inplace, zerodivision_check)\
     (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
 #endif
 
+/* PyDictContains.proto */
+static CYTHON_INLINE int __Pyx_PyDict_ContainsTF(PyObject* item, PyObject* dict, int eq) {
+    int result = PyDict_Contains(dict, item);
+    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
+}
+
+/* DictGetItem.proto */
+#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
+static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key);
+#define __Pyx_PyObject_Dict_GetItem(obj, name)\
+    (likely(PyDict_CheckExact(obj)) ?\
+     __Pyx_PyDict_GetItem(obj, name) : PyObject_GetItem(obj, name))
+#else
+#define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
+#define __Pyx_PyObject_Dict_GetItem(obj, name)  PyObject_GetItem(obj, name)
+#endif
+
+/* PyObjectCallNoArg.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
+#else
+#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
+#endif
+
+/* PyIntBinop.proto */
+#if !CYTHON_COMPILING_IN_PYPY
+static PyObject* __Pyx_PyInt_FloorDivideObjC(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
+#else
+#define __Pyx_PyInt_FloorDivideObjC(op1, op2, intval, inplace, zerodivision_check)\
+    (inplace ? PyNumber_InPlaceFloorDivide(op1, op2) : PyNumber_FloorDivide(op1, op2))
+#endif
+
 /* GetItemInt.proto */
 #define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
     (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
     __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
     (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
                __Pyx_GetItemInt_Generic(o, to_py_func(i))))
 #define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
@@ -1407,21 +1439,27 @@
 /* ObjectGetItem.proto */
 #if CYTHON_USE_TYPE_SLOTS
 static CYTHON_INLINE PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject* key);
 #else
 #define __Pyx_PyObject_GetItem(obj, key)  PyObject_GetItem(obj, key)
 #endif
 
-/* PyObjectCallNoArg.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
+/* MatrixMultiply.proto */
+#if PY_VERSION_HEX >= 0x03050000
+  #define __Pyx_PyNumber_MatrixMultiply(x,y)         PyNumber_MatrixMultiply(x,y)
+  #define __Pyx_PyNumber_InPlaceMatrixMultiply(x,y)  PyNumber_InPlaceMatrixMultiply(x,y)
 #else
-#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
+#define __Pyx_PyNumber_MatrixMultiply(x,y)         __Pyx__PyNumber_MatrixMultiply(x, y, "@")
+static PyObject* __Pyx__PyNumber_MatrixMultiply(PyObject* x, PyObject* y, const char* op_name);
+static PyObject* __Pyx_PyNumber_InPlaceMatrixMultiply(PyObject* x, PyObject* y);
 #endif
 
+/* PyIntCompare.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, long inplace);
+
 /* PyObject_GenericGetAttrNoDict.proto */
 #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static CYTHON_INLINE PyObject* __Pyx_PyObject_GenericGetAttrNoDict(PyObject* obj, PyObject* attr_name);
 #else
 #define __Pyx_PyObject_GenericGetAttrNoDict PyObject_GenericGetAttr
 #endif
 
@@ -1729,23 +1767,32 @@
 int __pyx_module_is_main_pyaibox__base__mathops = 0;
 
 /* Implementation of 'pyaibox.base.mathops' */
 static PyObject *__pyx_builtin_print;
 static PyObject *__pyx_builtin_TypeError;
 static PyObject *__pyx_builtin_zip;
 static const char __pyx_k_[] = "+";
+static const char __pyx_k_A[] = "A";
+static const char __pyx_k_B[] = "B";
 static const char __pyx_k_X[] = "X";
 static const char __pyx_k_a[] = "a";
 static const char __pyx_k_b[] = "b";
 static const char __pyx_k_d[] = "d";
 static const char __pyx_k_i[] = "i";
 static const char __pyx_k_j[] = "j";
 static const char __pyx_k_n[] = "n";
 static const char __pyx_k_s[] = "s";
 static const char __pyx_k_x[] = "x";
+static const char __pyx_k_Ac[] = "Ac";
+static const char __pyx_k_Ar[] = "Ar";
+static const char __pyx_k_Bc[] = "Bc";
+static const char __pyx_k_Br[] = "Br";
+static const char __pyx_k_Mc[] = "Mc";
+static const char __pyx_k_Mr[] = "Mr";
+static const char __pyx_k_Nc[] = "Nc";
 static const char __pyx_k__2[] = "-";
 static const char __pyx_k__3[] = "*";
 static const char __pyx_k__4[] = "/";
 static const char __pyx_k__5[] = "**";
 static const char __pyx_k__6[] = "^";
 static const char __pyx_k__7[] = "!";
 static const char __pyx_k_db[] = "db";
@@ -1764,14 +1811,15 @@
 static const char __pyx_k_pow[] = "pow";
 static const char __pyx_k_r2c[] = "r2c";
 static const char __pyx_k_sub[] = "sub";
 static const char __pyx_k_sum[] = "sum";
 static const char __pyx_k_zip[] = "zip";
 static const char __pyx_k_args[] = "args";
 static const char __pyx_k_axis[] = "axis";
+static const char __pyx_k_cdim[] = "cdim";
 static const char __pyx_k_ceil[] = "ceil";
 static const char __pyx_k_conj[] = "conj";
 static const char __pyx_k_ebeo[] = "ebeo";
 static const char __pyx_k_fnab[] = "fnab";
 static const char __pyx_k_imag[] = "imag";
 static const char __pyx_k_log2[] = "log2";
 static const char __pyx_k_main[] = "__main__";
@@ -1791,44 +1839,60 @@
 static const char __pyx_k_caxis[] = "caxis";
 static const char __pyx_k_close[] = "close";
 static const char __pyx_k_floor[] = "floor";
 static const char __pyx_k_log10[] = "log10";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_pow_2[] = "---pow";
 static const char __pyx_k_print[] = "print";
+static const char __pyx_k_randn[] = "randn";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_stack[] = "stack";
 static const char __pyx_k_throw[] = "throw";
 static const char __pyx_k_conj_2[] = "---conj";
 static const char __pyx_k_db2mag[] = "db2mag";
 static const char __pyx_k_imag_2[] = "---imag";
 static const char __pyx_k_import[] = "__import__";
+static const char __pyx_k_kwargs[] = "kwargs";
 static const char __pyx_k_mag2db[] = "mag2db";
+static const char __pyx_k_matmul[] = "__matmul__";
 static const char __pyx_k_random[] = "random";
 static const char __pyx_k_real_2[] = "---real";
+static const char __pyx_k_ematmul[] = "ematmul";
 static const char __pyx_k_genexpr[] = "genexpr";
 static const char __pyx_k_idximag[] = "idximag";
 static const char __pyx_k_idxreal[] = "idxreal";
+static const char __pyx_k_imatmul[] = "__imatmul__";
 static const char __pyx_k_pyaibox[] = "pyaibox";
 static const char __pyx_k_randint[] = "randint";
+static const char __pyx_k_rmatmul[] = "__rmatmul__";
+static const char __pyx_k_keepaxis[] = "keepaxis";
+static const char __pyx_k_matmul_2[] = "matmul";
 static const char __pyx_k_nextpow2[] = "nextpow2";
 static const char __pyx_k_prevpow2[] = "prevpow2";
 static const char __pyx_k_TypeError[] = "TypeError";
 static const char __pyx_k_iscomplex[] = "iscomplex";
-static const char __pyx_k_keepcaxis[] = "keepcaxis";
 static const char __pyx_k_zeros_like[] = "zeros_like";
 static const char __pyx_k_concatenate[] = "concatenate";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_pyaibox_base_mathops[] = "pyaibox.base.mathops";
 static const char __pyx_k_db2mag_locals_genexpr[] = "db2mag.<locals>.genexpr";
 static const char __pyx_k_mag2db_locals_genexpr[] = "mag2db.<locals>.genexpr";
 static const char __pyx_k_Not_supported_operation[] = "Not supported operation: ";
 static const char __pyx_k_pyaibox_base_mathops_py[] = "pyaibox/base/mathops.py";
 static PyObject *__pyx_kp_u_;
+static PyObject *__pyx_n_s_A;
+static PyObject *__pyx_n_s_Ac;
+static PyObject *__pyx_n_s_Ar;
+static PyObject *__pyx_n_s_B;
+static PyObject *__pyx_n_s_Bc;
+static PyObject *__pyx_n_s_Br;
 static PyObject *__pyx_n_u_Error;
+static PyObject *__pyx_n_s_Mc;
+static PyObject *__pyx_n_s_Mr;
+static PyObject *__pyx_n_s_Nc;
 static PyObject *__pyx_kp_u_Not_supported_operation;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_n_s_X;
 static PyObject *__pyx_n_s_Xcplx;
 static PyObject *__pyx_n_u_Xcplx;
 static PyObject *__pyx_n_s_Xreal;
 static PyObject *__pyx_n_u_Xreal;
@@ -1846,46 +1910,54 @@
 static PyObject *__pyx_n_u_add;
 static PyObject *__pyx_n_s_any;
 static PyObject *__pyx_n_s_args;
 static PyObject *__pyx_n_s_axis;
 static PyObject *__pyx_n_s_b;
 static PyObject *__pyx_n_s_c2r;
 static PyObject *__pyx_n_s_caxis;
+static PyObject *__pyx_n_u_caxis;
+static PyObject *__pyx_n_s_cdim;
+static PyObject *__pyx_n_u_cdim;
 static PyObject *__pyx_n_s_ceil;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_n_s_close;
 static PyObject *__pyx_n_s_concatenate;
 static PyObject *__pyx_n_s_conj;
 static PyObject *__pyx_kp_u_conj_2;
 static PyObject *__pyx_n_s_d;
 static PyObject *__pyx_n_s_db;
 static PyObject *__pyx_n_s_db2mag;
 static PyObject *__pyx_n_s_db2mag_locals_genexpr;
 static PyObject *__pyx_n_u_div;
 static PyObject *__pyx_n_s_ebeo;
+static PyObject *__pyx_n_s_ematmul;
 static PyObject *__pyx_n_s_floor;
 static PyObject *__pyx_n_s_fnab;
 static PyObject *__pyx_n_s_genexpr;
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_idx;
 static PyObject *__pyx_n_s_idximag;
 static PyObject *__pyx_n_s_idxreal;
 static PyObject *__pyx_n_s_imag;
 static PyObject *__pyx_kp_u_imag_2;
+static PyObject *__pyx_n_s_imatmul;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_iscomplex;
 static PyObject *__pyx_n_s_j;
-static PyObject *__pyx_n_s_keepcaxis;
+static PyObject *__pyx_n_s_keepaxis;
+static PyObject *__pyx_n_s_kwargs;
 static PyObject *__pyx_n_s_log10;
 static PyObject *__pyx_n_s_log2;
 static PyObject *__pyx_n_s_mag;
 static PyObject *__pyx_n_s_mag2db;
 static PyObject *__pyx_n_s_mag2db_locals_genexpr;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_u_main;
+static PyObject *__pyx_n_s_matmul;
+static PyObject *__pyx_n_s_matmul_2;
 static PyObject *__pyx_n_u_mul;
 static PyObject *__pyx_n_s_n;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_ndim;
 static PyObject *__pyx_n_s_nextpow2;
 static PyObject *__pyx_n_s_np;
 static PyObject *__pyx_n_s_numpy;
@@ -1898,17 +1970,19 @@
 static PyObject *__pyx_n_s_print;
 static PyObject *__pyx_n_s_pyaibox;
 static PyObject *__pyx_n_s_pyaibox_base_mathops;
 static PyObject *__pyx_kp_s_pyaibox_base_mathops_py;
 static PyObject *__pyx_n_s_r2c;
 static PyObject *__pyx_n_s_rand;
 static PyObject *__pyx_n_s_randint;
+static PyObject *__pyx_n_s_randn;
 static PyObject *__pyx_n_s_random;
 static PyObject *__pyx_n_s_real;
 static PyObject *__pyx_kp_u_real_2;
+static PyObject *__pyx_n_s_rmatmul;
 static PyObject *__pyx_n_s_s;
 static PyObject *__pyx_n_s_seed;
 static PyObject *__pyx_n_s_send;
 static PyObject *__pyx_n_s_shape;
 static PyObject *__pyx_n_s_sl;
 static PyObject *__pyx_n_s_sqrt;
 static PyObject *__pyx_n_s_stack;
@@ -1925,21 +1999,23 @@
 static PyObject *__pyx_pf_7pyaibox_4base_7mathops_6mag2db_genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7mathops_6mag2db_3genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7mathops_2mag2db(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mag, PyObject *__pyx_v_s); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7mathops_4fnab(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7mathops_6ebeo(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_op); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7mathops_8nextpow2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
 static PyObject *__pyx_pf_7pyaibox_4base_7mathops_10prevpow2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_12r2c(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis); /* proto */
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_14c2r(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis); /* proto */
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_16conj(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis); /* proto */
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_18real(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis); /* proto */
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_20imag(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis); /* proto */
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_22abs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis); /* proto */
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_24pow(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_12ematmul(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_A, PyObject *__pyx_v_B, PyObject *__pyx_v_kwargs); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_14matmul(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_A, PyObject *__pyx_v_B, PyObject *__pyx_v_kwargs); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_16c2r(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_18r2c(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_20conj(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_22real(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_24imag(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_26abs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis); /* proto */
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_28pow(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis); /* proto */
 static PyObject *__pyx_tp_new_7pyaibox_4base_7mathops___pyx_scope_struct__db2mag(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_7pyaibox_4base_7mathops___pyx_scope_struct_1_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_7pyaibox_4base_7mathops___pyx_scope_struct_2_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_7pyaibox_4base_7mathops___pyx_scope_struct_3_mag2db(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_7pyaibox_4base_7mathops___pyx_scope_struct_4_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_7pyaibox_4base_7mathops___pyx_scope_struct_5_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_float_0_3;
@@ -1965,53 +2041,58 @@
 static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__16;
 static PyObject *__pyx_tuple__18;
 static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__25;
-static PyObject *__pyx_tuple__26;
-static PyObject *__pyx_tuple__28;
+static PyObject *__pyx_tuple__27;
 static PyObject *__pyx_tuple__29;
-static PyObject *__pyx_tuple__31;
+static PyObject *__pyx_tuple__30;
 static PyObject *__pyx_tuple__32;
-static PyObject *__pyx_tuple__34;
+static PyObject *__pyx_tuple__33;
 static PyObject *__pyx_tuple__35;
-static PyObject *__pyx_tuple__37;
+static PyObject *__pyx_tuple__36;
 static PyObject *__pyx_tuple__38;
-static PyObject *__pyx_tuple__40;
+static PyObject *__pyx_tuple__39;
 static PyObject *__pyx_tuple__41;
-static PyObject *__pyx_tuple__43;
+static PyObject *__pyx_tuple__42;
 static PyObject *__pyx_tuple__44;
 static PyObject *__pyx_tuple__45;
-static PyObject *__pyx_tuple__46;
 static PyObject *__pyx_tuple__47;
 static PyObject *__pyx_tuple__48;
 static PyObject *__pyx_tuple__49;
 static PyObject *__pyx_tuple__50;
 static PyObject *__pyx_tuple__51;
 static PyObject *__pyx_tuple__52;
 static PyObject *__pyx_tuple__53;
 static PyObject *__pyx_tuple__54;
 static PyObject *__pyx_tuple__55;
 static PyObject *__pyx_tuple__56;
 static PyObject *__pyx_tuple__57;
+static PyObject *__pyx_tuple__58;
+static PyObject *__pyx_tuple__59;
+static PyObject *__pyx_tuple__60;
+static PyObject *__pyx_tuple__61;
+static PyObject *__pyx_tuple__62;
 static PyObject *__pyx_codeobj__9;
 static PyObject *__pyx_codeobj__12;
 static PyObject *__pyx_codeobj__15;
 static PyObject *__pyx_codeobj__17;
 static PyObject *__pyx_codeobj__20;
 static PyObject *__pyx_codeobj__22;
 static PyObject *__pyx_codeobj__24;
-static PyObject *__pyx_codeobj__27;
-static PyObject *__pyx_codeobj__30;
-static PyObject *__pyx_codeobj__33;
-static PyObject *__pyx_codeobj__36;
-static PyObject *__pyx_codeobj__39;
-static PyObject *__pyx_codeobj__42;
+static PyObject *__pyx_codeobj__26;
+static PyObject *__pyx_codeobj__28;
+static PyObject *__pyx_codeobj__31;
+static PyObject *__pyx_codeobj__34;
+static PyObject *__pyx_codeobj__37;
+static PyObject *__pyx_codeobj__40;
+static PyObject *__pyx_codeobj__43;
+static PyObject *__pyx_codeobj__46;
 /* Late includes */
 
 /* "pyaibox/base/mathops.py":33
  * 
  * 
  * def db2mag(db, s=20.):             # <<<<<<<<<<<<<<
  *     r"""Converts decibel values to magnitudes
@@ -4762,449 +4843,1858 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "pyaibox/base/mathops.py":240
  * 
  * 
- * def r2c(X, caxis=-1, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""convert real-valued array to complex-valued array
+ * def ematmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Element-by-element complex multiplication
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_13r2c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_4base_7mathops_12r2c[] = "convert real-valued array to complex-valued array\n\n    Convert real-valued array (the size of :attr:`axis` -th dimension is 2) to complex-valued array\n\n    Args:\n        X (numpy array): real-valued array.\n        caxis (int, optional): the complex axis. Defaults to -1.\n        keepcaxis (bool, optional): keepcaxis? default is False.\n\n    Returns:\n        numpy array: complex-valued array\n\n    Examples:\n\n        ::\n\n            import numpy as np\n\n            np.random.seed(2020)\n\n            Xreal = np.random.randint(0, 30, (3, 2, 4))\n            Xcplx = r2c(Xreal, caxis=1)\n            Yreal = c2r(Xcplx, caxis=0, keepcaxis=True)\n\n            print(Xreal, Xreal.shape, 'Xreal')\n            print(Xcplx, Xcplx.shape, 'Xcplx')\n            print(Yreal, Yreal.shape, 'Yreal')\n            print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')\n\n            # output\n            [[[ 0  8  3 22]\n            [ 3 27 29  3]]\n\n            [[ 7 24 29 16]\n            [ 0 24 10  9]]\n\n            [[19 11 23 18]\n            [ 3  6  5 16]]] (3, 2, 4) Xreal\n\n            [[[ 0. +3.j  8.+27.j  3.+29.j 22. +3.j]]\n\n            [[ 7. +0.j 24.+24.j 29.+10.j 16. +9.j]]\n\n            [[19. +3.j 11. +6.j 23. +5.j 18.+16.j]]] (3, 1, 4) Xcplx\n\n            [[[[ 0.  8.  3. 22.]]\n\n            [[ 7. 24. 29. 16.]]\n\n            [[19. 11. 23. 18.]]]\n\n\n            [[[ 3. 27. 29.  3.]]\n\n            [[ 0. 24. 10.  9.]]\n\n            [[ 3.  6.  5. 16.]]]] (2, 3, 1, 4) Yreal\n\n            0.0 0.0, Error\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_13r2c = {"r2c", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_13r2c, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_12r2c};
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_13r2c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_X = 0;
-  PyObject *__pyx_v_caxis = 0;
-  PyObject *__pyx_v_keepcaxis = 0;
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_13ematmul(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_12ematmul[] = "Element-by-element complex multiplication\n\n    like A .* B in matlab\n\n    Parameters\n    ----------\n    A : array\n        any size array, both complex and real representation are supported.\n        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.\n    B : array\n        any size array, both complex and real representation are supported.\n        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.\n    cdim : int or None, optional\n        if :attr:`A` and :attr:`B` are complex arrays but represented in real format, :attr:`cdim` or :attr:`caxis`\n        should be specified (Default is :obj:`None`).\n\n    Returns\n    -------\n    tensor\n        result of element-by-element complex multiplication with the same repesentation as :attr:`A` and :attr:`B`.\n    \n    Examples\n    ----------\n\n    ::\n\n        np.random.seed(2020)\n        Ar = np.random.randn(3, 3, 2)\n        Br = np.random.randn(3, 3, 2)\n\n        Ac = pb.r2c(Ar)\n        Bc = pb.r2c(Br)\n\n        Mr = pb.c2r(Ac * Bc)\n        print(np.sum(Mr - ematmul(Ar, Br, cdim=-1)))\n        print(np.sum(Ac * Bc - ematmul(Ac, Bc)))\n\n        # output\n        tensor(0)\n        tensor(0j)\n\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_13ematmul = {"ematmul", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_13ematmul, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_12ematmul};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_13ematmul(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_A = 0;
+  PyObject *__pyx_v_B = 0;
+  PyObject *__pyx_v_kwargs = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("r2c (wrapper)", 0);
+  __Pyx_RefNannySetupContext("ematmul (wrapper)", 0);
+  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
+  __Pyx_GOTREF(__pyx_v_kwargs);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepcaxis,0};
-    PyObject* values[3] = {0,0,0};
-    values[1] = ((PyObject *)((PyObject *)__pyx_int_neg_1));
-    values[2] = ((PyObject *)((PyObject *)Py_False));
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_A,&__pyx_n_s_B,0};
+    PyObject* values[2] = {0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
-          if (value) { values[1] = value; kw_args--; }
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepcaxis);
-          if (value) { values[2] = value; kw_args--; }
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_B)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("ematmul", 1, 2, 2, 1); __PYX_ERR(0, 240, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "r2c") < 0)) __PYX_ERR(0, 240, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "ematmul") < 0)) __PYX_ERR(0, 240, __pyx_L3_error)
       }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+      goto __pyx_L5_argtuple_error;
     } else {
-      switch (PyTuple_GET_SIZE(__pyx_args)) {
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        break;
-        default: goto __pyx_L5_argtuple_error;
-      }
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_X = values[0];
-    __pyx_v_caxis = values[1];
-    __pyx_v_keepcaxis = values[2];
+    __pyx_v_A = values[0];
+    __pyx_v_B = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("r2c", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 240, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ematmul", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 240, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyaibox.base.mathops.r2c", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
+  __Pyx_AddTraceback("pyaibox.base.mathops.ematmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_12r2c(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepcaxis);
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_12ematmul(__pyx_self, __pyx_v_A, __pyx_v_B, __pyx_v_kwargs);
 
   /* function exit code */
+  __Pyx_XDECREF(__pyx_v_kwargs);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_12r2c(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis) {
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_12ematmul(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_A, PyObject *__pyx_v_B, PyObject *__pyx_v_kwargs) {
+  PyObject *__pyx_v_cdim = NULL;
+  PyObject *__pyx_v_Nc = NULL;
   PyObject *__pyx_v_idxreal = NULL;
   PyObject *__pyx_v_idximag = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
+  int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  int __pyx_t_8;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("r2c", 0);
+  __Pyx_RefNannySetupContext("ematmul", 0);
 
-  /* "pyaibox/base/mathops.py":302
+  /* "pyaibox/base/mathops.py":284
  *     """
  * 
- *     if keepcaxis:             # <<<<<<<<<<<<<<
- *         idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[[0]])
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[[1]])
+ *     if 'cdim' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 302, __pyx_L1_error)
-  if (__pyx_t_1) {
+  __pyx_t_1 = (__Pyx_PyDict_ContainsTF(__pyx_n_u_cdim, __pyx_v_kwargs, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 284, __pyx_L1_error)
+  __pyx_t_2 = (__pyx_t_1 != 0);
+  if (__pyx_t_2) {
+
+    /* "pyaibox/base/mathops.py":285
+ * 
+ *     if 'cdim' in kwargs:
+ *         cdim = kwargs['cdim']             # <<<<<<<<<<<<<<
+ *     elif 'caxis' in kwargs:
+ *         cdim = kwargs['caxis']
+ */
+    __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_kwargs, __pyx_n_u_cdim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_v_cdim = __pyx_t_3;
+    __pyx_t_3 = 0;
 
-    /* "pyaibox/base/mathops.py":303
+    /* "pyaibox/base/mathops.py":284
+ *     """
  * 
- *     if keepcaxis:
- *         idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[[0]])             # <<<<<<<<<<<<<<
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[[1]])
+ *     if 'cdim' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:
+ */
+    goto __pyx_L3;
+  }
+
+  /* "pyaibox/base/mathops.py":286
+ *     if 'cdim' in kwargs:
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['caxis']
  *     else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pb); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sl); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 303, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyDict_ContainsTF(__pyx_n_u_caxis, __pyx_v_kwargs, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 286, __pyx_L1_error)
+  __pyx_t_1 = (__pyx_t_2 != 0);
+  if (__pyx_t_1) {
+
+    /* "pyaibox/base/mathops.py":287
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:
+ *         cdim = kwargs['caxis']             # <<<<<<<<<<<<<<
+ *     else:
+ *         cdim = None
+ */
+    __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_kwargs, __pyx_n_u_caxis); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ndim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
-      if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-        __Pyx_INCREF(__pyx_t_4);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_5, function);
-      }
+    __pyx_v_cdim = __pyx_t_3;
+    __pyx_t_3 = 0;
+
+    /* "pyaibox/base/mathops.py":286
+ *     if 'cdim' in kwargs:
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['caxis']
+ *     else:
+ */
+    goto __pyx_L3;
+  }
+
+  /* "pyaibox/base/mathops.py":289
+ *         cdim = kwargs['caxis']
+ *     else:
+ *         cdim = None             # <<<<<<<<<<<<<<
+ * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():
+ */
+  /*else*/ {
+    __Pyx_INCREF(Py_None);
+    __pyx_v_cdim = Py_None;
+  }
+  __pyx_L3:;
+
+  /* "pyaibox/base/mathops.py":291
+ *         cdim = None
+ * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():             # <<<<<<<<<<<<<<
+ *         return A * B
+ *         # return A.real * B.real - A.imag * B.imag + 1j * (A.real * B.imag + A.imag * B.real)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_5)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_5);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_6, function);
     }
-    __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_X);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 303, __pyx_L1_error)
+  }
+  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_A) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_A);
+  __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_any); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_4)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_4);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_6, function);
+    }
+  }
+  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (!__pyx_t_2) {
+  } else {
+    __pyx_t_1 = __pyx_t_2;
+    goto __pyx_L5_bool_binop_done;
+  }
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_4)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+      __Pyx_INCREF(__pyx_t_4);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_5, function);
+    }
+  }
+  __pyx_t_6 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_v_B) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_B);
+  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_any); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
+    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_6)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+      __Pyx_INCREF(__pyx_t_6);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_5, function);
+    }
+  }
+  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_1 = __pyx_t_2;
+  __pyx_L5_bool_binop_done:;
+  if (__pyx_t_1) {
+
+    /* "pyaibox/base/mathops.py":292
+ * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():
+ *         return A * B             # <<<<<<<<<<<<<<
+ *         # return A.real * B.real - A.imag * B.imag + 1j * (A.real * B.imag + A.imag * B.real)
+ *     elif cdim is None:
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_3 = PyNumber_Multiply(__pyx_v_A, __pyx_v_B); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_r = __pyx_t_3;
+    __pyx_t_3 = 0;
+    goto __pyx_L0;
+
+    /* "pyaibox/base/mathops.py":291
+ *         cdim = None
+ * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():             # <<<<<<<<<<<<<<
+ *         return A * B
+ *         # return A.real * B.real - A.imag * B.imag + 1j * (A.real * B.imag + A.imag * B.real)
+ */
+  }
+
+  /* "pyaibox/base/mathops.py":294
+ *         return A * B
+ *         # return A.real * B.real - A.imag * B.imag + 1j * (A.real * B.imag + A.imag * B.real)
+ *     elif cdim is None:             # <<<<<<<<<<<<<<
+ *         return A * B
+ *     else:
+ */
+  __pyx_t_1 = (__pyx_v_cdim == Py_None);
+  __pyx_t_2 = (__pyx_t_1 != 0);
+  if (__pyx_t_2) {
+
+    /* "pyaibox/base/mathops.py":295
+ *         # return A.real * B.real - A.imag * B.imag + 1j * (A.real * B.imag + A.imag * B.real)
+ *     elif cdim is None:
+ *         return A * B             # <<<<<<<<<<<<<<
+ *     else:
+ *         Nc = A.shape[cdim] // 2
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_3 = PyNumber_Multiply(__pyx_v_A, __pyx_v_B); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_r = __pyx_t_3;
+    __pyx_t_3 = 0;
+    goto __pyx_L0;
+
+    /* "pyaibox/base/mathops.py":294
+ *         return A * B
+ *         # return A.real * B.real - A.imag * B.imag + 1j * (A.real * B.imag + A.imag * B.real)
+ *     elif cdim is None:             # <<<<<<<<<<<<<<
+ *         return A * B
+ *     else:
+ */
+  }
+
+  /* "pyaibox/base/mathops.py":297
+ *         return A * B
+ *     else:
+ *         Nc = A.shape[cdim] // 2             # <<<<<<<<<<<<<<
+ *         idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))
+ *         return np.concatenate((A[idxreal] * B[idxreal] - A[idximag] * B[idximag], A[idxreal] * B[idximag] + A[idximag] * B[idxreal]), axis=cdim)
+ */
+  /*else*/ {
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_cdim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GIVEREF(__pyx_t_2);
-    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
-    __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 303, __pyx_L1_error)
-    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_INCREF(__pyx_int_0);
-    __Pyx_GIVEREF(__pyx_int_0);
-    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
-    __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GIVEREF(__pyx_t_4);
-    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
-    __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_idx, __pyx_t_6) < 0) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_5, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_v_idxreal = __pyx_t_6;
-    __pyx_t_6 = 0;
+    __pyx_v_Nc = __pyx_t_3;
+    __pyx_t_3 = 0;
 
-    /* "pyaibox/base/mathops.py":304
- *     if keepcaxis:
- *         idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[[0]])
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[[1]])             # <<<<<<<<<<<<<<
+    /* "pyaibox/base/mathops.py":298
  *     else:
- *         idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[0])
+ *         Nc = A.shape[cdim] // 2
+ *         idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))             # <<<<<<<<<<<<<<
+ *         return np.concatenate((A[idxreal] * B[idxreal] - A[idximag] * B[idximag], A[idxreal] * B[idximag] + A[idximag] * B[idxreal]), axis=cdim)
+ * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_pb); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 304, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 304, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pb); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sl); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_5)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_5);
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_ndim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_4 = PySlice_New(Py_None, __pyx_v_Nc, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_7 = NULL;
+    __pyx_t_8 = 0;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
+      if (likely(__pyx_t_7)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+        __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
+        __Pyx_DECREF_SET(__pyx_t_6, function);
+        __pyx_t_8 = 1;
       }
     }
-    __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_X);
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 304, __pyx_L1_error)
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_6)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_5, __pyx_v_cdim, __pyx_t_4};
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_5, __pyx_v_cdim, __pyx_t_4};
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_9 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      if (__pyx_t_7) {
+        __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
+      }
+      __Pyx_GIVEREF(__pyx_t_5);
+      PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_t_5);
+      __Pyx_INCREF(__pyx_v_cdim);
+      __Pyx_GIVEREF(__pyx_v_cdim);
+      PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_v_cdim);
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_t_4);
+      __pyx_t_5 = 0;
+      __pyx_t_4 = 0;
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_pb); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_sl); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_ndim); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_5 = PySlice_New(__pyx_v_Nc, Py_None, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_7 = NULL;
+    __pyx_t_8 = 0;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
+      if (likely(__pyx_t_7)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_7);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_4, function);
+        __pyx_t_8 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_4)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_9, __pyx_v_cdim, __pyx_t_5};
+      __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_9, __pyx_v_cdim, __pyx_t_5};
+      __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_10 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      if (__pyx_t_7) {
+        __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7); __pyx_t_7 = NULL;
+      }
+      __Pyx_GIVEREF(__pyx_t_9);
+      PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_8, __pyx_t_9);
+      __Pyx_INCREF(__pyx_v_cdim);
+      __Pyx_GIVEREF(__pyx_v_cdim);
+      PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_8, __pyx_v_cdim);
+      __Pyx_GIVEREF(__pyx_t_5);
+      PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_8, __pyx_t_5);
+      __pyx_t_9 = 0;
+      __pyx_t_5 = 0;
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_10, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_v_idxreal = __pyx_t_3;
+    __pyx_t_3 = 0;
+    __pyx_v_idximag = __pyx_t_6;
+    __pyx_t_6 = 0;
+
+    /* "pyaibox/base/mathops.py":299
+ *         Nc = A.shape[cdim] // 2
+ *         idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))
+ *         return np.concatenate((A[idxreal] * B[idxreal] - A[idximag] * B[idximag], A[idxreal] * B[idximag] + A[idximag] * B[idxreal]), axis=cdim)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GIVEREF(__pyx_t_6);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
-    __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idxreal); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
-    __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idxreal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idximag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idximag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_INCREF(__pyx_int_1);
-    __Pyx_GIVEREF(__pyx_int_1);
-    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_1);
-    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_10, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idxreal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idximag); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __pyx_t_4 = PyNumber_Multiply(__pyx_t_5, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idximag); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idxreal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_10, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_5);
-    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_5);
+    __pyx_t_6 = 0;
     __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_idx, __pyx_t_4) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_9);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_9);
+    __pyx_t_9 = 0;
+    __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_axis, __pyx_v_cdim) < 0) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_v_idximag = __pyx_t_4;
-    __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_r = __pyx_t_6;
+    __pyx_t_6 = 0;
+    goto __pyx_L0;
+  }
+
+  /* "pyaibox/base/mathops.py":240
+ * 
+ * 
+ * def ematmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Element-by-element complex multiplication
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_AddTraceback("pyaibox.base.mathops.ematmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_cdim);
+  __Pyx_XDECREF(__pyx_v_Nc);
+  __Pyx_XDECREF(__pyx_v_idxreal);
+  __Pyx_XDECREF(__pyx_v_idximag);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyaibox/base/mathops.py":302
+ * 
+ * 
+ * def matmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Complex matrix multiplication
+ * 
+ */
 
-    /* "pyaibox/base/mathops.py":302
+/* Python wrapper */
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_15matmul(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_14matmul[] = "Complex matrix multiplication\n\n    like A * B in matlab\n\n    Parameters\n    ----------\n    A : tensor\n        any size tensor, both complex and real representation are supported.\n        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.\n    B : tensor\n        any size tensor, both complex and real representation are supported.\n        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.\n    cdim : int or None, optional\n        if :attr:`A` and :attr:`B` are complex tensors but represented in real format, :attr:`cdim` or :attr:`caxis`\n        should be specified (Default is :obj:`None`).\n\n    Returns\n    -------\n    tensor\n        result of complex multiplication with the same repesentation as :attr:`A` and :attr:`B`.\n    \n    Examples\n    ----------\n\n    ::\n\n        np.random.seed(2020)\n        Ar = np.random.randn(3, 3, 2)\n        Br = np.random.randn(3, 3, 2)\n\n        Ac = pb.r2c(Ar)\n        Bc = pb.r2c(Br)\n\n        print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))\n        Mr = matmul(Ar, Br, cdim=-1)\n        Mc = pb.c2r(np.matmul(Ac, Bc))\n        print(np.sum(Mr - Mc))\n\n        # output\n        tensor(0j)\n        tensor(0)\n\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_15matmul = {"matmul", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_15matmul, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_14matmul};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_15matmul(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_A = 0;
+  PyObject *__pyx_v_B = 0;
+  PyObject *__pyx_v_kwargs = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("matmul (wrapper)", 0);
+  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
+  __Pyx_GOTREF(__pyx_v_kwargs);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_A,&__pyx_n_s_B,0};
+    PyObject* values[2] = {0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_B)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("matmul", 1, 2, 2, 1); __PYX_ERR(0, 302, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "matmul") < 0)) __PYX_ERR(0, 302, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+    }
+    __pyx_v_A = values[0];
+    __pyx_v_B = values[1];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("matmul", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 302, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
+  __Pyx_AddTraceback("pyaibox.base.mathops.matmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_14matmul(__pyx_self, __pyx_v_A, __pyx_v_B, __pyx_v_kwargs);
+
+  /* function exit code */
+  __Pyx_XDECREF(__pyx_v_kwargs);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_14matmul(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_A, PyObject *__pyx_v_B, PyObject *__pyx_v_kwargs) {
+  PyObject *__pyx_v_cdim = NULL;
+  PyObject *__pyx_v_Nc = NULL;
+  PyObject *__pyx_v_idxreal = NULL;
+  PyObject *__pyx_v_idximag = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  int __pyx_t_2;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  PyObject *__pyx_t_11 = NULL;
+  PyObject *__pyx_t_12 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("matmul", 0);
+
+  /* "pyaibox/base/mathops.py":347
  *     """
  * 
- *     if keepcaxis:             # <<<<<<<<<<<<<<
- *         idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[[0]])
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[[1]])
+ *     if 'cdim' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:
+ */
+  __pyx_t_1 = (__Pyx_PyDict_ContainsTF(__pyx_n_u_cdim, __pyx_v_kwargs, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 347, __pyx_L1_error)
+  __pyx_t_2 = (__pyx_t_1 != 0);
+  if (__pyx_t_2) {
+
+    /* "pyaibox/base/mathops.py":348
+ * 
+ *     if 'cdim' in kwargs:
+ *         cdim = kwargs['cdim']             # <<<<<<<<<<<<<<
+ *     elif 'caxis' in kwargs:
+ *         cdim = kwargs['caxis']
+ */
+    __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_kwargs, __pyx_n_u_cdim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_v_cdim = __pyx_t_3;
+    __pyx_t_3 = 0;
+
+    /* "pyaibox/base/mathops.py":347
+ *     """
+ * 
+ *     if 'cdim' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:
  */
     goto __pyx_L3;
   }
 
-  /* "pyaibox/base/mathops.py":306
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[[1]])
+  /* "pyaibox/base/mathops.py":349
+ *     if 'cdim' in kwargs:
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['caxis']
+ *     else:
+ */
+  __pyx_t_2 = (__Pyx_PyDict_ContainsTF(__pyx_n_u_caxis, __pyx_v_kwargs, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 349, __pyx_L1_error)
+  __pyx_t_1 = (__pyx_t_2 != 0);
+  if (__pyx_t_1) {
+
+    /* "pyaibox/base/mathops.py":350
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:
+ *         cdim = kwargs['caxis']             # <<<<<<<<<<<<<<
  *     else:
- *         idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[0])             # <<<<<<<<<<<<<<
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[1])
+ *         cdim = None
+ */
+    __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_kwargs, __pyx_n_u_caxis); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 350, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_v_cdim = __pyx_t_3;
+    __pyx_t_3 = 0;
+
+    /* "pyaibox/base/mathops.py":349
+ *     if 'cdim' in kwargs:
+ *         cdim = kwargs['cdim']
+ *     elif 'caxis' in kwargs:             # <<<<<<<<<<<<<<
+ *         cdim = kwargs['caxis']
+ *     else:
+ */
+    goto __pyx_L3;
+  }
+
+  /* "pyaibox/base/mathops.py":352
+ *         cdim = kwargs['caxis']
+ *     else:
+ *         cdim = None             # <<<<<<<<<<<<<<
  * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pb); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sl); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_3)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_3);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
-      }
+    __Pyx_INCREF(Py_None);
+    __pyx_v_cdim = Py_None;
+  }
+  __pyx_L3:;
+
+  /* "pyaibox/base/mathops.py":354
+ *         cdim = None
+ * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():             # <<<<<<<<<<<<<<
+ *         return A @ B
+ *         # return np.matmul(A.real, B.real) - np.matmul(A.imag, B.imag) + 1j * (np.matmul(A.real, B.imag) + np.matmul(A.imag, B.real))
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_5)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_5);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_6, function);
     }
-    __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_4);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
-    __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 306, __pyx_L1_error)
-    __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
+  }
+  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_A) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_A);
+  __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_any); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_4)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_4);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_6, function);
+    }
+  }
+  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (!__pyx_t_2) {
+  } else {
+    __pyx_t_1 = __pyx_t_2;
+    goto __pyx_L5_bool_binop_done;
+  }
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_4)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+      __Pyx_INCREF(__pyx_t_4);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_5, function);
+    }
+  }
+  __pyx_t_6 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_v_B) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_B);
+  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_any); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
+    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_6)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+      __Pyx_INCREF(__pyx_t_6);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_5, function);
+    }
+  }
+  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_1 = __pyx_t_2;
+  __pyx_L5_bool_binop_done:;
+  if (__pyx_t_1) {
+
+    /* "pyaibox/base/mathops.py":355
+ * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():
+ *         return A @ B             # <<<<<<<<<<<<<<
+ *         # return np.matmul(A.real, B.real) - np.matmul(A.imag, B.imag) + 1j * (np.matmul(A.real, B.imag) + np.matmul(A.imag, B.real))
+ *     elif cdim is None:
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_3 = __Pyx_PyNumber_MatrixMultiply(__pyx_v_A, __pyx_v_B); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 355, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_INCREF(__pyx_int_0);
-    __Pyx_GIVEREF(__pyx_int_0);
-    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_idx, __pyx_t_3) < 0) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
+    __pyx_r = __pyx_t_3;
+    __pyx_t_3 = 0;
+    goto __pyx_L0;
+
+    /* "pyaibox/base/mathops.py":354
+ *         cdim = None
+ * 
+ *     if np.iscomplex(A).any() or np.iscomplex(B).any():             # <<<<<<<<<<<<<<
+ *         return A @ B
+ *         # return np.matmul(A.real, B.real) - np.matmul(A.imag, B.imag) + 1j * (np.matmul(A.real, B.imag) + np.matmul(A.imag, B.real))
+ */
+  }
+
+  /* "pyaibox/base/mathops.py":357
+ *         return A @ B
+ *         # return np.matmul(A.real, B.real) - np.matmul(A.imag, B.imag) + 1j * (np.matmul(A.real, B.imag) + np.matmul(A.imag, B.real))
+ *     elif cdim is None:             # <<<<<<<<<<<<<<
+ *         return A @ B
+ *     else:
+ */
+  __pyx_t_1 = (__pyx_v_cdim == Py_None);
+  __pyx_t_2 = (__pyx_t_1 != 0);
+  if (__pyx_t_2) {
+
+    /* "pyaibox/base/mathops.py":358
+ *         # return np.matmul(A.real, B.real) - np.matmul(A.imag, B.imag) + 1j * (np.matmul(A.real, B.imag) + np.matmul(A.imag, B.real))
+ *     elif cdim is None:
+ *         return A @ B             # <<<<<<<<<<<<<<
+ *     else:
+ *         Nc = A.shape[cdim] // 2
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_3 = __Pyx_PyNumber_MatrixMultiply(__pyx_v_A, __pyx_v_B); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_v_idxreal = __pyx_t_3;
+    __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
+    goto __pyx_L0;
 
-    /* "pyaibox/base/mathops.py":307
+    /* "pyaibox/base/mathops.py":357
+ *         return A @ B
+ *         # return np.matmul(A.real, B.real) - np.matmul(A.imag, B.imag) + 1j * (np.matmul(A.real, B.imag) + np.matmul(A.imag, B.real))
+ *     elif cdim is None:             # <<<<<<<<<<<<<<
+ *         return A @ B
  *     else:
- *         idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[0])
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[1])             # <<<<<<<<<<<<<<
- * 
- *     return X[idxreal] + 1j * X[idximag]
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_pb); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
+  }
+
+  /* "pyaibox/base/mathops.py":360
+ *         return A @ B
+ *     else:
+ *         Nc = A.shape[cdim] // 2             # <<<<<<<<<<<<<<
+ *         if Nc == 1:
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, 0), pb.sl(A.ndim, cdim, 1)
+ */
+  /*else*/ {
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sl); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_cdim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 360, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
-      if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-        __Pyx_INCREF(__pyx_t_2);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_6, function);
-      }
-    }
-    __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_X);
-    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_5, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_v_Nc = __pyx_t_3;
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
+
+    /* "pyaibox/base/mathops.py":361
+ *     else:
+ *         Nc = A.shape[cdim] // 2
+ *         if Nc == 1:             # <<<<<<<<<<<<<<
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, 0), pb.sl(A.ndim, cdim, 1)
+ *             return np.stack((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)
+ */
+    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_Nc, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 307, __pyx_L1_error)
-    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_int_1);
-    __Pyx_GIVEREF(__pyx_int_1);
-    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_idx, __pyx_t_2) < 0) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_v_idximag = __pyx_t_2;
-    __pyx_t_2 = 0;
-  }
-  __pyx_L3:;
+    if (__pyx_t_2) {
+
+      /* "pyaibox/base/mathops.py":362
+ *         Nc = A.shape[cdim] // 2
+ *         if Nc == 1:
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, 0), pb.sl(A.ndim, cdim, 1)             # <<<<<<<<<<<<<<
+ *             return np.stack((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)
+ *         else:
+ */
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pb); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sl); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_ndim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_4 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
+        if (likely(__pyx_t_4)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_6, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_6)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_5, __pyx_v_cdim, __pyx_int_0};
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_5, __pyx_v_cdim, __pyx_int_0};
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        if (__pyx_t_4) {
+          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_4); __pyx_t_4 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_5);
+        __Pyx_INCREF(__pyx_v_cdim);
+        __Pyx_GIVEREF(__pyx_v_cdim);
+        PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_cdim);
+        __Pyx_INCREF(__pyx_int_0);
+        __Pyx_GIVEREF(__pyx_int_0);
+        PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_int_0);
+        __pyx_t_5 = 0;
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_pb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 362, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_sl); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_ndim); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 362, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __pyx_t_4 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
+        if (likely(__pyx_t_4)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_5, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_8, __pyx_v_cdim, __pyx_int_1};
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_8, __pyx_v_cdim, __pyx_int_1};
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_9 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        if (__pyx_t_4) {
+          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_8);
+        PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_7, __pyx_t_8);
+        __Pyx_INCREF(__pyx_v_cdim);
+        __Pyx_GIVEREF(__pyx_v_cdim);
+        PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_7, __pyx_v_cdim);
+        __Pyx_INCREF(__pyx_int_1);
+        __Pyx_GIVEREF(__pyx_int_1);
+        PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_7, __pyx_int_1);
+        __pyx_t_8 = 0;
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_idxreal = __pyx_t_3;
+      __pyx_t_3 = 0;
+      __pyx_v_idximag = __pyx_t_6;
+      __pyx_t_6 = 0;
 
-  /* "pyaibox/base/mathops.py":309
- *         idximag = pb.sl(np.ndim(X), axis=caxis, idx=[1])
+      /* "pyaibox/base/mathops.py":363
+ *         if Nc == 1:
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, 0), pb.sl(A.ndim, cdim, 1)
+ *             return np.stack((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)             # <<<<<<<<<<<<<<
+ *         else:
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))
+ */
+      __Pyx_XDECREF(__pyx_r);
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_stack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idxreal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idxreal); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __pyx_t_4 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_9);
+        if (likely(__pyx_t_4)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_9, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_9)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_8};
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_8};
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        if (__pyx_t_4) {
+          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4); __pyx_t_4 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_7, __pyx_t_5);
+        __Pyx_GIVEREF(__pyx_t_8);
+        PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_7, __pyx_t_8);
+        __pyx_t_5 = 0;
+        __pyx_t_8 = 0;
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_10, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idximag); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idximag); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_4 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
+        if (likely(__pyx_t_4)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
+          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_8, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_8)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_10, __pyx_t_5};
+        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_9);
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_10, __pyx_t_5};
+        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_9);
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_11 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        if (__pyx_t_4) {
+          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_4); __pyx_t_4 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_10);
+        PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_7, __pyx_t_10);
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_7, __pyx_t_5);
+        __pyx_t_10 = 0;
+        __pyx_t_5 = 0;
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_11, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __pyx_t_8 = PyNumber_Subtract(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idxreal); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idximag); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_10 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
+        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_11);
+        if (likely(__pyx_t_10)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+          __Pyx_INCREF(__pyx_t_10);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_11, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_11)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_6, __pyx_t_5};
+        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __Pyx_GOTREF(__pyx_t_9);
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_6, __pyx_t_5};
+        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __Pyx_GOTREF(__pyx_t_9);
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        if (__pyx_t_10) {
+          __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_10); __pyx_t_10 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_6);
+        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_t_6);
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_t_5);
+        __pyx_t_6 = 0;
+        __pyx_t_5 = 0;
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_4, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idximag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idxreal); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_10 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
+        if (likely(__pyx_t_10)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+          __Pyx_INCREF(__pyx_t_10);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_5, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_4, __pyx_t_6};
+        __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_4, __pyx_t_6};
+        __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_12 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        if (__pyx_t_10) {
+          __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_4);
+        PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_7, __pyx_t_4);
+        __Pyx_GIVEREF(__pyx_t_6);
+        PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_7, __pyx_t_6);
+        __pyx_t_4 = 0;
+        __pyx_t_6 = 0;
+        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 363, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_t_5 = PyNumber_Add(__pyx_t_9, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_GIVEREF(__pyx_t_8);
+      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_8);
+      __Pyx_GIVEREF(__pyx_t_5);
+      PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_5);
+      __pyx_t_8 = 0;
+      __pyx_t_5 = 0;
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_11);
+      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_11);
+      __pyx_t_11 = 0;
+      __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_axis, __pyx_v_cdim) < 0) __PYX_ERR(0, 363, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_r = __pyx_t_8;
+      __pyx_t_8 = 0;
+      goto __pyx_L0;
+
+      /* "pyaibox/base/mathops.py":361
+ *     else:
+ *         Nc = A.shape[cdim] // 2
+ *         if Nc == 1:             # <<<<<<<<<<<<<<
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, 0), pb.sl(A.ndim, cdim, 1)
+ *             return np.stack((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)
+ */
+    }
+
+    /* "pyaibox/base/mathops.py":365
+ *             return np.stack((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)
+ *         else:
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))             # <<<<<<<<<<<<<<
+ *             return np.concatenate((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)
  * 
- *     return X[idxreal] + 1j * X[idximag]             # <<<<<<<<<<<<<<
+ */
+    /*else*/ {
+      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_pb); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_sl); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_ndim); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_3 = PySlice_New(Py_None, __pyx_v_Nc, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_9 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
+        if (likely(__pyx_t_9)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+          __Pyx_INCREF(__pyx_t_9);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_5, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_11, __pyx_v_cdim, __pyx_t_3};
+        __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_11, __pyx_v_cdim, __pyx_t_3};
+        __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_12 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        if (__pyx_t_9) {
+          __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_9); __pyx_t_9 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_11);
+        PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_7, __pyx_t_11);
+        __Pyx_INCREF(__pyx_v_cdim);
+        __Pyx_GIVEREF(__pyx_v_cdim);
+        PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_7, __pyx_v_cdim);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_7, __pyx_t_3);
+        __pyx_t_11 = 0;
+        __pyx_t_3 = 0;
+        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_12, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_pb); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_sl); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_A, __pyx_n_s_ndim); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_11 = PySlice_New(__pyx_v_Nc, Py_None, Py_None); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 365, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_9 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
+        if (likely(__pyx_t_9)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          __Pyx_INCREF(__pyx_t_9);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_3)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_12, __pyx_v_cdim, __pyx_t_11};
+        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_12, __pyx_v_cdim, __pyx_t_11};
+        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_6 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        if (__pyx_t_9) {
+          __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_9); __pyx_t_9 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_12);
+        PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_7, __pyx_t_12);
+        __Pyx_INCREF(__pyx_v_cdim);
+        __Pyx_GIVEREF(__pyx_v_cdim);
+        PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_7, __pyx_v_cdim);
+        __Pyx_GIVEREF(__pyx_t_11);
+        PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_7, __pyx_t_11);
+        __pyx_t_12 = 0;
+        __pyx_t_11 = 0;
+        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_v_idxreal = __pyx_t_8;
+      __pyx_t_8 = 0;
+      __pyx_v_idximag = __pyx_t_5;
+      __pyx_t_5 = 0;
+
+      /* "pyaibox/base/mathops.py":366
+ *         else:
+ *             idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))
+ *             return np.concatenate((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_v_idxreal); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 309, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_v_idximag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 309, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Add(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 309, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_r = __pyx_t_6;
-  __pyx_t_6 = 0;
-  goto __pyx_L0;
+      __Pyx_XDECREF(__pyx_r);
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idxreal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idxreal); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_12 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
+        if (likely(__pyx_t_12)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+          __Pyx_INCREF(__pyx_t_12);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_6, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_6)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_3, __pyx_t_11};
+        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_3, __pyx_t_11};
+        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_9 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        if (__pyx_t_12) {
+          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_12); __pyx_t_12 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_7, __pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_11);
+        PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_7, __pyx_t_11);
+        __pyx_t_3 = 0;
+        __pyx_t_11 = 0;
+        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idximag); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idximag); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_12 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
+        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
+        if (likely(__pyx_t_12)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+          __Pyx_INCREF(__pyx_t_12);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_11, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_11)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_9, __pyx_t_3};
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_9, __pyx_t_3};
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        if (__pyx_t_12) {
+          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_12); __pyx_t_12 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_9);
+        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_t_9);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_t_3);
+        __pyx_t_9 = 0;
+        __pyx_t_3 = 0;
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_11 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idxreal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idximag); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_9 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
+        if (likely(__pyx_t_9)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+          __Pyx_INCREF(__pyx_t_9);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_4, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_4)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_5, __pyx_t_3};
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_5, __pyx_t_3};
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_12 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        if (__pyx_t_9) {
+          __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_9); __pyx_t_9 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_7, __pyx_t_5);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_7, __pyx_t_3);
+        __pyx_t_5 = 0;
+        __pyx_t_3 = 0;
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_12, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_A, __pyx_v_idximag); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_B, __pyx_v_idxreal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_9 = NULL;
+      __pyx_t_7 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
+        if (likely(__pyx_t_9)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          __Pyx_INCREF(__pyx_t_9);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __pyx_t_7 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_3)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_12, __pyx_t_5};
+        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_12, __pyx_t_5};
+        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        if (__pyx_t_9) {
+          __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_12);
+        PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_7, __pyx_t_12);
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_7, __pyx_t_5);
+        __pyx_t_12 = 0;
+        __pyx_t_5 = 0;
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_GIVEREF(__pyx_t_11);
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_11);
+      __Pyx_GIVEREF(__pyx_t_3);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
+      __pyx_t_11 = 0;
+      __pyx_t_3 = 0;
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_cdim) < 0) __PYX_ERR(0, 366, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 366, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_r = __pyx_t_11;
+      __pyx_t_11 = 0;
+      goto __pyx_L0;
+    }
+  }
 
-  /* "pyaibox/base/mathops.py":240
+  /* "pyaibox/base/mathops.py":302
  * 
  * 
- * def r2c(X, caxis=-1, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""convert real-valued array to complex-valued array
+ * def matmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Complex matrix multiplication
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_AddTraceback("pyaibox.base.mathops.r2c", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_AddTraceback("pyaibox.base.mathops.matmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_cdim);
+  __Pyx_XDECREF(__pyx_v_Nc);
   __Pyx_XDECREF(__pyx_v_idxreal);
   __Pyx_XDECREF(__pyx_v_idximag);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyaibox/base/mathops.py":312
+/* "pyaibox/base/mathops.py":369
  * 
  * 
- * def c2r(X, caxis=-1, keepcaxis=True):             # <<<<<<<<<<<<<<
+ * def c2r(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""convert complex-valued array to real-valued array
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_15c2r(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_4base_7mathops_14c2r[] = "convert complex-valued array to real-valued array\n\n    Args:\n        X (numpy array): complex-valued array\n        caxis (int, optional): complex axis for real-valued array. Defaults to -1.\n        keepcaxis (bool, optional): keepcaxis? default is True.\n\n    Returns:\n        numpy array: real-valued array\n\n    Examples:\n\n        ::\n\n            import numpy as np\n\n            np.random.seed(2020)\n\n            Xreal = np.random.randint(0, 30, (3, 2, 4))\n            Xcplx = r2c(Xreal, caxis=1)\n            Yreal = c2r(Xcplx, caxis=0, keepcaxis=True)\n\n            print(Xreal, Xreal.shape, 'Xreal')\n            print(Xcplx, Xcplx.shape, 'Xcplx')\n            print(Yreal, Yreal.shape, 'Yreal')\n            print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')\n\n            # output\n            [[[ 0  8  3 22]\n            [ 3 27 29  3]]\n\n            [[ 7 24 29 16]\n            [ 0 24 10  9]]\n\n            [[19 11 23 18]\n            [ 3  6  5 16]]] (3, 2, 4) Xreal\n\n            [[[ 0. +3.j  8.+27.j  3.+29.j 22. +3.j]]\n\n            [[ 7. +0.j 24.+24.j 29.+10.j 16. +9.j]]\n\n            [[19. +3.j 11. +6.j 23. +5.j 18.+16.j]]] (3, 1, 4) Xcplx\n\n            [[[[ 0.  8.  3. 22.]]\n\n            [[ 7. 24. 29. 16.]]\n\n            [[19. 11. 23. 18.]]]\n\n\n            [[[ 3. 27. 29.  3.]]\n\n            [[ 0. 24. 10.  9.]]\n\n            [[ 3.  6.  5. 16.]]]] (2, 3, 1, 4) Yreal\n\n            0.0 0.0, Error\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_15c2r = {"c2r", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_15c2r, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_14c2r};
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_15c2r(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_17c2r(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_16c2r[] = "convert complex-valued array to real-valued array\n\n    Args:\n        X (numpy array): input in complex representaion\n        caxis (int, optional): complex axis for real-valued array. Defaults to -1.\n        keepaxis (bool, optional): if :obj:`False`, stacks (make a new axis) at dimension :attr:`cdim`, \n        otherwise concatenates the real and imag part at exist dimension :attr:`cdim`, (Default is :obj:`False`).\n\n    Returns:\n        numpy array: output in real representaion\n\n    see also :func:`r2c`\n\n    Examples:\n\n        ::\n\n            import numpy as np\n\n            np.random.seed(2020)\n\n            Xreal = np.random.randint(0, 30, (3, 2, 4))\n            Xcplx = r2c(Xreal, caxis=1)\n            Yreal = c2r(Xcplx, caxis=0, keepaxis=True)\n\n            print(Xreal, Xreal.shape, 'Xreal')\n            print(Xcplx, Xcplx.shape, 'Xcplx')\n            print(Yreal, Yreal.shape, 'Yreal')\n            print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')\n\n            # output\n            [[[ 0  8  3 22]\n            [ 3 27 29  3]]\n\n            [[ 7 24 29 16]\n            [ 0 24 10  9]]\n\n            [[19 11 23 18]\n            [ 3  6  5 16]]] (3, 2, 4) Xreal\n\n            [[[ 0. +3.j  8.+27.j  3.+29.j 22. +3.j]]\n\n            [[ 7. +0.j 24.+24.j 29.+10.j 16. +9.j]]\n\n            [[19. +3.j 11. +6.j 23. +5.j 18.+16.j]]] (3, 1, 4) Xcplx\n\n            [[[[ 0.  8.  3. 22.]]\n\n            [[ 7. 24. 29. 16.]]\n\n            [[19. 11. 23. 18.]]]\n\n\n            [[[ 3. 27. 29.  3.]]\n\n            [[ 0. 24. 10.  9.]]\n\n            [[ 3.  6.  5. 16.]]]] (2, 3, 1, 4) Yreal\n\n            0.0 0.0, Error\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_17c2r = {"c2r", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_17c2r, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_16c2r};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_17c2r(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_X = 0;
   PyObject *__pyx_v_caxis = 0;
-  PyObject *__pyx_v_keepcaxis = 0;
+  PyObject *__pyx_v_keepaxis = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("c2r (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepcaxis,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepaxis,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)__pyx_int_neg_1));
-    values[2] = ((PyObject *)((PyObject *)Py_True));
+    values[2] = ((PyObject *)((PyObject *)Py_False));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -5224,173 +6714,173 @@
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepcaxis);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepaxis);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c2r") < 0)) __PYX_ERR(0, 312, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c2r") < 0)) __PYX_ERR(0, 369, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_X = values[0];
     __pyx_v_caxis = values[1];
-    __pyx_v_keepcaxis = values[2];
+    __pyx_v_keepaxis = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("c2r", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 312, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("c2r", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 369, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pyaibox.base.mathops.c2r", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_14c2r(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepcaxis);
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_16c2r(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepaxis);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_14c2r(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis) {
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_16c2r(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("c2r", 0);
 
-  /* "pyaibox/base/mathops.py":372
+  /* "pyaibox/base/mathops.py":432
  *     """
  * 
- *     if keepcaxis:             # <<<<<<<<<<<<<<
- *         return np.stack((X.real, X.imag), axis=caxis)
+ *     if keepaxis:             # <<<<<<<<<<<<<<
+ *         return np.concatenate((X.real, X.imag), axis=caxis)
  *     else:
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 372, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 432, __pyx_L1_error)
   if (__pyx_t_1) {
 
-    /* "pyaibox/base/mathops.py":373
+    /* "pyaibox/base/mathops.py":433
  * 
- *     if keepcaxis:
- *         return np.stack((X.real, X.imag), axis=caxis)             # <<<<<<<<<<<<<<
+ *     if keepaxis:
+ *         return np.concatenate((X.real, X.imag), axis=caxis)             # <<<<<<<<<<<<<<
  *     else:
- *         return np.concatenate((X.real, X.imag), axis=caxis)
+ *         return np.stack((X.real, X.imag), axis=caxis)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_stack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
     __pyx_t_2 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 373, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "pyaibox/base/mathops.py":372
+    /* "pyaibox/base/mathops.py":432
  *     """
  * 
- *     if keepcaxis:             # <<<<<<<<<<<<<<
- *         return np.stack((X.real, X.imag), axis=caxis)
+ *     if keepaxis:             # <<<<<<<<<<<<<<
+ *         return np.concatenate((X.real, X.imag), axis=caxis)
  *     else:
  */
   }
 
-  /* "pyaibox/base/mathops.py":375
- *         return np.stack((X.real, X.imag), axis=caxis)
+  /* "pyaibox/base/mathops.py":435
+ *         return np.concatenate((X.real, X.imag), axis=caxis)
  *     else:
- *         return np.concatenate((X.real, X.imag), axis=caxis)             # <<<<<<<<<<<<<<
+ *         return np.stack((X.real, X.imag), axis=caxis)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_stack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
     __pyx_t_2 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 375, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 435, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
   }
 
-  /* "pyaibox/base/mathops.py":312
+  /* "pyaibox/base/mathops.py":369
  * 
  * 
- * def c2r(X, caxis=-1, keepcaxis=True):             # <<<<<<<<<<<<<<
+ * def c2r(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""convert complex-valued array to real-valued array
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
@@ -5401,27 +6891,520 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyaibox/base/mathops.py":378
+/* "pyaibox/base/mathops.py":438
+ * 
+ * 
+ * def r2c(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""convert real-valued array to complex-valued array
+ * 
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_19r2c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_18r2c[] = "convert real-valued array to complex-valued array\n\n    Convert real-valued array (the size of :attr:`axis` -th dimension is 2) to complex-valued array\n\n    Args:\n        X (numpy array): input in real representaion\n        caxis (int, optional): the complex axis. Defaults to -1.\n        keepaxis (bool, optional): if :obj:`False`, discards axis :attr:`cdim`, \n        otherwise preserves the axis :attr:`cdim`, (Default is :obj:`False`). \n        (only work when the dimension at :attr:`cdim` equals 2)\n\n    Returns:\n        numpy array: complex-valued array\n\n    Examples:\n\n        ::\n\n            import numpy as np\n\n            np.random.seed(2020)\n\n            Xreal = np.random.randint(0, 30, (3, 2, 4))\n            Xcplx = r2c(Xreal, caxis=1)\n            Yreal = c2r(Xcplx, caxis=0, keepaxis=True)\n\n            print(Xreal, Xreal.shape, 'Xreal')\n            print(Xcplx, Xcplx.shape, 'Xcplx')\n            print(Yreal, Yreal.shape, 'Yreal')\n            print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')\n\n            # output\n            [[[ 0  8  3 22]\n            [ 3 27 29  3]]\n\n            [[ 7 24 29 16]\n            [ 0 24 10  9]]\n\n            [[19 11 23 18]\n            [ 3  6  5 16]]] (3, 2, 4) Xreal\n\n            [[[ 0. +3.j  8.+27.j  3.+29.j 22. +3.j]]\n\n            [[ 7. +0.j 24.+24.j 29.+10.j 16. +9.j]]\n\n            [[19. +3.j 11. +6.j 23. +5.j 18.+16.j]]] (3, 1, 4) Xcplx\n\n            [[[[ 0.  8.  3. 22.]]\n\n            [[ 7. 24. 29. 16.]]\n\n            [[19. 11. 23. 18.]]]\n\n\n            [[[ 3. 27. 29.  3.]]\n\n            [[ 0. 24. 10.  9.]]\n\n            [[ 3.  6.  5. 16.]]]] (2, 3, 1, 4) Yreal\n\n            0.0 0.0, Error\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_19r2c = {"r2c", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_19r2c, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_18r2c};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_19r2c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_X = 0;
+  PyObject *__pyx_v_caxis = 0;
+  PyObject *__pyx_v_keepaxis = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("r2c (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepaxis,0};
+    PyObject* values[3] = {0,0,0};
+    values[1] = ((PyObject *)((PyObject *)__pyx_int_neg_1));
+    values[2] = ((PyObject *)((PyObject *)Py_False));
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
+          if (value) { values[1] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepaxis);
+          if (value) { values[2] = value; kw_args--; }
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "r2c") < 0)) __PYX_ERR(0, 438, __pyx_L3_error)
+      }
+    } else {
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+    }
+    __pyx_v_X = values[0];
+    __pyx_v_caxis = values[1];
+    __pyx_v_keepaxis = values[2];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("r2c", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 438, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyaibox.base.mathops.r2c", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_18r2c(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepaxis);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_18r2c(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis) {
+  PyObject *__pyx_v_d = NULL;
+  PyObject *__pyx_v_Nc = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  int __pyx_t_6;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("r2c", 0);
+  __Pyx_INCREF(__pyx_v_keepaxis);
+
+  /* "pyaibox/base/mathops.py":502
+ *     """
+ * 
+ *     d, Nc = X.ndim, X.shape[caxis] // 2             # <<<<<<<<<<<<<<
+ *     keepaxis = keepaxis if Nc == 1 else True
+ *     if keepaxis:
+ */
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_caxis); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_3, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_d = __pyx_t_1;
+  __pyx_t_1 = 0;
+  __pyx_v_Nc = __pyx_t_2;
+  __pyx_t_2 = 0;
+
+  /* "pyaibox/base/mathops.py":503
+ * 
+ *     d, Nc = X.ndim, X.shape[caxis] // 2
+ *     keepaxis = keepaxis if Nc == 1 else True             # <<<<<<<<<<<<<<
+ *     if keepaxis:
+ *         return X[pb.sl(d, caxis, slice(0, Nc))] + 1j * X[pb.sl(d, caxis, slice(Nc, None))]
+ */
+  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_Nc, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (__pyx_t_4) {
+    __Pyx_INCREF(__pyx_v_keepaxis);
+    __pyx_t_2 = __pyx_v_keepaxis;
+  } else {
+    __Pyx_INCREF(Py_True);
+    __pyx_t_2 = Py_True;
+  }
+  __Pyx_DECREF_SET(__pyx_v_keepaxis, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "pyaibox/base/mathops.py":504
+ *     d, Nc = X.ndim, X.shape[caxis] // 2
+ *     keepaxis = keepaxis if Nc == 1 else True
+ *     if keepaxis:             # <<<<<<<<<<<<<<
+ *         return X[pb.sl(d, caxis, slice(0, Nc))] + 1j * X[pb.sl(d, caxis, slice(Nc, None))]
+ *     else:
+ */
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 504, __pyx_L1_error)
+  if (__pyx_t_4) {
+
+    /* "pyaibox/base/mathops.py":505
+ *     keepaxis = keepaxis if Nc == 1 else True
+ *     if keepaxis:
+ *         return X[pb.sl(d, caxis, slice(0, Nc))] + 1j * X[pb.sl(d, caxis, slice(Nc, None))]             # <<<<<<<<<<<<<<
+ *     else:
+ *         return X[pb.sl(d, caxis, [0])] + 1j * X[pb.sl(d, caxis, [1])]
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PySlice_New(__pyx_int_0, __pyx_v_Nc, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = NULL;
+    __pyx_t_6 = 0;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_5)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_5);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+        __pyx_t_6 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_v_d, __pyx_v_caxis, __pyx_t_1};
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_v_d, __pyx_v_caxis, __pyx_t_1};
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      if (__pyx_t_5) {
+        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
+      }
+      __Pyx_INCREF(__pyx_v_d);
+      __Pyx_GIVEREF(__pyx_v_d);
+      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_d);
+      __Pyx_INCREF(__pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_v_caxis);
+      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_t_1);
+      PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_1);
+      __pyx_t_1 = 0;
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PySlice_New(__pyx_v_Nc, Py_None, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_8 = NULL;
+    __pyx_t_6 = 0;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_5);
+      if (likely(__pyx_t_8)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+        __Pyx_INCREF(__pyx_t_8);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_5, function);
+        __pyx_t_6 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_5)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_v_d, __pyx_v_caxis, __pyx_t_1};
+      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_v_d, __pyx_v_caxis, __pyx_t_1};
+      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_9 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      if (__pyx_t_8) {
+        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
+      }
+      __Pyx_INCREF(__pyx_v_d);
+      __Pyx_GIVEREF(__pyx_v_d);
+      PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_6, __pyx_v_d);
+      __Pyx_INCREF(__pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_v_caxis);
+      PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_6, __pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_t_1);
+      PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_6, __pyx_t_1);
+      __pyx_t_1 = 0;
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = PyNumber_Multiply(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_r = __pyx_t_5;
+    __pyx_t_5 = 0;
+    goto __pyx_L0;
+
+    /* "pyaibox/base/mathops.py":504
+ *     d, Nc = X.ndim, X.shape[caxis] // 2
+ *     keepaxis = keepaxis if Nc == 1 else True
+ *     if keepaxis:             # <<<<<<<<<<<<<<
+ *         return X[pb.sl(d, caxis, slice(0, Nc))] + 1j * X[pb.sl(d, caxis, slice(Nc, None))]
+ *     else:
+ */
+  }
+
+  /* "pyaibox/base/mathops.py":507
+ *         return X[pb.sl(d, caxis, slice(0, Nc))] + 1j * X[pb.sl(d, caxis, slice(Nc, None))]
+ *     else:
+ *         return X[pb.sl(d, caxis, [0])] + 1j * X[pb.sl(d, caxis, [1])]             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  /*else*/ {
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_pb); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sl); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_INCREF(__pyx_int_0);
+    __Pyx_GIVEREF(__pyx_int_0);
+    PyList_SET_ITEM(__pyx_t_7, 0, __pyx_int_0);
+    __pyx_t_2 = NULL;
+    __pyx_t_6 = 0;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_2);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+        __pyx_t_6 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_d, __pyx_v_caxis, __pyx_t_7};
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_d, __pyx_v_caxis, __pyx_t_7};
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_9 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      if (__pyx_t_2) {
+        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
+      }
+      __Pyx_INCREF(__pyx_v_d);
+      __Pyx_GIVEREF(__pyx_v_d);
+      PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_6, __pyx_v_d);
+      __Pyx_INCREF(__pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_v_caxis);
+      PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_6, __pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_t_7);
+      PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_6, __pyx_t_7);
+      __pyx_t_7 = 0;
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_pb); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_INCREF(__pyx_int_1);
+    __Pyx_GIVEREF(__pyx_int_1);
+    PyList_SET_ITEM(__pyx_t_7, 0, __pyx_int_1);
+    __pyx_t_1 = NULL;
+    __pyx_t_6 = 0;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
+      if (likely(__pyx_t_1)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+        __Pyx_INCREF(__pyx_t_1);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __pyx_t_6 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_v_d, __pyx_v_caxis, __pyx_t_7};
+      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_GOTREF(__pyx_t_9);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_v_d, __pyx_v_caxis, __pyx_t_7};
+      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_GOTREF(__pyx_t_9);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_8 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      if (__pyx_t_1) {
+        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1); __pyx_t_1 = NULL;
+      }
+      __Pyx_INCREF(__pyx_v_d);
+      __Pyx_GIVEREF(__pyx_v_d);
+      PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_6, __pyx_v_d);
+      __Pyx_INCREF(__pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_v_caxis);
+      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_6, __pyx_v_caxis);
+      __Pyx_GIVEREF(__pyx_t_7);
+      PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_6, __pyx_t_7);
+      __pyx_t_7 = 0;
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_r = __pyx_t_2;
+    __pyx_t_2 = 0;
+    goto __pyx_L0;
+  }
+
+  /* "pyaibox/base/mathops.py":438
+ * 
+ * 
+ * def r2c(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""convert real-valued array to complex-valued array
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_AddTraceback("pyaibox.base.mathops.r2c", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_d);
+  __Pyx_XDECREF(__pyx_v_Nc);
+  __Pyx_XDECREF(__pyx_v_keepaxis);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyaibox/base/mathops.py":510
  * 
  * 
  * def conj(X, caxis=None):             # <<<<<<<<<<<<<<
  *     r"""conjugates a array
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_17conj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_4base_7mathops_16conj[] = "conjugates a array\n\n    Both complex and real representation are supported.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n\n    Returns\n    -------\n    array\n         the inputs's conjugate matrix.\n\n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---conj')\n        print(conj(X, caxis=0))\n        print(conj(X[0] + 1j * X[1]))\n\n        # ---output\n        ---conj\n        [[[ 0.98627683  0.87339195  0.50974552]\n        [ 0.27183571  0.33691873  0.21695427]\n        [ 0.27647714  0.34331559  0.86215894]]\n\n        [[-0.15669967 -0.14088724 -0.75708028]\n        [-0.73632492 -0.35566309 -0.34109302]\n        [-0.66680305 -0.21710064 -0.56142698]]]\n        [[0.98627683-0.15669967j 0.87339195-0.14088724j 0.50974552-0.75708028j]\n        [0.27183571-0.73632492j 0.33691873-0.35566309j 0.21695427-0.34109302j]\n        [0.27647714-0.66680305j 0.34331559-0.21710064j 0.86215894-0.56142698j]]\n\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_17conj = {"conj", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_17conj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_16conj};
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_17conj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_21conj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_20conj[] = "conjugates a array\n\n    Both complex and real representation are supported.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n\n    Returns\n    -------\n    array\n         the inputs's conjugate matrix.\n\n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---conj')\n        print(conj(X, caxis=0))\n        print(conj(X[0] + 1j * X[1]))\n\n        # ---output\n        ---conj\n        [[[ 0.98627683  0.87339195  0.50974552]\n        [ 0.27183571  0.33691873  0.21695427]\n        [ 0.27647714  0.34331559  0.86215894]]\n\n        [[-0.15669967 -0.14088724 -0.75708028]\n        [-0.73632492 -0.35566309 -0.34109302]\n        [-0.66680305 -0.21710064 -0.56142698]]]\n        [[0.98627683-0.15669967j 0.87339195-0.14088724j 0.50974552-0.75708028j]\n        [0.27183571-0.73632492j 0.33691873-0.35566309j 0.21695427-0.34109302j]\n        [0.27647714-0.66680305j 0.34331559-0.21710064j 0.86215894-0.56142698j]]\n\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_21conj = {"conj", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_21conj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_20conj};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_21conj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_X = 0;
   PyObject *__pyx_v_caxis = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -5450,15 +7433,15 @@
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "conj") < 0)) __PYX_ERR(0, 378, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "conj") < 0)) __PYX_ERR(0, 510, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -5466,28 +7449,28 @@
       }
     }
     __pyx_v_X = values[0];
     __pyx_v_caxis = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("conj", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 378, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("conj", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 510, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pyaibox.base.mathops.conj", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_16conj(__pyx_self, __pyx_v_X, __pyx_v_caxis);
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_20conj(__pyx_self, __pyx_v_X, __pyx_v_caxis);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_16conj(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis) {
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_20conj(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis) {
   PyObject *__pyx_v_d = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
@@ -5497,278 +7480,260 @@
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("conj", 0);
 
-  /* "pyaibox/base/mathops.py":424
+  /* "pyaibox/base/mathops.py":556
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return np.conj(X)
  *     else:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 424, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_5) {
 
-    /* "pyaibox/base/mathops.py":425
+    /* "pyaibox/base/mathops.py":557
  * 
  *     if np.iscomplex(X).any():  # complex in complex
  *         return np.conj(X)             # <<<<<<<<<<<<<<
  *     else:
  *         if caxis is None:  # real
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 425, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_conj); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 425, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_conj); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 557, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "pyaibox/base/mathops.py":424
+    /* "pyaibox/base/mathops.py":556
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return np.conj(X)
  *     else:
  */
   }
 
-  /* "pyaibox/base/mathops.py":427
+  /* "pyaibox/base/mathops.py":559
  *         return np.conj(X)
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return X
  *         else:  # complex in real
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_caxis == Py_None);
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "pyaibox/base/mathops.py":428
+      /* "pyaibox/base/mathops.py":560
  *     else:
  *         if caxis is None:  # real
  *             return X             # <<<<<<<<<<<<<<
  *         else:  # complex in real
- *             d = np.ndim(X)
+ *             d = X.ndim
  */
       __Pyx_XDECREF(__pyx_r);
       __Pyx_INCREF(__pyx_v_X);
       __pyx_r = __pyx_v_X;
       goto __pyx_L0;
 
-      /* "pyaibox/base/mathops.py":427
+      /* "pyaibox/base/mathops.py":559
  *         return np.conj(X)
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return X
  *         else:  # complex in real
  */
     }
 
-    /* "pyaibox/base/mathops.py":430
+    /* "pyaibox/base/mathops.py":562
  *             return X
  *         else:  # complex in real
- *             d = np.ndim(X)             # <<<<<<<<<<<<<<
+ *             d = X.ndim             # <<<<<<<<<<<<<<
  *             return np.concatenate((X[pb.sl(d, axis=caxis, idx=[[0]])], -X[pb.sl(d, axis=caxis, idx=[[1]])]), axis=caxis)
  * 
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ndim); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 430, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
-        if (likely(__pyx_t_2)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-          __Pyx_INCREF(__pyx_t_2);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_4, function);
-        }
-      }
-      __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
-      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_v_d = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":431
+      /* "pyaibox/base/mathops.py":563
  *         else:  # complex in real
- *             d = np.ndim(X)
+ *             d = X.ndim
  *             return np.concatenate((X[pb.sl(d, axis=caxis, idx=[[0]])], -X[pb.sl(d, axis=caxis, idx=[[1]])]), axis=caxis)             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 431, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 563, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_d);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 431, __pyx_L1_error)
-      __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 431, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 563, __pyx_L1_error)
+      __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyList_SET_ITEM(__pyx_t_7, 0, __pyx_int_0);
-      __pyx_t_8 = PyList_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_8 = PyList_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_7);
       PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_7);
       __pyx_t_7 = 0;
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_idx, __pyx_t_8) < 0) __PYX_ERR(0, 431, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_idx, __pyx_t_8) < 0) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_pb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_pb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_sl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_sl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
       PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_d);
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 431, __pyx_L1_error)
-      __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 563, __pyx_L1_error)
+      __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_INCREF(__pyx_int_1);
       __Pyx_GIVEREF(__pyx_int_1);
       PyList_SET_ITEM(__pyx_t_7, 0, __pyx_int_1);
-      __pyx_t_9 = PyList_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_9 = PyList_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_GIVEREF(__pyx_t_7);
       PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_7);
       __pyx_t_7 = 0;
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_idx, __pyx_t_9) < 0) __PYX_ERR(0, 431, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_idx, __pyx_t_9) < 0) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_8, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = PyNumber_Negative(__pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_9 = PyNumber_Negative(__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_3);
-      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_9);
-      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_9);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
       __pyx_t_3 = 0;
       __pyx_t_9 = 0;
-      __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_GIVEREF(__pyx_t_2);
-      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2);
-      __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 431, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_9, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L1_error)
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 563, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_r = __pyx_t_3;
       __pyx_t_3 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "pyaibox/base/mathops.py":378
+  /* "pyaibox/base/mathops.py":510
  * 
  * 
  * def conj(X, caxis=None):             # <<<<<<<<<<<<<<
  *     r"""conjugates a array
  * 
  */
 
@@ -5786,38 +7751,38 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_d);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyaibox/base/mathops.py":434
+/* "pyaibox/base/mathops.py":566
  * 
  * 
- * def real(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def real(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain real part of a array
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_19real(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_4base_7mathops_18real[] = "obtain real part of a array\n\n    Both complex and real representation are supported.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepcaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's real part array.\n\n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---real')\n        print(real(X, caxis=0))\n        print(real(X[0] + 1j * X[1]))\n\n        # ---output\n        ---real\n        [[0.98627683 0.87339195 0.50974552]\n        [0.27183571 0.33691873 0.21695427]\n        [0.27647714 0.34331559 0.86215894]]\n        [[0.98627683 0.87339195 0.50974552]\n        [0.27183571 0.33691873 0.21695427]\n        [0.27647714 0.34331559 0.86215894]]\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_19real = {"real", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_19real, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_18real};
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_19real(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_23real(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_22real[] = "obtain real part of a array\n\n    Both complex and real representation are supported.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's real part array.\n\n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---real')\n        print(real(X, caxis=0))\n        print(real(X[0] + 1j * X[1]))\n\n        # ---output\n        ---real\n        [[0.98627683 0.87339195 0.50974552]\n        [0.27183571 0.33691873 0.21695427]\n        [0.27647714 0.34331559 0.86215894]]\n        [[0.98627683 0.87339195 0.50974552]\n        [0.27183571 0.33691873 0.21695427]\n        [0.27647714 0.34331559 0.86215894]]\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_23real = {"real", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_23real, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_22real};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_23real(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_X = 0;
   PyObject *__pyx_v_caxis = 0;
-  PyObject *__pyx_v_keepcaxis = 0;
+  PyObject *__pyx_v_keepaxis = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("real (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepcaxis,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepaxis,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)Py_None));
     values[2] = ((PyObject *)((PyObject *)Py_False));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -5840,52 +7805,52 @@
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepcaxis);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepaxis);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "real") < 0)) __PYX_ERR(0, 434, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "real") < 0)) __PYX_ERR(0, 566, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_X = values[0];
     __pyx_v_caxis = values[1];
-    __pyx_v_keepcaxis = values[2];
+    __pyx_v_keepaxis = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("real", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 434, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("real", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 566, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pyaibox.base.mathops.real", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_18real(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepcaxis);
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_22real(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepaxis);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_18real(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis) {
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_22real(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis) {
   PyObject *__pyx_v_d = NULL;
   PyObject *__pyx_v_idx = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -5893,223 +7858,205 @@
   int __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("real", 0);
 
-  /* "pyaibox/base/mathops.py":477
+  /* "pyaibox/base/mathops.py":609
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return X.real
  *     else:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 477, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_5) {
 
-    /* "pyaibox/base/mathops.py":478
+    /* "pyaibox/base/mathops.py":610
  * 
  *     if np.iscomplex(X).any():  # complex in complex
  *         return X.real             # <<<<<<<<<<<<<<
  *     else:
  *         if caxis is None:  # real
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "pyaibox/base/mathops.py":477
+    /* "pyaibox/base/mathops.py":609
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return X.real
  *     else:
  */
   }
 
-  /* "pyaibox/base/mathops.py":480
+  /* "pyaibox/base/mathops.py":612
  *         return X.real
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return X
  *         else:  # complex in real
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_caxis == Py_None);
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "pyaibox/base/mathops.py":481
+      /* "pyaibox/base/mathops.py":613
  *     else:
  *         if caxis is None:  # real
  *             return X             # <<<<<<<<<<<<<<
  *         else:  # complex in real
- *             d = np.ndim(X)
+ *             d = X.ndim
  */
       __Pyx_XDECREF(__pyx_r);
       __Pyx_INCREF(__pyx_v_X);
       __pyx_r = __pyx_v_X;
       goto __pyx_L0;
 
-      /* "pyaibox/base/mathops.py":480
+      /* "pyaibox/base/mathops.py":612
  *         return X.real
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return X
  *         else:  # complex in real
  */
     }
 
-    /* "pyaibox/base/mathops.py":483
+    /* "pyaibox/base/mathops.py":615
  *             return X
  *         else:  # complex in real
- *             d = np.ndim(X)             # <<<<<<<<<<<<<<
- *             idx = [[0]] if keepcaxis else [0]
+ *             d = X.ndim             # <<<<<<<<<<<<<<
+ *             idx = [[0]] if keepaxis else [0]
  *             return X[pb.sl(d, axis=caxis, idx=idx)]
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 483, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 483, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_4)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_4);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
-        }
-      }
-      __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 483, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_d = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":484
+      /* "pyaibox/base/mathops.py":616
  *         else:  # complex in real
- *             d = np.ndim(X)
- *             idx = [[0]] if keepcaxis else [0]             # <<<<<<<<<<<<<<
+ *             d = X.ndim
+ *             idx = [[0]] if keepaxis else [0]             # <<<<<<<<<<<<<<
  *             return X[pb.sl(d, axis=caxis, idx=idx)]
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 484, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
       if (__pyx_t_6) {
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 484, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 616, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
-        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 484, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        __Pyx_GIVEREF(__pyx_t_2);
-        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_1 = __pyx_t_4;
+        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 616, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_4);
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
         __pyx_t_4 = 0;
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       } else {
-        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 484, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 616, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
-        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
-        __pyx_t_1 = __pyx_t_4;
-        __pyx_t_4 = 0;
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       }
       __pyx_v_idx = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":485
- *             d = np.ndim(X)
- *             idx = [[0]] if keepcaxis else [0]
+      /* "pyaibox/base/mathops.py":617
+ *             d = X.ndim
+ *             idx = [[0]] if keepaxis else [0]
  *             return X[pb.sl(d, axis=caxis, idx=idx)]             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 617, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 485, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 617, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 617, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_d);
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 485, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_idx, __pyx_v_idx) < 0) __PYX_ERR(0, 485, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 617, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_idx, __pyx_v_idx) < 0) __PYX_ERR(0, 617, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 617, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_r = __pyx_t_2;
-      __pyx_t_2 = 0;
+      __pyx_r = __pyx_t_4;
+      __pyx_t_4 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "pyaibox/base/mathops.py":434
+  /* "pyaibox/base/mathops.py":566
  * 
  * 
- * def real(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def real(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain real part of a array
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -6122,38 +8069,38 @@
   __Pyx_XDECREF(__pyx_v_d);
   __Pyx_XDECREF(__pyx_v_idx);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyaibox/base/mathops.py":488
+/* "pyaibox/base/mathops.py":620
  * 
  * 
- * def imag(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def imag(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain imaginary part of a array
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_21imag(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_4base_7mathops_20imag[] = "obtain imaginary part of a array\n\n    Both complex and real representation are supported.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepcaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's imaginary part array.\n\n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---imag')\n        print(imag(X, caxis=0))\n        print(imag(X[0] + 1j * X[1]))\n\n        # ---output\n        ---imag\n        [[0.15669967 0.14088724 0.75708028]\n        [0.73632492 0.35566309 0.34109302]\n        [0.66680305 0.21710064 0.56142698]]\n        [[0.15669967 0.14088724 0.75708028]\n        [0.73632492 0.35566309 0.34109302]\n        [0.66680305 0.21710064 0.56142698]]\n\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_21imag = {"imag", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_21imag, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_20imag};
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_21imag(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_25imag(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_24imag[] = "obtain imaginary part of a array\n\n    Both complex and real representation are supported.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's imaginary part array.\n\n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---imag')\n        print(imag(X, caxis=0))\n        print(imag(X[0] + 1j * X[1]))\n\n        # ---output\n        ---imag\n        [[0.15669967 0.14088724 0.75708028]\n        [0.73632492 0.35566309 0.34109302]\n        [0.66680305 0.21710064 0.56142698]]\n        [[0.15669967 0.14088724 0.75708028]\n        [0.73632492 0.35566309 0.34109302]\n        [0.66680305 0.21710064 0.56142698]]\n\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_25imag = {"imag", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_25imag, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_24imag};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_25imag(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_X = 0;
   PyObject *__pyx_v_caxis = 0;
-  PyObject *__pyx_v_keepcaxis = 0;
+  PyObject *__pyx_v_keepaxis = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("imag (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepcaxis,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepaxis,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)Py_None));
     values[2] = ((PyObject *)((PyObject *)Py_False));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -6176,52 +8123,52 @@
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepcaxis);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepaxis);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "imag") < 0)) __PYX_ERR(0, 488, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "imag") < 0)) __PYX_ERR(0, 620, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_X = values[0];
     __pyx_v_caxis = values[1];
-    __pyx_v_keepcaxis = values[2];
+    __pyx_v_keepaxis = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("imag", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 488, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("imag", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 620, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pyaibox.base.mathops.imag", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_20imag(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepcaxis);
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_24imag(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepaxis);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_20imag(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis) {
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_24imag(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis) {
   PyObject *__pyx_v_d = NULL;
   PyObject *__pyx_v_idx = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -6229,261 +8176,243 @@
   int __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("imag", 0);
 
-  /* "pyaibox/base/mathops.py":532
+  /* "pyaibox/base/mathops.py":664
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return np.imag(X)
  *     else:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 532, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 532, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 532, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 532, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 532, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_5) {
 
-    /* "pyaibox/base/mathops.py":533
+    /* "pyaibox/base/mathops.py":665
  * 
  *     if np.iscomplex(X).any():  # complex in complex
  *         return np.imag(X)             # <<<<<<<<<<<<<<
  *     else:
  *         if caxis is None:  # real
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 665, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_imag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_imag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 665, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 533, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 665, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "pyaibox/base/mathops.py":532
+    /* "pyaibox/base/mathops.py":664
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return np.imag(X)
  *     else:
  */
   }
 
-  /* "pyaibox/base/mathops.py":535
+  /* "pyaibox/base/mathops.py":667
  *         return np.imag(X)
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return np.zeros_like(X)
  *         else:  # complex in real
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_caxis == Py_None);
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "pyaibox/base/mathops.py":536
+      /* "pyaibox/base/mathops.py":668
  *     else:
  *         if caxis is None:  # real
  *             return np.zeros_like(X)             # <<<<<<<<<<<<<<
  *         else:  # complex in real
- *             d = np.ndim(X)
+ *             d = X.ndim
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 668, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_2);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
       goto __pyx_L0;
 
-      /* "pyaibox/base/mathops.py":535
+      /* "pyaibox/base/mathops.py":667
  *         return np.imag(X)
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return np.zeros_like(X)
  *         else:  # complex in real
  */
     }
 
-    /* "pyaibox/base/mathops.py":538
+    /* "pyaibox/base/mathops.py":670
  *             return np.zeros_like(X)
  *         else:  # complex in real
- *             d = np.ndim(X)             # <<<<<<<<<<<<<<
- *             idx = [[1]] if keepcaxis else [1]
+ *             d = X.ndim             # <<<<<<<<<<<<<<
+ *             idx = [[1]] if keepaxis else [1]
  *             return X[pb.sl(d, axis=caxis, idx=idx)]
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 538, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 538, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_4)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_4);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
-        }
-      }
-      __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_d = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":539
+      /* "pyaibox/base/mathops.py":671
  *         else:  # complex in real
- *             d = np.ndim(X)
- *             idx = [[1]] if keepcaxis else [1]             # <<<<<<<<<<<<<<
+ *             d = X.ndim
+ *             idx = [[1]] if keepaxis else [1]             # <<<<<<<<<<<<<<
  *             return X[pb.sl(d, axis=caxis, idx=idx)]
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 539, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 671, __pyx_L1_error)
       if (__pyx_t_6) {
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 539, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 671, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
-        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 539, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        __Pyx_GIVEREF(__pyx_t_2);
-        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_1 = __pyx_t_4;
+        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_1);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_4);
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
         __pyx_t_4 = 0;
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       } else {
-        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 539, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
-        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_1);
-        __pyx_t_1 = __pyx_t_4;
-        __pyx_t_4 = 0;
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       }
       __pyx_v_idx = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":540
- *             d = np.ndim(X)
- *             idx = [[1]] if keepcaxis else [1]
+      /* "pyaibox/base/mathops.py":672
+ *             d = X.ndim
+ *             idx = [[1]] if keepaxis else [1]
  *             return X[pb.sl(d, axis=caxis, idx=idx)]             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_d);
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 540, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_idx, __pyx_v_idx) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 672, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_idx, __pyx_v_idx) < 0) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 540, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_r = __pyx_t_2;
-      __pyx_t_2 = 0;
+      __pyx_r = __pyx_t_4;
+      __pyx_t_4 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "pyaibox/base/mathops.py":488
+  /* "pyaibox/base/mathops.py":620
  * 
  * 
- * def imag(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def imag(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain imaginary part of a array
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -6496,38 +8425,38 @@
   __Pyx_XDECREF(__pyx_v_d);
   __Pyx_XDECREF(__pyx_v_idx);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyaibox/base/mathops.py":543
+/* "pyaibox/base/mathops.py":675
  * 
  * 
- * def abs(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def abs(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain amplitude of a array
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_23abs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_4base_7mathops_22abs[] = "obtain amplitude of a array\n\n    Both complex and real representation are supported.\n\n    .. math::\n       {\\rm abs}({\\bf X}) = |{\\bf x}| = \\sqrt{u^2 + v^2}, x\\in {\\bf X}\n\n    where, :math:`u, v` are the real and imaginary part of x, respectively.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepcaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's amplitude.\n   \n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---abs')\n        print(abs(X, caxis=0))\n        print(abs(X[0] + 1j * X[1]))\n\n        # ---output\n        ---abs\n        [[0.99864747 0.88468226 0.91269439]\n        [0.78490066 0.48990863 0.40424448]\n        [0.72184896 0.40619981 1.02884318]]\n        [[0.99864747 0.88468226 0.91269439]\n        [0.78490066 0.48990863 0.40424448]\n        [0.72184896 0.40619981 1.02884318]]\n\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_23abs = {"abs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_23abs, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_22abs};
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_23abs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_27abs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_26abs[] = "obtain amplitude of a array\n\n    Both complex and real representation are supported.\n\n    .. math::\n       {\\rm abs}({\\bf X}) = |{\\bf x}| = \\sqrt{u^2 + v^2}, x\\in {\\bf X}\n\n    where, :math:`u, v` are the real and imaginary part of x, respectively.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's amplitude.\n   \n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---abs')\n        print(abs(X, caxis=0))\n        print(abs(X[0] + 1j * X[1]))\n\n        # ---output\n        ---abs\n        [[0.99864747 0.88468226 0.91269439]\n        [0.78490066 0.48990863 0.40424448]\n        [0.72184896 0.40619981 1.02884318]]\n        [[0.99864747 0.88468226 0.91269439]\n        [0.78490066 0.48990863 0.40424448]\n        [0.72184896 0.40619981 1.02884318]]\n\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_27abs = {"abs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_27abs, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_26abs};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_27abs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_X = 0;
   PyObject *__pyx_v_caxis = 0;
-  PyObject *__pyx_v_keepcaxis = 0;
+  PyObject *__pyx_v_keepaxis = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("abs (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepcaxis,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepaxis,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)Py_None));
     values[2] = ((PyObject *)((PyObject *)Py_False));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -6550,52 +8479,52 @@
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepcaxis);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepaxis);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "abs") < 0)) __PYX_ERR(0, 543, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "abs") < 0)) __PYX_ERR(0, 675, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_X = values[0];
     __pyx_v_caxis = values[1];
-    __pyx_v_keepcaxis = values[2];
+    __pyx_v_keepaxis = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("abs", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 543, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("abs", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 675, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pyaibox.base.mathops.abs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_22abs(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepcaxis);
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_26abs(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepaxis);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_22abs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis) {
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_26abs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis) {
   PyObject *__pyx_v_d = NULL;
   PyObject *__pyx_v_idxreal = NULL;
   PyObject *__pyx_v_idximag = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
@@ -6607,347 +8536,329 @@
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("abs", 0);
 
-  /* "pyaibox/base/mathops.py":592
+  /* "pyaibox/base/mathops.py":724
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return np.abs(X)
  *     else:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 592, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 592, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 724, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 592, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 724, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 592, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 724, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 592, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 592, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 724, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_5) {
 
-    /* "pyaibox/base/mathops.py":593
+    /* "pyaibox/base/mathops.py":725
  * 
  *     if np.iscomplex(X).any():  # complex in complex
  *         return np.abs(X)             # <<<<<<<<<<<<<<
  *     else:
  *         if caxis is None:  # real
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 593, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 593, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "pyaibox/base/mathops.py":592
+    /* "pyaibox/base/mathops.py":724
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return np.abs(X)
  *     else:
  */
   }
 
-  /* "pyaibox/base/mathops.py":595
+  /* "pyaibox/base/mathops.py":727
  *         return np.abs(X)
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return np.abs(X)
  *         else:  # complex in real
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_caxis == Py_None);
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "pyaibox/base/mathops.py":596
+      /* "pyaibox/base/mathops.py":728
  *     else:
  *         if caxis is None:  # real
  *             return np.abs(X)             # <<<<<<<<<<<<<<
  *         else:  # complex in real
- *             d = np.ndim(X)
+ *             d = X.ndim
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 596, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_abs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 596, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_abs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 728, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_2);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 596, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
       goto __pyx_L0;
 
-      /* "pyaibox/base/mathops.py":595
+      /* "pyaibox/base/mathops.py":727
  *         return np.abs(X)
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return np.abs(X)
  *         else:  # complex in real
  */
     }
 
-    /* "pyaibox/base/mathops.py":598
+    /* "pyaibox/base/mathops.py":730
  *             return np.abs(X)
  *         else:  # complex in real
- *             d = np.ndim(X)             # <<<<<<<<<<<<<<
- *             idxreal = [[0]] if keepcaxis else [0]
- *             idximag = [[1]] if keepcaxis else [1]
+ *             d = X.ndim             # <<<<<<<<<<<<<<
+ *             idxreal = [[0]] if keepaxis else [0]
+ *             idximag = [[1]] if keepaxis else [1]
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 598, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_4)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_4);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
-        }
-      }
-      __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_d = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":599
+      /* "pyaibox/base/mathops.py":731
  *         else:  # complex in real
- *             d = np.ndim(X)
- *             idxreal = [[0]] if keepcaxis else [0]             # <<<<<<<<<<<<<<
- *             idximag = [[1]] if keepcaxis else [1]
+ *             d = X.ndim
+ *             idxreal = [[0]] if keepaxis else [0]             # <<<<<<<<<<<<<<
+ *             idximag = [[1]] if keepaxis else [1]
  *             return np.sqrt((X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2))
  */
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 599, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 731, __pyx_L1_error)
       if (__pyx_t_6) {
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 599, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
-        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 599, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        __Pyx_GIVEREF(__pyx_t_2);
-        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_1 = __pyx_t_4;
+        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_4);
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
         __pyx_t_4 = 0;
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       } else {
-        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 599, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
-        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
-        __pyx_t_1 = __pyx_t_4;
-        __pyx_t_4 = 0;
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       }
       __pyx_v_idxreal = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":600
- *             d = np.ndim(X)
- *             idxreal = [[0]] if keepcaxis else [0]
- *             idximag = [[1]] if keepcaxis else [1]             # <<<<<<<<<<<<<<
+      /* "pyaibox/base/mathops.py":732
+ *             d = X.ndim
+ *             idxreal = [[0]] if keepaxis else [0]
+ *             idximag = [[1]] if keepaxis else [1]             # <<<<<<<<<<<<<<
  *             return np.sqrt((X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2))
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 600, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 732, __pyx_L1_error)
       if (__pyx_t_6) {
-        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 600, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 732, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
-        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_1);
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_GIVEREF(__pyx_t_4);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
-        __pyx_t_4 = 0;
-        __pyx_t_1 = __pyx_t_2;
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
+        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_GIVEREF(__pyx_t_2);
+        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
         __pyx_t_2 = 0;
+        __pyx_t_1 = __pyx_t_4;
+        __pyx_t_4 = 0;
       } else {
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
-        __pyx_t_1 = __pyx_t_2;
-        __pyx_t_2 = 0;
+        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_1);
+        __pyx_t_1 = __pyx_t_4;
+        __pyx_t_4 = 0;
       }
       __pyx_v_idximag = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":601
- *             idxreal = [[0]] if keepcaxis else [0]
- *             idximag = [[1]] if keepcaxis else [1]
+      /* "pyaibox/base/mathops.py":733
+ *             idxreal = [[0]] if keepaxis else [0]
+ *             idximag = [[1]] if keepaxis else [1]
  *             return np.sqrt((X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2))             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pb); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sl); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pb); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 733, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sl); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 733, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
-      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_d);
-      __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 601, __pyx_L1_error)
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_d);
+      __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_idx, __pyx_v_idxreal) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 601, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 733, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_idx, __pyx_v_idxreal) < 0) __PYX_ERR(0, 733, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyNumber_Power(__pyx_t_7, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_8 = PyNumber_Power(__pyx_t_7, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_pb); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_pb); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sl); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 733, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
       PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_d);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_idx, __pyx_v_idximag) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 601, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 733, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_idx, __pyx_v_idximag) < 0) __PYX_ERR(0, 733, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_9 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Add(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Add(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_t_9 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_9)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_4, function);
+          __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
-      __pyx_t_1 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_9, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
+      __pyx_t_1 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 733, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "pyaibox/base/mathops.py":543
+  /* "pyaibox/base/mathops.py":675
  * 
  * 
- * def abs(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def abs(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain amplitude of a array
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -6964,38 +8875,38 @@
   __Pyx_XDECREF(__pyx_v_idxreal);
   __Pyx_XDECREF(__pyx_v_idximag);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyaibox/base/mathops.py":604
+/* "pyaibox/base/mathops.py":736
  * 
  * 
- * def pow(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def pow(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain power of a array
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_25pow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_4base_7mathops_24pow[] = "obtain power of a array\n\n    Both complex and real representation are supported.\n\n    .. math::\n       {\\rm pow}({\\bf X}) = |{\\bf x}| = u^2 + v^2, x\\in {\\bf X}\n\n    where, :math:`u, v` are the real and imaginary part of x, respectively.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepcaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's power.\n   \n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---pow')\n        print(pow(X, caxis=0))\n        print(pow(X[0] + 1j * X[1]))\n\n        # ---output\n        ---pow\n        [[0.99729677 0.78266271 0.83301105]\n        [0.61606904 0.24001046 0.1634136 ]\n        [0.52106592 0.16499828 1.05851829]]\n        [[0.99729677 0.78266271 0.83301105]\n        [0.61606904 0.24001046 0.1634136 ]\n        [0.52106592 0.16499828 1.05851829]]\n\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_25pow = {"pow", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_25pow, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_24pow};
-static PyObject *__pyx_pw_7pyaibox_4base_7mathops_25pow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_29pow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_4base_7mathops_28pow[] = "obtain power of a array\n\n    Both complex and real representation are supported.\n\n    .. math::\n       {\\rm pow}({\\bf X}) = |{\\bf x}| = u^2 + v^2, x\\in {\\bf X}\n\n    where, :math:`u, v` are the real and imaginary part of x, respectively.\n\n    Parameters\n    ----------\n    X : array\n        input\n    caxis : int or None\n        If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer\n        then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;\n        otherwise (None), :attr:`X` will be treated as real-valued\n    keepaxis : bool, optional\n        keep complex-dimension?\n\n    Returns\n    -------\n    array\n         the inputs's power.\n   \n    Examples\n    ---------\n\n    ::\n\n        np.random.seed(2020)\n        X = np.random.rand(2, 3, 3)\n\n        print('---pow')\n        print(pow(X, caxis=0))\n        print(pow(X[0] + 1j * X[1]))\n\n        # ---output\n        ---pow\n        [[0.99729677 0.78266271 0.83301105]\n        [0.61606904 0.24001046 0.1634136 ]\n        [0.52106592 0.16499828 1.05851829]]\n        [[0.99729677 0.78266271 0.83301105]\n        [0.61606904 0.24001046 0.1634136 ]\n        [0.52106592 0.16499828 1.05851829]]\n\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_4base_7mathops_29pow = {"pow", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_4base_7mathops_29pow, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_4base_7mathops_28pow};
+static PyObject *__pyx_pw_7pyaibox_4base_7mathops_29pow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_X = 0;
   PyObject *__pyx_v_caxis = 0;
-  PyObject *__pyx_v_keepcaxis = 0;
+  PyObject *__pyx_v_keepaxis = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("pow (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepcaxis,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_X,&__pyx_n_s_caxis,&__pyx_n_s_keepaxis,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)Py_None));
     values[2] = ((PyObject *)((PyObject *)Py_False));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -7018,52 +8929,52 @@
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_caxis);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepcaxis);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_keepaxis);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "pow") < 0)) __PYX_ERR(0, 604, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "pow") < 0)) __PYX_ERR(0, 736, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_X = values[0];
     __pyx_v_caxis = values[1];
-    __pyx_v_keepcaxis = values[2];
+    __pyx_v_keepaxis = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("pow", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 604, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("pow", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 736, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pyaibox.base.mathops.pow", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_24pow(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepcaxis);
+  __pyx_r = __pyx_pf_7pyaibox_4base_7mathops_28pow(__pyx_self, __pyx_v_X, __pyx_v_caxis, __pyx_v_keepaxis);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_4base_7mathops_24pow(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepcaxis) {
+static PyObject *__pyx_pf_7pyaibox_4base_7mathops_28pow(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_caxis, PyObject *__pyx_v_keepaxis) {
   PyObject *__pyx_v_d = NULL;
   PyObject *__pyx_v_idxreal = NULL;
   PyObject *__pyx_v_idximag = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
@@ -7073,308 +8984,290 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("pow", 0);
 
-  /* "pyaibox/base/mathops.py":653
+  /* "pyaibox/base/mathops.py":785
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return X.real*X.real + X.imag*X.imag
  *     else:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 653, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 653, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 653, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 653, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_5) {
 
-    /* "pyaibox/base/mathops.py":654
+    /* "pyaibox/base/mathops.py":786
  * 
  *     if np.iscomplex(X).any():  # complex in complex
  *         return X.real*X.real + X.imag*X.imag             # <<<<<<<<<<<<<<
  *     else:
  *         if caxis is None:  # real
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_real); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_imag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "pyaibox/base/mathops.py":653
+    /* "pyaibox/base/mathops.py":785
  *     """
  * 
  *     if np.iscomplex(X).any():  # complex in complex             # <<<<<<<<<<<<<<
  *         return X.real*X.real + X.imag*X.imag
  *     else:
  */
   }
 
-  /* "pyaibox/base/mathops.py":656
+  /* "pyaibox/base/mathops.py":788
  *         return X.real*X.real + X.imag*X.imag
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return X**2
  *         else:  # complex in real
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_caxis == Py_None);
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "pyaibox/base/mathops.py":657
+      /* "pyaibox/base/mathops.py":789
  *     else:
  *         if caxis is None:  # real
  *             return X**2             # <<<<<<<<<<<<<<
  *         else:  # complex in real
- *             d = np.ndim(X)
+ *             d = X.ndim
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_1 = PyNumber_Power(__pyx_v_X, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Power(__pyx_v_X, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
       goto __pyx_L0;
 
-      /* "pyaibox/base/mathops.py":656
+      /* "pyaibox/base/mathops.py":788
  *         return X.real*X.real + X.imag*X.imag
  *     else:
  *         if caxis is None:  # real             # <<<<<<<<<<<<<<
  *             return X**2
  *         else:  # complex in real
  */
     }
 
-    /* "pyaibox/base/mathops.py":659
+    /* "pyaibox/base/mathops.py":791
  *             return X**2
  *         else:  # complex in real
- *             d = np.ndim(X)             # <<<<<<<<<<<<<<
- *             idxreal = [[0]] if keepcaxis else [0]
- *             idximag = [[1]] if keepcaxis else [1]
+ *             d = X.ndim             # <<<<<<<<<<<<<<
+ *             idxreal = [[0]] if keepaxis else [0]
+ *             idximag = [[1]] if keepaxis else [1]
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 659, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 659, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_3)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_3);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
-        }
-      }
-      __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_X) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_X);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_d = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":660
+      /* "pyaibox/base/mathops.py":792
  *         else:  # complex in real
- *             d = np.ndim(X)
- *             idxreal = [[0]] if keepcaxis else [0]             # <<<<<<<<<<<<<<
- *             idximag = [[1]] if keepcaxis else [1]
+ *             d = X.ndim
+ *             idxreal = [[0]] if keepaxis else [0]             # <<<<<<<<<<<<<<
+ *             idximag = [[1]] if keepaxis else [1]
  *             return X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2
  */
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 660, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 792, __pyx_L1_error)
       if (__pyx_t_6) {
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
-        __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_GIVEREF(__pyx_t_2);
-        PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_1 = __pyx_t_3;
+        PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 792, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
         __pyx_t_3 = 0;
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       } else {
-        __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 792, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
-        PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
-        __pyx_t_1 = __pyx_t_3;
-        __pyx_t_3 = 0;
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+        __pyx_t_1 = __pyx_t_2;
+        __pyx_t_2 = 0;
       }
       __pyx_v_idxreal = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":661
- *             d = np.ndim(X)
- *             idxreal = [[0]] if keepcaxis else [0]
- *             idximag = [[1]] if keepcaxis else [1]             # <<<<<<<<<<<<<<
+      /* "pyaibox/base/mathops.py":793
+ *             d = X.ndim
+ *             idxreal = [[0]] if keepaxis else [0]
+ *             idximag = [[1]] if keepaxis else [1]             # <<<<<<<<<<<<<<
  *             return X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 661, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 793, __pyx_L1_error)
       if (__pyx_t_6) {
-        __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 661, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
-        PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 661, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_GIVEREF(__pyx_t_3);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
-        __pyx_t_3 = 0;
-        __pyx_t_1 = __pyx_t_2;
+        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
+        __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_2);
+        PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
         __pyx_t_2 = 0;
+        __pyx_t_1 = __pyx_t_3;
+        __pyx_t_3 = 0;
       } else {
-        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 661, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
-        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
-        __pyx_t_1 = __pyx_t_2;
-        __pyx_t_2 = 0;
+        PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
+        __pyx_t_1 = __pyx_t_3;
+        __pyx_t_3 = 0;
       }
       __pyx_v_idximag = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "pyaibox/base/mathops.py":662
- *             idxreal = [[0]] if keepcaxis else [0]
- *             idximag = [[1]] if keepcaxis else [1]
+      /* "pyaibox/base/mathops.py":794
+ *             idxreal = [[0]] if keepaxis else [0]
+ *             idximag = [[1]] if keepaxis else [1]
  *             return X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sl); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_d);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_idx, __pyx_v_idxreal) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 794, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_idx, __pyx_v_idxreal) < 0) __PYX_ERR(0, 794, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 794, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_4 = PyNumber_Power(__pyx_t_2, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 794, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_pb); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pb); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_v_d);
       __Pyx_GIVEREF(__pyx_v_d);
-      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_d);
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_idx, __pyx_v_idximag) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 662, __pyx_L1_error)
+      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_d);
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_caxis) < 0) __PYX_ERR(0, 794, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_idx, __pyx_v_idximag) < 0) __PYX_ERR(0, 794, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 794, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_X, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyNumber_Power(__pyx_t_2, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_7 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 794, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_r = __pyx_t_2;
-      __pyx_t_2 = 0;
+      __pyx_r = __pyx_t_3;
+      __pyx_t_3 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "pyaibox/base/mathops.py":604
+  /* "pyaibox/base/mathops.py":736
  * 
  * 
- * def pow(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def pow(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain power of a array
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -8146,15 +10039,24 @@
 #else
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_kp_u_, __pyx_k_, sizeof(__pyx_k_), 0, 1, 0, 0},
+  {&__pyx_n_s_A, __pyx_k_A, sizeof(__pyx_k_A), 0, 0, 1, 1},
+  {&__pyx_n_s_Ac, __pyx_k_Ac, sizeof(__pyx_k_Ac), 0, 0, 1, 1},
+  {&__pyx_n_s_Ar, __pyx_k_Ar, sizeof(__pyx_k_Ar), 0, 0, 1, 1},
+  {&__pyx_n_s_B, __pyx_k_B, sizeof(__pyx_k_B), 0, 0, 1, 1},
+  {&__pyx_n_s_Bc, __pyx_k_Bc, sizeof(__pyx_k_Bc), 0, 0, 1, 1},
+  {&__pyx_n_s_Br, __pyx_k_Br, sizeof(__pyx_k_Br), 0, 0, 1, 1},
   {&__pyx_n_u_Error, __pyx_k_Error, sizeof(__pyx_k_Error), 0, 1, 0, 1},
+  {&__pyx_n_s_Mc, __pyx_k_Mc, sizeof(__pyx_k_Mc), 0, 0, 1, 1},
+  {&__pyx_n_s_Mr, __pyx_k_Mr, sizeof(__pyx_k_Mr), 0, 0, 1, 1},
+  {&__pyx_n_s_Nc, __pyx_k_Nc, sizeof(__pyx_k_Nc), 0, 0, 1, 1},
   {&__pyx_kp_u_Not_supported_operation, __pyx_k_Not_supported_operation, sizeof(__pyx_k_Not_supported_operation), 0, 1, 0, 0},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_n_s_X, __pyx_k_X, sizeof(__pyx_k_X), 0, 0, 1, 1},
   {&__pyx_n_s_Xcplx, __pyx_k_Xcplx, sizeof(__pyx_k_Xcplx), 0, 0, 1, 1},
   {&__pyx_n_u_Xcplx, __pyx_k_Xcplx, sizeof(__pyx_k_Xcplx), 0, 1, 0, 1},
   {&__pyx_n_s_Xreal, __pyx_k_Xreal, sizeof(__pyx_k_Xreal), 0, 0, 1, 1},
   {&__pyx_n_u_Xreal, __pyx_k_Xreal, sizeof(__pyx_k_Xreal), 0, 1, 0, 1},
@@ -8172,46 +10074,54 @@
   {&__pyx_n_u_add, __pyx_k_add, sizeof(__pyx_k_add), 0, 1, 0, 1},
   {&__pyx_n_s_any, __pyx_k_any, sizeof(__pyx_k_any), 0, 0, 1, 1},
   {&__pyx_n_s_args, __pyx_k_args, sizeof(__pyx_k_args), 0, 0, 1, 1},
   {&__pyx_n_s_axis, __pyx_k_axis, sizeof(__pyx_k_axis), 0, 0, 1, 1},
   {&__pyx_n_s_b, __pyx_k_b, sizeof(__pyx_k_b), 0, 0, 1, 1},
   {&__pyx_n_s_c2r, __pyx_k_c2r, sizeof(__pyx_k_c2r), 0, 0, 1, 1},
   {&__pyx_n_s_caxis, __pyx_k_caxis, sizeof(__pyx_k_caxis), 0, 0, 1, 1},
+  {&__pyx_n_u_caxis, __pyx_k_caxis, sizeof(__pyx_k_caxis), 0, 1, 0, 1},
+  {&__pyx_n_s_cdim, __pyx_k_cdim, sizeof(__pyx_k_cdim), 0, 0, 1, 1},
+  {&__pyx_n_u_cdim, __pyx_k_cdim, sizeof(__pyx_k_cdim), 0, 1, 0, 1},
   {&__pyx_n_s_ceil, __pyx_k_ceil, sizeof(__pyx_k_ceil), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_n_s_close, __pyx_k_close, sizeof(__pyx_k_close), 0, 0, 1, 1},
   {&__pyx_n_s_concatenate, __pyx_k_concatenate, sizeof(__pyx_k_concatenate), 0, 0, 1, 1},
   {&__pyx_n_s_conj, __pyx_k_conj, sizeof(__pyx_k_conj), 0, 0, 1, 1},
   {&__pyx_kp_u_conj_2, __pyx_k_conj_2, sizeof(__pyx_k_conj_2), 0, 1, 0, 0},
   {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
   {&__pyx_n_s_db, __pyx_k_db, sizeof(__pyx_k_db), 0, 0, 1, 1},
   {&__pyx_n_s_db2mag, __pyx_k_db2mag, sizeof(__pyx_k_db2mag), 0, 0, 1, 1},
   {&__pyx_n_s_db2mag_locals_genexpr, __pyx_k_db2mag_locals_genexpr, sizeof(__pyx_k_db2mag_locals_genexpr), 0, 0, 1, 1},
   {&__pyx_n_u_div, __pyx_k_div, sizeof(__pyx_k_div), 0, 1, 0, 1},
   {&__pyx_n_s_ebeo, __pyx_k_ebeo, sizeof(__pyx_k_ebeo), 0, 0, 1, 1},
+  {&__pyx_n_s_ematmul, __pyx_k_ematmul, sizeof(__pyx_k_ematmul), 0, 0, 1, 1},
   {&__pyx_n_s_floor, __pyx_k_floor, sizeof(__pyx_k_floor), 0, 0, 1, 1},
   {&__pyx_n_s_fnab, __pyx_k_fnab, sizeof(__pyx_k_fnab), 0, 0, 1, 1},
   {&__pyx_n_s_genexpr, __pyx_k_genexpr, sizeof(__pyx_k_genexpr), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_idx, __pyx_k_idx, sizeof(__pyx_k_idx), 0, 0, 1, 1},
   {&__pyx_n_s_idximag, __pyx_k_idximag, sizeof(__pyx_k_idximag), 0, 0, 1, 1},
   {&__pyx_n_s_idxreal, __pyx_k_idxreal, sizeof(__pyx_k_idxreal), 0, 0, 1, 1},
   {&__pyx_n_s_imag, __pyx_k_imag, sizeof(__pyx_k_imag), 0, 0, 1, 1},
   {&__pyx_kp_u_imag_2, __pyx_k_imag_2, sizeof(__pyx_k_imag_2), 0, 1, 0, 0},
+  {&__pyx_n_s_imatmul, __pyx_k_imatmul, sizeof(__pyx_k_imatmul), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_iscomplex, __pyx_k_iscomplex, sizeof(__pyx_k_iscomplex), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
-  {&__pyx_n_s_keepcaxis, __pyx_k_keepcaxis, sizeof(__pyx_k_keepcaxis), 0, 0, 1, 1},
+  {&__pyx_n_s_keepaxis, __pyx_k_keepaxis, sizeof(__pyx_k_keepaxis), 0, 0, 1, 1},
+  {&__pyx_n_s_kwargs, __pyx_k_kwargs, sizeof(__pyx_k_kwargs), 0, 0, 1, 1},
   {&__pyx_n_s_log10, __pyx_k_log10, sizeof(__pyx_k_log10), 0, 0, 1, 1},
   {&__pyx_n_s_log2, __pyx_k_log2, sizeof(__pyx_k_log2), 0, 0, 1, 1},
   {&__pyx_n_s_mag, __pyx_k_mag, sizeof(__pyx_k_mag), 0, 0, 1, 1},
   {&__pyx_n_s_mag2db, __pyx_k_mag2db, sizeof(__pyx_k_mag2db), 0, 0, 1, 1},
   {&__pyx_n_s_mag2db_locals_genexpr, __pyx_k_mag2db_locals_genexpr, sizeof(__pyx_k_mag2db_locals_genexpr), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_u_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 1, 0, 1},
+  {&__pyx_n_s_matmul, __pyx_k_matmul, sizeof(__pyx_k_matmul), 0, 0, 1, 1},
+  {&__pyx_n_s_matmul_2, __pyx_k_matmul_2, sizeof(__pyx_k_matmul_2), 0, 0, 1, 1},
   {&__pyx_n_u_mul, __pyx_k_mul, sizeof(__pyx_k_mul), 0, 1, 0, 1},
   {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
   {&__pyx_n_s_nextpow2, __pyx_k_nextpow2, sizeof(__pyx_k_nextpow2), 0, 0, 1, 1},
   {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
   {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
@@ -8224,17 +10134,19 @@
   {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
   {&__pyx_n_s_pyaibox, __pyx_k_pyaibox, sizeof(__pyx_k_pyaibox), 0, 0, 1, 1},
   {&__pyx_n_s_pyaibox_base_mathops, __pyx_k_pyaibox_base_mathops, sizeof(__pyx_k_pyaibox_base_mathops), 0, 0, 1, 1},
   {&__pyx_kp_s_pyaibox_base_mathops_py, __pyx_k_pyaibox_base_mathops_py, sizeof(__pyx_k_pyaibox_base_mathops_py), 0, 0, 1, 0},
   {&__pyx_n_s_r2c, __pyx_k_r2c, sizeof(__pyx_k_r2c), 0, 0, 1, 1},
   {&__pyx_n_s_rand, __pyx_k_rand, sizeof(__pyx_k_rand), 0, 0, 1, 1},
   {&__pyx_n_s_randint, __pyx_k_randint, sizeof(__pyx_k_randint), 0, 0, 1, 1},
+  {&__pyx_n_s_randn, __pyx_k_randn, sizeof(__pyx_k_randn), 0, 0, 1, 1},
   {&__pyx_n_s_random, __pyx_k_random, sizeof(__pyx_k_random), 0, 0, 1, 1},
   {&__pyx_n_s_real, __pyx_k_real, sizeof(__pyx_k_real), 0, 0, 1, 1},
   {&__pyx_kp_u_real_2, __pyx_k_real_2, sizeof(__pyx_k_real_2), 0, 1, 0, 0},
+  {&__pyx_n_s_rmatmul, __pyx_k_rmatmul, sizeof(__pyx_k_rmatmul), 0, 0, 1, 1},
   {&__pyx_n_s_s, __pyx_k_s, sizeof(__pyx_k_s), 0, 0, 1, 1},
   {&__pyx_n_s_seed, __pyx_k_seed, sizeof(__pyx_k_seed), 0, 0, 1, 1},
   {&__pyx_n_s_send, __pyx_k_send, sizeof(__pyx_k_send), 0, 0, 1, 1},
   {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
   {&__pyx_n_s_sl, __pyx_k_sl, sizeof(__pyx_k_sl), 0, 0, 1, 1},
   {&__pyx_n_s_sqrt, __pyx_k_sqrt, sizeof(__pyx_k_sqrt), 0, 0, 1, 1},
   {&__pyx_n_s_stack, __pyx_k_stack, sizeof(__pyx_k_stack), 0, 0, 1, 1},
@@ -8244,15 +10156,15 @@
   {&__pyx_n_s_throw, __pyx_k_throw, sizeof(__pyx_k_throw), 0, 0, 1, 1},
   {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
   {&__pyx_n_s_zeros_like, __pyx_k_zeros_like, sizeof(__pyx_k_zeros_like), 0, 0, 1, 1},
   {&__pyx_n_s_zip, __pyx_k_zip, sizeof(__pyx_k_zip), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 675, __pyx_L1_error)
+  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 807, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(0, 169, __pyx_L1_error)
   __pyx_builtin_zip = __Pyx_GetBuiltinName(__pyx_n_s_zip); if (!__pyx_builtin_zip) __PYX_ERR(0, 159, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
@@ -8340,261 +10252,296 @@
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
   __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_prevpow2, 207, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 207, __pyx_L1_error)
 
   /* "pyaibox/base/mathops.py":240
  * 
  * 
- * def r2c(X, caxis=-1, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""convert real-valued array to complex-valued array
+ * def ematmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Element-by-element complex multiplication
  * 
  */
-  __pyx_tuple__23 = PyTuple_Pack(5, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepcaxis, __pyx_n_s_idxreal, __pyx_n_s_idximag); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_tuple__23 = PyTuple_Pack(7, __pyx_n_s_A, __pyx_n_s_B, __pyx_n_s_kwargs, __pyx_n_s_cdim, __pyx_n_s_Nc, __pyx_n_s_idxreal, __pyx_n_s_idximag); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 240, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__23);
   __Pyx_GIVEREF(__pyx_tuple__23);
-  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_r2c, 240, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 240, __pyx_L1_error)
-  __pyx_tuple__25 = PyTuple_Pack(2, ((PyObject *)__pyx_int_neg_1), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 240, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__25);
-  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_ematmul, 240, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 240, __pyx_L1_error)
 
-  /* "pyaibox/base/mathops.py":312
+  /* "pyaibox/base/mathops.py":302
  * 
  * 
- * def c2r(X, caxis=-1, keepcaxis=True):             # <<<<<<<<<<<<<<
- *     r"""convert complex-valued array to real-valued array
+ * def matmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Complex matrix multiplication
  * 
  */
-  __pyx_tuple__26 = PyTuple_Pack(3, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepcaxis); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 312, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
-  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_c2r, 312, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 312, __pyx_L1_error)
-  __pyx_tuple__28 = PyTuple_Pack(2, ((PyObject *)__pyx_int_neg_1), ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 312, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__25 = PyTuple_Pack(7, __pyx_n_s_A, __pyx_n_s_B, __pyx_n_s_kwargs, __pyx_n_s_cdim, __pyx_n_s_Nc, __pyx_n_s_idxreal, __pyx_n_s_idximag); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_codeobj__26 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_matmul_2, 302, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 302, __pyx_L1_error)
 
-  /* "pyaibox/base/mathops.py":378
+  /* "pyaibox/base/mathops.py":369
  * 
  * 
- * def conj(X, caxis=None):             # <<<<<<<<<<<<<<
- *     r"""conjugates a array
+ * def c2r(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""convert complex-valued array to real-valued array
  * 
  */
-  __pyx_tuple__29 = PyTuple_Pack(3, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_d); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __pyx_tuple__27 = PyTuple_Pack(3, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepaxis); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_c2r, 369, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __pyx_tuple__29 = PyTuple_Pack(2, ((PyObject *)__pyx_int_neg_1), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__29);
   __Pyx_GIVEREF(__pyx_tuple__29);
-  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_conj, 378, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 378, __pyx_L1_error)
-  __pyx_tuple__31 = PyTuple_Pack(1, ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 378, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
 
-  /* "pyaibox/base/mathops.py":434
+  /* "pyaibox/base/mathops.py":438
  * 
  * 
- * def real(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""obtain real part of a array
+ * def r2c(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""convert real-valued array to complex-valued array
  * 
  */
-  __pyx_tuple__32 = PyTuple_Pack(5, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepcaxis, __pyx_n_s_d, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 434, __pyx_L1_error)
+  __pyx_tuple__30 = PyTuple_Pack(5, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepaxis, __pyx_n_s_d, __pyx_n_s_Nc); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_r2c, 438, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __pyx_tuple__32 = PyTuple_Pack(2, ((PyObject *)__pyx_int_neg_1), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 438, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__32);
   __Pyx_GIVEREF(__pyx_tuple__32);
-  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_real, 434, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 434, __pyx_L1_error)
-  __pyx_tuple__34 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 434, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__34);
-  __Pyx_GIVEREF(__pyx_tuple__34);
 
-  /* "pyaibox/base/mathops.py":488
+  /* "pyaibox/base/mathops.py":510
  * 
  * 
- * def imag(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""obtain imaginary part of a array
+ * def conj(X, caxis=None):             # <<<<<<<<<<<<<<
+ *     r"""conjugates a array
  * 
  */
-  __pyx_tuple__35 = PyTuple_Pack(5, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepcaxis, __pyx_n_s_d, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 488, __pyx_L1_error)
+  __pyx_tuple__33 = PyTuple_Pack(3, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_d); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_conj, 510, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_tuple__35 = PyTuple_Pack(1, ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 510, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__35);
   __Pyx_GIVEREF(__pyx_tuple__35);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_imag, 488, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 488, __pyx_L1_error)
-  __pyx_tuple__37 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 488, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
 
-  /* "pyaibox/base/mathops.py":543
+  /* "pyaibox/base/mathops.py":566
  * 
  * 
- * def abs(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""obtain amplitude of a array
+ * def real(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""obtain real part of a array
  * 
  */
-  __pyx_tuple__38 = PyTuple_Pack(6, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepcaxis, __pyx_n_s_d, __pyx_n_s_idxreal, __pyx_n_s_idximag); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_tuple__36 = PyTuple_Pack(5, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepaxis, __pyx_n_s_d, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 566, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
+  __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_real, 566, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 566, __pyx_L1_error)
+  __pyx_tuple__38 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__38);
   __Pyx_GIVEREF(__pyx_tuple__38);
-  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_abs, 543, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 543, __pyx_L1_error)
-  __pyx_tuple__40 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 543, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
 
-  /* "pyaibox/base/mathops.py":604
+  /* "pyaibox/base/mathops.py":620
  * 
  * 
- * def pow(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""obtain power of a array
+ * def imag(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""obtain imaginary part of a array
  * 
  */
-  __pyx_tuple__41 = PyTuple_Pack(6, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepcaxis, __pyx_n_s_d, __pyx_n_s_idxreal, __pyx_n_s_idximag); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_tuple__39 = PyTuple_Pack(5, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepaxis, __pyx_n_s_d, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_imag, 620, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_tuple__41 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 620, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__41);
   __Pyx_GIVEREF(__pyx_tuple__41);
-  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_pow, 604, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 604, __pyx_L1_error)
-  __pyx_tuple__43 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 604, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
 
-  /* "pyaibox/base/mathops.py":669
+  /* "pyaibox/base/mathops.py":675
+ * 
+ * 
+ * def abs(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""obtain amplitude of a array
+ * 
+ */
+  __pyx_tuple__42 = PyTuple_Pack(6, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepaxis, __pyx_n_s_d, __pyx_n_s_idxreal, __pyx_n_s_idximag); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 675, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
+  __pyx_codeobj__43 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__42, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_abs, 675, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 675, __pyx_L1_error)
+  __pyx_tuple__44 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 675, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__44);
+  __Pyx_GIVEREF(__pyx_tuple__44);
+
+  /* "pyaibox/base/mathops.py":736
+ * 
+ * 
+ * def pow(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""obtain power of a array
+ * 
+ */
+  __pyx_tuple__45 = PyTuple_Pack(6, __pyx_n_s_X, __pyx_n_s_caxis, __pyx_n_s_keepaxis, __pyx_n_s_d, __pyx_n_s_idxreal, __pyx_n_s_idximag); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
+  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_base_mathops_py, __pyx_n_s_pow, 736, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_tuple__47 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__47);
+  __Pyx_GIVEREF(__pyx_tuple__47);
+
+  /* "pyaibox/base/mathops.py":801
  *     import numpy as np
  * 
  *     np.random.seed(2020)             # <<<<<<<<<<<<<<
  * 
  *     Xreal = np.random.randint(0, 30, (3, 2, 4))
  */
-  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_int_2020); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 669, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__44);
-  __Pyx_GIVEREF(__pyx_tuple__44);
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_int_2020); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
 
-  /* "pyaibox/base/mathops.py":671
+  /* "pyaibox/base/mathops.py":803
  *     np.random.seed(2020)
  * 
  *     Xreal = np.random.randint(0, 30, (3, 2, 4))             # <<<<<<<<<<<<<<
- *     Xcplx = r2c(Xreal, caxis=1, keepcaxis=True)
+ *     Xcplx = r2c(Xreal, caxis=1, keepaxis=True)
  *     Yreal = c2r(Xcplx, caxis=0)
  */
-  __pyx_tuple__45 = PyTuple_Pack(3, __pyx_int_3, __pyx_int_2, __pyx_int_4); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 671, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__45);
-  __Pyx_GIVEREF(__pyx_tuple__45);
-  __pyx_tuple__46 = PyTuple_Pack(3, __pyx_int_0, __pyx_int_30, __pyx_tuple__45); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 671, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__46);
-  __Pyx_GIVEREF(__pyx_tuple__46);
+  __pyx_tuple__49 = PyTuple_Pack(3, __pyx_int_3, __pyx_int_2, __pyx_int_4); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_tuple__50 = PyTuple_Pack(3, __pyx_int_0, __pyx_int_30, __pyx_tuple__49); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__50);
+  __Pyx_GIVEREF(__pyx_tuple__50);
 
-  /* "pyaibox/base/mathops.py":680
+  /* "pyaibox/base/mathops.py":812
  *     print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
  * 
  *     print(prevpow2(-5), nextpow2(-5))             # <<<<<<<<<<<<<<
  *     print(prevpow2(5), nextpow2(5))
  *     print(prevpow2(0.3), nextpow2(0.3))
  */
-  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_int_neg_5); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 680, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__47);
-  __Pyx_GIVEREF(__pyx_tuple__47);
+  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_int_neg_5); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 812, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__51);
+  __Pyx_GIVEREF(__pyx_tuple__51);
 
-  /* "pyaibox/base/mathops.py":681
+  /* "pyaibox/base/mathops.py":813
  * 
  *     print(prevpow2(-5), nextpow2(-5))
  *     print(prevpow2(5), nextpow2(5))             # <<<<<<<<<<<<<<
  *     print(prevpow2(0.3), nextpow2(0.3))
  *     print(prevpow2(7.3), nextpow2(7.3))
  */
-  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_int_5); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 681, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
+  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_int_5); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 813, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__52);
+  __Pyx_GIVEREF(__pyx_tuple__52);
 
-  /* "pyaibox/base/mathops.py":682
+  /* "pyaibox/base/mathops.py":814
  *     print(prevpow2(-5), nextpow2(-5))
  *     print(prevpow2(5), nextpow2(5))
  *     print(prevpow2(0.3), nextpow2(0.3))             # <<<<<<<<<<<<<<
  *     print(prevpow2(7.3), nextpow2(7.3))
  *     print(prevpow2(-3.5), nextpow2(-3.5))
  */
-  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_float_0_3); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 682, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__49);
-  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_float_0_3); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__53);
+  __Pyx_GIVEREF(__pyx_tuple__53);
 
-  /* "pyaibox/base/mathops.py":683
+  /* "pyaibox/base/mathops.py":815
  *     print(prevpow2(5), nextpow2(5))
  *     print(prevpow2(0.3), nextpow2(0.3))
  *     print(prevpow2(7.3), nextpow2(7.3))             # <<<<<<<<<<<<<<
  *     print(prevpow2(-3.5), nextpow2(-3.5))
  * 
  */
-  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_float_7_3); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 683, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
+  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_float_7_3); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__54);
+  __Pyx_GIVEREF(__pyx_tuple__54);
 
-  /* "pyaibox/base/mathops.py":684
+  /* "pyaibox/base/mathops.py":816
  *     print(prevpow2(0.3), nextpow2(0.3))
  *     print(prevpow2(7.3), nextpow2(7.3))
  *     print(prevpow2(-3.5), nextpow2(-3.5))             # <<<<<<<<<<<<<<
  * 
  *     np.random.seed(2020)
  */
-  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_float_neg_3_5); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 684, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__51);
-  __Pyx_GIVEREF(__pyx_tuple__51);
+  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_float_neg_3_5); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__55);
+  __Pyx_GIVEREF(__pyx_tuple__55);
 
-  /* "pyaibox/base/mathops.py":687
+  /* "pyaibox/base/mathops.py":819
+ * 
+ *     np.random.seed(2020)
+ *     Ar = np.random.randn(3, 3, 2)             # <<<<<<<<<<<<<<
+ *     Br = np.random.randn(3, 3, 2)
+ * 
+ */
+  __pyx_tuple__56 = PyTuple_Pack(3, __pyx_int_3, __pyx_int_3, __pyx_int_2); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 819, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__56);
+  __Pyx_GIVEREF(__pyx_tuple__56);
+
+  /* "pyaibox/base/mathops.py":842
  * 
  *     np.random.seed(2020)
  *     X = np.random.rand(2, 3, 3)             # <<<<<<<<<<<<<<
  * 
  *     print('---conj')
  */
-  __pyx_tuple__52 = PyTuple_Pack(3, __pyx_int_2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 687, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__52);
-  __Pyx_GIVEREF(__pyx_tuple__52);
+  __pyx_tuple__57 = PyTuple_Pack(3, __pyx_int_2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__57);
+  __Pyx_GIVEREF(__pyx_tuple__57);
 
-  /* "pyaibox/base/mathops.py":689
+  /* "pyaibox/base/mathops.py":844
  *     X = np.random.rand(2, 3, 3)
  * 
  *     print('---conj')             # <<<<<<<<<<<<<<
  *     print(conj(X, caxis=0))
  *     print(conj(X[0] + 1j * X[1]))
  */
-  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_u_conj_2); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 689, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__53);
-  __Pyx_GIVEREF(__pyx_tuple__53);
+  __pyx_tuple__58 = PyTuple_Pack(1, __pyx_kp_u_conj_2); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__58);
+  __Pyx_GIVEREF(__pyx_tuple__58);
 
-  /* "pyaibox/base/mathops.py":693
+  /* "pyaibox/base/mathops.py":848
  *     print(conj(X[0] + 1j * X[1]))
  * 
  *     print('---real')             # <<<<<<<<<<<<<<
  *     print(real(X, caxis=0))
  *     print(real(X[0] + 1j * X[1]))
  */
-  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_u_real_2); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 693, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__54);
-  __Pyx_GIVEREF(__pyx_tuple__54);
+  __pyx_tuple__59 = PyTuple_Pack(1, __pyx_kp_u_real_2); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 848, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__59);
+  __Pyx_GIVEREF(__pyx_tuple__59);
 
-  /* "pyaibox/base/mathops.py":697
+  /* "pyaibox/base/mathops.py":852
  *     print(real(X[0] + 1j * X[1]))
  * 
  *     print('---imag')             # <<<<<<<<<<<<<<
  *     print(imag(X, caxis=0))
  *     print(imag(X[0] + 1j * X[1]))
  */
-  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_u_imag_2); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 697, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__55);
-  __Pyx_GIVEREF(__pyx_tuple__55);
+  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_u_imag_2); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__60);
+  __Pyx_GIVEREF(__pyx_tuple__60);
 
-  /* "pyaibox/base/mathops.py":701
+  /* "pyaibox/base/mathops.py":856
  *     print(imag(X[0] + 1j * X[1]))
  * 
  *     print('---abs')             # <<<<<<<<<<<<<<
  *     print(abs(X, caxis=0))
  *     print(abs(X[0] + 1j * X[1]))
  */
-  __pyx_tuple__56 = PyTuple_Pack(1, __pyx_kp_u_abs_2); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 701, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__56);
-  __Pyx_GIVEREF(__pyx_tuple__56);
+  __pyx_tuple__61 = PyTuple_Pack(1, __pyx_kp_u_abs_2); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__61);
+  __Pyx_GIVEREF(__pyx_tuple__61);
 
-  /* "pyaibox/base/mathops.py":705
+  /* "pyaibox/base/mathops.py":860
  *     print(abs(X[0] + 1j * X[1]))
  * 
  *     print('---pow')             # <<<<<<<<<<<<<<
  *     print(pow(X, caxis=0))
  *     print(pow(X[0] + 1j * X[1]))
  */
-  __pyx_tuple__57 = PyTuple_Pack(1, __pyx_kp_u_pow_2); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 705, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__57);
-  __Pyx_GIVEREF(__pyx_tuple__57);
+  __pyx_tuple__62 = PyTuple_Pack(1, __pyx_kp_u_pow_2); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__62);
+  __Pyx_GIVEREF(__pyx_tuple__62);
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -8835,14 +10782,15 @@
 {
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
@@ -9042,988 +10990,1513 @@
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_prevpow2, __pyx_t_1) < 0) __PYX_ERR(0, 207, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "pyaibox/base/mathops.py":240
  * 
  * 
- * def r2c(X, caxis=-1, keepcaxis=False):             # <<<<<<<<<<<<<<
- *     r"""convert real-valued array to complex-valued array
+ * def ematmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Element-by-element complex multiplication
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_13r2c, 0, __pyx_n_s_r2c, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_13ematmul, 0, __pyx_n_s_ematmul, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__25);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_r2c, __pyx_t_1) < 0) __PYX_ERR(0, 240, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ematmul, __pyx_t_1) < 0) __PYX_ERR(0, 240, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyaibox/base/mathops.py":312
+  /* "pyaibox/base/mathops.py":302
+ * 
  * 
+ * def matmul(A, B, **kwargs):             # <<<<<<<<<<<<<<
+ *     r"""Complex matrix multiplication
  * 
- * def c2r(X, caxis=-1, keepcaxis=True):             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_15matmul, 0, __pyx_n_s_matmul_2, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__26)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_matmul_2, __pyx_t_1) < 0) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pyaibox/base/mathops.py":369
+ * 
+ * 
+ * def c2r(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""convert complex-valued array to real-valued array
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_15c2r, 0, __pyx_n_s_c2r, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_17c2r, 0, __pyx_n_s_c2r, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__28);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c2r, __pyx_t_1) < 0) __PYX_ERR(0, 312, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__29);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c2r, __pyx_t_1) < 0) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyaibox/base/mathops.py":378
+  /* "pyaibox/base/mathops.py":438
+ * 
+ * 
+ * def r2c(X, caxis=-1, keepaxis=False):             # <<<<<<<<<<<<<<
+ *     r"""convert real-valued array to complex-valued array
+ * 
+ */
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_19r2c, 0, __pyx_n_s_r2c, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__31)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__32);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_r2c, __pyx_t_1) < 0) __PYX_ERR(0, 438, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pyaibox/base/mathops.py":510
  * 
  * 
  * def conj(X, caxis=None):             # <<<<<<<<<<<<<<
  *     r"""conjugates a array
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_17conj, 0, __pyx_n_s_conj, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_21conj, 0, __pyx_n_s_conj, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__31);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_conj, __pyx_t_1) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__35);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_conj, __pyx_t_1) < 0) __PYX_ERR(0, 510, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyaibox/base/mathops.py":434
+  /* "pyaibox/base/mathops.py":566
  * 
  * 
- * def real(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def real(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain real part of a array
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_19real, 0, __pyx_n_s_real, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__33)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_23real, 0, __pyx_n_s_real, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__37)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__34);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_real, __pyx_t_1) < 0) __PYX_ERR(0, 434, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__38);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_real, __pyx_t_1) < 0) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyaibox/base/mathops.py":488
+  /* "pyaibox/base/mathops.py":620
  * 
  * 
- * def imag(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def imag(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain imaginary part of a array
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_21imag, 0, __pyx_n_s_imag, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_25imag, 0, __pyx_n_s_imag, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__40)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__37);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_imag, __pyx_t_1) < 0) __PYX_ERR(0, 488, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__41);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_imag, __pyx_t_1) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyaibox/base/mathops.py":543
+  /* "pyaibox/base/mathops.py":675
  * 
  * 
- * def abs(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def abs(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain amplitude of a array
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_23abs, 0, __pyx_n_s_abs, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__39)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_27abs, 0, __pyx_n_s_abs, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__43)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__40);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_abs, __pyx_t_1) < 0) __PYX_ERR(0, 543, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__44);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_abs, __pyx_t_1) < 0) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyaibox/base/mathops.py":604
+  /* "pyaibox/base/mathops.py":736
  * 
  * 
- * def pow(X, caxis=None, keepcaxis=False):             # <<<<<<<<<<<<<<
+ * def pow(X, caxis=None, keepaxis=False):             # <<<<<<<<<<<<<<
  *     r"""obtain power of a array
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_25pow, 0, __pyx_n_s_pow, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__42)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_4base_7mathops_29pow, 0, __pyx_n_s_pow, NULL, __pyx_n_s_pyaibox_base_mathops, __pyx_d, ((PyObject *)__pyx_codeobj__46)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__43);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pow, __pyx_t_1) < 0) __PYX_ERR(0, 604, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_1, __pyx_tuple__47);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pow, __pyx_t_1) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyaibox/base/mathops.py":665
+  /* "pyaibox/base/mathops.py":797
  * 
  * 
  * if __name__ == '__main__':             # <<<<<<<<<<<<<<
  * 
  *     import numpy as np
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 665, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_main, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 665, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_main, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "pyaibox/base/mathops.py":667
+    /* "pyaibox/base/mathops.py":799
  * if __name__ == '__main__':
  * 
  *     import numpy as np             # <<<<<<<<<<<<<<
  * 
  *     np.random.seed(2020)
  */
-    __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 667, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":669
+    /* "pyaibox/base/mathops.py":801
  *     import numpy as np
  * 
  *     np.random.seed(2020)             # <<<<<<<<<<<<<<
  * 
  *     Xreal = np.random.randint(0, 30, (3, 2, 4))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_seed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_seed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "pyaibox/base/mathops.py":671
+    /* "pyaibox/base/mathops.py":803
  *     np.random.seed(2020)
  * 
  *     Xreal = np.random.randint(0, 30, (3, 2, 4))             # <<<<<<<<<<<<<<
- *     Xcplx = r2c(Xreal, caxis=1, keepcaxis=True)
+ *     Xcplx = r2c(Xreal, caxis=1, keepaxis=True)
  *     Yreal = c2r(Xcplx, caxis=0)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_randint); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_randint); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Xreal, __pyx_t_1) < 0) __PYX_ERR(0, 671, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Xreal, __pyx_t_1) < 0) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":672
+    /* "pyaibox/base/mathops.py":804
  * 
  *     Xreal = np.random.randint(0, 30, (3, 2, 4))
- *     Xcplx = r2c(Xreal, caxis=1, keepcaxis=True)             # <<<<<<<<<<<<<<
+ *     Xcplx = r2c(Xreal, caxis=1, keepaxis=True)             # <<<<<<<<<<<<<<
  *     Yreal = c2r(Xcplx, caxis=0)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_r2c); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_r2c); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xreal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xreal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_int_1) < 0) __PYX_ERR(0, 672, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_keepcaxis, Py_True) < 0) __PYX_ERR(0, 672, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 672, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_int_1) < 0) __PYX_ERR(0, 804, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_keepaxis, Py_True) < 0) __PYX_ERR(0, 804, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Xcplx, __pyx_t_5) < 0) __PYX_ERR(0, 672, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Xcplx, __pyx_t_5) < 0) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":673
+    /* "pyaibox/base/mathops.py":805
  *     Xreal = np.random.randint(0, 30, (3, 2, 4))
- *     Xcplx = r2c(Xreal, caxis=1, keepcaxis=True)
+ *     Xcplx = r2c(Xreal, caxis=1, keepaxis=True)
  *     Yreal = c2r(Xcplx, caxis=0)             # <<<<<<<<<<<<<<
  * 
  *     print(Xreal, Xreal.shape, 'Xreal')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_c2r); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_c2r); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 805, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 805, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 673, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 805, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 805, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Yreal, __pyx_t_1) < 0) __PYX_ERR(0, 673, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Yreal, __pyx_t_1) < 0) __PYX_ERR(0, 805, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":675
+    /* "pyaibox/base/mathops.py":807
  *     Yreal = c2r(Xcplx, caxis=0)
  * 
  *     print(Xreal, Xreal.shape, 'Xreal')             # <<<<<<<<<<<<<<
  *     print(Xcplx, Xcplx.shape, 'Xcplx')
  *     print(Yreal, Yreal.shape, 'Yreal')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Xreal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Xreal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xreal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xreal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
     __Pyx_INCREF(__pyx_n_u_Xreal);
     __Pyx_GIVEREF(__pyx_n_u_Xreal);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_n_u_Xreal);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/mathops.py":676
+    /* "pyaibox/base/mathops.py":808
  * 
  *     print(Xreal, Xreal.shape, 'Xreal')
  *     print(Xcplx, Xcplx.shape, 'Xcplx')             # <<<<<<<<<<<<<<
  *     print(Yreal, Yreal.shape, 'Yreal')
  *     print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 676, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
     __Pyx_INCREF(__pyx_n_u_Xcplx);
     __Pyx_GIVEREF(__pyx_n_u_Xcplx);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_n_u_Xcplx);
     __pyx_t_4 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":677
+    /* "pyaibox/base/mathops.py":809
  *     print(Xreal, Xreal.shape, 'Xreal')
  *     print(Xcplx, Xcplx.shape, 'Xcplx')
  *     print(Yreal, Yreal.shape, 'Yreal')             # <<<<<<<<<<<<<<
  *     print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 809, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 677, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 809, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 677, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 809, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 677, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 809, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
     __Pyx_INCREF(__pyx_n_u_Yreal);
     __Pyx_GIVEREF(__pyx_n_u_Yreal);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_n_u_Yreal);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 677, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 809, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/mathops.py":678
+    /* "pyaibox/base/mathops.py":810
  *     print(Xcplx, Xcplx.shape, 'Xcplx')
  *     print(Yreal, Yreal.shape, 'Yreal')
  *     print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')             # <<<<<<<<<<<<<<
  * 
  *     print(prevpow2(-5), nextpow2(-5))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_real); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_real); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Yreal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Xcplx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_imag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_imag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_6);
     __Pyx_INCREF(__pyx_n_u_Error);
     __Pyx_GIVEREF(__pyx_n_u_Error);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_n_u_Error);
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 810, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "pyaibox/base/mathops.py":680
+    /* "pyaibox/base/mathops.py":812
  *     print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
  * 
  *     print(prevpow2(-5), nextpow2(-5))             # <<<<<<<<<<<<<<
  *     print(prevpow2(5), nextpow2(5))
  *     print(prevpow2(0.3), nextpow2(0.3))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 812, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 812, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 812, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 812, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 812, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":681
+    /* "pyaibox/base/mathops.py":813
  * 
  *     print(prevpow2(-5), nextpow2(-5))
  *     print(prevpow2(5), nextpow2(5))             # <<<<<<<<<<<<<<
  *     print(prevpow2(0.3), nextpow2(0.3))
  *     print(prevpow2(7.3), nextpow2(7.3))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 681, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 681, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 681, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 681, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 681, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
     __pyx_t_6 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 681, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/mathops.py":682
+    /* "pyaibox/base/mathops.py":814
  *     print(prevpow2(-5), nextpow2(-5))
  *     print(prevpow2(5), nextpow2(5))
  *     print(prevpow2(0.3), nextpow2(0.3))             # <<<<<<<<<<<<<<
  *     print(prevpow2(7.3), nextpow2(7.3))
  *     print(prevpow2(-3.5), nextpow2(-3.5))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 682, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 814, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 682, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 682, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_6);
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "pyaibox/base/mathops.py":683
+    /* "pyaibox/base/mathops.py":815
  *     print(prevpow2(5), nextpow2(5))
  *     print(prevpow2(0.3), nextpow2(0.3))
  *     print(prevpow2(7.3), nextpow2(7.3))             # <<<<<<<<<<<<<<
  *     print(prevpow2(-3.5), nextpow2(-3.5))
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":684
+    /* "pyaibox/base/mathops.py":816
  *     print(prevpow2(0.3), nextpow2(0.3))
  *     print(prevpow2(7.3), nextpow2(7.3))
  *     print(prevpow2(-3.5), nextpow2(-3.5))             # <<<<<<<<<<<<<<
  * 
  *     np.random.seed(2020)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_prevpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
     __pyx_t_6 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/mathops.py":686
+    /* "pyaibox/base/mathops.py":818
  *     print(prevpow2(-3.5), nextpow2(-3.5))
  * 
  *     np.random.seed(2020)             # <<<<<<<<<<<<<<
- *     X = np.random.rand(2, 3, 3)
- * 
+ *     Ar = np.random.randn(3, 3, 2)
+ *     Br = np.random.randn(3, 3, 2)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_seed); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_seed); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":687
+    /* "pyaibox/base/mathops.py":819
  * 
  *     np.random.seed(2020)
- *     X = np.random.rand(2, 3, 3)             # <<<<<<<<<<<<<<
+ *     Ar = np.random.randn(3, 3, 2)             # <<<<<<<<<<<<<<
+ *     Br = np.random.randn(3, 3, 2)
  * 
- *     print('---conj')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_rand); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_randn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_X, __pyx_t_4) < 0) __PYX_ERR(0, 687, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Ar, __pyx_t_4) < 0) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/mathops.py":689
- *     X = np.random.rand(2, 3, 3)
+    /* "pyaibox/base/mathops.py":820
+ *     np.random.seed(2020)
+ *     Ar = np.random.randn(3, 3, 2)
+ *     Br = np.random.randn(3, 3, 2)             # <<<<<<<<<<<<<<
  * 
- *     print('---conj')             # <<<<<<<<<<<<<<
- *     print(conj(X, caxis=0))
- *     print(conj(X[0] + 1j * X[1]))
+ *     Ac = pb.r2c(Ar)
  */
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_randn); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Br, __pyx_t_5) < 0) __PYX_ERR(0, 820, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":690
+    /* "pyaibox/base/mathops.py":822
+ *     Br = np.random.randn(3, 3, 2)
  * 
- *     print('---conj')
- *     print(conj(X, caxis=0))             # <<<<<<<<<<<<<<
- *     print(conj(X[0] + 1j * X[1]))
+ *     Ac = pb.r2c(Ar)             # <<<<<<<<<<<<<<
+ *     Bc = pb.r2c(Br)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_conj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pb); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 822, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_r2c); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 822, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_X); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_Ar); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 822, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 822, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Ac, __pyx_t_6) < 0) __PYX_ERR(0, 822, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+    /* "pyaibox/base/mathops.py":823
+ * 
+ *     Ac = pb.r2c(Ar)
+ *     Bc = pb.r2c(Br)             # <<<<<<<<<<<<<<
+ * 
+ *     Mr = pb.c2r(Ac * Bc)
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_pb); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 823, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_r2c); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 823, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Br); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 823, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 823, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Bc, __pyx_t_4) < 0) __PYX_ERR(0, 823, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+
+    /* "pyaibox/base/mathops.py":825
+ *     Bc = pb.r2c(Br)
+ * 
+ *     Mr = pb.c2r(Ac * Bc)             # <<<<<<<<<<<<<<
+ *     print(np.sum(Mr - ematmul(Ar, Br, cdim=-1)))
+ *     print(np.sum(Ac * Bc - ematmul(Ac, Bc)))
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pb); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 825, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_c2r); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 825, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Ac); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 825, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_Bc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 825, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 690, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 825, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 825, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Mr, __pyx_t_5) < 0) __PYX_ERR(0, 825, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":691
- *     print('---conj')
- *     print(conj(X, caxis=0))
- *     print(conj(X[0] + 1j * X[1]))             # <<<<<<<<<<<<<<
+    /* "pyaibox/base/mathops.py":826
+ * 
+ *     Mr = pb.c2r(Ac * Bc)
+ *     print(np.sum(Mr - ematmul(Ar, Br, cdim=-1)))             # <<<<<<<<<<<<<<
+ *     print(np.sum(Ac * Bc - ematmul(Ac, Bc)))
  * 
- *     print('---real')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_conj); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_X); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_Mr); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 826, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_ematmul); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 691, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_X); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Ar); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Br); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 826, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_1);
+    __pyx_t_4 = 0;
+    __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_cdim, __pyx_int_neg_1) < 0) __PYX_ERR(0, 826, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+    /* "pyaibox/base/mathops.py":827
+ *     Mr = pb.c2r(Ac * Bc)
+ *     print(np.sum(Mr - ematmul(Ar, Br, cdim=-1)))
+ *     print(np.sum(Ac * Bc - ematmul(Ac, Bc)))             # <<<<<<<<<<<<<<
+ * 
+ *     np.random.seed(2020)
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 827, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Ac); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Bc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_ematmul); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Ac); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_Bc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_7);
+    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_7);
+    __pyx_t_1 = 0;
+    __pyx_t_7 = 0;
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+    /* "pyaibox/base/mathops.py":829
+ *     print(np.sum(Ac * Bc - ematmul(Ac, Bc)))
+ * 
+ *     np.random.seed(2020)             # <<<<<<<<<<<<<<
+ *     Ar = np.random.randn(3, 3, 2)
+ *     Br = np.random.randn(3, 3, 2)
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 829, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 829, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_seed); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 829, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 829, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+    /* "pyaibox/base/mathops.py":830
+ * 
+ *     np.random.seed(2020)
+ *     Ar = np.random.randn(3, 3, 2)             # <<<<<<<<<<<<<<
+ *     Br = np.random.randn(3, 3, 2)
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 830, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_random); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_randn); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 830, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Ar, __pyx_t_6) < 0) __PYX_ERR(0, 830, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+    /* "pyaibox/base/mathops.py":831
+ *     np.random.seed(2020)
+ *     Ar = np.random.randn(3, 3, 2)
+ *     Br = np.random.randn(3, 3, 2)             # <<<<<<<<<<<<<<
+ * 
+ *     Ac = pb.r2c(Ar)
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 831, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_randn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 831, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Br, __pyx_t_7) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+    /* "pyaibox/base/mathops.py":833
+ *     Br = np.random.randn(3, 3, 2)
+ * 
+ *     Ac = pb.r2c(Ar)             # <<<<<<<<<<<<<<
+ *     Bc = pb.r2c(Br)
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_pb); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_r2c); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_Ar); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Ac, __pyx_t_4) < 0) __PYX_ERR(0, 833, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+
+    /* "pyaibox/base/mathops.py":834
+ * 
+ *     Ac = pb.r2c(Ar)
+ *     Bc = pb.r2c(Br)             # <<<<<<<<<<<<<<
+ * 
+ *     print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pb); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_r2c); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Br); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Bc, __pyx_t_6) < 0) __PYX_ERR(0, 834, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+    /* "pyaibox/base/mathops.py":836
+ *     Bc = pb.r2c(Br)
+ * 
+ *     print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))             # <<<<<<<<<<<<<<
+ *     Mr = matmul(Ar, Br, cdim=-1)
+ *     Mc = pb.c2r(np.matmul(Ac, Bc))
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Ac); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_Bc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5);
+    __pyx_t_6 = 0;
+    __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_Ac); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Bc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_7);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_6);
+    __pyx_t_7 = 0;
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":693
- *     print(conj(X[0] + 1j * X[1]))
+    /* "pyaibox/base/mathops.py":837
  * 
- *     print('---real')             # <<<<<<<<<<<<<<
- *     print(real(X, caxis=0))
- *     print(real(X[0] + 1j * X[1]))
+ *     print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))
+ *     Mr = matmul(Ar, Br, cdim=-1)             # <<<<<<<<<<<<<<
+ *     Mc = pb.c2r(np.matmul(Ac, Bc))
+ *     print(np.sum(Mr - Mc))
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Ar); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Br); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
+    __pyx_t_6 = 0;
+    __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_cdim, __pyx_int_neg_1) < 0) __PYX_ERR(0, 837, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Mr, __pyx_t_6) < 0) __PYX_ERR(0, 837, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "pyaibox/base/mathops.py":694
+    /* "pyaibox/base/mathops.py":838
+ *     print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))
+ *     Mr = matmul(Ar, Br, cdim=-1)
+ *     Mc = pb.c2r(np.matmul(Ac, Bc))             # <<<<<<<<<<<<<<
+ *     print(np.sum(Mr - Mc))
  * 
- *     print('---real')
- *     print(real(X, caxis=0))             # <<<<<<<<<<<<<<
- *     print(real(X[0] + 1j * X[1]))
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_pb); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_c2r); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_matmul_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Ac); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
+    __pyx_t_6 = 0;
+    __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_Mc, __pyx_t_3) < 0) __PYX_ERR(0, 838, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+
+    /* "pyaibox/base/mathops.py":839
+ *     Mr = matmul(Ar, Br, cdim=-1)
+ *     Mc = pb.c2r(np.matmul(Ac, Bc))
+ *     print(np.sum(Mr - Mc))             # <<<<<<<<<<<<<<
  * 
+ *     np.random.seed(2020)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_real); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_X); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Mr); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_Mc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Subtract(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 839, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+    /* "pyaibox/base/mathops.py":841
+ *     print(np.sum(Mr - Mc))
+ * 
+ *     np.random.seed(2020)             # <<<<<<<<<<<<<<
+ *     X = np.random.rand(2, 3, 3)
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 841, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 841, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_seed); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 841, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 841, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+
+    /* "pyaibox/base/mathops.py":842
+ * 
+ *     np.random.seed(2020)
+ *     X = np.random.rand(2, 3, 3)             # <<<<<<<<<<<<<<
+ * 
+ *     print('---conj')
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_rand); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__57, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_X, __pyx_t_5) < 0) __PYX_ERR(0, 842, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+    /* "pyaibox/base/mathops.py":844
+ *     X = np.random.rand(2, 3, 3)
+ * 
+ *     print('---conj')             # <<<<<<<<<<<<<<
+ *     print(conj(X, caxis=0))
+ *     print(conj(X[0] + 1j * X[1]))
+ */
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__58, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 844, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+    /* "pyaibox/base/mathops.py":845
+ * 
+ *     print('---conj')
+ *     print(conj(X, caxis=0))             # <<<<<<<<<<<<<<
+ *     print(conj(X[0] + 1j * X[1]))
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_conj); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_X); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
-    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 845, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+
+    /* "pyaibox/base/mathops.py":846
+ *     print('---conj')
+ *     print(conj(X, caxis=0))
+ *     print(conj(X[0] + 1j * X[1]))             # <<<<<<<<<<<<<<
+ * 
+ *     print('---real')
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_conj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 846, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 694, __pyx_L1_error)
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_X); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_X); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_5, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 846, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+    /* "pyaibox/base/mathops.py":848
+ *     print(conj(X[0] + 1j * X[1]))
+ * 
+ *     print('---real')             # <<<<<<<<<<<<<<
+ *     print(real(X, caxis=0))
+ *     print(real(X[0] + 1j * X[1]))
+ */
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__59, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 848, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+    /* "pyaibox/base/mathops.py":849
+ * 
+ *     print('---real')
+ *     print(real(X, caxis=0))             # <<<<<<<<<<<<<<
+ *     print(real(X[0] + 1j * X[1]))
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_real); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_X); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
+    __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 849, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":695
+    /* "pyaibox/base/mathops.py":850
  *     print('---real')
  *     print(real(X, caxis=0))
  *     print(real(X[0] + 1j * X[1]))             # <<<<<<<<<<<<<<
  * 
  *     print('---imag')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_real); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_X); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 695, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_real); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 695, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_X); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_X); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 695, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_1 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_X); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "pyaibox/base/mathops.py":697
+    /* "pyaibox/base/mathops.py":852
  *     print(real(X[0] + 1j * X[1]))
  * 
  *     print('---imag')             # <<<<<<<<<<<<<<
  *     print(imag(X, caxis=0))
  *     print(imag(X[0] + 1j * X[1]))
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 852, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "pyaibox/base/mathops.py":698
+    /* "pyaibox/base/mathops.py":853
  * 
  *     print('---imag')
  *     print(imag(X, caxis=0))             # <<<<<<<<<<<<<<
  *     print(imag(X[0] + 1j * X[1]))
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_imag); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_imag); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_X); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
-    __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 698, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_X); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 853, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 853, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 853, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 853, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 853, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "pyaibox/base/mathops.py":699
+    /* "pyaibox/base/mathops.py":854
  *     print('---imag')
  *     print(imag(X, caxis=0))
  *     print(imag(X[0] + 1j * X[1]))             # <<<<<<<<<<<<<<
  * 
  *     print('---abs')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_imag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 699, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_X); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_imag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 854, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_X); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_X); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 854, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_X); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 854, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 854, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 854, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":701
+    /* "pyaibox/base/mathops.py":856
  *     print(imag(X[0] + 1j * X[1]))
  * 
  *     print('---abs')             # <<<<<<<<<<<<<<
  *     print(abs(X, caxis=0))
  *     print(abs(X[0] + 1j * X[1]))
  */
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 701, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__61, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 856, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":702
+    /* "pyaibox/base/mathops.py":857
  * 
  *     print('---abs')
  *     print(abs(X, caxis=0))             # <<<<<<<<<<<<<<
  *     print(abs(X[0] + 1j * X[1]))
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_abs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 702, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_X); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_abs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 857, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_X); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 857, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 702, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 857, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 857, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "pyaibox/base/mathops.py":703
+    /* "pyaibox/base/mathops.py":858
  *     print('---abs')
  *     print(abs(X, caxis=0))
  *     print(abs(X[0] + 1j * X[1]))             # <<<<<<<<<<<<<<
  * 
  *     print('---pow')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_abs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 703, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_abs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 858, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_X); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 703, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 703, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 703, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_X); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 703, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 703, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_X); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 858, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Multiply(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 703, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 858, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 703, __pyx_L1_error)
+    __pyx_t_5 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 858, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_X); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 858, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 858, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 703, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_1 = PyNumber_Multiply(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 858, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 703, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 858, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 858, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 858, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/mathops.py":705
+    /* "pyaibox/base/mathops.py":860
  *     print(abs(X[0] + 1j * X[1]))
  * 
  *     print('---pow')             # <<<<<<<<<<<<<<
  *     print(pow(X, caxis=0))
  *     print(pow(X[0] + 1j * X[1]))
  */
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__57, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__62, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 860, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/base/mathops.py":706
+    /* "pyaibox/base/mathops.py":861
  * 
  *     print('---pow')
  *     print(pow(X, caxis=0))             # <<<<<<<<<<<<<<
  *     print(pow(X[0] + 1j * X[1]))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pow); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_X); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 706, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 706, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pow); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 861, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_X); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 861, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GIVEREF(__pyx_t_6);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
-    __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 706, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 706, __pyx_L1_error)
+    __Pyx_GIVEREF(__pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+    __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 861, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 706, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_caxis, __pyx_int_0) < 0) __PYX_ERR(0, 861, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 861, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 861, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/base/mathops.py":707
+    /* "pyaibox/base/mathops.py":862
  *     print('---pow')
  *     print(pow(X, caxis=0))
  *     print(pow(X[0] + 1j * X[1]))             # <<<<<<<<<<<<<<
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_pow); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 707, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_X); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pow); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_X); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 707, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_X); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_5, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyComplex_FromDoubles(0.0, 1.0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_X); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Add(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 862, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/base/mathops.py":665
+    /* "pyaibox/base/mathops.py":797
  * 
  * 
  * if __name__ == '__main__':             # <<<<<<<<<<<<<<
  * 
  *     import numpy as np
  */
   }
 
   /* "pyaibox/base/mathops.py":1
  * #!/usr/bin/env python             # <<<<<<<<<<<<<<
  * #-*- coding: utf-8 -*-
  * # @file      : mathops.py
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_4) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_5) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
   if (__pyx_m) {
     if (__pyx_d) {
       __Pyx_AddTraceback("init pyaibox.base.mathops", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
     PyErr_SetString(PyExc_ImportError, "init pyaibox.base.mathops");
@@ -11133,14 +13606,202 @@
         PyFPE_START_PROTECT("add", return NULL)
         result = a + b;
         PyFPE_END_PROTECT(result)
         return PyFloat_FromDouble(result);
 }
 #endif
 
+/* DictGetItem */
+  #if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
+static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
+    PyObject *value;
+    value = PyDict_GetItemWithError(d, key);
+    if (unlikely(!value)) {
+        if (!PyErr_Occurred()) {
+            if (unlikely(PyTuple_Check(key))) {
+                PyObject* args = PyTuple_Pack(1, key);
+                if (likely(args)) {
+                    PyErr_SetObject(PyExc_KeyError, args);
+                    Py_DECREF(args);
+                }
+            } else {
+                PyErr_SetObject(PyExc_KeyError, key);
+            }
+        }
+        return NULL;
+    }
+    Py_INCREF(value);
+    return value;
+}
+#endif
+
+/* PyObjectCallNoArg */
+  #if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
+#if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(func)) {
+        return __Pyx_PyFunction_FastCall(func, NULL, 0);
+    }
+#endif
+#ifdef __Pyx_CyFunction_USED
+    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
+#else
+    if (likely(PyCFunction_Check(func)))
+#endif
+    {
+        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
+            return __Pyx_PyObject_CallMethO(func, NULL);
+        }
+    }
+    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
+}
+#endif
+
+/* PyIntBinop */
+  #if !CYTHON_COMPILING_IN_PYPY
+#if PY_MAJOR_VERSION < 3 || CYTHON_USE_PYLONG_INTERNALS
+#define __Pyx_PyInt_FloorDivideObjC_ZeroDivisionError(operand)\
+    if (unlikely(zerodivision_check && ((operand) == 0))) {\
+        PyErr_SetString(PyExc_ZeroDivisionError, "integer division by zero");\
+        return NULL;\
+    }
+#endif
+static PyObject* __Pyx_PyInt_FloorDivideObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, int inplace, int zerodivision_check) {
+    (void)inplace;
+    (void)zerodivision_check;
+    #if PY_MAJOR_VERSION < 3
+    if (likely(PyInt_CheckExact(op1))) {
+        const long b = intval;
+        long x;
+        long a = PyInt_AS_LONG(op1);
+            __Pyx_PyInt_FloorDivideObjC_ZeroDivisionError(b)
+            if (unlikely(b == -1 && ((unsigned long)a) == 0-(unsigned long)a))
+                return PyInt_Type.tp_as_number->nb_floor_divide(op1, op2);
+            else {
+                long q, r;
+                q = a / b;
+                r = a - q*b;
+                q -= ((r != 0) & ((r ^ b) < 0));
+                x = q;
+            }
+            return PyInt_FromLong(x);
+    }
+    #endif
+    #if CYTHON_USE_PYLONG_INTERNALS
+    if (likely(PyLong_CheckExact(op1))) {
+        const long b = intval;
+        long a, x;
+#ifdef HAVE_LONG_LONG
+        const PY_LONG_LONG llb = intval;
+        PY_LONG_LONG lla, llx;
+#endif
+        const digit* digits = ((PyLongObject*)op1)->ob_digit;
+        const Py_ssize_t size = Py_SIZE(op1);
+        if (likely(__Pyx_sst_abs(size) <= 1)) {
+            a = likely(size) ? digits[0] : 0;
+            if (size == -1) a = -a;
+        } else {
+            switch (size) {
+                case -2:
+                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
+                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
+                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case 2:
+                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
+                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
+                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case -3:
+                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
+                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
+                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case 3:
+                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
+                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
+                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case -4:
+                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
+                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
+                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                case 4:
+                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
+                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+#ifdef HAVE_LONG_LONG
+                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
+                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
+                        goto long_long;
+#endif
+                    }
+                    CYTHON_FALLTHROUGH;
+                default: return PyLong_Type.tp_as_number->nb_floor_divide(op1, op2);
+            }
+        }
+                __Pyx_PyInt_FloorDivideObjC_ZeroDivisionError(b)
+                {
+                    long q, r;
+                    q = a / b;
+                    r = a - q*b;
+                    q -= ((r != 0) & ((r ^ b) < 0));
+                    x = q;
+                }
+            return PyLong_FromLong(x);
+#ifdef HAVE_LONG_LONG
+        long_long:
+                {
+                    PY_LONG_LONG q, r;
+                    q = lla / llb;
+                    r = lla - q*llb;
+                    q -= ((r != 0) & ((r ^ llb) < 0));
+                    llx = q;
+                }
+            return PyLong_FromLongLong(llx);
+#endif
+        
+        
+    }
+    #endif
+    return (inplace ? PyNumber_InPlaceFloorDivide : PyNumber_FloorDivide)(op1, op2);
+}
+#endif
+
 /* GetItemInt */
   static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
     PyObject *r;
     if (!j) return NULL;
     r = PyObject_GetItem(o, j);
     Py_DECREF(j);
     return r;
@@ -11249,35 +13910,162 @@
     if (likely(m && m->mp_subscript)) {
         return m->mp_subscript(obj, key);
     }
     return __Pyx_PyObject_GetIndex(obj, key);
 }
 #endif
 
-/* PyObjectCallNoArg */
-  #if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
-#if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(func)) {
-        return __Pyx_PyFunction_FastCall(func, NULL, 0);
+/* MatrixMultiply */
+  #if PY_VERSION_HEX < 0x03050000
+static PyObject* __Pyx_PyObject_CallMatrixMethod(PyObject* method, PyObject* arg) {
+    PyObject *result = NULL;
+#if CYTHON_UNPACK_METHODS
+    if (likely(PyMethod_Check(method))) {
+        PyObject *self = PyMethod_GET_SELF(method);
+        if (likely(self)) {
+            PyObject *args;
+            PyObject *function = PyMethod_GET_FUNCTION(method);
+            #if CYTHON_FAST_PYCALL
+            if (PyFunction_Check(function)) {
+                PyObject *args[2] = {self, arg};
+                result = __Pyx_PyFunction_FastCall(function, args, 2);
+                goto done;
+            }
+            #endif
+            #if CYTHON_FAST_PYCCALL
+            if (__Pyx_PyFastCFunction_Check(function)) {
+                PyObject *args[2] = {self, arg};
+                result = __Pyx_PyCFunction_FastCall(function, args, 2);
+                goto done;
+            }
+            #endif
+            args = PyTuple_New(2);
+            if (unlikely(!args)) goto done;
+            Py_INCREF(self);
+            PyTuple_SET_ITEM(args, 0, self);
+            Py_INCREF(arg);
+            PyTuple_SET_ITEM(args, 1, arg);
+            Py_INCREF(function);
+            Py_DECREF(method); method = NULL;
+            result = __Pyx_PyObject_Call(function, args, NULL);
+            Py_DECREF(args);
+            Py_DECREF(function);
+            return result;
+        }
     }
 #endif
-#ifdef __Pyx_CyFunction_USED
-    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
-#else
-    if (likely(PyCFunction_Check(func)))
+    result = __Pyx_PyObject_CallOneArg(method, arg);
+done:
+    Py_DECREF(method);
+    return result;
+}
+#define __Pyx_TryMatrixMethod(x, y, py_method_name) {\
+    PyObject *func = __Pyx_PyObject_GetAttrStr(x, py_method_name);\
+    if (func) {\
+        PyObject *result = __Pyx_PyObject_CallMatrixMethod(func, y);\
+        if (result != Py_NotImplemented)\
+            return result;\
+        Py_DECREF(result);\
+    } else {\
+        if (!PyErr_ExceptionMatches(PyExc_AttributeError))\
+            return NULL;\
+        PyErr_Clear();\
+    }\
+}
+static PyObject* __Pyx__PyNumber_MatrixMultiply(PyObject* x, PyObject* y, const char* op_name) {
+    int right_is_subtype = PyObject_IsSubclass((PyObject*)Py_TYPE(y), (PyObject*)Py_TYPE(x));
+    if (unlikely(right_is_subtype == -1))
+        return NULL;
+    if (right_is_subtype) {
+        __Pyx_TryMatrixMethod(y, x, __pyx_n_s_rmatmul)
+    }
+    __Pyx_TryMatrixMethod(x, y, __pyx_n_s_matmul)
+    if (!right_is_subtype) {
+        __Pyx_TryMatrixMethod(y, x, __pyx_n_s_rmatmul)
+    }
+    PyErr_Format(PyExc_TypeError,
+                 "unsupported operand type(s) for %.2s: '%.100s' and '%.100s'",
+                 op_name,
+                 Py_TYPE(x)->tp_name,
+                 Py_TYPE(y)->tp_name);
+    return NULL;
+}
+static PyObject* __Pyx_PyNumber_InPlaceMatrixMultiply(PyObject* x, PyObject* y) {
+    __Pyx_TryMatrixMethod(x, y, __pyx_n_s_imatmul)
+    return __Pyx__PyNumber_MatrixMultiply(x, y, "@=");
+}
+#undef __Pyx_TryMatrixMethod
 #endif
-    {
-        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
-            return __Pyx_PyObject_CallMethO(func, NULL);
+
+/* PyIntCompare */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED long inplace) {
+    if (op1 == op2) {
+        Py_RETURN_TRUE;
+    }
+    #if PY_MAJOR_VERSION < 3
+    if (likely(PyInt_CheckExact(op1))) {
+        const long b = intval;
+        long a = PyInt_AS_LONG(op1);
+        if (a == b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
+    }
+    #endif
+    #if CYTHON_USE_PYLONG_INTERNALS
+    if (likely(PyLong_CheckExact(op1))) {
+        int unequal;
+        unsigned long uintval;
+        Py_ssize_t size = Py_SIZE(op1);
+        const digit* digits = ((PyLongObject*)op1)->ob_digit;
+        if (intval == 0) {
+            if (size == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
+        } else if (intval < 0) {
+            if (size >= 0)
+                Py_RETURN_FALSE;
+            intval = -intval;
+            size = -size;
+        } else {
+            if (size <= 0)
+                Py_RETURN_FALSE;
         }
+        uintval = (unsigned long) intval;
+#if PyLong_SHIFT * 4 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 4)) {
+            unequal = (size != 5) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[4] != ((uintval >> (4 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
+        } else
+#endif
+#if PyLong_SHIFT * 3 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 3)) {
+            unequal = (size != 4) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
+        } else
+#endif
+#if PyLong_SHIFT * 2 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 2)) {
+            unequal = (size != 3) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
+        } else
+#endif
+#if PyLong_SHIFT * 1 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 1)) {
+            unequal = (size != 2) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
+        } else
+#endif
+            unequal = (size != 1) || (((unsigned long) digits[0]) != (uintval & (unsigned long) PyLong_MASK));
+        if (unequal == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
     }
-    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
+    #endif
+    if (PyFloat_CheckExact(op1)) {
+        const long b = intval;
+        double a = PyFloat_AS_DOUBLE(op1);
+        if ((double)a == (double)b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
+    }
+    return (
+        PyObject_RichCompare(op1, op2, Py_EQ));
 }
-#endif
 
 /* PyObject_GenericGetAttrNoDict */
   #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static PyObject *__Pyx_RaiseGenericGetAttributeError(PyTypeObject *tp, PyObject *attr_name) {
     PyErr_Format(PyExc_AttributeError,
 #if PY_MAJOR_VERSION >= 3
                  "'%.50s' object has no attribute '%U'",
```

### Comparing `pyaibox-1.1.20/pyaibox/base/mathops.py` & `pyaibox-1.1.21/pyaibox/base/mathops.py`

 * *Files 16% similar despite different names*

```diff
@@ -233,38 +233,168 @@
             1 2
 
     """
     
     return int(np.floor(np.log2(np.abs(x) + 1e-32)))
 
 
-def r2c(X, caxis=-1, keepcaxis=False):
-    r"""convert real-valued array to complex-valued array
+def ematmul(A, B, **kwargs):
+    r"""Element-by-element complex multiplication
 
-    Convert real-valued array (the size of :attr:`axis` -th dimension is 2) to complex-valued array
+    like A .* B in matlab
+
+    Parameters
+    ----------
+    A : array
+        any size array, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    B : array
+        any size array, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    cdim : int or None, optional
+        if :attr:`A` and :attr:`B` are complex arrays but represented in real format, :attr:`cdim` or :attr:`caxis`
+        should be specified (Default is :obj:`None`).
+
+    Returns
+    -------
+    tensor
+        result of element-by-element complex multiplication with the same repesentation as :attr:`A` and :attr:`B`.
+    
+    Examples
+    ----------
+
+    ::
+
+        np.random.seed(2020)
+        Ar = np.random.randn(3, 3, 2)
+        Br = np.random.randn(3, 3, 2)
+
+        Ac = pb.r2c(Ar)
+        Bc = pb.r2c(Br)
+
+        Mr = pb.c2r(Ac * Bc)
+        print(np.sum(Mr - ematmul(Ar, Br, cdim=-1)))
+        print(np.sum(Ac * Bc - ematmul(Ac, Bc)))
+
+        # output
+        tensor(0)
+        tensor(0j)
+
+    """
+
+    if 'cdim' in kwargs:
+        cdim = kwargs['cdim']
+    elif 'caxis' in kwargs:
+        cdim = kwargs['caxis']
+    else:
+        cdim = None
+
+    if np.iscomplex(A).any() or np.iscomplex(B).any():
+        return A * B
+        # return A.real * B.real - A.imag * B.imag + 1j * (A.real * B.imag + A.imag * B.real)
+    elif cdim is None:
+        return A * B
+    else:
+        Nc = A.shape[cdim] // 2
+        idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))
+        return np.concatenate((A[idxreal] * B[idxreal] - A[idximag] * B[idximag], A[idxreal] * B[idximag] + A[idximag] * B[idxreal]), axis=cdim)
+
+
+def matmul(A, B, **kwargs):
+    r"""Complex matrix multiplication
+
+    like A * B in matlab
+
+    Parameters
+    ----------
+    A : tensor
+        any size tensor, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    B : tensor
+        any size tensor, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    cdim : int or None, optional
+        if :attr:`A` and :attr:`B` are complex tensors but represented in real format, :attr:`cdim` or :attr:`caxis`
+        should be specified (Default is :obj:`None`).
+
+    Returns
+    -------
+    tensor
+        result of complex multiplication with the same repesentation as :attr:`A` and :attr:`B`.
+    
+    Examples
+    ----------
+
+    ::
+
+        np.random.seed(2020)
+        Ar = np.random.randn(3, 3, 2)
+        Br = np.random.randn(3, 3, 2)
+
+        Ac = pb.r2c(Ar)
+        Bc = pb.r2c(Br)
+
+        print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))
+        Mr = matmul(Ar, Br, cdim=-1)
+        Mc = pb.c2r(np.matmul(Ac, Bc))
+        print(np.sum(Mr - Mc))
+
+        # output
+        tensor(0j)
+        tensor(0)
+
+    """
+
+    if 'cdim' in kwargs:
+        cdim = kwargs['cdim']
+    elif 'caxis' in kwargs:
+        cdim = kwargs['caxis']
+    else:
+        cdim = None
+
+    if np.iscomplex(A).any() or np.iscomplex(B).any():
+        return A @ B
+        # return np.matmul(A.real, B.real) - np.matmul(A.imag, B.imag) + 1j * (np.matmul(A.real, B.imag) + np.matmul(A.imag, B.real))
+    elif cdim is None:
+        return A @ B
+    else:
+        Nc = A.shape[cdim] // 2
+        if Nc == 1:
+            idxreal, idximag = pb.sl(A.ndim, cdim, 0), pb.sl(A.ndim, cdim, 1)
+            return np.stack((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)
+        else:
+            idxreal, idximag = pb.sl(A.ndim, cdim, slice(None, Nc)), pb.sl(A.ndim, cdim, slice(Nc, None))
+            return np.concatenate((np.matmul(A[idxreal], B[idxreal]) - np.matmul(A[idximag], B[idximag]), np.matmul(A[idxreal], B[idximag]) + np.matmul(A[idximag], B[idxreal])), axis=cdim)
+
+
+def c2r(X, caxis=-1, keepaxis=False):
+    r"""convert complex-valued array to real-valued array
 
     Args:
-        X (numpy array): real-valued array.
-        caxis (int, optional): the complex axis. Defaults to -1.
-        keepcaxis (bool, optional): keepcaxis? default is False.
+        X (numpy array): input in complex representaion
+        caxis (int, optional): complex axis for real-valued array. Defaults to -1.
+        keepaxis (bool, optional): if :obj:`False`, stacks (make a new axis) at dimension :attr:`cdim`, 
+        otherwise concatenates the real and imag part at exist dimension :attr:`cdim`, (Default is :obj:`False`).
 
     Returns:
-        numpy array: complex-valued array
+        numpy array: output in real representaion
+
+    see also :func:`r2c`
 
     Examples:
 
         ::
 
             import numpy as np
 
             np.random.seed(2020)
 
             Xreal = np.random.randint(0, 30, (3, 2, 4))
             Xcplx = r2c(Xreal, caxis=1)
-            Yreal = c2r(Xcplx, caxis=0, keepcaxis=True)
+            Yreal = c2r(Xcplx, caxis=0, keepaxis=True)
 
             print(Xreal, Xreal.shape, 'Xreal')
             print(Xcplx, Xcplx.shape, 'Xcplx')
             print(Yreal, Yreal.shape, 'Yreal')
             print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
 
             # output
@@ -295,46 +425,46 @@
             [[ 0. 24. 10.  9.]]
 
             [[ 3.  6.  5. 16.]]]] (2, 3, 1, 4) Yreal
 
             0.0 0.0, Error
     """
 
-    if keepcaxis:
-        idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[[0]])
-        idximag = pb.sl(np.ndim(X), axis=caxis, idx=[[1]])
+    if keepaxis:
+        return np.concatenate((X.real, X.imag), axis=caxis)
     else:
-        idxreal = pb.sl(np.ndim(X), axis=caxis, idx=[0])
-        idximag = pb.sl(np.ndim(X), axis=caxis, idx=[1])
+        return np.stack((X.real, X.imag), axis=caxis)
 
-    return X[idxreal] + 1j * X[idximag]
 
+def r2c(X, caxis=-1, keepaxis=False):
+    r"""convert real-valued array to complex-valued array
 
-def c2r(X, caxis=-1, keepcaxis=True):
-    r"""convert complex-valued array to real-valued array
+    Convert real-valued array (the size of :attr:`axis` -th dimension is 2) to complex-valued array
 
     Args:
-        X (numpy array): complex-valued array
-        caxis (int, optional): complex axis for real-valued array. Defaults to -1.
-        keepcaxis (bool, optional): keepcaxis? default is True.
+        X (numpy array): input in real representaion
+        caxis (int, optional): the complex axis. Defaults to -1.
+        keepaxis (bool, optional): if :obj:`False`, discards axis :attr:`cdim`, 
+        otherwise preserves the axis :attr:`cdim`, (Default is :obj:`False`). 
+        (only work when the dimension at :attr:`cdim` equals 2)
 
     Returns:
-        numpy array: real-valued array
+        numpy array: complex-valued array
 
     Examples:
 
         ::
 
             import numpy as np
 
             np.random.seed(2020)
 
             Xreal = np.random.randint(0, 30, (3, 2, 4))
             Xcplx = r2c(Xreal, caxis=1)
-            Yreal = c2r(Xcplx, caxis=0, keepcaxis=True)
+            Yreal = c2r(Xcplx, caxis=0, keepaxis=True)
 
             print(Xreal, Xreal.shape, 'Xreal')
             print(Xcplx, Xcplx.shape, 'Xcplx')
             print(Yreal, Yreal.shape, 'Yreal')
             print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
 
             # output
@@ -365,18 +495,20 @@
             [[ 0. 24. 10.  9.]]
 
             [[ 3.  6.  5. 16.]]]] (2, 3, 1, 4) Yreal
 
             0.0 0.0, Error
     """
 
-    if keepcaxis:
-        return np.stack((X.real, X.imag), axis=caxis)
+    d, Nc = X.ndim, X.shape[caxis] // 2
+    keepaxis = keepaxis if Nc == 1 else True
+    if keepaxis:
+        return X[pb.sl(d, caxis, slice(0, Nc))] + 1j * X[pb.sl(d, caxis, slice(Nc, None))]
     else:
-        return np.concatenate((X.real, X.imag), axis=caxis)
+        return X[pb.sl(d, caxis, [0])] + 1j * X[pb.sl(d, caxis, [1])]
 
 
 def conj(X, caxis=None):
     r"""conjugates a array
 
     Both complex and real representation are supported.
 
@@ -423,32 +555,32 @@
 
     if np.iscomplex(X).any():  # complex in complex
         return np.conj(X)
     else:
         if caxis is None:  # real
             return X
         else:  # complex in real
-            d = np.ndim(X)
+            d = X.ndim
             return np.concatenate((X[pb.sl(d, axis=caxis, idx=[[0]])], -X[pb.sl(d, axis=caxis, idx=[[1]])]), axis=caxis)
 
 
-def real(X, caxis=None, keepcaxis=False):
+def real(X, caxis=None, keepaxis=False):
     r"""obtain real part of a array
 
     Both complex and real representation are supported.
 
     Parameters
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's real part array.
 
@@ -476,33 +608,33 @@
 
     if np.iscomplex(X).any():  # complex in complex
         return X.real
     else:
         if caxis is None:  # real
             return X
         else:  # complex in real
-            d = np.ndim(X)
-            idx = [[0]] if keepcaxis else [0]
+            d = X.ndim
+            idx = [[0]] if keepaxis else [0]
             return X[pb.sl(d, axis=caxis, idx=idx)]
 
 
-def imag(X, caxis=None, keepcaxis=False):
+def imag(X, caxis=None, keepaxis=False):
     r"""obtain imaginary part of a array
 
     Both complex and real representation are supported.
 
     Parameters
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's imaginary part array.
 
@@ -531,20 +663,20 @@
 
     if np.iscomplex(X).any():  # complex in complex
         return np.imag(X)
     else:
         if caxis is None:  # real
             return np.zeros_like(X)
         else:  # complex in real
-            d = np.ndim(X)
-            idx = [[1]] if keepcaxis else [1]
+            d = X.ndim
+            idx = [[1]] if keepaxis else [1]
             return X[pb.sl(d, axis=caxis, idx=idx)]
 
 
-def abs(X, caxis=None, keepcaxis=False):
+def abs(X, caxis=None, keepaxis=False):
     r"""obtain amplitude of a array
 
     Both complex and real representation are supported.
 
     .. math::
        {\rm abs}({\bf X}) = |{\bf x}| = \sqrt{u^2 + v^2}, x\in {\bf X}
 
@@ -554,15 +686,15 @@
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's amplitude.
    
@@ -591,21 +723,21 @@
 
     if np.iscomplex(X).any():  # complex in complex
         return np.abs(X)
     else:
         if caxis is None:  # real
             return np.abs(X)
         else:  # complex in real
-            d = np.ndim(X)
-            idxreal = [[0]] if keepcaxis else [0]
-            idximag = [[1]] if keepcaxis else [1]
+            d = X.ndim
+            idxreal = [[0]] if keepaxis else [0]
+            idximag = [[1]] if keepaxis else [1]
             return np.sqrt((X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2))
 
 
-def pow(X, caxis=None, keepcaxis=False):
+def pow(X, caxis=None, keepaxis=False):
     r"""obtain power of a array
 
     Both complex and real representation are supported.
 
     .. math::
        {\rm pow}({\bf X}) = |{\bf x}| = u^2 + v^2, x\in {\bf X}
 
@@ -615,15 +747,15 @@
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's power.
    
@@ -652,42 +784,65 @@
 
     if np.iscomplex(X).any():  # complex in complex
         return X.real*X.real + X.imag*X.imag
     else:
         if caxis is None:  # real
             return X**2
         else:  # complex in real
-            d = np.ndim(X)
-            idxreal = [[0]] if keepcaxis else [0]
-            idximag = [[1]] if keepcaxis else [1]
+            d = X.ndim
+            idxreal = [[0]] if keepaxis else [0]
+            idximag = [[1]] if keepaxis else [1]
             return X[pb.sl(d, axis=caxis, idx=idxreal)]**2 + X[pb.sl(d, axis=caxis, idx=idximag)]**2
 
 
 if __name__ == '__main__':
 
     import numpy as np
 
     np.random.seed(2020)
 
     Xreal = np.random.randint(0, 30, (3, 2, 4))
-    Xcplx = r2c(Xreal, caxis=1, keepcaxis=True)
+    Xcplx = r2c(Xreal, caxis=1, keepaxis=True)
     Yreal = c2r(Xcplx, caxis=0)
 
     print(Xreal, Xreal.shape, 'Xreal')
     print(Xcplx, Xcplx.shape, 'Xcplx')
     print(Yreal, Yreal.shape, 'Yreal')
     print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
 
     print(prevpow2(-5), nextpow2(-5))
     print(prevpow2(5), nextpow2(5))
     print(prevpow2(0.3), nextpow2(0.3))
     print(prevpow2(7.3), nextpow2(7.3))
     print(prevpow2(-3.5), nextpow2(-3.5))
 
     np.random.seed(2020)
+    Ar = np.random.randn(3, 3, 2)
+    Br = np.random.randn(3, 3, 2)
+
+    Ac = pb.r2c(Ar)
+    Bc = pb.r2c(Br)
+
+    Mr = pb.c2r(Ac * Bc)
+    print(np.sum(Mr - ematmul(Ar, Br, cdim=-1)))
+    print(np.sum(Ac * Bc - ematmul(Ac, Bc)))
+
+    np.random.seed(2020)
+    Ar = np.random.randn(3, 3, 2)
+    Br = np.random.randn(3, 3, 2)
+
+    Ac = pb.r2c(Ar)
+    Bc = pb.r2c(Br)
+
+    print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))
+    Mr = matmul(Ar, Br, cdim=-1)
+    Mc = pb.c2r(np.matmul(Ac, Bc))
+    print(np.sum(Mr - Mc))
+
+    np.random.seed(2020)
     X = np.random.rand(2, 3, 3)
 
     print('---conj')
     print(conj(X, caxis=0))
     print(conj(X[0] + 1j * X[1]))
 
     print('---real')
```

### Comparing `pyaibox-1.1.20/pyaibox/base/mathops.pyi` & `pyaibox-1.1.21/pyaibox/base/mathops.pyi`

 * *Files 22% similar despite different names*

```diff
@@ -159,38 +159,128 @@
             2 3
             -2 -1
             2 3
             1 2
 
     """
 
-def r2c(X, caxis=-1, keepcaxis=False):
-    r"""convert real-valued array to complex-valued array
+def ematmul(A, B, **kwargs):
+    r"""Element-by-element complex multiplication
 
-    Convert real-valued array (the size of :attr:`axis` -th dimension is 2) to complex-valued array
+    like A .* B in matlab
+
+    Parameters
+    ----------
+    A : array
+        any size array, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    B : array
+        any size array, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    cdim : int or None, optional
+        if :attr:`A` and :attr:`B` are complex arrays but represented in real format, :attr:`cdim` or :attr:`caxis`
+        should be specified (Default is :obj:`None`).
+
+    Returns
+    -------
+    tensor
+        result of element-by-element complex multiplication with the same repesentation as :attr:`A` and :attr:`B`.
+    
+    Examples
+    ----------
+
+    ::
+
+        np.random.seed(2020)
+        Ar = np.random.randn(3, 3, 2)
+        Br = np.random.randn(3, 3, 2)
+
+        Ac = pb.r2c(Ar)
+        Bc = pb.r2c(Br)
+
+        Mr = pb.c2r(Ac * Bc)
+        print(np.sum(Mr - ematmul(Ar, Br, cdim=-1)))
+        print(np.sum(Ac * Bc - ematmul(Ac, Bc)))
+
+        # output
+        tensor(0)
+        tensor(0j)
+
+    """
+
+def matmul(A, B, **kwargs):
+    r"""Complex matrix multiplication
+
+    like A * B in matlab
+
+    Parameters
+    ----------
+    A : tensor
+        any size tensor, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    B : tensor
+        any size tensor, both complex and real representation are supported.
+        For real representation, the real and imaginary dimension is specified by :attr:`cdim` or :attr:`caxis`.
+    cdim : int or None, optional
+        if :attr:`A` and :attr:`B` are complex tensors but represented in real format, :attr:`cdim` or :attr:`caxis`
+        should be specified (Default is :obj:`None`).
+
+    Returns
+    -------
+    tensor
+        result of complex multiplication with the same repesentation as :attr:`A` and :attr:`B`.
+    
+    Examples
+    ----------
+
+    ::
+
+        np.random.seed(2020)
+        Ar = np.random.randn(3, 3, 2)
+        Br = np.random.randn(3, 3, 2)
+
+        Ac = pb.r2c(Ar)
+        Bc = pb.r2c(Br)
+
+        print(np.sum(np.matmul(Ac, Bc) - matmul(Ac, Bc)))
+        Mr = matmul(Ar, Br, cdim=-1)
+        Mc = pb.c2r(np.matmul(Ac, Bc))
+        print(np.sum(Mr - Mc))
+
+        # output
+        tensor(0j)
+        tensor(0)
+
+    """
+
+def c2r(X, caxis=-1, keepaxis=False):
+    r"""convert complex-valued array to real-valued array
 
     Args:
-        X (numpy array): real-valued array.
-        caxis (int, optional): the complex axis. Defaults to -1.
-        keepcaxis (bool, optional): keepcaxis? default is False.
+        X (numpy array): input in complex representaion
+        caxis (int, optional): complex axis for real-valued array. Defaults to -1.
+        keepaxis (bool, optional): if :obj:`False`, stacks (make a new axis) at dimension :attr:`cdim`, 
+        otherwise concatenates the real and imag part at exist dimension :attr:`cdim`, (Default is :obj:`False`).
 
     Returns:
-        numpy array: complex-valued array
+        numpy array: output in real representaion
+
+    see also :func:`r2c`
 
     Examples:
 
         ::
 
             import numpy as np
 
             np.random.seed(2020)
 
             Xreal = np.random.randint(0, 30, (3, 2, 4))
             Xcplx = r2c(Xreal, caxis=1)
-            Yreal = c2r(Xcplx, caxis=0, keepcaxis=True)
+            Yreal = c2r(Xcplx, caxis=0, keepaxis=True)
 
             print(Xreal, Xreal.shape, 'Xreal')
             print(Xcplx, Xcplx.shape, 'Xcplx')
             print(Yreal, Yreal.shape, 'Yreal')
             print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
 
             # output
@@ -221,36 +311,40 @@
             [[ 0. 24. 10.  9.]]
 
             [[ 3.  6.  5. 16.]]]] (2, 3, 1, 4) Yreal
 
             0.0 0.0, Error
     """
 
-def c2r(X, caxis=-1, keepcaxis=True):
-    r"""convert complex-valued array to real-valued array
+def r2c(X, caxis=-1, keepaxis=False):
+    r"""convert real-valued array to complex-valued array
+
+    Convert real-valued array (the size of :attr:`axis` -th dimension is 2) to complex-valued array
 
     Args:
-        X (numpy array): complex-valued array
-        caxis (int, optional): complex axis for real-valued array. Defaults to -1.
-        keepcaxis (bool, optional): keepcaxis? default is True.
+        X (numpy array): input in real representaion
+        caxis (int, optional): the complex axis. Defaults to -1.
+        keepaxis (bool, optional): if :obj:`False`, discards axis :attr:`cdim`, 
+        otherwise preserves the axis :attr:`cdim`, (Default is :obj:`False`). 
+        (only work when the dimension at :attr:`cdim` equals 2)
 
     Returns:
-        numpy array: real-valued array
+        numpy array: complex-valued array
 
     Examples:
 
         ::
 
             import numpy as np
 
             np.random.seed(2020)
 
             Xreal = np.random.randint(0, 30, (3, 2, 4))
             Xcplx = r2c(Xreal, caxis=1)
-            Yreal = c2r(Xcplx, caxis=0, keepcaxis=True)
+            Yreal = c2r(Xcplx, caxis=0, keepaxis=True)
 
             print(Xreal, Xreal.shape, 'Xreal')
             print(Xcplx, Xcplx.shape, 'Xcplx')
             print(Yreal, Yreal.shape, 'Yreal')
             print(np.sum(Yreal[0] - Xcplx.real), np.sum(Yreal[1] - Xcplx.imag), 'Error')
 
             # output
@@ -327,28 +421,28 @@
         [-0.66680305 -0.21710064 -0.56142698]]]
         [[0.98627683-0.15669967j 0.87339195-0.14088724j 0.50974552-0.75708028j]
         [0.27183571-0.73632492j 0.33691873-0.35566309j 0.21695427-0.34109302j]
         [0.27647714-0.66680305j 0.34331559-0.21710064j 0.86215894-0.56142698j]]
 
     """
 
-def real(X, caxis=None, keepcaxis=False):
+def real(X, caxis=None, keepaxis=False):
     r"""obtain real part of a array
 
     Both complex and real representation are supported.
 
     Parameters
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's real part array.
 
@@ -370,28 +464,28 @@
         [0.27183571 0.33691873 0.21695427]
         [0.27647714 0.34331559 0.86215894]]
         [[0.98627683 0.87339195 0.50974552]
         [0.27183571 0.33691873 0.21695427]
         [0.27647714 0.34331559 0.86215894]]
     """
 
-def imag(X, caxis=None, keepcaxis=False):
+def imag(X, caxis=None, keepaxis=False):
     r"""obtain imaginary part of a array
 
     Both complex and real representation are supported.
 
     Parameters
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's imaginary part array.
 
@@ -414,15 +508,15 @@
         [0.66680305 0.21710064 0.56142698]]
         [[0.15669967 0.14088724 0.75708028]
         [0.73632492 0.35566309 0.34109302]
         [0.66680305 0.21710064 0.56142698]]
 
     """
 
-def abs(X, caxis=None, keepcaxis=False):
+def abs(X, caxis=None, keepaxis=False):
     r"""obtain amplitude of a array
 
     Both complex and real representation are supported.
 
     .. math::
        {\rm abs}({\bf X}) = |{\bf x}| = \sqrt{u^2 + v^2}, x\in {\bf X}
 
@@ -432,15 +526,15 @@
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's amplitude.
    
@@ -463,15 +557,15 @@
         [0.72184896 0.40619981 1.02884318]]
         [[0.99864747 0.88468226 0.91269439]
         [0.78490066 0.48990863 0.40424448]
         [0.72184896 0.40619981 1.02884318]]
 
     """
 
-def pow(X, caxis=None, keepcaxis=False):
+def pow(X, caxis=None, keepaxis=False):
     r"""obtain power of a array
 
     Both complex and real representation are supported.
 
     .. math::
        {\rm pow}({\bf X}) = |{\bf x}| = u^2 + v^2, x\in {\bf X}
 
@@ -481,15 +575,15 @@
     ----------
     X : array
         input
     caxis : int or None
         If :attr:`X` is complex-valued, :attr:`cdim` is ignored. If :attr:`X` is real-valued and :attr:`cdim` is integer
         then :attr:`X` will be treated as complex-valued, in this case, :attr:`cdim` specifies the complex axis;
         otherwise (None), :attr:`X` will be treated as real-valued
-    keepcaxis : bool, optional
+    keepaxis : bool, optional
         keep complex-dimension?
 
     Returns
     -------
     array
          the inputs's power.
```

### Comparing `pyaibox-1.1.20/pyaibox/base/randomfunc.c` & `pyaibox-1.1.21/pyaibox/base/randomfunc.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/base/randomfunc.py` & `pyaibox-1.1.21/pyaibox/base/randomfunc.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/base/randomfunc.pyi` & `pyaibox-1.1.21/pyaibox/base/randomfunc.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/base/typevalue.c` & `pyaibox-1.1.21/pyaibox/base/typevalue.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/base/typevalue.py` & `pyaibox-1.1.21/pyaibox/base/typevalue.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/compression/huffman_coding.c` & `pyaibox-1.1.21/pyaibox/compression/huffman_coding.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/compression/huffman_coding.py` & `pyaibox-1.1.21/pyaibox/compression/huffman_coding.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/datasets/mnist.c` & `pyaibox-1.1.21/pyaibox/datasets/mnist.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/datasets/mnist.py` & `pyaibox-1.1.21/pyaibox/datasets/mnist.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/datasets/mnist.pyi` & `pyaibox-1.1.21/pyaibox/datasets/mnist.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/datasets/mstar.c` & `pyaibox-1.1.21/pyaibox/datasets/mstar.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/datasets/mstar.py` & `pyaibox-1.1.21/pyaibox/datasets/mstar.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/datasets/mstar.pyi` & `pyaibox-1.1.21/pyaibox/datasets/mstar.pyi`

 * *Files 5% similar despite different names*

```diff
@@ -116,8 +116,11 @@
         plt.subplot(224)
         plt.imshow(np.angle(x))
         plt.title('phase')
         plt.show()
 
     """
 
+# def read_mstar(rootdir, dataset='test', fmt='bin'):
+      ...
+
```

### Comparing `pyaibox-1.1.20/pyaibox/dsp/convolution.c` & `pyaibox-1.1.21/pyaibox/dsp/convolution.c`

 * *Files 1% similar despite different names*

```diff
@@ -1334,21 +1334,14 @@
 #define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
 #define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
 #endif
 
 /* RaiseException.proto */
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
 
-/* PyObjectCallNoArg.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
-#else
-#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
-#endif
-
 /* PyIntCompare.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, long inplace);
 
 /* PyNumberPow2.proto */
 #define __Pyx_PyNumber_InPlacePowerOf2(a, b, c) __Pyx__PyNumber_PowerOf2(a, b, c, 1)
 #define __Pyx_PyNumber_PowerOf2(a, b, c) __Pyx__PyNumber_PowerOf2(a, b, c, 0)
 static PyObject* __Pyx__PyNumber_PowerOf2(PyObject *two, PyObject *exp, PyObject *none, int inplace);
@@ -1583,15 +1576,14 @@
 static const char __pyx_k_Nh[] = "Nh";
 static const char __pyx_k_Ns[] = "Ns";
 static const char __pyx_k_Nx[] = "Nx";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_y1[] = "y1";
 static const char __pyx_k_y2[] = "y2";
 static const char __pyx_k_abs[] = "abs";
-static const char __pyx_k_any[] = "any";
 static const char __pyx_k_c2r[] = "c2r";
 static const char __pyx_k_cut[] = "cut";
 static const char __pyx_k_dot[] = "dot";
 static const char __pyx_k_eps[] = "eps";
 static const char __pyx_k_fft[] = "fft";
 static const char __pyx_k_fix[] = "fix";
 static const char __pyx_k_mod[] = "mod";
@@ -1632,18 +1624,19 @@
 static const char __pyx_k_Nextra[] = "Nextra";
 static const char __pyx_k_Nstart[] = "Nstart";
 static const char __pyx_k_hstack[] = "hstack";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_padfft[] = "padfft";
 static const char __pyx_k_ftshift[] = "ftshift";
 static const char __pyx_k_fftconv1[] = "fftconv1";
+static const char __pyx_k_keepaxis[] = "keepaxis";
 static const char __pyx_k_nextpow2[] = "nextpow2";
-static const char __pyx_k_iscomplex[] = "iscomplex";
 static const char __pyx_k_keepcaxis[] = "keepcaxis";
 static const char __pyx_k_ValueError[] = "ValueError";
+static const char __pyx_k_is_complex[] = "is_complex";
 static const char __pyx_k_cutfftconv1[] = "cutfftconv1";
 static const char __pyx_k_expand_dims[] = "expand_dims";
 static const char __pyx_k_CplxRealflag[] = "CplxRealflag";
 static const char __pyx_k_pyaibox_dsp_ffts[] = "pyaibox.dsp.ffts";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_pyaibox_base_mathops[] = "pyaibox.base.mathops";
 static const char __pyx_k_pyaibox_base_arrayops[] = "pyaibox.base.arrayops";
@@ -1672,15 +1665,14 @@
 static PyObject *__pyx_n_u_VALID;
 static PyObject *__pyx_n_u_Valid;
 static PyObject *__pyx_n_s_ValueError;
 static PyObject *__pyx_n_s_X;
 static PyObject *__pyx_n_s_Y;
 static PyObject *__pyx_n_s_abs;
 static PyObject *__pyx_n_s_angle;
-static PyObject *__pyx_n_s_any;
 static PyObject *__pyx_n_s_array;
 static PyObject *__pyx_n_s_axis;
 static PyObject *__pyx_n_s_c2r;
 static PyObject *__pyx_n_s_caxis;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_n_s_conv1;
 static PyObject *__pyx_n_s_cut;
@@ -1696,15 +1688,16 @@
 static PyObject *__pyx_n_u_full;
 static PyObject *__pyx_n_s_g;
 static PyObject *__pyx_n_s_h;
 static PyObject *__pyx_n_s_hstack;
 static PyObject *__pyx_n_s_ifft;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_int32;
-static PyObject *__pyx_n_s_iscomplex;
+static PyObject *__pyx_n_s_is_complex;
+static PyObject *__pyx_n_s_keepaxis;
 static PyObject *__pyx_n_s_keepcaxis;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_u_main;
 static PyObject *__pyx_n_s_mod;
 static PyObject *__pyx_n_s_n;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_ndim;
@@ -1732,15 +1725,15 @@
 static PyObject *__pyx_n_s_x;
 static PyObject *__pyx_n_s_y;
 static PyObject *__pyx_n_s_y1;
 static PyObject *__pyx_n_s_y2;
 static PyObject *__pyx_n_s_zeros;
 static PyObject *__pyx_pf_7pyaibox_3dsp_11convolution_conv1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_f, PyObject *__pyx_v_g, PyObject *__pyx_v_shape, CYTHON_UNUSED PyObject *__pyx_v_axis); /* proto */
 static PyObject *__pyx_pf_7pyaibox_3dsp_11convolution_2cutfftconv1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y, PyObject *__pyx_v_nfft, PyObject *__pyx_v_Nx, PyObject *__pyx_v_Nh, PyObject *__pyx_v_shape, PyObject *__pyx_v_axis, PyObject *__pyx_v_ftshift); /* proto */
-static PyObject *__pyx_pf_7pyaibox_3dsp_11convolution_4fftconv1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_h, PyObject *__pyx_v_shape, PyObject *__pyx_v_caxis, PyObject *__pyx_v_axis, PyObject *__pyx_v_keepcaxis, PyObject *__pyx_v_nfft, PyObject *__pyx_v_ftshift, PyObject *__pyx_v_eps); /* proto */
+static PyObject *__pyx_pf_7pyaibox_3dsp_11convolution_4fftconv1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_h, PyObject *__pyx_v_shape, PyObject *__pyx_v_caxis, PyObject *__pyx_v_axis, CYTHON_UNUSED PyObject *__pyx_v_keepcaxis, PyObject *__pyx_v_nfft, PyObject *__pyx_v_ftshift, PyObject *__pyx_v_eps); /* proto */
 static PyObject *__pyx_float_0_;
 static PyObject *__pyx_float_2_;
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_2;
 static PyObject *__pyx_int_3;
 static PyObject *__pyx_int_4;
@@ -3901,15 +3894,15 @@
 static PyMethodDef __pyx_mdef_7pyaibox_3dsp_11convolution_5fftconv1 = {"fftconv1", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_3dsp_11convolution_5fftconv1, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_3dsp_11convolution_4fftconv1};
 static PyObject *__pyx_pw_7pyaibox_3dsp_11convolution_5fftconv1(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_x = 0;
   PyObject *__pyx_v_h = 0;
   PyObject *__pyx_v_shape = 0;
   PyObject *__pyx_v_caxis = 0;
   PyObject *__pyx_v_axis = 0;
-  PyObject *__pyx_v_keepcaxis = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_keepcaxis = 0;
   PyObject *__pyx_v_nfft = 0;
   PyObject *__pyx_v_ftshift = 0;
   PyObject *__pyx_v_eps = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -4050,60 +4043,61 @@
   __pyx_r = __pyx_pf_7pyaibox_3dsp_11convolution_4fftconv1(__pyx_self, __pyx_v_x, __pyx_v_h, __pyx_v_shape, __pyx_v_caxis, __pyx_v_axis, __pyx_v_keepcaxis, __pyx_v_nfft, __pyx_v_ftshift, __pyx_v_eps);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_3dsp_11convolution_4fftconv1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_h, PyObject *__pyx_v_shape, PyObject *__pyx_v_caxis, PyObject *__pyx_v_axis, PyObject *__pyx_v_keepcaxis, PyObject *__pyx_v_nfft, PyObject *__pyx_v_ftshift, PyObject *__pyx_v_eps) {
+static PyObject *__pyx_pf_7pyaibox_3dsp_11convolution_4fftconv1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_h, PyObject *__pyx_v_shape, PyObject *__pyx_v_caxis, PyObject *__pyx_v_axis, CYTHON_UNUSED PyObject *__pyx_v_keepcaxis, PyObject *__pyx_v_nfft, PyObject *__pyx_v_ftshift, PyObject *__pyx_v_eps) {
   int __pyx_v_CplxRealflag;
   PyObject *__pyx_v_Nh = NULL;
   PyObject *__pyx_v_Nx = NULL;
   PyObject *__pyx_v_N = NULL;
   PyObject *__pyx_v_X = NULL;
   PyObject *__pyx_v_H = NULL;
   PyObject *__pyx_v_Y = NULL;
   PyObject *__pyx_v_y = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
+  int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_t_6;
-  int __pyx_t_7;
-  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  int __pyx_t_8;
+  PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fftconv1", 0);
   __Pyx_INCREF(__pyx_v_x);
   __Pyx_INCREF(__pyx_v_h);
   __Pyx_INCREF(__pyx_v_nfft);
 
   /* "pyaibox/dsp/convolution.py":202
  *     """
  * 
  *     CplxRealflag = False             # <<<<<<<<<<<<<<
- *     if np.iscomplex(x).any():  # complex in complex
- *         pass
+ *     if (not np.is_complex(x)) and (caxis is not None):  # complex in real
+ *         CplxRealflag = True
  */
   __pyx_v_CplxRealflag = 0;
 
   /* "pyaibox/dsp/convolution.py":203
  * 
  *     CplxRealflag = False
- *     if np.iscomplex(x).any():  # complex in complex             # <<<<<<<<<<<<<<
- *         pass
- *     else:
+ *     if (not np.is_complex(x)) and (caxis is not None):  # complex in real             # <<<<<<<<<<<<<<
+ *         CplxRealflag = True
+ *         x = r2c(x, caxis=caxis, keepaxis=True)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_iscomplex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_is_complex); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -4113,852 +4107,828 @@
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_x) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_x);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_any); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 203, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-      __Pyx_INCREF(__pyx_t_2);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_4, function);
-    }
-  }
-  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 203, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 203, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__pyx_t_5) {
-    goto __pyx_L3;
+  __pyx_t_6 = ((!__pyx_t_5) != 0);
+  if (__pyx_t_6) {
+  } else {
+    __pyx_t_1 = __pyx_t_6;
+    goto __pyx_L4_bool_binop_done;
   }
+  __pyx_t_6 = (__pyx_v_caxis != Py_None);
+  __pyx_t_5 = (__pyx_t_6 != 0);
+  __pyx_t_1 = __pyx_t_5;
+  __pyx_L4_bool_binop_done:;
+  if (__pyx_t_1) {
 
-  /* "pyaibox/dsp/convolution.py":206
- *         pass
- *     else:
- *         if caxis is None:  # real             # <<<<<<<<<<<<<<
- *             pass
- *         else:  # complex in real
+    /* "pyaibox/dsp/convolution.py":204
+ *     CplxRealflag = False
+ *     if (not np.is_complex(x)) and (caxis is not None):  # complex in real
+ *         CplxRealflag = True             # <<<<<<<<<<<<<<
+ *         x = r2c(x, caxis=caxis, keepaxis=True)
+ *         h = r2c(h, caxis=caxis, keepaxis=True)
  */
-  /*else*/ {
-    __pyx_t_5 = (__pyx_v_caxis == Py_None);
-    __pyx_t_6 = (__pyx_t_5 != 0);
-    if (__pyx_t_6) {
-      goto __pyx_L4;
-    }
+    __pyx_v_CplxRealflag = 1;
 
-    /* "pyaibox/dsp/convolution.py":209
- *             pass
- *         else:  # complex in real
- *             CplxRealflag = True             # <<<<<<<<<<<<<<
- *             x = r2c(x, caxis=caxis, keepcaxis=keepcaxis)
- *             h = r2c(h, caxis=caxis, keepcaxis=keepcaxis)
+    /* "pyaibox/dsp/convolution.py":205
+ *     if (not np.is_complex(x)) and (caxis is not None):  # complex in real
+ *         CplxRealflag = True
+ *         x = r2c(x, caxis=caxis, keepaxis=True)             # <<<<<<<<<<<<<<
+ *         h = r2c(h, caxis=caxis, keepaxis=True)
+ * 
  */
-    /*else*/ {
-      __pyx_v_CplxRealflag = 1;
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_r2c); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 205, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 205, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_INCREF(__pyx_v_x);
+    __Pyx_GIVEREF(__pyx_v_x);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_x);
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 205, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_v_caxis) < 0) __PYX_ERR(0, 205, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_keepaxis, Py_True) < 0) __PYX_ERR(0, 205, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 205, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_7);
+    __pyx_t_7 = 0;
 
-      /* "pyaibox/dsp/convolution.py":210
- *         else:  # complex in real
- *             CplxRealflag = True
- *             x = r2c(x, caxis=caxis, keepcaxis=keepcaxis)             # <<<<<<<<<<<<<<
- *             h = r2c(h, caxis=caxis, keepcaxis=keepcaxis)
+    /* "pyaibox/dsp/convolution.py":206
+ *         CplxRealflag = True
+ *         x = r2c(x, caxis=caxis, keepaxis=True)
+ *         h = r2c(h, caxis=caxis, keepaxis=True)             # <<<<<<<<<<<<<<
  * 
+ *     if np.ndim(h) == 1 and axis > 0:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_r2c); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 210, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 210, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_INCREF(__pyx_v_x);
-      __Pyx_GIVEREF(__pyx_v_x);
-      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_x);
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 210, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_caxis, __pyx_v_caxis) < 0) __PYX_ERR(0, 210, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_keepcaxis, __pyx_v_keepcaxis) < 0) __PYX_ERR(0, 210, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 210, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_3);
-      __pyx_t_3 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_r2c); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 206, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 206, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_INCREF(__pyx_v_h);
+    __Pyx_GIVEREF(__pyx_v_h);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_h);
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 206, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, __pyx_v_caxis) < 0) __PYX_ERR(0, 206, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_keepaxis, Py_True) < 0) __PYX_ERR(0, 206, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 206, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF_SET(__pyx_v_h, __pyx_t_2);
+    __pyx_t_2 = 0;
 
-      /* "pyaibox/dsp/convolution.py":211
- *             CplxRealflag = True
- *             x = r2c(x, caxis=caxis, keepcaxis=keepcaxis)
- *             h = r2c(h, caxis=caxis, keepcaxis=keepcaxis)             # <<<<<<<<<<<<<<
+    /* "pyaibox/dsp/convolution.py":203
  * 
- *     if np.ndim(h) == 1 and axis > 0:
+ *     CplxRealflag = False
+ *     if (not np.is_complex(x)) and (caxis is not None):  # complex in real             # <<<<<<<<<<<<<<
+ *         CplxRealflag = True
+ *         x = r2c(x, caxis=caxis, keepaxis=True)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_r2c); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 211, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_INCREF(__pyx_v_h);
-      __Pyx_GIVEREF(__pyx_v_h);
-      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_h);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 211, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, __pyx_v_caxis) < 0) __PYX_ERR(0, 211, __pyx_L1_error)
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_keepcaxis, __pyx_v_keepcaxis) < 0) __PYX_ERR(0, 211, __pyx_L1_error)
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF_SET(__pyx_v_h, __pyx_t_1);
-      __pyx_t_1 = 0;
-    }
-    __pyx_L4:;
   }
-  __pyx_L3:;
 
-  /* "pyaibox/dsp/convolution.py":213
- *             h = r2c(h, caxis=caxis, keepcaxis=keepcaxis)
+  /* "pyaibox/dsp/convolution.py":208
+ *         h = r2c(h, caxis=caxis, keepaxis=True)
  * 
  *     if np.ndim(h) == 1 and axis > 0:             # <<<<<<<<<<<<<<
  *         h = np.expand_dims(h, list(range(axis)))
  *     Nh = np.size(h, axis)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ndim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 208, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_h) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_h);
+  __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_h) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_h);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 208, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 208, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_5) {
   } else {
-    __pyx_t_6 = __pyx_t_5;
-    goto __pyx_L6_bool_binop_done;
+    __pyx_t_1 = __pyx_t_5;
+    goto __pyx_L7_bool_binop_done;
   }
-  __pyx_t_2 = PyObject_RichCompare(__pyx_v_axis, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 213, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_6 = __pyx_t_5;
-  __pyx_L6_bool_binop_done:;
-  if (__pyx_t_6) {
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_axis, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 208, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 208, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_1 = __pyx_t_5;
+  __pyx_L7_bool_binop_done:;
+  if (__pyx_t_1) {
 
-    /* "pyaibox/dsp/convolution.py":214
+    /* "pyaibox/dsp/convolution.py":209
  * 
  *     if np.ndim(h) == 1 and axis > 0:
  *         h = np.expand_dims(h, list(range(axis)))             # <<<<<<<<<<<<<<
  *     Nh = np.size(h, axis)
  *     Nx = np.size(x, axis)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_expand_dims); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 214, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_expand_dims); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_axis); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = NULL;
-    __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_axis); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_7 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    __pyx_t_8 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
-      if (likely(__pyx_t_1)) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
+      if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-        __Pyx_INCREF(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
-        __pyx_t_7 = 1;
+        __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_4)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_h, __pyx_t_3};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_h, __pyx_t_7};
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 209, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_h, __pyx_t_3};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_h, __pyx_t_7};
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 209, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 214, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      if (__pyx_t_1) {
-        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1); __pyx_t_1 = NULL;
+      __pyx_t_9 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 209, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      if (__pyx_t_2) {
+        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_INCREF(__pyx_v_h);
       __Pyx_GIVEREF(__pyx_v_h);
-      PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_h);
-      __Pyx_GIVEREF(__pyx_t_3);
-      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_3);
-      __pyx_t_3 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_h);
+      __Pyx_GIVEREF(__pyx_t_7);
+      PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_t_7);
+      __pyx_t_7 = 0;
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 209, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF_SET(__pyx_v_h, __pyx_t_2);
-    __pyx_t_2 = 0;
+    __Pyx_DECREF_SET(__pyx_v_h, __pyx_t_3);
+    __pyx_t_3 = 0;
 
-    /* "pyaibox/dsp/convolution.py":213
- *             h = r2c(h, caxis=caxis, keepcaxis=keepcaxis)
+    /* "pyaibox/dsp/convolution.py":208
+ *         h = r2c(h, caxis=caxis, keepaxis=True)
  * 
  *     if np.ndim(h) == 1 and axis > 0:             # <<<<<<<<<<<<<<
  *         h = np.expand_dims(h, list(range(axis)))
  *     Nh = np.size(h, axis)
  */
   }
 
-  /* "pyaibox/dsp/convolution.py":215
+  /* "pyaibox/dsp/convolution.py":210
  *     if np.ndim(h) == 1 and axis > 0:
  *         h = np.expand_dims(h, list(range(axis)))
  *     Nh = np.size(h, axis)             # <<<<<<<<<<<<<<
  *     Nx = np.size(x, axis)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 210, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 215, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_8);
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_size); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 210, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
-  __pyx_t_7 = 0;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
+  __pyx_t_8 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_9);
     if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_8, function);
-      __pyx_t_7 = 1;
+      __Pyx_DECREF_SET(__pyx_t_9, function);
+      __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
-  if (PyFunction_Check(__pyx_t_8)) {
+  if (PyFunction_Check(__pyx_t_9)) {
     PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_h, __pyx_v_axis};
-    __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 210, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
-  if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
     PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_h, __pyx_v_axis};
-    __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 210, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   {
-    __pyx_t_3 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 215, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_7 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 210, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
     if (__pyx_t_4) {
-      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
+      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_v_h);
     __Pyx_GIVEREF(__pyx_v_h);
-    PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_7, __pyx_v_h);
+    PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_8, __pyx_v_h);
     __Pyx_INCREF(__pyx_v_axis);
     __Pyx_GIVEREF(__pyx_v_axis);
-    PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_7, __pyx_v_axis);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_8, __pyx_v_axis);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 210, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
-  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_v_Nh = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+  __pyx_v_Nh = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "pyaibox/dsp/convolution.py":216
+  /* "pyaibox/dsp/convolution.py":211
  *         h = np.expand_dims(h, list(range(axis)))
  *     Nh = np.size(h, axis)
  *     Nx = np.size(x, axis)             # <<<<<<<<<<<<<<
  * 
  *     N = Nx + Nh - 1
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 216, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 216, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = NULL;
-  __pyx_t_7 = 0;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_8)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_8);
+  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 211, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 211, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+  __pyx_t_9 = NULL;
+  __pyx_t_8 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
+    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_7);
+    if (likely(__pyx_t_9)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+      __Pyx_INCREF(__pyx_t_9);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
-      __pyx_t_7 = 1;
+      __Pyx_DECREF_SET(__pyx_t_7, function);
+      __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
-  if (PyFunction_Check(__pyx_t_3)) {
-    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_x, __pyx_v_axis};
-    __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 216, __pyx_L1_error)
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+  if (PyFunction_Check(__pyx_t_7)) {
+    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_x, __pyx_v_axis};
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
-  if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
-    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_x, __pyx_v_axis};
-    __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 216, __pyx_L1_error)
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
+    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_x, __pyx_v_axis};
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   {
-    __pyx_t_4 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 216, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 211, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (__pyx_t_8) {
-      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8); __pyx_t_8 = NULL;
+    if (__pyx_t_9) {
+      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_9); __pyx_t_9 = NULL;
     }
     __Pyx_INCREF(__pyx_v_x);
     __Pyx_GIVEREF(__pyx_v_x);
-    PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_v_x);
+    PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_8, __pyx_v_x);
     __Pyx_INCREF(__pyx_v_axis);
     __Pyx_GIVEREF(__pyx_v_axis);
-    PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_v_axis);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 216, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_8, __pyx_v_axis);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_Nx = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_v_Nx = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "pyaibox/dsp/convolution.py":218
+  /* "pyaibox/dsp/convolution.py":213
  *     Nx = np.size(x, axis)
  * 
  *     N = Nx + Nh - 1             # <<<<<<<<<<<<<<
  *     if nfft is None:
  *         nfft = 2**nextpow2(N)
  */
-  __pyx_t_2 = PyNumber_Add(__pyx_v_Nx, __pyx_v_Nh); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 218, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 218, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_v_Nx, __pyx_v_Nh); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_N = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_N = __pyx_t_7;
+  __pyx_t_7 = 0;
 
-  /* "pyaibox/dsp/convolution.py":219
+  /* "pyaibox/dsp/convolution.py":214
  * 
  *     N = Nx + Nh - 1
  *     if nfft is None:             # <<<<<<<<<<<<<<
  *         nfft = 2**nextpow2(N)
  *     else:
  */
-  __pyx_t_6 = (__pyx_v_nfft == Py_None);
-  __pyx_t_5 = (__pyx_t_6 != 0);
+  __pyx_t_1 = (__pyx_v_nfft == Py_None);
+  __pyx_t_5 = (__pyx_t_1 != 0);
   if (__pyx_t_5) {
 
-    /* "pyaibox/dsp/convolution.py":220
+    /* "pyaibox/dsp/convolution.py":215
  *     N = Nx + Nh - 1
  *     if nfft is None:
  *         nfft = 2**nextpow2(N)             # <<<<<<<<<<<<<<
  *     else:
  *         if nfft < N:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_nextpow2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_N) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_N);
+    __pyx_t_7 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_N) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_N);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 220, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyNumber_PowerOf2(__pyx_int_2, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF_SET(__pyx_v_nfft, __pyx_t_2);
-    __pyx_t_2 = 0;
+    __pyx_t_3 = __Pyx_PyNumber_PowerOf2(__pyx_int_2, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF_SET(__pyx_v_nfft, __pyx_t_3);
+    __pyx_t_3 = 0;
 
-    /* "pyaibox/dsp/convolution.py":219
+    /* "pyaibox/dsp/convolution.py":214
  * 
  *     N = Nx + Nh - 1
  *     if nfft is None:             # <<<<<<<<<<<<<<
  *         nfft = 2**nextpow2(N)
  *     else:
  */
-    goto __pyx_L8;
+    goto __pyx_L9;
   }
 
-  /* "pyaibox/dsp/convolution.py":222
+  /* "pyaibox/dsp/convolution.py":217
  *         nfft = 2**nextpow2(N)
  *     else:
  *         if nfft < N:             # <<<<<<<<<<<<<<
  *             raise ValueError("~~~To get right results, nfft must be larger than Nx+Nh-1!")
  * 
  */
   /*else*/ {
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_nfft, __pyx_v_N, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 222, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 222, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_nfft, __pyx_v_N, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 217, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 217, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (unlikely(__pyx_t_5)) {
 
-      /* "pyaibox/dsp/convolution.py":223
+      /* "pyaibox/dsp/convolution.py":218
  *     else:
  *         if nfft < N:
  *             raise ValueError("~~~To get right results, nfft must be larger than Nx+Nh-1!")             # <<<<<<<<<<<<<<
  * 
  *     x = padfft(x, nfft, axis, ftshift)
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 223, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 223, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 218, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_Raise(__pyx_t_3, 0, 0, 0);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __PYX_ERR(0, 218, __pyx_L1_error)
 
-      /* "pyaibox/dsp/convolution.py":222
+      /* "pyaibox/dsp/convolution.py":217
  *         nfft = 2**nextpow2(N)
  *     else:
  *         if nfft < N:             # <<<<<<<<<<<<<<
  *             raise ValueError("~~~To get right results, nfft must be larger than Nx+Nh-1!")
  * 
  */
     }
   }
-  __pyx_L8:;
+  __pyx_L9:;
 
-  /* "pyaibox/dsp/convolution.py":225
+  /* "pyaibox/dsp/convolution.py":220
  *             raise ValueError("~~~To get right results, nfft must be larger than Nx+Nh-1!")
  * 
  *     x = padfft(x, nfft, axis, ftshift)             # <<<<<<<<<<<<<<
  *     h = padfft(h, nfft, axis, ftshift)
  *     X = fft(x, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_padfft); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_padfft); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 220, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_4 = NULL;
-  __pyx_t_7 = 0;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+  __pyx_t_8 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
-      __pyx_t_7 = 1;
+      __Pyx_DECREF_SET(__pyx_t_7, function);
+      __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
-  if (PyFunction_Check(__pyx_t_3)) {
+  if (PyFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[5] = {__pyx_t_4, __pyx_v_x, __pyx_v_nfft, __pyx_v_axis, __pyx_v_ftshift};
-    __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 220, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
-  if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[5] = {__pyx_t_4, __pyx_v_x, __pyx_v_nfft, __pyx_v_axis, __pyx_v_ftshift};
-    __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 220, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   {
-    __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 225, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_8);
+    __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
     if (__pyx_t_4) {
-      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_4); __pyx_t_4 = NULL;
+      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_v_x);
     __Pyx_GIVEREF(__pyx_v_x);
-    PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_x);
+    PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_x);
     __Pyx_INCREF(__pyx_v_nfft);
     __Pyx_GIVEREF(__pyx_v_nfft);
-    PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_nfft);
+    PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_v_nfft);
     __Pyx_INCREF(__pyx_v_axis);
     __Pyx_GIVEREF(__pyx_v_axis);
-    PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_v_axis);
+    PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_v_axis);
     __Pyx_INCREF(__pyx_v_ftshift);
     __Pyx_GIVEREF(__pyx_v_ftshift);
-    PyTuple_SET_ITEM(__pyx_t_8, 3+__pyx_t_7, __pyx_v_ftshift);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_v_ftshift);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   }
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "pyaibox/dsp/convolution.py":226
+  /* "pyaibox/dsp/convolution.py":221
  * 
  *     x = padfft(x, nfft, axis, ftshift)
  *     h = padfft(h, nfft, axis, ftshift)             # <<<<<<<<<<<<<<
  *     X = fft(x, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     H = fft(h, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_padfft); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_8 = NULL;
-  __pyx_t_7 = 0;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_8)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_8);
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_padfft); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 221, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_9 = NULL;
+  __pyx_t_8 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
+    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_7);
+    if (likely(__pyx_t_9)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+      __Pyx_INCREF(__pyx_t_9);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
-      __pyx_t_7 = 1;
+      __Pyx_DECREF_SET(__pyx_t_7, function);
+      __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
-  if (PyFunction_Check(__pyx_t_3)) {
-    PyObject *__pyx_temp[5] = {__pyx_t_8, __pyx_v_h, __pyx_v_nfft, __pyx_v_axis, __pyx_v_ftshift};
-    __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+  if (PyFunction_Check(__pyx_t_7)) {
+    PyObject *__pyx_temp[5] = {__pyx_t_9, __pyx_v_h, __pyx_v_nfft, __pyx_v_axis, __pyx_v_ftshift};
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 221, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
-  if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
-    PyObject *__pyx_temp[5] = {__pyx_t_8, __pyx_v_h, __pyx_v_nfft, __pyx_v_axis, __pyx_v_ftshift};
-    __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __Pyx_GOTREF(__pyx_t_2);
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
+    PyObject *__pyx_temp[5] = {__pyx_t_9, __pyx_v_h, __pyx_v_nfft, __pyx_v_axis, __pyx_v_ftshift};
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 221, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_GOTREF(__pyx_t_3);
   } else
   #endif
   {
-    __pyx_t_4 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 221, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (__pyx_t_8) {
-      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8); __pyx_t_8 = NULL;
+    if (__pyx_t_9) {
+      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_9); __pyx_t_9 = NULL;
     }
     __Pyx_INCREF(__pyx_v_h);
     __Pyx_GIVEREF(__pyx_v_h);
-    PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_v_h);
+    PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_8, __pyx_v_h);
     __Pyx_INCREF(__pyx_v_nfft);
     __Pyx_GIVEREF(__pyx_v_nfft);
-    PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_v_nfft);
+    PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_8, __pyx_v_nfft);
     __Pyx_INCREF(__pyx_v_axis);
     __Pyx_GIVEREF(__pyx_v_axis);
-    PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_7, __pyx_v_axis);
+    PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_8, __pyx_v_axis);
     __Pyx_INCREF(__pyx_v_ftshift);
     __Pyx_GIVEREF(__pyx_v_ftshift);
-    PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_7, __pyx_v_ftshift);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_8, __pyx_v_ftshift);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 221, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF_SET(__pyx_v_h, __pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_DECREF_SET(__pyx_v_h, __pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "pyaibox/dsp/convolution.py":227
+  /* "pyaibox/dsp/convolution.py":222
  *     x = padfft(x, nfft, axis, ftshift)
  *     h = padfft(h, nfft, axis, ftshift)
  *     X = fft(x, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)             # <<<<<<<<<<<<<<
  *     H = fft(h, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     Y = X * H
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_fft); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 227, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fft); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 222, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(__pyx_v_x);
   __Pyx_GIVEREF(__pyx_v_x);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_x);
+  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_x);
   __Pyx_INCREF(__pyx_v_nfft);
   __Pyx_GIVEREF(__pyx_v_nfft);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_nfft);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 227, __pyx_L1_error)
+  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_nfft);
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, Py_None) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_axis) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_keepcaxis, Py_False) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_norm, Py_None) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_shift, __pyx_v_ftshift) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 227, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_8);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, Py_None) < 0) __PYX_ERR(0, 222, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_axis) < 0) __PYX_ERR(0, 222, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_keepcaxis, Py_False) < 0) __PYX_ERR(0, 222, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_norm, Py_None) < 0) __PYX_ERR(0, 222, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_shift, __pyx_v_ftshift) < 0) __PYX_ERR(0, 222, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 222, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_X = __pyx_t_8;
-  __pyx_t_8 = 0;
+  __pyx_v_X = __pyx_t_9;
+  __pyx_t_9 = 0;
 
-  /* "pyaibox/dsp/convolution.py":228
+  /* "pyaibox/dsp/convolution.py":223
  *     h = padfft(h, nfft, axis, ftshift)
  *     X = fft(x, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     H = fft(h, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)             # <<<<<<<<<<<<<<
  *     Y = X * H
  *     y = ifft(Y, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_fft); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 228, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 228, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_fft); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 223, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_h);
   __Pyx_GIVEREF(__pyx_v_h);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_h);
   __Pyx_INCREF(__pyx_v_nfft);
   __Pyx_GIVEREF(__pyx_v_nfft);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_nfft);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 228, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 223, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_caxis, Py_None) < 0) __PYX_ERR(0, 223, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_v_axis) < 0) __PYX_ERR(0, 223, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_keepcaxis, Py_False) < 0) __PYX_ERR(0, 223, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_norm, Py_None) < 0) __PYX_ERR(0, 223, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_shift, __pyx_v_ftshift) < 0) __PYX_ERR(0, 223, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, Py_None) < 0) __PYX_ERR(0, 228, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_v_axis) < 0) __PYX_ERR(0, 228, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_keepcaxis, Py_False) < 0) __PYX_ERR(0, 228, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_norm, Py_None) < 0) __PYX_ERR(0, 228, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_shift, __pyx_v_ftshift) < 0) __PYX_ERR(0, 228, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_H = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_v_H = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "pyaibox/dsp/convolution.py":229
+  /* "pyaibox/dsp/convolution.py":224
  *     X = fft(x, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     H = fft(h, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     Y = X * H             # <<<<<<<<<<<<<<
  *     y = ifft(Y, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     y = cutfftconv1(y, nfft, Nx, Nh, shape, axis, ftshift)
  */
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_X, __pyx_v_H); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 229, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_v_Y = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_X, __pyx_v_H); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 224, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_v_Y = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "pyaibox/dsp/convolution.py":230
+  /* "pyaibox/dsp/convolution.py":225
  *     H = fft(h, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     Y = X * H
  *     y = ifft(Y, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)             # <<<<<<<<<<<<<<
  *     y = cutfftconv1(y, nfft, Nx, Nh, shape, axis, ftshift)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_ifft); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 230, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_ifft); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(__pyx_v_Y);
   __Pyx_GIVEREF(__pyx_v_Y);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_Y);
+  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_Y);
   __Pyx_INCREF(__pyx_v_nfft);
   __Pyx_GIVEREF(__pyx_v_nfft);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_nfft);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 230, __pyx_L1_error)
+  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_nfft);
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, Py_None) < 0) __PYX_ERR(0, 230, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_axis) < 0) __PYX_ERR(0, 230, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_keepcaxis, Py_False) < 0) __PYX_ERR(0, 230, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_norm, Py_None) < 0) __PYX_ERR(0, 230, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_shift, __pyx_v_ftshift) < 0) __PYX_ERR(0, 230, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 230, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_8);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_caxis, Py_None) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_v_axis) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_keepcaxis, Py_False) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_norm, Py_None) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_shift, __pyx_v_ftshift) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_y = __pyx_t_8;
-  __pyx_t_8 = 0;
+  __pyx_v_y = __pyx_t_9;
+  __pyx_t_9 = 0;
 
-  /* "pyaibox/dsp/convolution.py":231
+  /* "pyaibox/dsp/convolution.py":226
  *     Y = X * H
  *     y = ifft(Y, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
  *     y = cutfftconv1(y, nfft, Nx, Nh, shape, axis, ftshift)             # <<<<<<<<<<<<<<
  * 
  *     if eps is not None:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_cutfftconv1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 231, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_cutfftconv1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = NULL;
-  __pyx_t_7 = 0;
+  __pyx_t_7 = NULL;
+  __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
-    if (likely(__pyx_t_3)) {
+    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_7)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_7);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
-      __pyx_t_7 = 1;
+      __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_4)) {
-    PyObject *__pyx_temp[8] = {__pyx_t_3, __pyx_v_y, __pyx_v_nfft, __pyx_v_Nx, __pyx_v_Nh, __pyx_v_shape, __pyx_v_axis, __pyx_v_ftshift};
-    __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 7+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 231, __pyx_L1_error)
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GOTREF(__pyx_t_8);
+    PyObject *__pyx_temp[8] = {__pyx_t_7, __pyx_v_y, __pyx_v_nfft, __pyx_v_Nx, __pyx_v_Nh, __pyx_v_shape, __pyx_v_axis, __pyx_v_ftshift};
+    __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 7+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_GOTREF(__pyx_t_9);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
-    PyObject *__pyx_temp[8] = {__pyx_t_3, __pyx_v_y, __pyx_v_nfft, __pyx_v_Nx, __pyx_v_Nh, __pyx_v_shape, __pyx_v_axis, __pyx_v_ftshift};
-    __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 7+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 231, __pyx_L1_error)
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GOTREF(__pyx_t_8);
+    PyObject *__pyx_temp[8] = {__pyx_t_7, __pyx_v_y, __pyx_v_nfft, __pyx_v_Nx, __pyx_v_Nh, __pyx_v_shape, __pyx_v_axis, __pyx_v_ftshift};
+    __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 7+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_GOTREF(__pyx_t_9);
   } else
   #endif
   {
-    __pyx_t_2 = PyTuple_New(7+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 231, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    if (__pyx_t_3) {
-      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
+    __pyx_t_3 = PyTuple_New(7+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    if (__pyx_t_7) {
+      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7); __pyx_t_7 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y);
     __Pyx_GIVEREF(__pyx_v_y);
-    PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_7, __pyx_v_y);
+    PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_y);
     __Pyx_INCREF(__pyx_v_nfft);
     __Pyx_GIVEREF(__pyx_v_nfft);
-    PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_7, __pyx_v_nfft);
+    PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_v_nfft);
     __Pyx_INCREF(__pyx_v_Nx);
     __Pyx_GIVEREF(__pyx_v_Nx);
-    PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_7, __pyx_v_Nx);
+    PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_8, __pyx_v_Nx);
     __Pyx_INCREF(__pyx_v_Nh);
     __Pyx_GIVEREF(__pyx_v_Nh);
-    PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_7, __pyx_v_Nh);
+    PyTuple_SET_ITEM(__pyx_t_3, 3+__pyx_t_8, __pyx_v_Nh);
     __Pyx_INCREF(__pyx_v_shape);
     __Pyx_GIVEREF(__pyx_v_shape);
-    PyTuple_SET_ITEM(__pyx_t_2, 4+__pyx_t_7, __pyx_v_shape);
+    PyTuple_SET_ITEM(__pyx_t_3, 4+__pyx_t_8, __pyx_v_shape);
     __Pyx_INCREF(__pyx_v_axis);
     __Pyx_GIVEREF(__pyx_v_axis);
-    PyTuple_SET_ITEM(__pyx_t_2, 5+__pyx_t_7, __pyx_v_axis);
+    PyTuple_SET_ITEM(__pyx_t_3, 5+__pyx_t_8, __pyx_v_axis);
     __Pyx_INCREF(__pyx_v_ftshift);
     __Pyx_GIVEREF(__pyx_v_ftshift);
-    PyTuple_SET_ITEM(__pyx_t_2, 6+__pyx_t_7, __pyx_v_ftshift);
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 231, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    PyTuple_SET_ITEM(__pyx_t_3, 6+__pyx_t_8, __pyx_v_ftshift);
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF_SET(__pyx_v_y, __pyx_t_8);
-  __pyx_t_8 = 0;
+  __Pyx_DECREF_SET(__pyx_v_y, __pyx_t_9);
+  __pyx_t_9 = 0;
 
-  /* "pyaibox/dsp/convolution.py":233
+  /* "pyaibox/dsp/convolution.py":228
  *     y = cutfftconv1(y, nfft, Nx, Nh, shape, axis, ftshift)
  * 
  *     if eps is not None:             # <<<<<<<<<<<<<<
  *         y[abs(y) < eps] = 0.
  * 
  */
   __pyx_t_5 = (__pyx_v_eps != Py_None);
-  __pyx_t_6 = (__pyx_t_5 != 0);
-  if (__pyx_t_6) {
+  __pyx_t_1 = (__pyx_t_5 != 0);
+  if (__pyx_t_1) {
 
-    /* "pyaibox/dsp/convolution.py":234
+    /* "pyaibox/dsp/convolution.py":229
  * 
  *     if eps is not None:
  *         y[abs(y) < eps] = 0.             # <<<<<<<<<<<<<<
  * 
  *     if CplxRealflag:
  */
-    __pyx_t_8 = __Pyx_PyNumber_Absolute(__pyx_v_y); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 234, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = PyObject_RichCompare(__pyx_t_8, __pyx_v_eps, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_y, __pyx_t_4, __pyx_float_0_) < 0)) __PYX_ERR(0, 234, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyNumber_Absolute(__pyx_v_y); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 229, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_4 = PyObject_RichCompare(__pyx_t_9, __pyx_v_eps, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 229, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    if (unlikely(PyObject_SetItem(__pyx_v_y, __pyx_t_4, __pyx_float_0_) < 0)) __PYX_ERR(0, 229, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "pyaibox/dsp/convolution.py":233
+    /* "pyaibox/dsp/convolution.py":228
  *     y = cutfftconv1(y, nfft, Nx, Nh, shape, axis, ftshift)
  * 
  *     if eps is not None:             # <<<<<<<<<<<<<<
  *         y[abs(y) < eps] = 0.
  * 
  */
   }
 
-  /* "pyaibox/dsp/convolution.py":236
+  /* "pyaibox/dsp/convolution.py":231
  *         y[abs(y) < eps] = 0.
  * 
  *     if CplxRealflag:             # <<<<<<<<<<<<<<
- *         y = c2r(y, caxis=caxis, keepcaxis=not keepcaxis)
+ *         y = c2r(y, caxis=caxis, keepaxis=True)
  * 
  */
-  __pyx_t_6 = (__pyx_v_CplxRealflag != 0);
-  if (__pyx_t_6) {
+  __pyx_t_1 = (__pyx_v_CplxRealflag != 0);
+  if (__pyx_t_1) {
 
-    /* "pyaibox/dsp/convolution.py":237
+    /* "pyaibox/dsp/convolution.py":232
  * 
  *     if CplxRealflag:
- *         y = c2r(y, caxis=caxis, keepcaxis=not keepcaxis)             # <<<<<<<<<<<<<<
+ *         y = c2r(y, caxis=caxis, keepaxis=True)             # <<<<<<<<<<<<<<
  * 
  *     return y
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_c2r); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_c2r); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 232, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 237, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_8);
+    __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 232, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
     __Pyx_INCREF(__pyx_v_y);
     __Pyx_GIVEREF(__pyx_v_y);
-    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_y);
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_caxis, __pyx_v_caxis) < 0) __PYX_ERR(0, 237, __pyx_L1_error)
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_keepcaxis); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 237, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyBool_FromLong((!__pyx_t_6)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_keepcaxis, __pyx_t_3) < 0) __PYX_ERR(0, 237, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_v_y);
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 232, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_caxis, __pyx_v_caxis) < 0) __PYX_ERR(0, 232, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_keepaxis, Py_True) < 0) __PYX_ERR(0, 232, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_9, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 232, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF_SET(__pyx_v_y, __pyx_t_3);
-    __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF_SET(__pyx_v_y, __pyx_t_7);
+    __pyx_t_7 = 0;
 
-    /* "pyaibox/dsp/convolution.py":236
+    /* "pyaibox/dsp/convolution.py":231
  *         y[abs(y) < eps] = 0.
  * 
  *     if CplxRealflag:             # <<<<<<<<<<<<<<
- *         y = c2r(y, caxis=caxis, keepcaxis=not keepcaxis)
+ *         y = c2r(y, caxis=caxis, keepaxis=True)
  * 
  */
   }
 
-  /* "pyaibox/dsp/convolution.py":239
- *         y = c2r(y, caxis=caxis, keepcaxis=not keepcaxis)
+  /* "pyaibox/dsp/convolution.py":234
+ *         y = c2r(y, caxis=caxis, keepaxis=True)
  * 
  *     return y             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_y);
@@ -4971,19 +4941,19 @@
  * def fftconv1(x, h, shape='same', caxis=None, axis=0, keepcaxis=False, nfft=None, ftshift=False, eps=None):             # <<<<<<<<<<<<<<
  *     """Convolution using Fast Fourier Transformation
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_9);
   __Pyx_AddTraceback("pyaibox.dsp.convolution.fftconv1", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_Nh);
   __Pyx_XDECREF(__pyx_v_Nx);
   __Pyx_XDECREF(__pyx_v_N);
   __Pyx_XDECREF(__pyx_v_X);
@@ -5066,15 +5036,14 @@
   {&__pyx_n_u_VALID, __pyx_k_VALID, sizeof(__pyx_k_VALID), 0, 1, 0, 1},
   {&__pyx_n_u_Valid, __pyx_k_Valid, sizeof(__pyx_k_Valid), 0, 1, 0, 1},
   {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
   {&__pyx_n_s_X, __pyx_k_X, sizeof(__pyx_k_X), 0, 0, 1, 1},
   {&__pyx_n_s_Y, __pyx_k_Y, sizeof(__pyx_k_Y), 0, 0, 1, 1},
   {&__pyx_n_s_abs, __pyx_k_abs, sizeof(__pyx_k_abs), 0, 0, 1, 1},
   {&__pyx_n_s_angle, __pyx_k_angle, sizeof(__pyx_k_angle), 0, 0, 1, 1},
-  {&__pyx_n_s_any, __pyx_k_any, sizeof(__pyx_k_any), 0, 0, 1, 1},
   {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
   {&__pyx_n_s_axis, __pyx_k_axis, sizeof(__pyx_k_axis), 0, 0, 1, 1},
   {&__pyx_n_s_c2r, __pyx_k_c2r, sizeof(__pyx_k_c2r), 0, 0, 1, 1},
   {&__pyx_n_s_caxis, __pyx_k_caxis, sizeof(__pyx_k_caxis), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_n_s_conv1, __pyx_k_conv1, sizeof(__pyx_k_conv1), 0, 0, 1, 1},
   {&__pyx_n_s_cut, __pyx_k_cut, sizeof(__pyx_k_cut), 0, 0, 1, 1},
@@ -5090,15 +5059,16 @@
   {&__pyx_n_u_full, __pyx_k_full, sizeof(__pyx_k_full), 0, 1, 0, 1},
   {&__pyx_n_s_g, __pyx_k_g, sizeof(__pyx_k_g), 0, 0, 1, 1},
   {&__pyx_n_s_h, __pyx_k_h, sizeof(__pyx_k_h), 0, 0, 1, 1},
   {&__pyx_n_s_hstack, __pyx_k_hstack, sizeof(__pyx_k_hstack), 0, 0, 1, 1},
   {&__pyx_n_s_ifft, __pyx_k_ifft, sizeof(__pyx_k_ifft), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_int32, __pyx_k_int32, sizeof(__pyx_k_int32), 0, 0, 1, 1},
-  {&__pyx_n_s_iscomplex, __pyx_k_iscomplex, sizeof(__pyx_k_iscomplex), 0, 0, 1, 1},
+  {&__pyx_n_s_is_complex, __pyx_k_is_complex, sizeof(__pyx_k_is_complex), 0, 0, 1, 1},
+  {&__pyx_n_s_keepaxis, __pyx_k_keepaxis, sizeof(__pyx_k_keepaxis), 0, 0, 1, 1},
   {&__pyx_n_s_keepcaxis, __pyx_k_keepcaxis, sizeof(__pyx_k_keepcaxis), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_u_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 1, 0, 1},
   {&__pyx_n_s_mod, __pyx_k_mod, sizeof(__pyx_k_mod), 0, 0, 1, 1},
   {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
@@ -5127,15 +5097,15 @@
   {&__pyx_n_s_y, __pyx_k_y, sizeof(__pyx_k_y), 0, 0, 1, 1},
   {&__pyx_n_s_y1, __pyx_k_y1, sizeof(__pyx_k_y1), 0, 0, 1, 1},
   {&__pyx_n_s_y2, __pyx_k_y2, sizeof(__pyx_k_y2), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 253, __pyx_L1_error)
+  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 248, __pyx_L1_error)
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 76, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 129, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
@@ -5643,61 +5613,61 @@
  */
   __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_3dsp_11convolution_5fftconv1, 0, __pyx_n_s_fftconv1, NULL, __pyx_n_s_pyaibox_dsp_convolution, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_tuple__11);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_fftconv1, __pyx_t_2) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "pyaibox/dsp/convolution.py":242
+  /* "pyaibox/dsp/convolution.py":237
  * 
  * 
  * if __name__ == '__main__':             # <<<<<<<<<<<<<<
  * 
  *     ftshift = False
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_name); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_name); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_main, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 242, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_main, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 237, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "pyaibox/dsp/convolution.py":244
+    /* "pyaibox/dsp/convolution.py":239
  * if __name__ == '__main__':
  * 
  *     ftshift = False             # <<<<<<<<<<<<<<
  *     ftshift = True
  *     x = np.array([1, 2, 3 + 6j, 4, 5])
  */
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_ftshift, Py_False) < 0) __PYX_ERR(0, 244, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_ftshift, Py_False) < 0) __PYX_ERR(0, 239, __pyx_L1_error)
 
-    /* "pyaibox/dsp/convolution.py":245
+    /* "pyaibox/dsp/convolution.py":240
  * 
  *     ftshift = False
  *     ftshift = True             # <<<<<<<<<<<<<<
  *     x = np.array([1, 2, 3 + 6j, 4, 5])
  *     h = np.array([1 + 2j, 2, 3, 4, 5, 6, 7])
  */
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_ftshift, Py_True) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_ftshift, Py_True) < 0) __PYX_ERR(0, 240, __pyx_L1_error)
 
-    /* "pyaibox/dsp/convolution.py":246
+    /* "pyaibox/dsp/convolution.py":241
  *     ftshift = False
  *     ftshift = True
  *     x = np.array([1, 2, 3 + 6j, 4, 5])             # <<<<<<<<<<<<<<
  *     h = np.array([1 + 2j, 2, 3, 4, 5, 6, 7])
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_4 = __Pyx_c_sum_double(__pyx_t_double_complex_from_parts(3, 0), __pyx_t_double_complex_from_parts(0, 6.0));
-    __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)
+    __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyList_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 246, __pyx_L1_error)
+    __pyx_t_5 = PyList_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_1);
     __Pyx_INCREF(__pyx_int_2);
     __Pyx_GIVEREF(__pyx_int_2);
     PyList_SET_ITEM(__pyx_t_5, 1, __pyx_int_2);
@@ -5706,37 +5676,37 @@
     __Pyx_INCREF(__pyx_int_4);
     __Pyx_GIVEREF(__pyx_int_4);
     PyList_SET_ITEM(__pyx_t_5, 3, __pyx_int_4);
     __Pyx_INCREF(__pyx_int_5);
     __Pyx_GIVEREF(__pyx_int_5);
     PyList_SET_ITEM(__pyx_t_5, 4, __pyx_int_5);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_x, __pyx_t_2) < 0) __PYX_ERR(0, 246, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_x, __pyx_t_2) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pyaibox/dsp/convolution.py":247
+    /* "pyaibox/dsp/convolution.py":242
  *     ftshift = True
  *     x = np.array([1, 2, 3 + 6j, 4, 5])
  *     h = np.array([1 + 2j, 2, 3, 4, 5, 6, 7])             # <<<<<<<<<<<<<<
  * 
  *     y1 = conv1(x, h, shape='same')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 247, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 247, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_4 = __Pyx_c_sum_double(__pyx_t_double_complex_from_parts(1, 0), __pyx_t_double_complex_from_parts(0, 2.0));
-    __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 247, __pyx_L1_error)
+    __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyList_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_2);
     PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
     __Pyx_INCREF(__pyx_int_2);
     __Pyx_GIVEREF(__pyx_int_2);
     PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_2);
     __Pyx_INCREF(__pyx_int_3);
@@ -5751,473 +5721,473 @@
     __Pyx_INCREF(__pyx_int_6);
     __Pyx_GIVEREF(__pyx_int_6);
     PyList_SET_ITEM(__pyx_t_1, 5, __pyx_int_6);
     __Pyx_INCREF(__pyx_int_7);
     __Pyx_GIVEREF(__pyx_int_7);
     PyList_SET_ITEM(__pyx_t_1, 6, __pyx_int_7);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 247, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_h, __pyx_t_2) < 0) __PYX_ERR(0, 247, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_h, __pyx_t_2) < 0) __PYX_ERR(0, 242, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pyaibox/dsp/convolution.py":249
+    /* "pyaibox/dsp/convolution.py":244
  *     h = np.array([1 + 2j, 2, 3, 4, 5, 6, 7])
  * 
  *     y1 = conv1(x, h, shape='same')             # <<<<<<<<<<<<<<
  *     y2 = fftconv1(x, h, axis=0, nfft=None, shape='same', ftshift=ftshift)
  *     # print(y1)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_conv1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_conv1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_h); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_h); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_1 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_shape, __pyx_n_u_same) < 0) __PYX_ERR(0, 249, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_shape, __pyx_n_u_same) < 0) __PYX_ERR(0, 244, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y1, __pyx_t_1) < 0) __PYX_ERR(0, 249, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y1, __pyx_t_1) < 0) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/dsp/convolution.py":250
+    /* "pyaibox/dsp/convolution.py":245
  * 
  *     y1 = conv1(x, h, shape='same')
  *     y2 = fftconv1(x, h, axis=0, nfft=None, shape='same', ftshift=ftshift)             # <<<<<<<<<<<<<<
  *     # print(y1)
  *     # print(y2)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fftconv1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fftconv1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_x); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 250, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_x); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_h); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 250, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_h); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 250, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_6);
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 250, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 250, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_nfft, Py_None) < 0) __PYX_ERR(0, 250, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_n_u_same) < 0) __PYX_ERR(0, 250, __pyx_L1_error)
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ftshift); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 250, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_nfft, Py_None) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_n_u_same) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ftshift); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ftshift, __pyx_t_5) < 0) __PYX_ERR(0, 250, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ftshift, __pyx_t_5) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 250, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y2, __pyx_t_5) < 0) __PYX_ERR(0, 250, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y2, __pyx_t_5) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/dsp/convolution.py":253
+    /* "pyaibox/dsp/convolution.py":248
  *     # print(y1)
  *     # print(y2)
  *     print(np.sum(np.abs(y1 - y2)), np.sum(np.angle(y1) - np.angle(y2)))             # <<<<<<<<<<<<<<
  * 
  *     y1 = conv1(x, h, shape='valid')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_y1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_y1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_8);
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "pyaibox/dsp/convolution.py":255
+    /* "pyaibox/dsp/convolution.py":250
  *     print(np.sum(np.abs(y1 - y2)), np.sum(np.angle(y1) - np.angle(y2)))
  * 
  *     y1 = conv1(x, h, shape='valid')             # <<<<<<<<<<<<<<
  *     y2 = fftconv1(x, h, axis=0, nfft=None, shape='valid', ftshift=ftshift)
  *     # print(y1)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_conv1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_conv1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_h); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_h); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_7);
     __pyx_t_1 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_shape, __pyx_n_u_valid) < 0) __PYX_ERR(0, 255, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 255, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_shape, __pyx_n_u_valid) < 0) __PYX_ERR(0, 250, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y1, __pyx_t_1) < 0) __PYX_ERR(0, 255, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y1, __pyx_t_1) < 0) __PYX_ERR(0, 250, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/dsp/convolution.py":256
+    /* "pyaibox/dsp/convolution.py":251
  * 
  *     y1 = conv1(x, h, shape='valid')
  *     y2 = fftconv1(x, h, axis=0, nfft=None, shape='valid', ftshift=ftshift)             # <<<<<<<<<<<<<<
  *     # print(y1)
  *     # print(y2)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fftconv1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fftconv1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_h); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_h); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_6);
     __pyx_t_7 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_nfft, Py_None) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_n_u_valid) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_ftshift); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 256, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 251, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_nfft, Py_None) < 0) __PYX_ERR(0, 251, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_n_u_valid) < 0) __PYX_ERR(0, 251, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_ftshift); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ftshift, __pyx_t_7) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ftshift, __pyx_t_7) < 0) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y2, __pyx_t_7) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y2, __pyx_t_7) < 0) __PYX_ERR(0, 251, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "pyaibox/dsp/convolution.py":259
+    /* "pyaibox/dsp/convolution.py":254
  *     # print(y1)
  *     # print(y2)
  *     print(np.sum(np.abs(y1 - y2)), np.sum(np.angle(y1) - np.angle(y2)))             # <<<<<<<<<<<<<<
  * 
  *     y1 = conv1(x, h, shape='full')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_abs); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_abs); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_y1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_y1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = PyNumber_Subtract(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Subtract(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Subtract(__pyx_t_7, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_7, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
     __pyx_t_5 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pyaibox/dsp/convolution.py":261
+    /* "pyaibox/dsp/convolution.py":256
  *     print(np.sum(np.abs(y1 - y2)), np.sum(np.angle(y1) - np.angle(y2)))
  * 
  *     y1 = conv1(x, h, shape='full')             # <<<<<<<<<<<<<<
  *     y2 = fftconv1(x, h, axis=0, nfft=None, shape='full', ftshift=ftshift)
  *     # print(y1)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_conv1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_conv1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 256, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_h); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_h); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 261, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 256, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_1 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_shape, __pyx_n_u_full) < 0) __PYX_ERR(0, 261, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_shape, __pyx_n_u_full) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y1, __pyx_t_1) < 0) __PYX_ERR(0, 261, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y1, __pyx_t_1) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pyaibox/dsp/convolution.py":262
+    /* "pyaibox/dsp/convolution.py":257
  * 
  *     y1 = conv1(x, h, shape='full')
  *     y2 = fftconv1(x, h, axis=0, nfft=None, shape='full', ftshift=ftshift)             # <<<<<<<<<<<<<<
  *     # print(y1)
  *     # print(y2)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fftconv1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fftconv1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_x); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_x); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_h); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_h); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_6);
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_nfft, Py_None) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_n_u_full) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ftshift); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_nfft, Py_None) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_n_u_full) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ftshift); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ftshift, __pyx_t_5) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ftshift, __pyx_t_5) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y2, __pyx_t_5) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_y2, __pyx_t_5) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pyaibox/dsp/convolution.py":265
+    /* "pyaibox/dsp/convolution.py":260
  *     # print(y1)
  *     # print(y2)
  *     print(np.sum(np.abs(y1 - y2)), np.sum(np.angle(y1) - np.angle(y2)))             # <<<<<<<<<<<<<<
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_y1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_y1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_angle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_y2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_8);
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 260, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "pyaibox/dsp/convolution.py":242
+    /* "pyaibox/dsp/convolution.py":237
  * 
  * 
  * if __name__ == '__main__':             # <<<<<<<<<<<<<<
  * 
  *     ftshift = False
  */
   }
@@ -7751,36 +7721,14 @@
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
 
-/* PyObjectCallNoArg */
-  #if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
-#if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(func)) {
-        return __Pyx_PyFunction_FastCall(func, NULL, 0);
-    }
-#endif
-#ifdef __Pyx_CyFunction_USED
-    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
-#else
-    if (likely(PyCFunction_Check(func)))
-#endif
-    {
-        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
-            return __Pyx_PyObject_CallMethO(func, NULL);
-        }
-    }
-    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
-}
-#endif
-
 /* PyIntCompare */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED long inplace) {
     if (op1 == op2) {
         Py_RETURN_TRUE;
     }
     #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_CheckExact(op1))) {
```

### Comparing `pyaibox-1.1.20/pyaibox/dsp/convolution.py` & `pyaibox-1.1.21/pyaibox/dsp/convolution.py`

 * *Files 3% similar despite different names*

```diff
@@ -196,23 +196,18 @@
     -------
     y : numpy array
         Convolution result array.
 
     """
 
     CplxRealflag = False
-    if np.iscomplex(x).any():  # complex in complex
-        pass
-    else:
-        if caxis is None:  # real
-            pass
-        else:  # complex in real
-            CplxRealflag = True
-            x = r2c(x, caxis=caxis, keepcaxis=keepcaxis)
-            h = r2c(h, caxis=caxis, keepcaxis=keepcaxis)
+    if (not np.is_complex(x)) and (caxis is not None):  # complex in real
+        CplxRealflag = True
+        x = r2c(x, caxis=caxis, keepaxis=True)
+        h = r2c(h, caxis=caxis, keepaxis=True)
 
     if np.ndim(h) == 1 and axis > 0:
         h = np.expand_dims(h, list(range(axis)))
     Nh = np.size(h, axis)
     Nx = np.size(x, axis)
 
     N = Nx + Nh - 1
@@ -230,15 +225,15 @@
     y = ifft(Y, nfft, caxis=None, axis=axis, keepcaxis=False, norm=None, shift=ftshift)
     y = cutfftconv1(y, nfft, Nx, Nh, shape, axis, ftshift)
 
     if eps is not None:
         y[abs(y) < eps] = 0.
 
     if CplxRealflag:
-        y = c2r(y, caxis=caxis, keepcaxis=not keepcaxis)
+        y = c2r(y, caxis=caxis, keepaxis=True)
 
     return y
 
 
 if __name__ == '__main__':
 
     ftshift = False
```

### Comparing `pyaibox-1.1.20/pyaibox/dsp/convolution.pyi` & `pyaibox-1.1.21/pyaibox/dsp/convolution.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/correlation.c` & `pyaibox-1.1.21/pyaibox/dsp/correlation.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/correlation.py` & `pyaibox-1.1.21/pyaibox/dsp/correlation.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/correlation.pyi` & `pyaibox-1.1.21/pyaibox/dsp/correlation.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/ffts.c` & `pyaibox-1.1.21/pyaibox/dsp/ffts.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/ffts.py` & `pyaibox-1.1.21/pyaibox/dsp/ffts.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/ffts.pyi` & `pyaibox-1.1.21/pyaibox/dsp/ffts.pyi`

 * *Files 0% similar despite different names*

```diff
@@ -349,8 +349,10 @@
 def ffty(x, n=None):
     ...
 
 def ifftx(x, n=None):
     ...
 
 def iffty(x, n=None):
+    ...
+
```

### Comparing `pyaibox-1.1.20/pyaibox/dsp/frffts.c` & `pyaibox-1.1.21/pyaibox/dsp/frffts.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/frffts.py` & `pyaibox-1.1.21/pyaibox/dsp/frffts.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/frffts.pyi` & `pyaibox-1.1.21/pyaibox/dsp/frffts.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/function_base.c` & `pyaibox-1.1.21/pyaibox/dsp/function_base.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/function_base.py` & `pyaibox-1.1.21/pyaibox/dsp/function_base.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/function_base.pyi` & `pyaibox-1.1.21/pyaibox/dsp/function_base.pyi`

 * *Files 13% similar despite different names*

```diff
@@ -26,17 +26,22 @@
         x = np.array([3.14, -3.12, 3.12, 3.13, -3.11])
         y_np = unwrap(x)
         print(y_np, y_np.shape, type(y_np))
 
         # output
 
         tensor([3.1400, 3.1632, 3.1200, 3.1300, 3.1732], dtype=torch.float64) torch.Size([5]) <class 'torch.Tensor'>
-
     """
 
+    if discont is None:
+        discont = pb.PI
+
+    return np.unwrap(x, discont=discont, axis=axis)
+
+
 def unwrap2(x, discont=pb.PI, axis=-1):
     r"""Unwrap by changing deltas between values to :math:`2\pi` complement.
 
     Unwrap radian phase `x` by changing absoluted jumps greater than
     `discont` to their :math:`2\pi` complement along the given axis. The elements
     are divided into 2 parts (with equal length) along the given axis.
     The first part is unwrapped in inverse order, while the second part
@@ -71,15 +76,34 @@
         x = np.array([3.14, -3.12, 3.12, 3.13, -3.11])
         x = np.concatenate((x[::-1], x), axis=0)
         print(x)
         y = unwrap2(x)
         print(y, y.shape, type(y))
 
         # output
-        [3.14       3.16318531 3.12       3.13       3.17318531] (5,) <class 'numpy.ndarray'>
-        ------------------------
-        [3.17318531 3.13       3.12       3.16318531 3.14       3.14
-        3.16318531 3.12       3.13       3.17318531] (10,) <class 'numpy.ndarray'>
-    
+        [3.14       3.16318531 3.12       3.13       3.17318531] (5,) <class 'numpy.ndarray'> ------------------------
+                                                                           ...
+
+        3.16318531 3.12       3.13       3.17318531] (10,) <class 'numpy.ndarray'> 
     """
 
+    d = x.ndim
+    s = x.shape[axis]
+    i = int(s / 2)
+    y1 = np.unwrap(x[pb.sl(d, [axis], [slice(0, i, 1)])][::-1], discont=discont, axis=axis)
+    y2 = np.unwrap(x[pb.sl(d, [axis], [slice(i, s, 1)])], discont=discont, axis=axis)
+    y = np.concatenate((y1[::-1], y2), axis=axis)
+    return y
+
+
+if __name__ == '__main__':
+
+    x = np.array([3.14, -3.12, 3.12, 3.13, -3.11])
+    y = unwrap(x)
+    print(y, y.shape, type(y))
+
+    print("------------------------")
+    x = np.array([3.14, -3.12, 3.12, 3.13, -3.11])
+    x = np.concatenate((x[::-1], x), axis=0)
+    y = unwrap2(x)
+    print(y, y.shape, type(y))
```

### Comparing `pyaibox-1.1.20/pyaibox/dsp/interpolation1d.c` & `pyaibox-1.1.21/pyaibox/dsp/interpolation1d.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/interpolation1d.py` & `pyaibox-1.1.21/pyaibox/dsp/interpolation1d.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/interpolation1d.pyi` & `pyaibox-1.1.21/pyaibox/dsp/interpolation1d.pyi`

 * *Files 2% similar despite different names*

```diff
@@ -29,8 +29,10 @@
     -------
     y : float or complex (corresponding to fp) or ndarray
         The interpolated values, same shape as `x`.
 
     """
 
 def sinc(x):
+    ...
+
```

### Comparing `pyaibox-1.1.20/pyaibox/dsp/interpolation2d.c` & `pyaibox-1.1.21/pyaibox/dsp/interpolation2d.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/interpolation2d.py` & `pyaibox-1.1.21/pyaibox/dsp/interpolation2d.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/normalsignals.c` & `pyaibox-1.1.21/pyaibox/dsp/normalsignals.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/normalsignals.py` & `pyaibox-1.1.21/pyaibox/dsp/normalsignals.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/dsp/normalsignals.pyi` & `pyaibox-1.1.21/pyaibox/dsp/normalsignals.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/classification.c` & `pyaibox-1.1.21/pyaibox/evaluation/classification.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/classification.py` & `pyaibox-1.1.21/pyaibox/evaluation/classification.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/contrast.c` & `pyaibox-1.1.21/pyaibox/evaluation/contrast.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/contrast.py` & `pyaibox-1.1.21/pyaibox/evaluation/contrast.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/contrast.pyi` & `pyaibox-1.1.21/pyaibox/evaluation/contrast.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/detection_voc.c` & `pyaibox-1.1.21/pyaibox/evaluation/detection_voc.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/detection_voc.py` & `pyaibox-1.1.21/pyaibox/evaluation/detection_voc.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/detection_voc.pyi` & `pyaibox-1.1.21/pyaibox/evaluation/detection_voc.pyi`

 * *Files 23% similar despite different names*

```diff
@@ -71,21 +71,24 @@
         dict:
 
         The keys, value-types and the description of the values are listed
         below.
 
         - **ap** (ndarray): An array of average precisions.
             The :math:`l`-th value corresponds to the average precision
-            for class :math:`l`. If class :math:`l` does not exist in 
-            either :obj:`pred_labels` or :obj:`gt_labels`, 
-            the corresponding value is set to :obj:`numpy.nan`.
-        - **map** (float): The average of Average Precisions over classes.
-
+            for class :math:`l`. If class :math:`l` does not exist in  either :obj:`pred_labels` or :obj:`gt_labels`, 
     """
 
+    prec, rec = calc_detection_voc_prec_rec(pred_bboxes, pred_labels, pred_scores, gt_bboxes, gt_labels, gt_difficults, iou_thresh=iou_thresh)
+
+    ap = calc_detection_voc_ap(prec, rec, use_07_metric=use_07_metric)
+
+    return {'ap': ap, 'map': np.nanmean(ap)}
+
+
 def calc_detection_voc_prec_rec(pred_bboxes, pred_labels, pred_scores, gt_bboxes, gt_labels, gt_difficults=None, iou_thresh=0.5):
     r"""Calculate precision and recall based on evaluation code of PASCAL VOC.
 
     This function calculates precision and recall of
     predicted bounding boxes obtained from a dataset which has :math:`N`
     images.
     The code is based on the evaluation code used in PASCAL VOC Challenge.
@@ -125,46 +128,120 @@
             Union with the ground truth is above this value..
 
     Returns:
         tuple of two lists:
         This function returns two lists: :obj:`prec` and :obj:`rec`.
 
         * :obj:`prec`: A list of arrays. :obj:`prec[l]` is precision
-            for class :math:`l`. If class :math:`l` does not exist in
-            either :obj:`pred_labels` or :obj:`gt_labels`, :obj:`prec[l]` is
-            set to :obj:`None`.
-        * :obj:`rec`: A list of arrays. :obj:`rec[l]` is recall
-            for class :math:`l`. If class :math:`l` that is not marked as
-            difficult does not exist in :obj:`gt_labels`, :obj:`rec[l]` is set to :obj:`None`.
+            for class :math:`l`. If class :math:`l` does not exist in either :obj:`pred_labels` or :obj:`gt_labels`, :obj:`prec[l]` is
+                    ...
 
+            for class :math:`l`. If class :math:`l` that is not marked as difficult does not exist in :obj:`gt_labels`, :obj:`rec[l]` is set to :obj:`None`.
     """
 
+    pred_bboxes = iter(pred_bboxes)
+    pred_labels = iter(pred_labels)
+    pred_scores = iter(pred_scores)
+    gt_bboxes = iter(gt_bboxes)
+    gt_labels = iter(gt_labels)
+    if gt_difficults is None:
+        gt_difficults = itertools.repeat(None)
+    else:
+        gt_difficults = iter(gt_difficults)
+
+    n_pos = defaultdict(int)
+    score = defaultdict(list)
+    match = defaultdict(list)
+
+    for pred_bbox, pred_label, pred_score, gt_bbox, gt_label, gt_difficult in \
+            six.moves.zip(
+                pred_bboxes, pred_labels, pred_scores,
+                gt_bboxes, gt_labels, gt_difficults):
+
+        if gt_difficult is None:
+            gt_difficult = np.zeros(gt_bbox.shape[0], dtype=bool)
+
+        for l in np.unique(np.concatenate((pred_label, gt_label)).astype(int)):
+            pred_mask_l = pred_label == l
+            pred_bbox_l = pred_bbox[pred_mask_l]
+            pred_score_l = pred_score[pred_mask_l]
+            # sort by score
+            order = pred_score_l.argsort()[::-1]
+            pred_bbox_l = pred_bbox_l[order]
+            pred_score_l = pred_score_l[order]
+
+            gt_mask_l = gt_label == l
+            gt_bbox_l = gt_bbox[gt_mask_l]
+            gt_difficult_l = gt_difficult[gt_mask_l]
+
+            n_pos[l] += np.logical_not(gt_difficult_l).sum()
+            score[l].extend(pred_score_l)
+
+            if len(pred_bbox_l) == 0:
+                continue
+            if len(gt_bbox_l) == 0:
+                match[l].extend((0,) * pred_bbox_l.shape[0])
+                continue
+
+            # VOC evaluation follows integer typed bounding boxes.
+            pred_bbox_l = pred_bbox_l.copy()
+            pred_bbox_l[:, 2:] += 1
+            gt_bbox_l = gt_bbox_l.copy()
+            gt_bbox_l[:, 2:] += 1
+
+            iou = bbox_iou(pred_bbox_l, gt_bbox_l)
+            gt_index = iou.argmax(axis=1)
+            # set -1 if there is no matching ground truth
+            gt_index[iou.max(axis=1) < iou_thresh] = -1
+            del iou
+
+            selec = np.zeros(gt_bbox_l.shape[0], dtype=bool)
+            for gt_idx in gt_index:
+                if gt_idx >= 0:
+                    if gt_difficult_l[gt_idx]:
+                        match[l].append(-1)
+                    else:
+                        if not selec[gt_idx]:
+                            match[l].append(1)
+                        else:
+                            match[l].append(0)
+                    selec[gt_idx] = True
+                else:
+                    match[l].append(0)
+
+    for iter_ in (
+            pred_bboxes, pred_labels, pred_scores,
+            gt_bboxes, gt_labels, gt_difficults):
+        if next(iter_, None) is not None:
+            raise ValueError('Length of input iterables need to be same.')
+
+    n_fg_class = max(n_pos.keys()) + 1 prec = [None] * n_fg_class
+             ...
+
 def calc_detection_voc_ap(prec, rec, use_07_metric=False):
     r"""Calculate average precisions based on evaluation code of PASCAL VOC.
 
     This function calculates average precisions
     from given precisions and recalls.
     The code is based on the evaluation code used in PASCAL VOC Challenge.
 
     Args:
         prec (list of numpy.array): A list of arrays.
-            :obj:`prec[l]` indicates precision for class :math:`l`.
-            If :obj:`prec[l]` is :obj:`None`, this function returns
-            :obj:`numpy.nan` for class :math:`l`.
-        rec (list of numpy.array): A list of arrays.
-            :obj:`rec[l]` indicates recall for class :math:`l`.
-            If :obj:`rec[l]` is :obj:`None`, this function returns
-            :obj:`numpy.nan` for class :math:`l`.
-        use_07_metric (bool): Whether to use PASCAL VOC 2007 evaluation metric
-            for calculating average precision. The default value is
-            :obj:`False`.
+            :obj:`prec[l]` indicates precision for class :math:`l`. If :obj:`prec[l]` is :obj:`None`, this function returns
+                                                       ...
 
-    Returns:
-        ~numpy.ndarray:
-        This function returns an array of average precisions.
-        The :math:`l`-th value corresponds to the average precision
-        for class :math:`l`. If :obj:`prec[l]` or :obj:`rec[l]` is
-        :obj:`None`, the corresponding value is set to :obj:`numpy.nan`.
+            :obj:`numpy.nan` for class :math:`l`. rec (list of numpy.array): A list of arrays.
+                                     ...
+
+            :obj:`rec[l]` indicates recall for class :math:`l`. If :obj:`rec[l]` is :obj:`None`, this function returns
+                                                   ...
 
+            :obj:`numpy.nan` for class :math:`l`. use_07_metric (bool): Whether to use PASCAL VOC 2007 evaluation metric
+                                     ...
+
+        for class :math:`l`. If :obj:`prec[l]` or :obj:`rec[l]` is :obj:`None`, the corresponding value is set to :obj:`numpy.nan`.
     """
 
+    n_fg_class = len(prec) ap = np.empty(n_fg_class)
+             ...
+
```

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/entropy.c` & `pyaibox-1.1.21/pyaibox/evaluation/entropy.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/entropy.py` & `pyaibox-1.1.21/pyaibox/evaluation/entropy.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/entropy.pyi` & `pyaibox-1.1.21/pyaibox/evaluation/entropy.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/error.c` & `pyaibox-1.1.21/pyaibox/evaluation/error.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/error.py` & `pyaibox-1.1.21/pyaibox/evaluation/error.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/error.pyi` & `pyaibox-1.1.21/pyaibox/evaluation/error.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/norm.c` & `pyaibox-1.1.21/pyaibox/evaluation/norm.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/norm.py` & `pyaibox-1.1.21/pyaibox/evaluation/norm.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/norm.pyi` & `pyaibox-1.1.21/pyaibox/evaluation/norm.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/snrs.c` & `pyaibox-1.1.21/pyaibox/evaluation/snrs.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/snrs.py` & `pyaibox-1.1.21/pyaibox/evaluation/snrs.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/evaluation/snrs.pyi` & `pyaibox-1.1.21/pyaibox/evaluation/snrs.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/bounding_box.c` & `pyaibox-1.1.21/pyaibox/misc/bounding_box.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/bounding_box.py` & `pyaibox-1.1.21/pyaibox/misc/bounding_box.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/draw_shapes.c` & `pyaibox-1.1.21/pyaibox/misc/draw_shapes.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/draw_shapes.py` & `pyaibox-1.1.21/pyaibox/misc/draw_shapes.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/draw_shapes.pyi` & `pyaibox-1.1.21/pyaibox/misc/draw_shapes.pyi`

 * *Files 1% similar despite different names*

```diff
@@ -56,8 +56,10 @@
         plt.figure()
         plt.imshow(y)
         plt.show()
         
     """
 
 def draw_eclipse(x, centroids, aradii, bradii, edgecolors=[255, 0, 0], linewidths=1, fillcolors=None, axes=(-2, -1)):
+    ...
+
```

### Comparing `pyaibox-1.1.20/pyaibox/misc/mapping_operation.c` & `pyaibox-1.1.21/pyaibox/misc/mapping_operation.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/mapping_operation.py` & `pyaibox-1.1.21/pyaibox/misc/mapping_operation.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/mapping_operation.pyi` & `pyaibox-1.1.21/pyaibox/misc/mapping_operation.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/noising.c` & `pyaibox-1.1.21/pyaibox/misc/noising.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/noising.py` & `pyaibox-1.1.21/pyaibox/misc/noising.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/noising.pyi` & `pyaibox-1.1.21/pyaibox/misc/noising.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/sampling.c` & `pyaibox-1.1.21/pyaibox/misc/sampling.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/sampling.py` & `pyaibox-1.1.21/pyaibox/misc/sampling.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/sampling.pyi` & `pyaibox-1.1.21/pyaibox/misc/sampling.pyi`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,10 @@
+# def upsampling(X, shape, axis=-1, method='Lanczos'):
+      ...
+
 def slidegrid(start, stop, step, shake=0, n=None):
     r"""generates sliding grid indexes
 
     Generates :attr:`n` sliding grid indexes from :attr:`start` to :attr:`stop`
     with step size :attr:`step`.
 
     Args:
```

### Comparing `pyaibox-1.1.20/pyaibox/misc/transform.c` & `pyaibox-1.1.21/pyaibox/misc/transform.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/transform.py` & `pyaibox-1.1.21/pyaibox/misc/transform.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/misc/transform.pyi` & `pyaibox-1.1.21/pyaibox/misc/transform.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/ml/dataset_visualization.c` & `pyaibox-1.1.21/pyaibox/ml/dataset_visualization.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/ml/dataset_visualization.py` & `pyaibox-1.1.21/pyaibox/ml/dataset_visualization.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/ml/reduction_pca.c` & `pyaibox-1.1.21/pyaibox/ml/reduction_pca.c`

 * *Files 1% similar despite different names*

```diff
@@ -1500,16 +1500,16 @@
 static const char __pyx_k_pyaibox[] = "pyaibox";
 static const char __pyx_k_reshape[] = "reshape";
 static const char __pyx_k_rmatmul[] = "__rmatmul__";
 static const char __pyx_k_rootdir[] = "rootdir";
 static const char __pyx_k_str2num[] = "str2num";
 static const char __pyx_k_constant[] = "constant";
 static const char __pyx_k_keepdims[] = "keepdims";
+static const char __pyx_k_swapaxes[] = "swapaxes";
 static const char __pyx_k_lambd_sum[] = "lambd_sum";
-static const char __pyx_k_transpose[] = "transpose";
 static const char __pyx_k_lambd_sumk[] = "lambd_sumk";
 static const char __pyx_k_read_mnist[] = "read_mnist";
 static const char __pyx_k_patch2tensor[] = "patch2tensor";
 static const char __pyx_k_constant_values[] = "constant_values";
 static const char __pyx_k_Reconstructed_70[] = "Reconstructed(70%)";
 static const char __pyx_k_Reconstructed_90[] = "Reconstructed(90%)";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
@@ -1589,18 +1589,18 @@
 static PyObject *__pyx_n_s_shape;
 static PyObject *__pyx_n_s_show;
 static PyObject *__pyx_n_s_sigma;
 static PyObject *__pyx_n_s_str2num;
 static PyObject *__pyx_n_s_sum;
 static PyObject *__pyx_n_s_svd;
 static PyObject *__pyx_n_u_svd;
+static PyObject *__pyx_n_s_swapaxes;
 static PyObject *__pyx_n_u_test;
 static PyObject *__pyx_n_s_test_2;
 static PyObject *__pyx_n_s_titles;
-static PyObject *__pyx_n_s_transpose;
 static PyObject *__pyx_n_s_u;
 static PyObject *__pyx_n_u_ubyte;
 static PyObject *__pyx_n_s_vfn;
 static PyObject *__pyx_n_s_x;
 static PyObject *__pyx_n_s_xp;
 static PyObject *__pyx_n_s_xshape;
 static PyObject *__pyx_n_s_y;
@@ -1786,42 +1786,42 @@
   __pyx_t_1 = 0;
 
   /* "pyaibox/ml/reduction_pca.py":112
  * 
  *     xshape = x.shape
  *     N = xshape[axisn]             # <<<<<<<<<<<<<<
  *     if axisn != 0:
- *         x = x.transpose(0, axisn)
+ *         x = x.swapaxes(0, axisn)
  */
   __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_xshape, __pyx_v_axisn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 112, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_N = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "pyaibox/ml/reduction_pca.py":113
  *     xshape = x.shape
  *     N = xshape[axisn]
  *     if axisn != 0:             # <<<<<<<<<<<<<<
- *         x = x.transpose(0, axisn)
+ *         x = x.swapaxes(0, axisn)
  *     x = np.reshape(x, (N, -1))
  */
   __pyx_t_1 = __Pyx_PyInt_NeObjC(__pyx_v_axisn, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
     /* "pyaibox/ml/reduction_pca.py":114
  *     N = xshape[axisn]
  *     if axisn != 0:
- *         x = x.transpose(0, axisn)             # <<<<<<<<<<<<<<
+ *         x = x.swapaxes(0, axisn)             # <<<<<<<<<<<<<<
  *     x = np.reshape(x, (N, -1))
  *     N, M = x.shape
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_transpose); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_swapaxes); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     __pyx_t_5 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -1867,22 +1867,22 @@
     __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_1);
     __pyx_t_1 = 0;
 
     /* "pyaibox/ml/reduction_pca.py":113
  *     xshape = x.shape
  *     N = xshape[axisn]
  *     if axisn != 0:             # <<<<<<<<<<<<<<
- *         x = x.transpose(0, axisn)
+ *         x = x.swapaxes(0, axisn)
  *     x = np.reshape(x, (N, -1))
  */
   }
 
   /* "pyaibox/ml/reduction_pca.py":115
  *     if axisn != 0:
- *         x = x.transpose(0, axisn)
+ *         x = x.swapaxes(0, axisn)
  *     x = np.reshape(x, (N, -1))             # <<<<<<<<<<<<<<
  *     N, M = x.shape
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 115, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 115, __pyx_L1_error)
@@ -1943,15 +1943,15 @@
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "pyaibox/ml/reduction_pca.py":116
- *         x = x.transpose(0, axisn)
+ *         x = x.swapaxes(0, axisn)
  *     x = np.reshape(x, (N, -1))
  *     N, M = x.shape             # <<<<<<<<<<<<<<
  * 
  *     x = x - np.mean(x, axis=1, keepdims=True)
  */
   __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
@@ -2816,18 +2816,18 @@
   {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
   {&__pyx_n_s_show, __pyx_k_show, sizeof(__pyx_k_show), 0, 0, 1, 1},
   {&__pyx_n_s_sigma, __pyx_k_sigma, sizeof(__pyx_k_sigma), 0, 0, 1, 1},
   {&__pyx_n_s_str2num, __pyx_k_str2num, sizeof(__pyx_k_str2num), 0, 0, 1, 1},
   {&__pyx_n_s_sum, __pyx_k_sum, sizeof(__pyx_k_sum), 0, 0, 1, 1},
   {&__pyx_n_s_svd, __pyx_k_svd, sizeof(__pyx_k_svd), 0, 0, 1, 1},
   {&__pyx_n_u_svd, __pyx_k_svd, sizeof(__pyx_k_svd), 0, 1, 0, 1},
+  {&__pyx_n_s_swapaxes, __pyx_k_swapaxes, sizeof(__pyx_k_swapaxes), 0, 0, 1, 1},
   {&__pyx_n_u_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 1, 0, 1},
   {&__pyx_n_s_test_2, __pyx_k_test_2, sizeof(__pyx_k_test_2), 0, 0, 1, 1},
   {&__pyx_n_s_titles, __pyx_k_titles, sizeof(__pyx_k_titles), 0, 0, 1, 1},
-  {&__pyx_n_s_transpose, __pyx_k_transpose, sizeof(__pyx_k_transpose), 0, 0, 1, 1},
   {&__pyx_n_s_u, __pyx_k_u, sizeof(__pyx_k_u), 0, 0, 1, 1},
   {&__pyx_n_u_ubyte, __pyx_k_ubyte, sizeof(__pyx_k_ubyte), 0, 1, 0, 1},
   {&__pyx_n_s_vfn, __pyx_k_vfn, sizeof(__pyx_k_vfn), 0, 0, 1, 1},
   {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
   {&__pyx_n_s_xp, __pyx_k_xp, sizeof(__pyx_k_xp), 0, 0, 1, 1},
   {&__pyx_n_s_xshape, __pyx_k_xshape, sizeof(__pyx_k_xshape), 0, 0, 1, 1},
   {&__pyx_n_s_y, __pyx_k_y, sizeof(__pyx_k_y), 0, 0, 1, 1},
```

### Comparing `pyaibox-1.1.20/pyaibox/ml/reduction_pca.py` & `pyaibox-1.1.21/pyaibox/ml/reduction_pca.py`

 * *Files 1% similar despite different names*

```diff
@@ -107,15 +107,15 @@
         print(pb.nmse(x, z, axis=(1, 2)))
 
     """
 
     xshape = x.shape
     N = xshape[axisn]
     if axisn != 0:
-        x = x.transpose(0, axisn)
+        x = x.swapaxes(0, axisn)
     x = np.reshape(x, (N, -1))
     N, M = x.shape
 
     x = x - np.mean(x, axis=1, keepdims=True)
     sigma = x.T.conj() @ x / M  # M-M
 
     if algo.lower() in ['svd']:
```

### Comparing `pyaibox-1.1.20/pyaibox/ml/reduction_pca.pyi` & `pyaibox-1.1.21/pyaibox/ml/reduction_pca.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/nn/activations.c` & `pyaibox-1.1.21/pyaibox/nn/activations.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/nn/activations.py` & `pyaibox-1.1.21/pyaibox/nn/activations.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/nn/activations.pyi` & `pyaibox-1.1.21/pyaibox/nn/activations.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/summary/loss_log.c` & `pyaibox-1.1.21/pyaibox/summary/loss_log.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/summary/loss_log.py` & `pyaibox-1.1.21/pyaibox/summary/loss_log.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/colormaps.c` & `pyaibox-1.1.21/pyaibox/utils/colormaps.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/colormaps.py` & `pyaibox-1.1.21/pyaibox/utils/colormaps.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/colors.c` & `pyaibox-1.1.21/pyaibox/utils/colors.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/colors.py` & `pyaibox-1.1.21/pyaibox/utils/colors.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/colors.pyi` & `pyaibox-1.1.21/pyaibox/utils/colors.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/const.c` & `pyaibox-1.1.21/pyaibox/utils/const.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/const.py` & `pyaibox-1.1.21/pyaibox/utils/const.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/convert.c` & `pyaibox-1.1.21/pyaibox/utils/convert.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/convert.py` & `pyaibox-1.1.21/pyaibox/utils/convert.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/convert.pyi` & `pyaibox-1.1.21/pyaibox/utils/convert.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/docstr.c` & `pyaibox-1.1.21/pyaibox/utils/image.c`

 * *Files 18% similar despite different names*

```diff
@@ -1,18 +1,18 @@
 /* Generated by Cython 0.29.32 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
-        "name": "pyaibox.utils.docstr",
+        "name": "pyaibox.utils.image",
         "sources": [
-            "pyaibox/utils/docstr.py"
+            "pyaibox/utils/image.py"
         ]
     },
-    "module_name": "pyaibox.utils.docstr"
+    "module_name": "pyaibox.utils.image"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
@@ -746,16 +746,16 @@
   #ifdef __cplusplus
     #define __PYX_EXTERN_C extern "C"
   #else
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
-#define __PYX_HAVE__pyaibox__utils__docstr
-#define __PYX_HAVE_API__pyaibox__utils__docstr
+#define __PYX_HAVE__pyaibox__utils__image
+#define __PYX_HAVE_API__pyaibox__utils__image
 /* Early includes */
 #ifdef _OPENMP
 #include <omp.h>
 #endif /* _OPENMP */
 
 #if defined(PYREX_WITHOUT_ASSERTIONS) && !defined(CYTHON_WITHOUT_ASSERTIONS)
 #define CYTHON_WITHOUT_ASSERTIONS
@@ -958,15 +958,15 @@
 static int __pyx_lineno;
 static int __pyx_clineno = 0;
 static const char * __pyx_cfilenm= __FILE__;
 static const char *__pyx_filename;
 
 
 static const char *__pyx_f[] = {
-  "pyaibox/utils/docstr.py",
+  "pyaibox/utils/image.py",
 };
 
 /*--- Type declarations ---*/
 
 /* --- Runtime support code (head) --- */
 /* Refnanny.proto */
 #ifndef CYTHON_REFNANNY
@@ -1037,26 +1037,14 @@
 #else
 #define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
 #endif
 
 /* GetBuiltinName.proto */
 static PyObject *__Pyx_GetBuiltinName(PyObject *name);
 
-/* RaiseDoubleKeywords.proto */
-static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
-
-/* ParseKeywords.proto */
-static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
-    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
-    const char* function_name);
-
-/* RaiseArgTupleInvalid.proto */
-static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
-    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
-
 /* PyDictVersioning.proto */
 #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
 #define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
 #define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
 #define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
     (version_var) = __PYX_GET_DICT_VERSION(dict);\
     (cache_var) = (value);
@@ -1096,21 +1084,14 @@
 static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
 #else
 #define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 #define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
 #endif
 
-/* PyObjectCall.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
-#else
-#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
-#endif
-
 /* PyCFunctionFastCall.proto */
 #if CYTHON_FAST_PYCCALL
 static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
 #else
 #define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
 #endif
 
@@ -1141,55 +1122,63 @@
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
 
+/* PyObjectCall.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
+#else
+#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
+#endif
+
 /* PyObjectCall2Args.proto */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
 
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
 
 /* PyObjectCallOneArg.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
 
-/* ListAppend.proto */
-#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
-static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
-    PyListObject* L = (PyListObject*) list;
-    Py_ssize_t len = Py_SIZE(list);
-    if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
-        Py_INCREF(x);
-        PyList_SET_ITEM(list, len, x);
-        __Pyx_SET_SIZE(list, len + 1);
-        return 0;
-    }
-    return PyList_Append(list, x);
-}
-#else
-#define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
-#endif
+/* RaiseArgTupleInvalid.proto */
+static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
+    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
 
-/* SliceObject.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
-        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
-        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
-        int has_cstart, int has_cstop, int wraparound);
+/* RaiseDoubleKeywords.proto */
+static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
+
+/* ParseKeywords.proto */
+static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
+    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
+    const char* function_name);
 
 /* PyObjectCallNoArg.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
 #else
 #define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
 #endif
 
+/* RaiseTooManyValuesToUnpack.proto */
+static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);
+
+/* RaiseNeedMoreValuesToUnpack.proto */
+static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);
+
+/* IterFinish.proto */
+static CYTHON_INLINE int __Pyx_IterFinish(void);
+
+/* UnpackItemEndCheck.proto */
+static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);
+
 /* GetItemInt.proto */
 #define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
     (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
     __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
     (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
                __Pyx_GetItemInt_Generic(o, to_py_func(i))))
 #define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
@@ -1204,90 +1193,19 @@
     (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
 static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                               int wraparound, int boundscheck);
 static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
 static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                      int is_list, int wraparound, int boundscheck);
 
-/* ObjectGetItem.proto */
-#if CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject* key);
-#else
-#define __Pyx_PyObject_GetItem(obj, key)  PyObject_GetItem(obj, key)
-#endif
-
-/* PyIntCompare.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, long inplace);
-
-/* PyIntBinop.proto */
-#if !CYTHON_COMPILING_IN_PYPY
-static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
-#else
-#define __Pyx_PyInt_AddObjC(op1, op2, intval, inplace, zerodivision_check)\
-    (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
-#endif
-
-/* IncludeStringH.proto */
-#include <string.h>
-
-/* BytesEquals.proto */
-static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);
-
-/* UnicodeEquals.proto */
-static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals);
-
-/* PyIntBinop.proto */
-#if !CYTHON_COMPILING_IN_PYPY
-static PyObject* __Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
-#else
-#define __Pyx_PyInt_SubtractObjC(op1, op2, intval, inplace, zerodivision_check)\
-    (inplace ? PyNumber_InPlaceSubtract(op1, op2) : PyNumber_Subtract(op1, op2))
-#endif
-
-/* None.proto */
-static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname);
-
-/* PyThreadStateGet.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
-#define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
-#define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
-#else
-#define __Pyx_PyThreadState_declare
-#define __Pyx_PyThreadState_assign
-#define __Pyx_PyErr_Occurred()  PyErr_Occurred()
-#endif
-
-/* PyErrFetchRestore.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
-#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
-#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
-#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
-#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
-static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
-static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
-#if CYTHON_COMPILING_IN_CPYTHON
-#define __Pyx_PyErr_SetNone(exc) (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
-#else
-#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
-#endif
-#else
-#define __Pyx_PyErr_Clear() PyErr_Clear()
-#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
-#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
-#define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
-#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
-#endif
-
-/* RaiseException.proto */
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
+/* SliceObject.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
+        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
+        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
+        int has_cstart, int has_cstop, int wraparound);
 
 /* Import.proto */
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);
 
 /* ImportFrom.proto */
 static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);
 
@@ -1350,14 +1268,50 @@
 /* CythonFunction.proto */
 static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml,
                                       int flags, PyObject* qualname,
                                       PyObject *closure,
                                       PyObject *module, PyObject *globals,
                                       PyObject* code);
 
+/* PyThreadStateGet.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
+#define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
+#define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
+#else
+#define __Pyx_PyThreadState_declare
+#define __Pyx_PyThreadState_assign
+#define __Pyx_PyErr_Occurred()  PyErr_Occurred()
+#endif
+
+/* PyErrFetchRestore.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
+#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
+#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
+#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
+#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
+static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
+static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
+#if CYTHON_COMPILING_IN_CPYTHON
+#define __Pyx_PyErr_SetNone(exc) (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
+#else
+#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
+#endif
+#else
+#define __Pyx_PyErr_Clear() PyErr_Clear()
+#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
+#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
+#define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
+#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
+#endif
+
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
 #define __Pyx_CLineForTraceback(tstate, c_line)  (((CYTHON_CLINE_IN_TRACEBACK)) ? c_line : 0)
 #else
 static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line);
 #endif
 
@@ -1410,2157 +1364,1068 @@
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 
-/* Module declarations from 'pyaibox.utils.docstr' */
-#define __Pyx_MODULE_NAME "pyaibox.utils.docstr"
-extern int __pyx_module_is_main_pyaibox__utils__docstr;
-int __pyx_module_is_main_pyaibox__utils__docstr = 0;
-
-/* Implementation of 'pyaibox.utils.docstr' */
-static PyObject *__pyx_builtin_open;
-static PyObject *__pyx_builtin_range;
-static PyObject *__pyx_builtin_TypeError;
-static const char __pyx_k_[] = "):";
-static const char __pyx_k_N[] = "N";
-static const char __pyx_k_c[] = ".c";
-static const char __pyx_k_k[] = "k";
-static const char __pyx_k_n[] = "n";
-static const char __pyx_k_r[] = "r";
-static const char __pyx_k_w[] = "w";
-static const char __pyx_k__2[] = " ";
-static const char __pyx_k__4[] = "\"\"\"";
-static const char __pyx_k__5[] = "\n";
-static const char __pyx_k__6[] = "...\n\n";
-static const char __pyx_k_os[] = "os";
-static const char __pyx_k_py[] = ".py";
-static const char __pyx_k_def[] = "def ";
-static const char __pyx_k_fpy[] = "fpy";
-static const char __pyx_k_pyi[] = ".pyi";
-static const char __pyx_k_r_2[] = "r\"\"\"";
-static const char __pyx_k_data[] = "data";
-static const char __pyx_k_exts[] = "exts";
-static const char __pyx_k_file[] = "file";
-static const char __pyx_k_find[] = "find";
-static const char __pyx_k_fpyi[] = "fpyi";
-static const char __pyx_k_gpyi[] = "gpyi";
+/* Module declarations from 'pyaibox.utils.image' */
+#define __Pyx_MODULE_NAME "pyaibox.utils.image"
+extern int __pyx_module_is_main_pyaibox__utils__image;
+int __pyx_module_is_main_pyaibox__utils__image = 0;
+
+/* Implementation of 'pyaibox.utils.image' */
+static const char __pyx_k_np[] = "np";
+static const char __pyx_k_cdf[] = "cdf";
+static const char __pyx_k_img[] = "img";
+static const char __pyx_k_bins[] = "bins";
+static const char __pyx_k_clip[] = "clip";
+static const char __pyx_k_cval[] = "cval";
 static const char __pyx_k_main[] = "__main__";
+static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "__name__";
-static const char __pyx_k_open[] = "open";
-static const char __pyx_k_ostr[] = "ostr";
 static const char __pyx_k_test[] = "__test__";
-static const char __pyx_k_class[] = "class ";
-static const char __pyx_k_close[] = "close";
-static const char __pyx_k_range[] = "range";
-static const char __pyx_k_write[] = "write";
-static const char __pyx_k_compos[] = "compos";
-static const char __pyx_k_danger[] = "danger!";
-static const char __pyx_k_defpos[] = "defpos";
-static const char __pyx_k_endpos[] = "endpos";
+static const char __pyx_k_nbins[] = "nbins";
+static const char __pyx_k_numpy[] = "numpy";
+static const char __pyx_k_order[] = "order";
+static const char __pyx_k_shape[] = "shape";
+static const char __pyx_k_astype[] = "astype";
+static const char __pyx_k_cumsum[] = "cumsum";
+static const char __pyx_k_dshape[] = "dshape";
+static const char __pyx_k_histeq[] = "histeq";
+static const char __pyx_k_imhist[] = "imhist";
 static const char __pyx_k_import[] = "__import__";
-static const char __pyx_k_outstr[] = "outstr";
-static const char __pyx_k_pkgdir[] = "pkgdir";
-static const char __pyx_k_pyfile[] = "pyfile";
-static const char __pyx_k_remove[] = "remove";
-static const char __pyx_k_ENDFLAG[] = "ENDFLAG";
-static const char __pyx_k_clspos1[] = "clspos1";
-static const char __pyx_k_clspos2[] = "clspos2";
-static const char __pyx_k_defpos1[] = "defpos1";
-static const char __pyx_k_defpos2[] = "defpos2";
-static const char __pyx_k_pyaibox[] = "pyaibox";
-static const char __pyx_k_pyifile[] = "pyifile";
-static const char __pyx_k_rmcache[] = "rmcache";
-static const char __pyx_k_allfiles[] = "allfiles";
-static const char __pyx_k_autoskip[] = "autoskip";
-static const char __pyx_k_dstfiles[] = "dstfiles";
-static const char __pyx_k_filetype[] = "filetype";
-static const char __pyx_k_finalstr[] = "finalstr";
-static const char __pyx_k_startpos[] = "startpos";
-static const char __pyx_k_TypeError[] = "TypeError";
-static const char __pyx_k_allcfiles[] = "allcfiles";
-static const char __pyx_k_init___py[] = "__init__.py";
-static const char __pyx_k_listxfile[] = "listxfile";
-static const char __pyx_k_readlines[] = "readlines";
-static const char __pyx_k_recursive[] = "recursive";
-static const char __pyx_k_cntcomflag[] = "cntcomflag";
-static const char __pyx_k_version_py[] = "version.py";
-static const char __pyx_k_dstfiletype[] = "dstfiletype";
+static const char __pyx_k_imread[] = "imread";
+static const char __pyx_k_imsave[] = "imsave";
+static const char __pyx_k_interp[] = "interp";
+static const char __pyx_k_normed[] = "normed";
+static const char __pyx_k_odtype[] = "odtype";
+static const char __pyx_k_oimage[] = "oimage";
+static const char __pyx_k_oshape[] = "oshape";
+static const char __pyx_k_resize[] = "resize";
+static const char __pyx_k_flatten[] = "flatten";
+static const char __pyx_k_imgfile[] = "imgfile";
+static const char __pyx_k_outfile[] = "outfile";
+static const char __pyx_k_reshape[] = "reshape";
+static const char __pyx_k_constant[] = "constant";
+static const char __pyx_k_imresize[] = "imresize";
+static const char __pyx_k_skimread[] = "skimread";
+static const char __pyx_k_skimsave[] = "skimsave";
+static const char __pyx_k_histogram[] = "histogram";
+static const char __pyx_k_skimage_io[] = "skimage.io";
+static const char __pyx_k_skimresize[] = "skimresize";
+static const char __pyx_k_output_shape[] = "output_shape";
+static const char __pyx_k_check_contrast[] = "check_contrast";
+static const char __pyx_k_preserve_range[] = "preserve_range";
+static const char __pyx_k_imresize_line_54[] = "imresize (line 54)";
+static const char __pyx_k_skimage_transform[] = "skimage.transform";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
-static const char __pyx_k_pyaibox_utils_docstr[] = "pyaibox.utils.docstr";
-static const char __pyx_k_pyaibox_utils_docstr_py[] = "pyaibox/utils/docstr.py";
-static const char __pyx_k_mnt_e_ws_github_antsfamily_torc[] = "/mnt/e/ws/github/antsfamily/torchcs/torchcs/torchcs/";
-static PyObject *__pyx_kp_u_;
-static PyObject *__pyx_n_u_ENDFLAG;
-static PyObject *__pyx_n_s_N;
-static PyObject *__pyx_n_s_TypeError;
-static PyObject *__pyx_kp_u__2;
-static PyObject *__pyx_kp_u__4;
-static PyObject *__pyx_kp_u__5;
-static PyObject *__pyx_kp_u__6;
-static PyObject *__pyx_n_s_allcfiles;
-static PyObject *__pyx_n_s_allfiles;
-static PyObject *__pyx_n_s_autoskip;
-static PyObject *__pyx_kp_u_c;
-static PyObject *__pyx_kp_u_class;
+static const char __pyx_k_pyaibox_utils_image[] = "pyaibox.utils.image";
+static const char __pyx_k_pyaibox_utils_image_py[] = "pyaibox/utils/image.py";
+static const char __pyx_k_resize_image_to_oshape_see_func[] = "resize image to oshape\n\n    see :func:`skimage.transform.resize`.\n\n    Parameters\n    ----------\n    img : ndarray\n        Input image.\n    oshape : tulpe, optional\n        output shape (the default is None, which is the same as the input)\n    odtype : str, optional\n        output data type, ``'uint8', 'uint16', 'int8', ...`` (the default is None, float)\n    order : int, optional\n        The order of the spline interpolation, default is 1. The order has to\n        be in the range 0-5. See `skimage.transform.warp` for detail.\n    mode : str, optional\n        Points outside the boundaries of the input are filled according\n        to the given mode. {``'constant'``, ``'edge'``, ``'symmetric'``, ``'reflect'``, ``'wrap'``},\n        Modes match the behaviour of `numpy.pad`.  The\n        default mode is 'constant'.\n    cval : float, optional\n        Used in conjunction with mode 'constant', the value outside\n        the image boundaries.\n    clip : bool, optional\n        Whether to clip the output to the range of values of the input image.\n        This is enabled by default, since higher order interpolation may\n        produce values outside the given input range.\n    preserve_range : bool, optional\n        Whether to keep the original range of values. Otherwise, the input\n        image is converted according to the conventions of `img_as_float`.\n\n    Returns\n    -------\n    resized : ndarray\n        Resized version of the input.\n\n    Notes\n    -----\n    Modes 'reflect' and 'symmetric' are similar, but differ in whether the edge\n    pixels are duplicated during the reflection.  As an example, if an array\n    has values [0, 1, 2] and was padded to the right by four values using\n    symmetric, the result would be [0, 1, 2, 2, 1, 0, 0], while for reflect it\n    would be [0, 1, 2, 1, 0, 1, 2].\n\n    Examples\n    --------\n    ::\n\n        >>> from skimage import data\n        >>> from skimage.transform import resize\n        >>> ima""ge = data.camera()\n        >>> resize(image, (100, 100), mode='reflect').shape\n        (100, 100)\n\n    ";
+static PyObject *__pyx_n_s_astype;
+static PyObject *__pyx_n_s_bins;
+static PyObject *__pyx_n_s_cdf;
+static PyObject *__pyx_n_s_check_contrast;
 static PyObject *__pyx_n_s_cline_in_traceback;
-static PyObject *__pyx_n_s_close;
-static PyObject *__pyx_n_s_clspos1;
-static PyObject *__pyx_n_s_clspos2;
-static PyObject *__pyx_n_s_cntcomflag;
-static PyObject *__pyx_n_s_compos;
-static PyObject *__pyx_kp_u_danger;
-static PyObject *__pyx_n_s_data;
-static PyObject *__pyx_kp_u_def;
-static PyObject *__pyx_n_s_defpos;
-static PyObject *__pyx_n_s_defpos1;
-static PyObject *__pyx_n_s_defpos2;
-static PyObject *__pyx_n_s_dstfiles;
-static PyObject *__pyx_n_s_dstfiletype;
-static PyObject *__pyx_n_s_endpos;
-static PyObject *__pyx_n_s_exts;
-static PyObject *__pyx_n_s_file;
-static PyObject *__pyx_n_s_filetype;
-static PyObject *__pyx_n_s_finalstr;
-static PyObject *__pyx_n_s_find;
-static PyObject *__pyx_n_s_fpy;
-static PyObject *__pyx_n_s_fpyi;
-static PyObject *__pyx_n_s_gpyi;
+static PyObject *__pyx_n_s_clip;
+static PyObject *__pyx_n_u_constant;
+static PyObject *__pyx_n_s_cumsum;
+static PyObject *__pyx_n_s_cval;
+static PyObject *__pyx_n_s_dshape;
+static PyObject *__pyx_n_s_flatten;
+static PyObject *__pyx_n_s_histeq;
+static PyObject *__pyx_n_s_histogram;
+static PyObject *__pyx_n_s_img;
+static PyObject *__pyx_n_s_imgfile;
+static PyObject *__pyx_n_s_imhist;
 static PyObject *__pyx_n_s_import;
-static PyObject *__pyx_kp_u_init___py;
-static PyObject *__pyx_n_s_k;
-static PyObject *__pyx_n_s_listxfile;
+static PyObject *__pyx_n_s_imread;
+static PyObject *__pyx_n_s_imresize;
+static PyObject *__pyx_kp_u_imresize_line_54;
+static PyObject *__pyx_n_s_imsave;
+static PyObject *__pyx_n_s_interp;
 static PyObject *__pyx_n_s_main;
-static PyObject *__pyx_n_u_main;
-static PyObject *__pyx_kp_u_mnt_e_ws_github_antsfamily_torc;
-static PyObject *__pyx_n_s_n;
+static PyObject *__pyx_n_s_mode;
 static PyObject *__pyx_n_s_name;
-static PyObject *__pyx_n_s_open;
-static PyObject *__pyx_n_s_os;
-static PyObject *__pyx_n_s_ostr;
-static PyObject *__pyx_n_s_outstr;
-static PyObject *__pyx_n_s_pkgdir;
-static PyObject *__pyx_kp_u_py;
-static PyObject *__pyx_n_s_pyaibox;
-static PyObject *__pyx_n_s_pyaibox_utils_docstr;
-static PyObject *__pyx_kp_s_pyaibox_utils_docstr_py;
-static PyObject *__pyx_n_s_pyfile;
-static PyObject *__pyx_kp_u_pyi;
-static PyObject *__pyx_n_s_pyifile;
-static PyObject *__pyx_n_u_r;
-static PyObject *__pyx_kp_u_r_2;
-static PyObject *__pyx_n_s_range;
-static PyObject *__pyx_n_s_readlines;
-static PyObject *__pyx_n_s_recursive;
-static PyObject *__pyx_n_s_remove;
-static PyObject *__pyx_n_s_rmcache;
-static PyObject *__pyx_n_s_startpos;
+static PyObject *__pyx_n_s_nbins;
+static PyObject *__pyx_n_s_normed;
+static PyObject *__pyx_n_s_np;
+static PyObject *__pyx_n_s_numpy;
+static PyObject *__pyx_n_s_odtype;
+static PyObject *__pyx_n_s_oimage;
+static PyObject *__pyx_n_s_order;
+static PyObject *__pyx_n_s_oshape;
+static PyObject *__pyx_n_s_outfile;
+static PyObject *__pyx_n_s_output_shape;
+static PyObject *__pyx_n_s_preserve_range;
+static PyObject *__pyx_n_s_pyaibox_utils_image;
+static PyObject *__pyx_kp_s_pyaibox_utils_image_py;
+static PyObject *__pyx_n_s_reshape;
+static PyObject *__pyx_n_s_resize;
+static PyObject *__pyx_kp_u_resize_image_to_oshape_see_func;
+static PyObject *__pyx_n_s_shape;
+static PyObject *__pyx_n_s_skimage_io;
+static PyObject *__pyx_n_s_skimage_transform;
+static PyObject *__pyx_n_s_skimread;
+static PyObject *__pyx_n_s_skimresize;
+static PyObject *__pyx_n_s_skimsave;
 static PyObject *__pyx_n_s_test;
-static PyObject *__pyx_kp_u_version_py;
-static PyObject *__pyx_n_u_w;
-static PyObject *__pyx_n_s_write;
-static PyObject *__pyx_pf_7pyaibox_5utils_6docstr_gpyi(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pkgdir, PyObject *__pyx_v_autoskip); /* proto */
-static PyObject *__pyx_pf_7pyaibox_5utils_6docstr_2rmcache(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pkgdir, PyObject *__pyx_v_exts); /* proto */
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_imread(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_imgfile); /* proto */
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_2imsave(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_outfile, PyObject *__pyx_v_img); /* proto */
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_4histeq(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_nbins); /* proto */
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_6imresize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_oshape, PyObject *__pyx_v_odtype, CYTHON_UNUSED PyObject *__pyx_v_order, PyObject *__pyx_v_mode, PyObject *__pyx_v_cval, PyObject *__pyx_v_clip, PyObject *__pyx_v_preserve_range); /* proto */
+static PyObject *__pyx_float_255_0;
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
-static PyObject *__pyx_int_2;
-static PyObject *__pyx_int_4;
+static PyObject *__pyx_int_256;
 static PyObject *__pyx_int_neg_1;
-static PyObject *__pyx_slice__3;
-static PyObject *__pyx_tuple__7;
+static PyObject *__pyx_slice_;
+static PyObject *__pyx_tuple__2;
+static PyObject *__pyx_tuple__4;
+static PyObject *__pyx_tuple__6;
 static PyObject *__pyx_tuple__8;
-static PyObject *__pyx_tuple__10;
+static PyObject *__pyx_tuple__9;
 static PyObject *__pyx_tuple__11;
-static PyObject *__pyx_tuple__13;
-static PyObject *__pyx_codeobj__9;
-static PyObject *__pyx_codeobj__12;
+static PyObject *__pyx_codeobj__3;
+static PyObject *__pyx_codeobj__5;
+static PyObject *__pyx_codeobj__7;
+static PyObject *__pyx_codeobj__10;
 /* Late includes */
 
-/* "pyaibox/utils/docstr.py":33
+/* "pyaibox/utils/image.py":36
+ * 
+ * 
+ * def imread(imgfile):             # <<<<<<<<<<<<<<
+ *     return skimread(imgfile)
+ * 
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_1imread(PyObject *__pyx_self, PyObject *__pyx_v_imgfile); /*proto*/
+static PyMethodDef __pyx_mdef_7pyaibox_5utils_5image_1imread = {"imread", (PyCFunction)__pyx_pw_7pyaibox_5utils_5image_1imread, METH_O, 0};
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_1imread(PyObject *__pyx_self, PyObject *__pyx_v_imgfile) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("imread (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pyaibox_5utils_5image_imread(__pyx_self, ((PyObject *)__pyx_v_imgfile));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_imread(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_imgfile) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("imread", 0);
+
+  /* "pyaibox/utils/image.py":37
+ * 
+ * def imread(imgfile):
+ *     return skimread(imgfile)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_skimread); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
+    }
+  }
+  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_imgfile) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_imgfile);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 37, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "pyaibox/utils/image.py":36
+ * 
+ * 
+ * def imread(imgfile):             # <<<<<<<<<<<<<<
+ *     return skimread(imgfile)
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_AddTraceback("pyaibox.utils.image.imread", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pyaibox/utils/image.py":40
  * 
  * 
- * def gpyi(pkgdir, autoskip=True):             # <<<<<<<<<<<<<<
- *     r"""generates ``pyi`` files
+ * def imsave(outfile, img):             # <<<<<<<<<<<<<<
+ *     return skimsave(outfile, img, check_contrast=False)
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_5utils_6docstr_1gpyi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_5utils_6docstr_gpyi[] = "generates ``pyi`` files\n\n    Parameters\n    ----------\n    pkgdir : str\n        package root directory\n    autoskip : bool, optional\n        skip ``__init__.py``, by default True\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_5utils_6docstr_1gpyi = {"gpyi", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_5utils_6docstr_1gpyi, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_5utils_6docstr_gpyi};
-static PyObject *__pyx_pw_7pyaibox_5utils_6docstr_1gpyi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_pkgdir = 0;
-  PyObject *__pyx_v_autoskip = 0;
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_3imsave(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_7pyaibox_5utils_5image_3imsave = {"imsave", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_5utils_5image_3imsave, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_3imsave(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_outfile = 0;
+  PyObject *__pyx_v_img = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("gpyi (wrapper)", 0);
+  __Pyx_RefNannySetupContext("imsave (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_pkgdir,&__pyx_n_s_autoskip,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_outfile,&__pyx_n_s_img,0};
     PyObject* values[2] = {0,0};
-    values[1] = ((PyObject *)((PyObject *)Py_True));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pkgdir)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_outfile)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_autoskip);
-          if (value) { values[1] = value; kw_args--; }
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("imsave", 1, 2, 2, 1); __PYX_ERR(0, 40, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gpyi") < 0)) __PYX_ERR(0, 33, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "imsave") < 0)) __PYX_ERR(0, 40, __pyx_L3_error)
       }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+      goto __pyx_L5_argtuple_error;
     } else {
-      switch (PyTuple_GET_SIZE(__pyx_args)) {
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        break;
-        default: goto __pyx_L5_argtuple_error;
-      }
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_pkgdir = values[0];
-    __pyx_v_autoskip = values[1];
+    __pyx_v_outfile = values[0];
+    __pyx_v_img = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("gpyi", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 33, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("imsave", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 40, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyaibox.utils.docstr.gpyi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyaibox.utils.image.imsave", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_5utils_6docstr_gpyi(__pyx_self, __pyx_v_pkgdir, __pyx_v_autoskip);
+  __pyx_r = __pyx_pf_7pyaibox_5utils_5image_2imsave(__pyx_self, __pyx_v_outfile, __pyx_v_img);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_5utils_6docstr_gpyi(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pkgdir, PyObject *__pyx_v_autoskip) {
-  PyObject *__pyx_v_filetype = NULL;
-  PyObject *__pyx_v_dstfiletype = NULL;
-  PyObject *__pyx_v_allfiles = NULL;
-  PyObject *__pyx_v_dstfiles = NULL;
-  PyObject *__pyx_v_file = NULL;
-  PyObject *__pyx_v_pyfile = NULL;
-  PyObject *__pyx_v_pyifile = NULL;
-  PyObject *__pyx_v_fpy = NULL;
-  PyObject *__pyx_v_fpyi = NULL;
-  PyObject *__pyx_v_data = NULL;
-  PyObject *__pyx_v_cntcomflag = NULL;
-  PyObject *__pyx_v_outstr = NULL;
-  PyObject *__pyx_v_n = NULL;
-  PyObject *__pyx_v_defpos = NULL;
-  PyObject *__pyx_v_k = NULL;
-  PyObject *__pyx_v_compos = NULL;
-  PyObject *__pyx_v_finalstr = NULL;
-  PyObject *__pyx_v_N = NULL;
-  PyObject *__pyx_v_defpos1 = NULL;
-  PyObject *__pyx_v_defpos2 = NULL;
-  PyObject *__pyx_v_clspos1 = NULL;
-  PyObject *__pyx_v_clspos2 = NULL;
-  PyObject *__pyx_v_startpos = NULL;
-  PyObject *__pyx_v_endpos = NULL;
-  PyObject *__pyx_v_ostr = NULL;
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_2imsave(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_outfile, PyObject *__pyx_v_img) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
-  Py_ssize_t __pyx_t_5;
-  PyObject *(*__pyx_t_6)(PyObject *);
-  int __pyx_t_7;
-  int __pyx_t_8;
-  int __pyx_t_9;
-  Py_ssize_t __pyx_t_10;
-  PyObject *__pyx_t_11 = NULL;
-  Py_ssize_t __pyx_t_12;
-  PyObject *(*__pyx_t_13)(PyObject *);
-  PyObject *__pyx_t_14 = NULL;
-  PyObject *__pyx_t_15 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("gpyi", 0);
+  __Pyx_RefNannySetupContext("imsave", 0);
 
-  /* "pyaibox/utils/docstr.py":44
- *     """
- * 
- *     filetype = '.py'             # <<<<<<<<<<<<<<
- *     dstfiletype = '.pyi'
- *     allfiles = listxfile(pkgdir, exts=filetype, recursive=True)
- */
-  __Pyx_INCREF(__pyx_kp_u_py);
-  __pyx_v_filetype = __pyx_kp_u_py;
-
-  /* "pyaibox/utils/docstr.py":45
+  /* "pyaibox/utils/image.py":41
  * 
- *     filetype = '.py'
- *     dstfiletype = '.pyi'             # <<<<<<<<<<<<<<
- *     allfiles = listxfile(pkgdir, exts=filetype, recursive=True)
+ * def imsave(outfile, img):
+ *     return skimsave(outfile, img, check_contrast=False)             # <<<<<<<<<<<<<<
  * 
- */
-  __Pyx_INCREF(__pyx_kp_u_pyi);
-  __pyx_v_dstfiletype = __pyx_kp_u_pyi;
-
-  /* "pyaibox/utils/docstr.py":46
- *     filetype = '.py'
- *     dstfiletype = '.pyi'
- *     allfiles = listxfile(pkgdir, exts=filetype, recursive=True)             # <<<<<<<<<<<<<<
  * 
- *     dstfiles = []
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_listxfile); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_skimsave); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 41, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(__pyx_v_pkgdir);
-  __Pyx_GIVEREF(__pyx_v_pkgdir);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_pkgdir);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_v_outfile);
+  __Pyx_GIVEREF(__pyx_v_outfile);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_outfile);
+  __Pyx_INCREF(__pyx_v_img);
+  __Pyx_GIVEREF(__pyx_v_img);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_img);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 41, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_exts, __pyx_v_filetype) < 0) __PYX_ERR(0, 46, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_recursive, Py_True) < 0) __PYX_ERR(0, 46, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 46, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_check_contrast, Py_False) < 0) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_allfiles = __pyx_t_4;
-  __pyx_t_4 = 0;
-
-  /* "pyaibox/utils/docstr.py":48
- *     allfiles = listxfile(pkgdir, exts=filetype, recursive=True)
- * 
- *     dstfiles = []             # <<<<<<<<<<<<<<
- *     for file in allfiles:
- *         if autoskip:
- */
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 48, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_v_dstfiles = ((PyObject*)__pyx_t_4);
+  __pyx_r = __pyx_t_4;
   __pyx_t_4 = 0;
+  goto __pyx_L0;
 
-  /* "pyaibox/utils/docstr.py":49
- * 
- *     dstfiles = []
- *     for file in allfiles:             # <<<<<<<<<<<<<<
- *         if autoskip:
- *             if (file.find('__init__.py') >= 0) or (file.find('version.py') >=0):
- */
-  if (likely(PyList_CheckExact(__pyx_v_allfiles)) || PyTuple_CheckExact(__pyx_v_allfiles)) {
-    __pyx_t_4 = __pyx_v_allfiles; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
-    __pyx_t_6 = NULL;
-  } else {
-    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_allfiles); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 49, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 49, __pyx_L1_error)
-  }
-  for (;;) {
-    if (likely(!__pyx_t_6)) {
-      if (likely(PyList_CheckExact(__pyx_t_4))) {
-        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
-        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 49, __pyx_L1_error)
-        #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        #endif
-      } else {
-        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
-        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 49, __pyx_L1_error)
-        #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        #endif
-      }
-    } else {
-      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
-      if (unlikely(!__pyx_t_3)) {
-        PyObject* exc_type = PyErr_Occurred();
-        if (exc_type) {
-          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 49, __pyx_L1_error)
-        }
-        break;
-      }
-      __Pyx_GOTREF(__pyx_t_3);
-    }
-    __Pyx_XDECREF_SET(__pyx_v_file, __pyx_t_3);
-    __pyx_t_3 = 0;
-
-    /* "pyaibox/utils/docstr.py":50
- *     dstfiles = []
- *     for file in allfiles:
- *         if autoskip:             # <<<<<<<<<<<<<<
- *             if (file.find('__init__.py') >= 0) or (file.find('version.py') >=0):
- *                 pass
- */
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_v_autoskip); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 50, __pyx_L1_error)
-    if (__pyx_t_7) {
-
-      /* "pyaibox/utils/docstr.py":51
- *     for file in allfiles:
- *         if autoskip:
- *             if (file.find('__init__.py') >= 0) or (file.find('version.py') >=0):             # <<<<<<<<<<<<<<
- *                 pass
- *             else:
- */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_file, __pyx_n_s_find); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_1)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_1);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
-        }
-      }
-      __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_kp_u_init___py) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_kp_u_init___py);
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (!__pyx_t_8) {
-      } else {
-        __pyx_t_7 = __pyx_t_8;
-        goto __pyx_L7_bool_binop_done;
-      }
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_file, __pyx_n_s_find); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
-        if (likely(__pyx_t_1)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-          __Pyx_INCREF(__pyx_t_1);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
-        }
-      }
-      __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_kp_u_version_py) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_kp_u_version_py);
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 51, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_7 = __pyx_t_8;
-      __pyx_L7_bool_binop_done:;
-      if (__pyx_t_7) {
-        goto __pyx_L6;
-      }
-
-      /* "pyaibox/utils/docstr.py":54
- *                 pass
- *             else:
- *                 dstfiles.append(file)             # <<<<<<<<<<<<<<
- *         else:
- *             dstfiles.append(file)
- */
-      /*else*/ {
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_dstfiles, __pyx_v_file); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 54, __pyx_L1_error)
-      }
-      __pyx_L6:;
-
-      /* "pyaibox/utils/docstr.py":50
- *     dstfiles = []
- *     for file in allfiles:
- *         if autoskip:             # <<<<<<<<<<<<<<
- *             if (file.find('__init__.py') >= 0) or (file.find('version.py') >=0):
- *                 pass
- */
-      goto __pyx_L5;
-    }
-
-    /* "pyaibox/utils/docstr.py":56
- *                 dstfiles.append(file)
- *         else:
- *             dstfiles.append(file)             # <<<<<<<<<<<<<<
- * 
- *     for pyfile in dstfiles:
- */
-    /*else*/ {
-      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_dstfiles, __pyx_v_file); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 56, __pyx_L1_error)
-    }
-    __pyx_L5:;
-
-    /* "pyaibox/utils/docstr.py":49
+  /* "pyaibox/utils/image.py":40
  * 
- *     dstfiles = []
- *     for file in allfiles:             # <<<<<<<<<<<<<<
- *         if autoskip:
- *             if (file.find('__init__.py') >= 0) or (file.find('version.py') >=0):
- */
-  }
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-
-  /* "pyaibox/utils/docstr.py":58
- *             dstfiles.append(file)
  * 
- *     for pyfile in dstfiles:             # <<<<<<<<<<<<<<
- *         pyifile = pyfile[:-len(filetype)] + dstfiletype
+ * def imsave(outfile, img):             # <<<<<<<<<<<<<<
+ *     return skimsave(outfile, img, check_contrast=False)
  * 
  */
-  __pyx_t_4 = __pyx_v_dstfiles; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
-  for (;;) {
-    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
-    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 58, __pyx_L1_error)
-    #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 58, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    #endif
-    __Pyx_XDECREF_SET(__pyx_v_pyfile, __pyx_t_3);
-    __pyx_t_3 = 0;
 
-    /* "pyaibox/utils/docstr.py":59
- * 
- *     for pyfile in dstfiles:
- *         pyifile = pyfile[:-len(filetype)] + dstfiletype             # <<<<<<<<<<<<<<
- * 
- *         fpy = open(pyfile, "r")
- */
-    __pyx_t_10 = __Pyx_PyUnicode_GET_LENGTH(__pyx_v_filetype); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 59, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_pyfile, 0, (-__pyx_t_10), NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_v_dstfiletype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_XDECREF_SET(__pyx_v_pyifile, __pyx_t_2);
-    __pyx_t_2 = 0;
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_AddTraceback("pyaibox.utils.image.imsave", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-    /* "pyaibox/utils/docstr.py":61
- *         pyifile = pyfile[:-len(filetype)] + dstfiletype
+/* "pyaibox/utils/image.py":44
  * 
- *         fpy = open(pyfile, "r")             # <<<<<<<<<<<<<<
- *         fpyi = open(pyifile, "w")
- *         data = fpy.readlines()
- */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_v_pyfile);
-    __Pyx_GIVEREF(__pyx_v_pyfile);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_pyfile);
-    __Pyx_INCREF(__pyx_n_u_r);
-    __Pyx_GIVEREF(__pyx_n_u_r);
-    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_n_u_r);
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_XDECREF_SET(__pyx_v_fpy, __pyx_t_3);
-    __pyx_t_3 = 0;
-
-    /* "pyaibox/utils/docstr.py":62
  * 
- *         fpy = open(pyfile, "r")
- *         fpyi = open(pyifile, "w")             # <<<<<<<<<<<<<<
- *         data = fpy.readlines()
- *         cntcomflag = -1
- */
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_INCREF(__pyx_v_pyifile);
-    __Pyx_GIVEREF(__pyx_v_pyifile);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_pyifile);
-    __Pyx_INCREF(__pyx_n_u_w);
-    __Pyx_GIVEREF(__pyx_n_u_w);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_n_u_w);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 62, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_XDECREF_SET(__pyx_v_fpyi, __pyx_t_2);
-    __pyx_t_2 = 0;
-
-    /* "pyaibox/utils/docstr.py":63
- *         fpy = open(pyfile, "r")
- *         fpyi = open(pyifile, "w")
- *         data = fpy.readlines()             # <<<<<<<<<<<<<<
- *         cntcomflag = -1
- *         outstr = []
- */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fpy, __pyx_n_s_readlines); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 63, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_1)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_1);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
-      }
-    }
-    __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
-    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 63, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_XDECREF_SET(__pyx_v_data, __pyx_t_2);
-    __pyx_t_2 = 0;
-
-    /* "pyaibox/utils/docstr.py":64
- *         fpyi = open(pyifile, "w")
- *         data = fpy.readlines()
- *         cntcomflag = -1             # <<<<<<<<<<<<<<
- *         outstr = []
- *         for n in range(len(data)):
- */
-    __Pyx_INCREF(__pyx_int_neg_1);
-    __Pyx_XDECREF_SET(__pyx_v_cntcomflag, __pyx_int_neg_1);
-
-    /* "pyaibox/utils/docstr.py":65
- *         data = fpy.readlines()
- *         cntcomflag = -1
- *         outstr = []             # <<<<<<<<<<<<<<
- *         for n in range(len(data)):
- *             defpos = data[n].find('def' + ' ')
- */
-    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 65, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_XDECREF_SET(__pyx_v_outstr, ((PyObject*)__pyx_t_2));
-    __pyx_t_2 = 0;
-
-    /* "pyaibox/utils/docstr.py":66
- *         cntcomflag = -1
- *         outstr = []
- *         for n in range(len(data)):             # <<<<<<<<<<<<<<
- *             defpos = data[n].find('def' + ' ')
- *             if defpos == -1:
- */
-    __pyx_t_10 = PyObject_Length(__pyx_v_data); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 66, __pyx_L1_error)
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 66, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 66, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
-      __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2); __pyx_t_10 = 0;
-      __pyx_t_6 = NULL;
-    } else {
-      __pyx_t_10 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 66, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 66, __pyx_L1_error)
-    }
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    for (;;) {
-      if (likely(!__pyx_t_6)) {
-        if (likely(PyList_CheckExact(__pyx_t_2))) {
-          if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_2)) break;
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 66, __pyx_L1_error)
-          #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 66, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          #endif
-        } else {
-          if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 66, __pyx_L1_error)
-          #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 66, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          #endif
-        }
-      } else {
-        __pyx_t_3 = __pyx_t_6(__pyx_t_2);
-        if (unlikely(!__pyx_t_3)) {
-          PyObject* exc_type = PyErr_Occurred();
-          if (exc_type) {
-            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 66, __pyx_L1_error)
-          }
-          break;
-        }
-        __Pyx_GOTREF(__pyx_t_3);
-      }
-      __Pyx_XDECREF_SET(__pyx_v_n, __pyx_t_3);
-      __pyx_t_3 = 0;
-
-      /* "pyaibox/utils/docstr.py":67
- *         outstr = []
- *         for n in range(len(data)):
- *             defpos = data[n].find('def' + ' ')             # <<<<<<<<<<<<<<
- *             if defpos == -1:
- *                 defpos = data[n].find('class' + ' ')
- */
-      __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 67, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_find); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 67, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_11);
-        if (likely(__pyx_t_1)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-          __Pyx_INCREF(__pyx_t_1);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_11, function);
-        }
-      }
-      __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_1, __pyx_kp_u_def) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_kp_u_def);
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 67, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_defpos, __pyx_t_3);
-      __pyx_t_3 = 0;
-
-      /* "pyaibox/utils/docstr.py":68
- *         for n in range(len(data)):
- *             defpos = data[n].find('def' + ' ')
- *             if defpos == -1:             # <<<<<<<<<<<<<<
- *                 defpos = data[n].find('class' + ' ')
- *             if defpos == 0:
- */
-      __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_defpos, __pyx_int_neg_1, -1L, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 68, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__pyx_t_7) {
-
-        /* "pyaibox/utils/docstr.py":69
- *             defpos = data[n].find('def' + ' ')
- *             if defpos == -1:
- *                 defpos = data[n].find('class' + ' ')             # <<<<<<<<<<<<<<
- *             if defpos == 0:
- *                 cntcomflag = 0
- */
-        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 69, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_find); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = NULL;
-        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_1);
-          if (likely(__pyx_t_11)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-            __Pyx_INCREF(__pyx_t_11);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_1, function);
-          }
-        }
-        __pyx_t_3 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_11, __pyx_kp_u_class) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_kp_u_class);
-        __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 69, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_DECREF_SET(__pyx_v_defpos, __pyx_t_3);
-        __pyx_t_3 = 0;
-
-        /* "pyaibox/utils/docstr.py":68
- *         for n in range(len(data)):
- *             defpos = data[n].find('def' + ' ')
- *             if defpos == -1:             # <<<<<<<<<<<<<<
- *                 defpos = data[n].find('class' + ' ')
- *             if defpos == 0:
- */
-      }
-
-      /* "pyaibox/utils/docstr.py":70
- *             if defpos == -1:
- *                 defpos = data[n].find('class' + ' ')
- *             if defpos == 0:             # <<<<<<<<<<<<<<
- *                 cntcomflag = 0
- *                 if data[n].find('):') > -1:
- */
-      __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_defpos, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 70, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 70, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__pyx_t_7) {
-
-        /* "pyaibox/utils/docstr.py":71
- *                 defpos = data[n].find('class' + ' ')
- *             if defpos == 0:
- *                 cntcomflag = 0             # <<<<<<<<<<<<<<
- *                 if data[n].find('):') > -1:
- *                     outstr.append(data[n])
- */
-        __Pyx_INCREF(__pyx_int_0);
-        __Pyx_DECREF_SET(__pyx_v_cntcomflag, __pyx_int_0);
-
-        /* "pyaibox/utils/docstr.py":72
- *             if defpos == 0:
- *                 cntcomflag = 0
- *                 if data[n].find('):') > -1:             # <<<<<<<<<<<<<<
- *                     outstr.append(data[n])
- *                 else:
- */
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_find); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 72, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = NULL;
-        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_11);
-          if (likely(__pyx_t_1)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-            __Pyx_INCREF(__pyx_t_1);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_11, function);
-          }
-        }
-        __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_1, __pyx_kp_u_) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_kp_u_);
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 72, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = PyObject_RichCompare(__pyx_t_3, __pyx_int_neg_1, Py_GT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 72, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 72, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (__pyx_t_7) {
-
-          /* "pyaibox/utils/docstr.py":73
- *                 cntcomflag = 0
- *                 if data[n].find('):') > -1:
- *                     outstr.append(data[n])             # <<<<<<<<<<<<<<
- *                 else:
- *                     for k in range(len(data[n+1])):
- */
-          __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 73, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_outstr, __pyx_t_11); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 73, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-
-          /* "pyaibox/utils/docstr.py":72
- *             if defpos == 0:
- *                 cntcomflag = 0
- *                 if data[n].find('):') > -1:             # <<<<<<<<<<<<<<
- *                     outstr.append(data[n])
- *                 else:
- */
-          goto __pyx_L15;
-        }
-
-        /* "pyaibox/utils/docstr.py":75
- *                     outstr.append(data[n])
- *                 else:
- *                     for k in range(len(data[n+1])):             # <<<<<<<<<<<<<<
- *                         if data[n+1][k] != ' ':
- *                             break
- */
-        /*else*/ {
-          __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 75, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 75, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_12 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 75, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 75, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 75, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
-            __pyx_t_3 = __pyx_t_11; __Pyx_INCREF(__pyx_t_3); __pyx_t_12 = 0;
-            __pyx_t_13 = NULL;
-          } else {
-            __pyx_t_12 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 75, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 75, __pyx_L1_error)
-          }
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          for (;;) {
-            if (likely(!__pyx_t_13)) {
-              if (likely(PyList_CheckExact(__pyx_t_3))) {
-                if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_3)) break;
-                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                __pyx_t_11 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_11); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 75, __pyx_L1_error)
-                #else
-                __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 75, __pyx_L1_error)
-                __Pyx_GOTREF(__pyx_t_11);
-                #endif
-              } else {
-                if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
-                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_11); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 75, __pyx_L1_error)
-                #else
-                __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 75, __pyx_L1_error)
-                __Pyx_GOTREF(__pyx_t_11);
-                #endif
-              }
-            } else {
-              __pyx_t_11 = __pyx_t_13(__pyx_t_3);
-              if (unlikely(!__pyx_t_11)) {
-                PyObject* exc_type = PyErr_Occurred();
-                if (exc_type) {
-                  if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                  else __PYX_ERR(0, 75, __pyx_L1_error)
-                }
-                break;
-              }
-              __Pyx_GOTREF(__pyx_t_11);
-            }
-            __Pyx_XDECREF_SET(__pyx_v_k, __pyx_t_11);
-            __pyx_t_11 = 0;
-
-            /* "pyaibox/utils/docstr.py":76
- *                 else:
- *                     for k in range(len(data[n+1])):
- *                         if data[n+1][k] != ' ':             # <<<<<<<<<<<<<<
- *                             break
- *                     outstr.append(data[n][:-1] + data[n+1][k-1:])
- */
-            __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 76, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_1);
-            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-            __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_k); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 76, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __pyx_t_7 = (__Pyx_PyUnicode_Equals(__pyx_t_11, __pyx_kp_u__2, Py_NE)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 76, __pyx_L1_error)
-            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-            if (__pyx_t_7) {
-
-              /* "pyaibox/utils/docstr.py":77
- *                     for k in range(len(data[n+1])):
- *                         if data[n+1][k] != ' ':
- *                             break             # <<<<<<<<<<<<<<
- *                     outstr.append(data[n][:-1] + data[n+1][k-1:])
- *                 continue
- */
-              goto __pyx_L17_break;
-
-              /* "pyaibox/utils/docstr.py":76
- *                 else:
- *                     for k in range(len(data[n+1])):
- *                         if data[n+1][k] != ' ':             # <<<<<<<<<<<<<<
- *                             break
- *                     outstr.append(data[n][:-1] + data[n+1][k-1:])
- */
-            }
-
-            /* "pyaibox/utils/docstr.py":75
- *                     outstr.append(data[n])
- *                 else:
- *                     for k in range(len(data[n+1])):             # <<<<<<<<<<<<<<
- *                         if data[n+1][k] != ' ':
- *                             break
+ * def histeq(img, nbins=256):             # <<<<<<<<<<<<<<
+ *     dshape = img.shape
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)
  */
-          }
-          __pyx_L17_break:;
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-
-          /* "pyaibox/utils/docstr.py":78
- *                         if data[n+1][k] != ' ':
- *                             break
- *                     outstr.append(data[n][:-1] + data[n+1][k-1:])             # <<<<<<<<<<<<<<
- *                 continue
- *             compos = data[n].find('"' + '"' + '"')
- */
-          __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, -1L, NULL, NULL, &__pyx_slice__3, 0, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (unlikely(!__pyx_v_k)) { __Pyx_RaiseUnboundLocalError("k"); __PYX_ERR(0, 78, __pyx_L1_error) }
-          __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_14 = __Pyx_PyObject_GetSlice(__pyx_t_1, 0, 0, &__pyx_t_3, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_14);
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = PyNumber_Add(__pyx_t_11, __pyx_t_14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_outstr, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 78, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        }
-        __pyx_L15:;
-
-        /* "pyaibox/utils/docstr.py":79
- *                             break
- *                     outstr.append(data[n][:-1] + data[n+1][k-1:])
- *                 continue             # <<<<<<<<<<<<<<
- *             compos = data[n].find('"' + '"' + '"')
- *             if compos < 0:
- */
-        goto __pyx_L11_continue;
-
-        /* "pyaibox/utils/docstr.py":70
- *             if defpos == -1:
- *                 defpos = data[n].find('class' + ' ')
- *             if defpos == 0:             # <<<<<<<<<<<<<<
- *                 cntcomflag = 0
- *                 if data[n].find('):') > -1:
- */
-      }
 
-      /* "pyaibox/utils/docstr.py":80
- *                     outstr.append(data[n][:-1] + data[n+1][k-1:])
- *                 continue
- *             compos = data[n].find('"' + '"' + '"')             # <<<<<<<<<<<<<<
- *             if compos < 0:
- *                 compos = data[n].find('r"' + '"' + '"')
- */
-      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 80, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_find); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 80, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-        __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_11);
-        if (likely(__pyx_t_14)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-          __Pyx_INCREF(__pyx_t_14);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_11, function);
-        }
+/* Python wrapper */
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_5histeq(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_7pyaibox_5utils_5image_5histeq = {"histeq", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_5utils_5image_5histeq, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_5histeq(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_img = 0;
+  PyObject *__pyx_v_nbins = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("histeq (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_img,&__pyx_n_s_nbins,0};
+    PyObject* values[2] = {0,0};
+    values[1] = ((PyObject *)((PyObject *)__pyx_int_256));
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
       }
-      __pyx_t_3 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_14, __pyx_kp_u__4) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_kp_u__4);
-      __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_compos, __pyx_t_3);
-      __pyx_t_3 = 0;
-
-      /* "pyaibox/utils/docstr.py":81
- *                 continue
- *             compos = data[n].find('"' + '"' + '"')
- *             if compos < 0:             # <<<<<<<<<<<<<<
- *                 compos = data[n].find('r"' + '"' + '"')
- *             if compos >= 0:
- */
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_compos, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 81, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 81, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__pyx_t_7) {
-
-        /* "pyaibox/utils/docstr.py":82
- *             compos = data[n].find('"' + '"' + '"')
- *             if compos < 0:
- *                 compos = data[n].find('r"' + '"' + '"')             # <<<<<<<<<<<<<<
- *             if compos >= 0:
- *                 cntcomflag += 1
- */
-        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 82, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_find); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 82, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_14);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = NULL;
-        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
-          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_14);
-          if (likely(__pyx_t_11)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
-            __Pyx_INCREF(__pyx_t_11);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_14, function);
-          }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_nbins);
+          if (value) { values[1] = value; kw_args--; }
         }
-        __pyx_t_3 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_11, __pyx_kp_u_r_2) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_kp_u_r_2);
-        __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        __Pyx_DECREF_SET(__pyx_v_compos, __pyx_t_3);
-        __pyx_t_3 = 0;
-
-        /* "pyaibox/utils/docstr.py":81
- *                 continue
- *             compos = data[n].find('"' + '"' + '"')
- *             if compos < 0:             # <<<<<<<<<<<<<<
- *                 compos = data[n].find('r"' + '"' + '"')
- *             if compos >= 0:
- */
       }
-
-      /* "pyaibox/utils/docstr.py":83
- *             if compos < 0:
- *                 compos = data[n].find('r"' + '"' + '"')
- *             if compos >= 0:             # <<<<<<<<<<<<<<
- *                 cntcomflag += 1
- * 
- */
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_compos, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 83, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 83, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__pyx_t_7) {
-
-        /* "pyaibox/utils/docstr.py":84
- *                 compos = data[n].find('r"' + '"' + '"')
- *             if compos >= 0:
- *                 cntcomflag += 1             # <<<<<<<<<<<<<<
- * 
- *             if cntcomflag == 1:
- */
-        __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_cntcomflag, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 84, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF_SET(__pyx_v_cntcomflag, __pyx_t_3);
-        __pyx_t_3 = 0;
-
-        /* "pyaibox/utils/docstr.py":83
- *             if compos < 0:
- *                 compos = data[n].find('r"' + '"' + '"')
- *             if compos >= 0:             # <<<<<<<<<<<<<<
- *                 cntcomflag += 1
- * 
- */
-      }
-
-      /* "pyaibox/utils/docstr.py":86
- *                 cntcomflag += 1
- * 
- *             if cntcomflag == 1:             # <<<<<<<<<<<<<<
- *                 outstr.append(data[n])
- *             elif cntcomflag == 2:
- */
-      __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_cntcomflag, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 86, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 86, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__pyx_t_7) {
-
-        /* "pyaibox/utils/docstr.py":87
- * 
- *             if cntcomflag == 1:
- *                 outstr.append(data[n])             # <<<<<<<<<<<<<<
- *             elif cntcomflag == 2:
- *                 outstr.append(data[n] + '\n')
- */
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 87, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_outstr, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 87, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-
-        /* "pyaibox/utils/docstr.py":86
- *                 cntcomflag += 1
- * 
- *             if cntcomflag == 1:             # <<<<<<<<<<<<<<
- *                 outstr.append(data[n])
- *             elif cntcomflag == 2:
- */
-        goto __pyx_L21;
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "histeq") < 0)) __PYX_ERR(0, 44, __pyx_L3_error)
       }
-
-      /* "pyaibox/utils/docstr.py":88
- *             if cntcomflag == 1:
- *                 outstr.append(data[n])
- *             elif cntcomflag == 2:             # <<<<<<<<<<<<<<
- *                 outstr.append(data[n] + '\n')
- *                 cntcomflag = -1
- */
-      __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_cntcomflag, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 88, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 88, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__pyx_t_7) {
-
-        /* "pyaibox/utils/docstr.py":89
- *                 outstr.append(data[n])
- *             elif cntcomflag == 2:
- *                 outstr.append(data[n] + '\n')             # <<<<<<<<<<<<<<
- *                 cntcomflag = -1
- *         outstr.append('\n')
- */
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_data, __pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_14 = PyNumber_Add(__pyx_t_3, __pyx_kp_u__5); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 89, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_14);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_outstr, __pyx_t_14); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 89, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-
-        /* "pyaibox/utils/docstr.py":90
- *             elif cntcomflag == 2:
- *                 outstr.append(data[n] + '\n')
- *                 cntcomflag = -1             # <<<<<<<<<<<<<<
- *         outstr.append('\n')
- * 
- */
-        __Pyx_INCREF(__pyx_int_neg_1);
-        __Pyx_DECREF_SET(__pyx_v_cntcomflag, __pyx_int_neg_1);
-
-        /* "pyaibox/utils/docstr.py":88
- *             if cntcomflag == 1:
- *                 outstr.append(data[n])
- *             elif cntcomflag == 2:             # <<<<<<<<<<<<<<
- *                 outstr.append(data[n] + '\n')
- *                 cntcomflag = -1
- */
+    } else {
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
       }
-      __pyx_L21:;
-
-      /* "pyaibox/utils/docstr.py":66
- *         cntcomflag = -1
- *         outstr = []
- *         for n in range(len(data)):             # <<<<<<<<<<<<<<
- *             defpos = data[n].find('def' + ' ')
- *             if defpos == -1:
- */
-      __pyx_L11_continue:;
     }
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_v_img = values[0];
+    __pyx_v_nbins = values[1];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("histeq", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 44, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pyaibox.utils.image.histeq", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pyaibox_5utils_5image_4histeq(__pyx_self, __pyx_v_img, __pyx_v_nbins);
 
-    /* "pyaibox/utils/docstr.py":91
- *                 outstr.append(data[n] + '\n')
- *                 cntcomflag = -1
- *         outstr.append('\n')             # <<<<<<<<<<<<<<
- * 
- *         if len(outstr) == 0:
- */
-    __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_outstr, __pyx_kp_u__5); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 91, __pyx_L1_error)
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
 
-    /* "pyaibox/utils/docstr.py":93
- *         outstr.append('\n')
- * 
- *         if len(outstr) == 0:             # <<<<<<<<<<<<<<
- *             continue
- * 
- */
-    __pyx_t_10 = PyList_GET_SIZE(__pyx_v_outstr); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 93, __pyx_L1_error)
-    __pyx_t_7 = ((__pyx_t_10 == 0) != 0);
-    if (__pyx_t_7) {
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_4histeq(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_nbins) {
+  PyObject *__pyx_v_dshape = NULL;
+  PyObject *__pyx_v_imhist = NULL;
+  PyObject *__pyx_v_bins = NULL;
+  PyObject *__pyx_v_cdf = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *(*__pyx_t_5)(PyObject *);
+  PyObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
+  PyObject *__pyx_t_8 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("histeq", 0);
+  __Pyx_INCREF(__pyx_v_img);
 
-      /* "pyaibox/utils/docstr.py":94
- * 
- *         if len(outstr) == 0:
- *             continue             # <<<<<<<<<<<<<<
+  /* "pyaibox/utils/image.py":45
  * 
- *         # tmpstr = []
+ * def histeq(img, nbins=256):
+ *     dshape = img.shape             # <<<<<<<<<<<<<<
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)
+ *     cdf = imhist.cumsum()
  */
-      goto __pyx_L9_continue;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_img, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_v_dshape = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-      /* "pyaibox/utils/docstr.py":93
- *         outstr.append('\n')
- * 
- *         if len(outstr) == 0:             # <<<<<<<<<<<<<<
- *             continue
- * 
+  /* "pyaibox/utils/image.py":46
+ * def histeq(img, nbins=256):
+ *     dshape = img.shape
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)             # <<<<<<<<<<<<<<
+ *     cdf = imhist.cumsum()
+ *     cdf = 255.0 * cdf / cdf[-1]
  */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_histogram); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_img, __pyx_n_s_flatten); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_4)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_4);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
     }
-
-    /* "pyaibox/utils/docstr.py":116
- *         #     continue
- * 
- *         finalstr = []             # <<<<<<<<<<<<<<
- *         outstr.append('ENDFLAG')
- *         N = len(outstr)
- */
-    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_XDECREF_SET(__pyx_v_finalstr, ((PyObject*)__pyx_t_2));
-    __pyx_t_2 = 0;
-
-    /* "pyaibox/utils/docstr.py":117
- * 
- *         finalstr = []
- *         outstr.append('ENDFLAG')             # <<<<<<<<<<<<<<
- *         N = len(outstr)
- *         for n in range(0, N-1):
- */
-    __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_outstr, __pyx_n_u_ENDFLAG); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 117, __pyx_L1_error)
-
-    /* "pyaibox/utils/docstr.py":118
- *         finalstr = []
- *         outstr.append('ENDFLAG')
- *         N = len(outstr)             # <<<<<<<<<<<<<<
- *         for n in range(0, N-1):
- *             defpos1 = outstr[n].find('def' + ' ')
- */
-    __pyx_t_10 = PyList_GET_SIZE(__pyx_v_outstr); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 118, __pyx_L1_error)
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 118, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_XDECREF_SET(__pyx_v_N, __pyx_t_2);
-    __pyx_t_2 = 0;
-
-    /* "pyaibox/utils/docstr.py":119
- *         outstr.append('ENDFLAG')
- *         N = len(outstr)
- *         for n in range(0, N-1):             # <<<<<<<<<<<<<<
- *             defpos1 = outstr[n].find('def' + ' ')
- *             defpos2 = outstr[n+1].find('def' + ' ')
- */
-    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_N, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 119, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_14);
-    __Pyx_INCREF(__pyx_int_0);
-    __Pyx_GIVEREF(__pyx_int_0);
-    PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_int_0);
-    __Pyx_GIVEREF(__pyx_t_2);
-    PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_t_2);
-    __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_14, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
-      __pyx_t_14 = __pyx_t_2; __Pyx_INCREF(__pyx_t_14); __pyx_t_10 = 0;
-      __pyx_t_6 = NULL;
+  }
+  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+  __Pyx_INCREF(__pyx_v_nbins);
+  __Pyx_GIVEREF(__pyx_v_nbins);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_nbins);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_normed, Py_True) < 0) __PYX_ERR(0, 46, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
+    PyObject* sequence = __pyx_t_4;
+    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
+    if (unlikely(size != 2)) {
+      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
+      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
+      __PYX_ERR(0, 46, __pyx_L1_error)
+    }
+    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    if (likely(PyTuple_CheckExact(sequence))) {
+      __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
+      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
     } else {
-      __pyx_t_10 = -1; __pyx_t_14 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 119, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_6 = Py_TYPE(__pyx_t_14)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 119, __pyx_L1_error)
+      __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
+      __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
     }
+    __Pyx_INCREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_t_3);
+    #else
+    __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    #endif
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  } else {
+    Py_ssize_t index = -1;
+    __pyx_t_2 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext;
+    index = 0; __pyx_t_1 = __pyx_t_5(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
+    __Pyx_GOTREF(__pyx_t_1);
+    index = 1; __pyx_t_3 = __pyx_t_5(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
+    __Pyx_GOTREF(__pyx_t_3);
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_5(__pyx_t_2), 2) < 0) __PYX_ERR(0, 46, __pyx_L1_error)
+    __pyx_t_5 = NULL;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    for (;;) {
-      if (likely(!__pyx_t_6)) {
-        if (likely(PyList_CheckExact(__pyx_t_14))) {
-          if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_14)) break;
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_14, __pyx_t_10); __Pyx_INCREF(__pyx_t_2); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 119, __pyx_L1_error)
-          #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_14, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          #endif
-        } else {
-          if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_14)) break;
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_14, __pyx_t_10); __Pyx_INCREF(__pyx_t_2); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 119, __pyx_L1_error)
-          #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_14, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          #endif
-        }
-      } else {
-        __pyx_t_2 = __pyx_t_6(__pyx_t_14);
-        if (unlikely(!__pyx_t_2)) {
-          PyObject* exc_type = PyErr_Occurred();
-          if (exc_type) {
-            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 119, __pyx_L1_error)
-          }
-          break;
-        }
-        __Pyx_GOTREF(__pyx_t_2);
-      }
-      __Pyx_XDECREF_SET(__pyx_v_n, __pyx_t_2);
-      __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":120
- *         N = len(outstr)
- *         for n in range(0, N-1):
- *             defpos1 = outstr[n].find('def' + ' ')             # <<<<<<<<<<<<<<
- *             defpos2 = outstr[n+1].find('def' + ' ')
- *             clspos1 = outstr[n].find('class' + ' ')
- */
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_outstr, __pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 120, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_find); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 120, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
-        if (likely(__pyx_t_3)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-          __Pyx_INCREF(__pyx_t_3);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_11, function);
-        }
-      }
-      __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_kp_u_def) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_kp_u_def);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 120, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_defpos1, __pyx_t_2);
-      __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":121
- *         for n in range(0, N-1):
- *             defpos1 = outstr[n].find('def' + ' ')
- *             defpos2 = outstr[n+1].find('def' + ' ')             # <<<<<<<<<<<<<<
- *             clspos1 = outstr[n].find('class' + ' ')
- *             clspos2 = outstr[n+1].find('class' + ' ')
- */
-      __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 121, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_outstr, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 121, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_find); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 121, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
-        if (likely(__pyx_t_3)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-          __Pyx_INCREF(__pyx_t_3);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_11, function);
-        }
-      }
-      __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_kp_u_def) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_kp_u_def);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 121, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_defpos2, __pyx_t_2);
-      __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":122
- *             defpos1 = outstr[n].find('def' + ' ')
- *             defpos2 = outstr[n+1].find('def' + ' ')
- *             clspos1 = outstr[n].find('class' + ' ')             # <<<<<<<<<<<<<<
- *             clspos2 = outstr[n+1].find('class' + ' ')
- * 
- */
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_outstr, __pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 122, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_find); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 122, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
-        if (likely(__pyx_t_11)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-          __Pyx_INCREF(__pyx_t_11);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
-        }
-      }
-      __pyx_t_2 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_11, __pyx_kp_u_class) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_kp_u_class);
-      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_clspos1, __pyx_t_2);
-      __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":123
- *             defpos2 = outstr[n+1].find('def' + ' ')
- *             clspos1 = outstr[n].find('class' + ' ')
- *             clspos2 = outstr[n+1].find('class' + ' ')             # <<<<<<<<<<<<<<
- * 
- *             finalstr.append(outstr[n])
- */
-      __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 123, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_outstr, __pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 123, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_find); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 123, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
-        if (likely(__pyx_t_11)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-          __Pyx_INCREF(__pyx_t_11);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
-        }
-      }
-      __pyx_t_2 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_11, __pyx_kp_u_class) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_kp_u_class);
-      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 123, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_clspos2, __pyx_t_2);
-      __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":125
- *             clspos2 = outstr[n+1].find('class' + ' ')
- * 
- *             finalstr.append(outstr[n])             # <<<<<<<<<<<<<<
- * 
- *             startpos = -1 if (defpos1<0 and clspos1<0) else max(defpos1, clspos1)
- */
-      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_outstr, __pyx_v_n); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 125, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_finalstr, __pyx_t_2); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 125, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":127
- *             finalstr.append(outstr[n])
- * 
- *             startpos = -1 if (defpos1<0 and clspos1<0) else max(defpos1, clspos1)             # <<<<<<<<<<<<<<
- *             endpos = -1 if (defpos2<0 and clspos2<0) else max(defpos2, clspos2)
- *             if (startpos>=0 and endpos>=0) or (startpos>=0 and outstr[n+1]=='ENDFLAG'):
- */
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_defpos1, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 127, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 127, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__pyx_t_8) {
-      } else {
-        __pyx_t_7 = __pyx_t_8;
-        goto __pyx_L25_bool_binop_done;
-      }
-      __pyx_t_3 = PyObject_RichCompare(__pyx_v_clspos1, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 127, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 127, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_7 = __pyx_t_8;
-      __pyx_L25_bool_binop_done:;
-      if (__pyx_t_7) {
-        __Pyx_INCREF(__pyx_int_neg_1);
-        __pyx_t_2 = __pyx_int_neg_1;
-      } else {
-        __Pyx_INCREF(__pyx_v_clspos1);
-        __pyx_t_3 = __pyx_v_clspos1;
-        __Pyx_INCREF(__pyx_v_defpos1);
-        __pyx_t_11 = __pyx_v_defpos1;
-        __pyx_t_15 = PyObject_RichCompare(__pyx_t_3, __pyx_t_11, Py_GT); __Pyx_XGOTREF(__pyx_t_15); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 127, __pyx_L1_error)
-        __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_15); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 127, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        if (__pyx_t_8) {
-          __Pyx_INCREF(__pyx_t_3);
-          __pyx_t_1 = __pyx_t_3;
-        } else {
-          __Pyx_INCREF(__pyx_t_11);
-          __pyx_t_1 = __pyx_t_11;
-        }
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __Pyx_INCREF(__pyx_t_1);
-        __pyx_t_2 = __pyx_t_1;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      }
-      __Pyx_XDECREF_SET(__pyx_v_startpos, __pyx_t_2);
-      __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":128
- * 
- *             startpos = -1 if (defpos1<0 and clspos1<0) else max(defpos1, clspos1)
- *             endpos = -1 if (defpos2<0 and clspos2<0) else max(defpos2, clspos2)             # <<<<<<<<<<<<<<
- *             if (startpos>=0 and endpos>=0) or (startpos>=0 and outstr[n+1]=='ENDFLAG'):
- *                 # finalstr.append(' '*(startpos + 4) + 'r"' + '"' + '"' + '\n' + ' '*(startpos + 4) + 'r"' + '"' + '"' + '\n\n')
- */
-      __pyx_t_1 = PyObject_RichCompare(__pyx_v_defpos2, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 128, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (__pyx_t_8) {
-      } else {
-        __pyx_t_7 = __pyx_t_8;
-        goto __pyx_L27_bool_binop_done;
-      }
-      __pyx_t_1 = PyObject_RichCompare(__pyx_v_clspos2, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 128, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_7 = __pyx_t_8;
-      __pyx_L27_bool_binop_done:;
-      if (__pyx_t_7) {
-        __Pyx_INCREF(__pyx_int_neg_1);
-        __pyx_t_2 = __pyx_int_neg_1;
-      } else {
-        __Pyx_INCREF(__pyx_v_clspos2);
-        __pyx_t_1 = __pyx_v_clspos2;
-        __Pyx_INCREF(__pyx_v_defpos2);
-        __pyx_t_3 = __pyx_v_defpos2;
-        __pyx_t_15 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_GT); __Pyx_XGOTREF(__pyx_t_15); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 128, __pyx_L1_error)
-        __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_15); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 128, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        if (__pyx_t_8) {
-          __Pyx_INCREF(__pyx_t_1);
-          __pyx_t_11 = __pyx_t_1;
-        } else {
-          __Pyx_INCREF(__pyx_t_3);
-          __pyx_t_11 = __pyx_t_3;
-        }
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_INCREF(__pyx_t_11);
-        __pyx_t_2 = __pyx_t_11;
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      }
-      __Pyx_XDECREF_SET(__pyx_v_endpos, __pyx_t_2);
-      __pyx_t_2 = 0;
-
-      /* "pyaibox/utils/docstr.py":129
- *             startpos = -1 if (defpos1<0 and clspos1<0) else max(defpos1, clspos1)
- *             endpos = -1 if (defpos2<0 and clspos2<0) else max(defpos2, clspos2)
- *             if (startpos>=0 and endpos>=0) or (startpos>=0 and outstr[n+1]=='ENDFLAG'):             # <<<<<<<<<<<<<<
- *                 # finalstr.append(' '*(startpos + 4) + 'r"' + '"' + '"' + '\n' + ' '*(startpos + 4) + 'r"' + '"' + '"' + '\n\n')
- *                 finalstr.append(' '*(startpos + 4) + '...\n\n')
- */
-      __pyx_t_2 = PyObject_RichCompare(__pyx_v_startpos, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (!__pyx_t_8) {
-        goto __pyx_L31_next_or;
-      } else {
-      }
-      __pyx_t_2 = PyObject_RichCompare(__pyx_v_endpos, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (!__pyx_t_8) {
-      } else {
-        __pyx_t_7 = __pyx_t_8;
-        goto __pyx_L30_bool_binop_done;
-      }
-      __pyx_L31_next_or:;
-      __pyx_t_2 = PyObject_RichCompare(__pyx_v_startpos, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (__pyx_t_8) {
-      } else {
-        __pyx_t_7 = __pyx_t_8;
-        goto __pyx_L30_bool_binop_done;
-      }
-      __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_outstr, __pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_11, __pyx_n_u_ENDFLAG, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_7 = __pyx_t_8;
-      __pyx_L30_bool_binop_done:;
-      if (__pyx_t_7) {
-
-        /* "pyaibox/utils/docstr.py":131
- *             if (startpos>=0 and endpos>=0) or (startpos>=0 and outstr[n+1]=='ENDFLAG'):
- *                 # finalstr.append(' '*(startpos + 4) + 'r"' + '"' + '"' + '\n' + ' '*(startpos + 4) + 'r"' + '"' + '"' + '\n\n')
- *                 finalstr.append(' '*(startpos + 4) + '...\n\n')             # <<<<<<<<<<<<<<
- * 
- *         for ostr in finalstr:
- */
-        __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_startpos, __pyx_int_4, 4, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 131, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_2 = PyNumber_Multiply(__pyx_kp_u__2, __pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 131, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = PyNumber_Add(__pyx_t_2, __pyx_kp_u__6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 131, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_finalstr, __pyx_t_11); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 131, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-
-        /* "pyaibox/utils/docstr.py":129
- *             startpos = -1 if (defpos1<0 and clspos1<0) else max(defpos1, clspos1)
- *             endpos = -1 if (defpos2<0 and clspos2<0) else max(defpos2, clspos2)
- *             if (startpos>=0 and endpos>=0) or (startpos>=0 and outstr[n+1]=='ENDFLAG'):             # <<<<<<<<<<<<<<
- *                 # finalstr.append(' '*(startpos + 4) + 'r"' + '"' + '"' + '\n' + ' '*(startpos + 4) + 'r"' + '"' + '"' + '\n\n')
- *                 finalstr.append(' '*(startpos + 4) + '...\n\n')
- */
-      }
-
-      /* "pyaibox/utils/docstr.py":119
- *         outstr.append('ENDFLAG')
- *         N = len(outstr)
- *         for n in range(0, N-1):             # <<<<<<<<<<<<<<
- *             defpos1 = outstr[n].find('def' + ' ')
- *             defpos2 = outstr[n+1].find('def' + ' ')
+    goto __pyx_L4_unpacking_done;
+    __pyx_L3_unpacking_failed:;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_5 = NULL;
+    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
+    __PYX_ERR(0, 46, __pyx_L1_error)
+    __pyx_L4_unpacking_done:;
+  }
+  __pyx_v_imhist = __pyx_t_1;
+  __pyx_t_1 = 0;
+  __pyx_v_bins = __pyx_t_3;
+  __pyx_t_3 = 0;
+
+  /* "pyaibox/utils/image.py":47
+ *     dshape = img.shape
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)
+ *     cdf = imhist.cumsum()             # <<<<<<<<<<<<<<
+ *     cdf = 255.0 * cdf / cdf[-1]
+ *     #
  */
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_imhist, __pyx_n_s_cumsum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 47, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_1)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_1);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
     }
-    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-
-    /* "pyaibox/utils/docstr.py":133
- *                 finalstr.append(' '*(startpos + 4) + '...\n\n')
- * 
- *         for ostr in finalstr:             # <<<<<<<<<<<<<<
- *             fpyi.write(ostr)
- * 
- */
-    __pyx_t_14 = __pyx_v_finalstr; __Pyx_INCREF(__pyx_t_14); __pyx_t_10 = 0;
-    for (;;) {
-      if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_14)) break;
-      #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_11 = PyList_GET_ITEM(__pyx_t_14, __pyx_t_10); __Pyx_INCREF(__pyx_t_11); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 133, __pyx_L1_error)
-      #else
-      __pyx_t_11 = PySequence_ITEM(__pyx_t_14, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 133, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      #endif
-      __Pyx_XDECREF_SET(__pyx_v_ostr, __pyx_t_11);
-      __pyx_t_11 = 0;
+  }
+  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 47, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_cdf = __pyx_t_4;
+  __pyx_t_4 = 0;
 
-      /* "pyaibox/utils/docstr.py":134
- * 
- *         for ostr in finalstr:
- *             fpyi.write(ostr)             # <<<<<<<<<<<<<<
- * 
- *         # fpyi.write(finalstr[0])
+  /* "pyaibox/utils/image.py":48
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)
+ *     cdf = imhist.cumsum()
+ *     cdf = 255.0 * cdf / cdf[-1]             # <<<<<<<<<<<<<<
+ *     #
+ *     img = np.interp(img.flatten(), bins[:-1], cdf)
  */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fpyi, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_1)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_1);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
-        }
-      }
-      __pyx_t_11 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_v_ostr) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ostr);
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 134, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_4 = PyNumber_Multiply(__pyx_float_255_0, __pyx_v_cdf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_cdf, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(__pyx_v_cdf, __pyx_t_1);
+  __pyx_t_1 = 0;
 
-      /* "pyaibox/utils/docstr.py":133
- *                 finalstr.append(' '*(startpos + 4) + '...\n\n')
- * 
- *         for ostr in finalstr:             # <<<<<<<<<<<<<<
- *             fpyi.write(ostr)
+  /* "pyaibox/utils/image.py":50
+ *     cdf = 255.0 * cdf / cdf[-1]
+ *     #
+ *     img = np.interp(img.flatten(), bins[:-1], cdf)             # <<<<<<<<<<<<<<
+ *     return img.reshape(dshape)
  * 
  */
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_interp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_img, __pyx_n_s_flatten); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_6 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_6)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_6);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
     }
-    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-
-    /* "pyaibox/utils/docstr.py":149
- *         #         fpyi.write(finalstr[n])
- * 
- *         fpy.close()             # <<<<<<<<<<<<<<
- *         fpyi.close()
- * 
- */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_fpy, __pyx_n_s_close); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 149, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_2 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_2);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_11, function);
-      }
+  }
+  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_bins, 0, -1L, NULL, NULL, &__pyx_slice_, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_6 = NULL;
+  __pyx_t_7 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_6)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_6);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
+      __pyx_t_7 = 1;
     }
-    __pyx_t_14 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_11);
-    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 149, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_14);
-    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-
-    /* "pyaibox/utils/docstr.py":150
- * 
- *         fpy.close()
- *         fpyi.close()             # <<<<<<<<<<<<<<
- * 
- *     return 0
- */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_fpyi, __pyx_n_s_close); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 150, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_2 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_2);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_11, function);
-      }
+  }
+  #if CYTHON_FAST_PYCALL
+  if (PyFunction_Check(__pyx_t_4)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_2, __pyx_v_cdf};
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  } else
+  #endif
+  #if CYTHON_FAST_PYCCALL
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_2, __pyx_v_cdf};
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  } else
+  #endif
+  {
+    __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 50, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_8);
+    if (__pyx_t_6) {
+      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
     }
-    __pyx_t_14 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_11);
-    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 150, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_14);
-    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-
-    /* "pyaibox/utils/docstr.py":58
- *             dstfiles.append(file)
- * 
- *     for pyfile in dstfiles:             # <<<<<<<<<<<<<<
- *         pyifile = pyfile[:-len(filetype)] + dstfiletype
- * 
- */
-    __pyx_L9_continue:;
+    __Pyx_GIVEREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_2);
+    __Pyx_INCREF(__pyx_v_cdf);
+    __Pyx_GIVEREF(__pyx_v_cdf);
+    PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_v_cdf);
+    __pyx_t_3 = 0;
+    __pyx_t_2 = 0;
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF_SET(__pyx_v_img, __pyx_t_1);
+  __pyx_t_1 = 0;
 
-  /* "pyaibox/utils/docstr.py":152
- *         fpyi.close()
+  /* "pyaibox/utils/image.py":51
+ *     #
+ *     img = np.interp(img.flatten(), bins[:-1], cdf)
+ *     return img.reshape(dshape)             # <<<<<<<<<<<<<<
  * 
- *     return 0             # <<<<<<<<<<<<<<
  * 
- * def rmcache(pkgdir, exts='.c'):
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_int_0);
-  __pyx_r = __pyx_int_0;
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_img, __pyx_n_s_reshape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 51, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_8 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_8)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_8);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
+    }
+  }
+  __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_8, __pyx_v_dshape) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_dshape);
+  __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 51, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "pyaibox/utils/docstr.py":33
- * 
+  /* "pyaibox/utils/image.py":44
  * 
- * def gpyi(pkgdir, autoskip=True):             # <<<<<<<<<<<<<<
- *     r"""generates ``pyi`` files
  * 
+ * def histeq(img, nbins=256):             # <<<<<<<<<<<<<<
+ *     dshape = img.shape
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_15);
-  __Pyx_AddTraceback("pyaibox.utils.docstr.gpyi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_AddTraceback("pyaibox.utils.image.histeq", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_filetype);
-  __Pyx_XDECREF(__pyx_v_dstfiletype);
-  __Pyx_XDECREF(__pyx_v_allfiles);
-  __Pyx_XDECREF(__pyx_v_dstfiles);
-  __Pyx_XDECREF(__pyx_v_file);
-  __Pyx_XDECREF(__pyx_v_pyfile);
-  __Pyx_XDECREF(__pyx_v_pyifile);
-  __Pyx_XDECREF(__pyx_v_fpy);
-  __Pyx_XDECREF(__pyx_v_fpyi);
-  __Pyx_XDECREF(__pyx_v_data);
-  __Pyx_XDECREF(__pyx_v_cntcomflag);
-  __Pyx_XDECREF(__pyx_v_outstr);
-  __Pyx_XDECREF(__pyx_v_n);
-  __Pyx_XDECREF(__pyx_v_defpos);
-  __Pyx_XDECREF(__pyx_v_k);
-  __Pyx_XDECREF(__pyx_v_compos);
-  __Pyx_XDECREF(__pyx_v_finalstr);
-  __Pyx_XDECREF(__pyx_v_N);
-  __Pyx_XDECREF(__pyx_v_defpos1);
-  __Pyx_XDECREF(__pyx_v_defpos2);
-  __Pyx_XDECREF(__pyx_v_clspos1);
-  __Pyx_XDECREF(__pyx_v_clspos2);
-  __Pyx_XDECREF(__pyx_v_startpos);
-  __Pyx_XDECREF(__pyx_v_endpos);
-  __Pyx_XDECREF(__pyx_v_ostr);
+  __Pyx_XDECREF(__pyx_v_dshape);
+  __Pyx_XDECREF(__pyx_v_imhist);
+  __Pyx_XDECREF(__pyx_v_bins);
+  __Pyx_XDECREF(__pyx_v_cdf);
+  __Pyx_XDECREF(__pyx_v_img);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyaibox/utils/docstr.py":154
- *     return 0
+/* "pyaibox/utils/image.py":54
  * 
- * def rmcache(pkgdir, exts='.c'):             # <<<<<<<<<<<<<<
- *     r"""remove cache files
+ * 
+ * def imresize(img, oshape=None, odtype=None, order=1, mode='constant', cval=0, clip=True, preserve_range=False):             # <<<<<<<<<<<<<<
+ *     r"""resize image to oshape
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_7pyaibox_5utils_6docstr_3rmcache(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_7pyaibox_5utils_6docstr_2rmcache[] = "remove cache files\n\n    Parameters\n    ----------\n    pkgdir : str\n        package root directory\n    ext : str, optional\n        file extension\n    ";
-static PyMethodDef __pyx_mdef_7pyaibox_5utils_6docstr_3rmcache = {"rmcache", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_5utils_6docstr_3rmcache, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_5utils_6docstr_2rmcache};
-static PyObject *__pyx_pw_7pyaibox_5utils_6docstr_3rmcache(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_pkgdir = 0;
-  PyObject *__pyx_v_exts = 0;
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_7imresize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_7pyaibox_5utils_5image_6imresize[] = "resize image to oshape\n\n    see :func:`skimage.transform.resize`.\n\n    Parameters\n    ----------\n    img : ndarray\n        Input image.\n    oshape : tulpe, optional\n        output shape (the default is None, which is the same as the input)\n    odtype : str, optional\n        output data type, ``'uint8', 'uint16', 'int8', ...`` (the default is None, float)\n    order : int, optional\n        The order of the spline interpolation, default is 1. The order has to\n        be in the range 0-5. See `skimage.transform.warp` for detail.\n    mode : str, optional\n        Points outside the boundaries of the input are filled according\n        to the given mode. {``'constant'``, ``'edge'``, ``'symmetric'``, ``'reflect'``, ``'wrap'``},\n        Modes match the behaviour of `numpy.pad`.  The\n        default mode is 'constant'.\n    cval : float, optional\n        Used in conjunction with mode 'constant', the value outside\n        the image boundaries.\n    clip : bool, optional\n        Whether to clip the output to the range of values of the input image.\n        This is enabled by default, since higher order interpolation may\n        produce values outside the given input range.\n    preserve_range : bool, optional\n        Whether to keep the original range of values. Otherwise, the input\n        image is converted according to the conventions of `img_as_float`.\n\n    Returns\n    -------\n    resized : ndarray\n        Resized version of the input.\n\n    Notes\n    -----\n    Modes 'reflect' and 'symmetric' are similar, but differ in whether the edge\n    pixels are duplicated during the reflection.  As an example, if an array\n    has values [0, 1, 2] and was padded to the right by four values using\n    symmetric, the result would be [0, 1, 2, 2, 1, 0, 0], while for reflect it\n    would be [0, 1, 2, 1, 0, 1, 2].\n\n    Examples\n    --------\n    ::\n\n        >>> from skimage import data\n        >>> from skimage.transform import resize\n        >>> ima""ge = data.camera()\n        >>> resize(image, (100, 100), mode='reflect').shape\n        (100, 100)\n\n    ";
+static PyMethodDef __pyx_mdef_7pyaibox_5utils_5image_7imresize = {"imresize", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pyaibox_5utils_5image_7imresize, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7pyaibox_5utils_5image_6imresize};
+static PyObject *__pyx_pw_7pyaibox_5utils_5image_7imresize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_img = 0;
+  PyObject *__pyx_v_oshape = 0;
+  PyObject *__pyx_v_odtype = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_order = 0;
+  PyObject *__pyx_v_mode = 0;
+  PyObject *__pyx_v_cval = 0;
+  PyObject *__pyx_v_clip = 0;
+  PyObject *__pyx_v_preserve_range = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("rmcache (wrapper)", 0);
+  __Pyx_RefNannySetupContext("imresize (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_pkgdir,&__pyx_n_s_exts,0};
-    PyObject* values[2] = {0,0};
-    values[1] = ((PyObject *)((PyObject*)__pyx_kp_u_c));
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_img,&__pyx_n_s_oshape,&__pyx_n_s_odtype,&__pyx_n_s_order,&__pyx_n_s_mode,&__pyx_n_s_cval,&__pyx_n_s_clip,&__pyx_n_s_preserve_range,0};
+    PyObject* values[8] = {0,0,0,0,0,0,0,0};
+    values[1] = ((PyObject *)((PyObject *)Py_None));
+    values[2] = ((PyObject *)((PyObject *)Py_None));
+    values[3] = ((PyObject *)((PyObject *)__pyx_int_1));
+    values[4] = ((PyObject *)((PyObject*)__pyx_n_u_constant));
+    values[5] = ((PyObject *)((PyObject *)__pyx_int_0));
+    values[6] = ((PyObject *)((PyObject *)Py_True));
+    values[7] = ((PyObject *)((PyObject *)Py_False));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pkgdir)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exts);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_oshape);
           if (value) { values[1] = value; kw_args--; }
         }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_odtype);
+          if (value) { values[2] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_order);
+          if (value) { values[3] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mode);
+          if (value) { values[4] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cval);
+          if (value) { values[5] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_clip);
+          if (value) { values[6] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_preserve_range);
+          if (value) { values[7] = value; kw_args--; }
+        }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rmcache") < 0)) __PYX_ERR(0, 154, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "imresize") < 0)) __PYX_ERR(0, 54, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_pkgdir = values[0];
-    __pyx_v_exts = values[1];
+    __pyx_v_img = values[0];
+    __pyx_v_oshape = values[1];
+    __pyx_v_odtype = values[2];
+    __pyx_v_order = values[3];
+    __pyx_v_mode = values[4];
+    __pyx_v_cval = values[5];
+    __pyx_v_clip = values[6];
+    __pyx_v_preserve_range = values[7];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("rmcache", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 154, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("imresize", 0, 1, 8, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 54, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("pyaibox.utils.docstr.rmcache", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyaibox.utils.image.imresize", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_7pyaibox_5utils_6docstr_2rmcache(__pyx_self, __pyx_v_pkgdir, __pyx_v_exts);
+  __pyx_r = __pyx_pf_7pyaibox_5utils_5image_6imresize(__pyx_self, __pyx_v_img, __pyx_v_oshape, __pyx_v_odtype, __pyx_v_order, __pyx_v_mode, __pyx_v_cval, __pyx_v_clip, __pyx_v_preserve_range);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_7pyaibox_5utils_6docstr_2rmcache(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pkgdir, PyObject *__pyx_v_exts) {
-  PyObject *__pyx_v_allcfiles = NULL;
-  PyObject *__pyx_v_file = NULL;
+static PyObject *__pyx_pf_7pyaibox_5utils_5image_6imresize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_oshape, PyObject *__pyx_v_odtype, CYTHON_UNUSED PyObject *__pyx_v_order, PyObject *__pyx_v_mode, PyObject *__pyx_v_cval, PyObject *__pyx_v_clip, PyObject *__pyx_v_preserve_range) {
+  PyObject *__pyx_v_oimage = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  int __pyx_t_1;
+  PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  Py_ssize_t __pyx_t_6;
-  PyObject *(*__pyx_t_7)(PyObject *);
+  int __pyx_t_5;
+  int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("rmcache", 0);
+  __Pyx_RefNannySetupContext("imresize", 0);
 
-  /* "pyaibox/utils/docstr.py":165
+  /* "pyaibox/utils/image.py":111
  *     """
  * 
- *     if exts == '.py':             # <<<<<<<<<<<<<<
- *         raise TypeError("danger!")
+ *     oimage = skimresize(img, output_shape=oshape, order=1, mode=mode,             # <<<<<<<<<<<<<<
+ *                         cval=cval, clip=clip, preserve_range=preserve_range)
  * 
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_exts, __pyx_kp_u_py, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 165, __pyx_L1_error)
-  if (unlikely(__pyx_t_1)) {
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_skimresize); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(__pyx_v_img);
+  __Pyx_GIVEREF(__pyx_v_img);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_img);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_output_shape, __pyx_v_oshape) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_order, __pyx_int_1) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_mode, __pyx_v_mode) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
 
-    /* "pyaibox/utils/docstr.py":166
+  /* "pyaibox/utils/image.py":112
  * 
- *     if exts == '.py':
- *         raise TypeError("danger!")             # <<<<<<<<<<<<<<
+ *     oimage = skimresize(img, output_shape=oshape, order=1, mode=mode,
+ *                         cval=cval, clip=clip, preserve_range=preserve_range)             # <<<<<<<<<<<<<<
  * 
- *     allcfiles = listxfile(pkgdir, exts=exts, recursive=True)
+ *     if odtype is not None:
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 166, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 166, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_cval, __pyx_v_cval) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_clip, __pyx_v_clip) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_preserve_range, __pyx_v_preserve_range) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
 
-    /* "pyaibox/utils/docstr.py":165
+  /* "pyaibox/utils/image.py":111
  *     """
  * 
- *     if exts == '.py':             # <<<<<<<<<<<<<<
- *         raise TypeError("danger!")
+ *     oimage = skimresize(img, output_shape=oshape, order=1, mode=mode,             # <<<<<<<<<<<<<<
+ *                         cval=cval, clip=clip, preserve_range=preserve_range)
  * 
  */
-  }
-
-  /* "pyaibox/utils/docstr.py":168
- *         raise TypeError("danger!")
- * 
- *     allcfiles = listxfile(pkgdir, exts=exts, recursive=True)             # <<<<<<<<<<<<<<
- *     for file in allcfiles:
- *         os.remove(file)
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_listxfile); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 168, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_INCREF(__pyx_v_pkgdir);
-  __Pyx_GIVEREF(__pyx_v_pkgdir);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_pkgdir);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 168, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_exts, __pyx_v_exts) < 0) __PYX_ERR(0, 168, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_recursive, Py_True) < 0) __PYX_ERR(0, 168, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 168, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_allcfiles = __pyx_t_5;
-  __pyx_t_5 = 0;
+  __pyx_v_oimage = __pyx_t_4;
+  __pyx_t_4 = 0;
 
-  /* "pyaibox/utils/docstr.py":169
+  /* "pyaibox/utils/image.py":114
+ *                         cval=cval, clip=clip, preserve_range=preserve_range)
  * 
- *     allcfiles = listxfile(pkgdir, exts=exts, recursive=True)
- *     for file in allcfiles:             # <<<<<<<<<<<<<<
- *         os.remove(file)
+ *     if odtype is not None:             # <<<<<<<<<<<<<<
+ *         oimage = oimage.astype(odtype)
  * 
  */
-  if (likely(PyList_CheckExact(__pyx_v_allcfiles)) || PyTuple_CheckExact(__pyx_v_allcfiles)) {
-    __pyx_t_5 = __pyx_v_allcfiles; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
-    __pyx_t_7 = NULL;
-  } else {
-    __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_allcfiles); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 169, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 169, __pyx_L1_error)
-  }
-  for (;;) {
-    if (likely(!__pyx_t_7)) {
-      if (likely(PyList_CheckExact(__pyx_t_5))) {
-        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
-        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 169, __pyx_L1_error)
-        #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 169, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        #endif
-      } else {
-        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
-        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 169, __pyx_L1_error)
-        #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 169, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        #endif
-      }
-    } else {
-      __pyx_t_4 = __pyx_t_7(__pyx_t_5);
-      if (unlikely(!__pyx_t_4)) {
-        PyObject* exc_type = PyErr_Occurred();
-        if (exc_type) {
-          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 169, __pyx_L1_error)
-        }
-        break;
-      }
-      __Pyx_GOTREF(__pyx_t_4);
-    }
-    __Pyx_XDECREF_SET(__pyx_v_file, __pyx_t_4);
-    __pyx_t_4 = 0;
+  __pyx_t_5 = (__pyx_v_odtype != Py_None);
+  __pyx_t_6 = (__pyx_t_5 != 0);
+  if (__pyx_t_6) {
 
-    /* "pyaibox/utils/docstr.py":170
- *     allcfiles = listxfile(pkgdir, exts=exts, recursive=True)
- *     for file in allcfiles:
- *         os.remove(file)             # <<<<<<<<<<<<<<
+    /* "pyaibox/utils/image.py":115
+ * 
+ *     if odtype is not None:
+ *         oimage = oimage.astype(odtype)             # <<<<<<<<<<<<<<
  * 
- *     return 0
+ *     return oimage
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_os); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_oimage, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 115, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_remove); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 170, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_3)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_3);
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
-    __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_file) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_file);
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
+    __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_odtype) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_odtype);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 115, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF_SET(__pyx_v_oimage, __pyx_t_4);
+    __pyx_t_4 = 0;
 
-    /* "pyaibox/utils/docstr.py":169
+    /* "pyaibox/utils/image.py":114
+ *                         cval=cval, clip=clip, preserve_range=preserve_range)
  * 
- *     allcfiles = listxfile(pkgdir, exts=exts, recursive=True)
- *     for file in allcfiles:             # <<<<<<<<<<<<<<
- *         os.remove(file)
+ *     if odtype is not None:             # <<<<<<<<<<<<<<
+ *         oimage = oimage.astype(odtype)
  * 
  */
   }
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "pyaibox/utils/docstr.py":172
- *         os.remove(file)
- * 
- *     return 0             # <<<<<<<<<<<<<<
- * 
+  /* "pyaibox/utils/image.py":117
+ *         oimage = oimage.astype(odtype)
  * 
+ *     return oimage             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_int_0);
-  __pyx_r = __pyx_int_0;
+  __Pyx_INCREF(__pyx_v_oimage);
+  __pyx_r = __pyx_v_oimage;
   goto __pyx_L0;
 
-  /* "pyaibox/utils/docstr.py":154
- *     return 0
+  /* "pyaibox/utils/image.py":54
+ * 
  * 
- * def rmcache(pkgdir, exts='.c'):             # <<<<<<<<<<<<<<
- *     r"""remove cache files
+ * def imresize(img, oshape=None, odtype=None, order=1, mode='constant', cval=0, clip=True, preserve_range=False):             # <<<<<<<<<<<<<<
+ *     r"""resize image to oshape
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_AddTraceback("pyaibox.utils.docstr.rmcache", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("pyaibox.utils.image.imresize", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_allcfiles);
-  __Pyx_XDECREF(__pyx_v_file);
+  __Pyx_XDECREF(__pyx_v_oimage);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
-static int __pyx_pymod_exec_docstr(PyObject* module); /*proto*/
+static int __pyx_pymod_exec_image(PyObject* module); /*proto*/
 static PyModuleDef_Slot __pyx_moduledef_slots[] = {
   {Py_mod_create, (void*)__pyx_pymod_create},
-  {Py_mod_exec, (void*)__pyx_pymod_exec_docstr},
+  {Py_mod_exec, (void*)__pyx_pymod_exec_image},
   {0, NULL}
 };
 #endif
 
 static struct PyModuleDef __pyx_moduledef = {
     PyModuleDef_HEAD_INIT,
-    "docstr",
+    "image",
     0, /* m_doc */
   #if CYTHON_PEP489_MULTI_PHASE_INIT
     0, /* m_size */
   #else
     -1, /* m_size */
   #endif
     __pyx_methods /* m_methods */,
@@ -3581,162 +2446,149 @@
     #define CYTHON_SMALL_CODE __attribute__((cold))
 #else
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
-  {&__pyx_kp_u_, __pyx_k_, sizeof(__pyx_k_), 0, 1, 0, 0},
-  {&__pyx_n_u_ENDFLAG, __pyx_k_ENDFLAG, sizeof(__pyx_k_ENDFLAG), 0, 1, 0, 1},
-  {&__pyx_n_s_N, __pyx_k_N, sizeof(__pyx_k_N), 0, 0, 1, 1},
-  {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
-  {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
-  {&__pyx_kp_u__4, __pyx_k__4, sizeof(__pyx_k__4), 0, 1, 0, 0},
-  {&__pyx_kp_u__5, __pyx_k__5, sizeof(__pyx_k__5), 0, 1, 0, 0},
-  {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
-  {&__pyx_n_s_allcfiles, __pyx_k_allcfiles, sizeof(__pyx_k_allcfiles), 0, 0, 1, 1},
-  {&__pyx_n_s_allfiles, __pyx_k_allfiles, sizeof(__pyx_k_allfiles), 0, 0, 1, 1},
-  {&__pyx_n_s_autoskip, __pyx_k_autoskip, sizeof(__pyx_k_autoskip), 0, 0, 1, 1},
-  {&__pyx_kp_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 0},
-  {&__pyx_kp_u_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 1, 0, 0},
+  {&__pyx_n_s_astype, __pyx_k_astype, sizeof(__pyx_k_astype), 0, 0, 1, 1},
+  {&__pyx_n_s_bins, __pyx_k_bins, sizeof(__pyx_k_bins), 0, 0, 1, 1},
+  {&__pyx_n_s_cdf, __pyx_k_cdf, sizeof(__pyx_k_cdf), 0, 0, 1, 1},
+  {&__pyx_n_s_check_contrast, __pyx_k_check_contrast, sizeof(__pyx_k_check_contrast), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
-  {&__pyx_n_s_close, __pyx_k_close, sizeof(__pyx_k_close), 0, 0, 1, 1},
-  {&__pyx_n_s_clspos1, __pyx_k_clspos1, sizeof(__pyx_k_clspos1), 0, 0, 1, 1},
-  {&__pyx_n_s_clspos2, __pyx_k_clspos2, sizeof(__pyx_k_clspos2), 0, 0, 1, 1},
-  {&__pyx_n_s_cntcomflag, __pyx_k_cntcomflag, sizeof(__pyx_k_cntcomflag), 0, 0, 1, 1},
-  {&__pyx_n_s_compos, __pyx_k_compos, sizeof(__pyx_k_compos), 0, 0, 1, 1},
-  {&__pyx_kp_u_danger, __pyx_k_danger, sizeof(__pyx_k_danger), 0, 1, 0, 0},
-  {&__pyx_n_s_data, __pyx_k_data, sizeof(__pyx_k_data), 0, 0, 1, 1},
-  {&__pyx_kp_u_def, __pyx_k_def, sizeof(__pyx_k_def), 0, 1, 0, 0},
-  {&__pyx_n_s_defpos, __pyx_k_defpos, sizeof(__pyx_k_defpos), 0, 0, 1, 1},
-  {&__pyx_n_s_defpos1, __pyx_k_defpos1, sizeof(__pyx_k_defpos1), 0, 0, 1, 1},
-  {&__pyx_n_s_defpos2, __pyx_k_defpos2, sizeof(__pyx_k_defpos2), 0, 0, 1, 1},
-  {&__pyx_n_s_dstfiles, __pyx_k_dstfiles, sizeof(__pyx_k_dstfiles), 0, 0, 1, 1},
-  {&__pyx_n_s_dstfiletype, __pyx_k_dstfiletype, sizeof(__pyx_k_dstfiletype), 0, 0, 1, 1},
-  {&__pyx_n_s_endpos, __pyx_k_endpos, sizeof(__pyx_k_endpos), 0, 0, 1, 1},
-  {&__pyx_n_s_exts, __pyx_k_exts, sizeof(__pyx_k_exts), 0, 0, 1, 1},
-  {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
-  {&__pyx_n_s_filetype, __pyx_k_filetype, sizeof(__pyx_k_filetype), 0, 0, 1, 1},
-  {&__pyx_n_s_finalstr, __pyx_k_finalstr, sizeof(__pyx_k_finalstr), 0, 0, 1, 1},
-  {&__pyx_n_s_find, __pyx_k_find, sizeof(__pyx_k_find), 0, 0, 1, 1},
-  {&__pyx_n_s_fpy, __pyx_k_fpy, sizeof(__pyx_k_fpy), 0, 0, 1, 1},
-  {&__pyx_n_s_fpyi, __pyx_k_fpyi, sizeof(__pyx_k_fpyi), 0, 0, 1, 1},
-  {&__pyx_n_s_gpyi, __pyx_k_gpyi, sizeof(__pyx_k_gpyi), 0, 0, 1, 1},
+  {&__pyx_n_s_clip, __pyx_k_clip, sizeof(__pyx_k_clip), 0, 0, 1, 1},
+  {&__pyx_n_u_constant, __pyx_k_constant, sizeof(__pyx_k_constant), 0, 1, 0, 1},
+  {&__pyx_n_s_cumsum, __pyx_k_cumsum, sizeof(__pyx_k_cumsum), 0, 0, 1, 1},
+  {&__pyx_n_s_cval, __pyx_k_cval, sizeof(__pyx_k_cval), 0, 0, 1, 1},
+  {&__pyx_n_s_dshape, __pyx_k_dshape, sizeof(__pyx_k_dshape), 0, 0, 1, 1},
+  {&__pyx_n_s_flatten, __pyx_k_flatten, sizeof(__pyx_k_flatten), 0, 0, 1, 1},
+  {&__pyx_n_s_histeq, __pyx_k_histeq, sizeof(__pyx_k_histeq), 0, 0, 1, 1},
+  {&__pyx_n_s_histogram, __pyx_k_histogram, sizeof(__pyx_k_histogram), 0, 0, 1, 1},
+  {&__pyx_n_s_img, __pyx_k_img, sizeof(__pyx_k_img), 0, 0, 1, 1},
+  {&__pyx_n_s_imgfile, __pyx_k_imgfile, sizeof(__pyx_k_imgfile), 0, 0, 1, 1},
+  {&__pyx_n_s_imhist, __pyx_k_imhist, sizeof(__pyx_k_imhist), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
-  {&__pyx_kp_u_init___py, __pyx_k_init___py, sizeof(__pyx_k_init___py), 0, 1, 0, 0},
-  {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
-  {&__pyx_n_s_listxfile, __pyx_k_listxfile, sizeof(__pyx_k_listxfile), 0, 0, 1, 1},
+  {&__pyx_n_s_imread, __pyx_k_imread, sizeof(__pyx_k_imread), 0, 0, 1, 1},
+  {&__pyx_n_s_imresize, __pyx_k_imresize, sizeof(__pyx_k_imresize), 0, 0, 1, 1},
+  {&__pyx_kp_u_imresize_line_54, __pyx_k_imresize_line_54, sizeof(__pyx_k_imresize_line_54), 0, 1, 0, 0},
+  {&__pyx_n_s_imsave, __pyx_k_imsave, sizeof(__pyx_k_imsave), 0, 0, 1, 1},
+  {&__pyx_n_s_interp, __pyx_k_interp, sizeof(__pyx_k_interp), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
-  {&__pyx_n_u_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 1, 0, 1},
-  {&__pyx_kp_u_mnt_e_ws_github_antsfamily_torc, __pyx_k_mnt_e_ws_github_antsfamily_torc, sizeof(__pyx_k_mnt_e_ws_github_antsfamily_torc), 0, 1, 0, 0},
-  {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
+  {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
-  {&__pyx_n_s_open, __pyx_k_open, sizeof(__pyx_k_open), 0, 0, 1, 1},
-  {&__pyx_n_s_os, __pyx_k_os, sizeof(__pyx_k_os), 0, 0, 1, 1},
-  {&__pyx_n_s_ostr, __pyx_k_ostr, sizeof(__pyx_k_ostr), 0, 0, 1, 1},
-  {&__pyx_n_s_outstr, __pyx_k_outstr, sizeof(__pyx_k_outstr), 0, 0, 1, 1},
-  {&__pyx_n_s_pkgdir, __pyx_k_pkgdir, sizeof(__pyx_k_pkgdir), 0, 0, 1, 1},
-  {&__pyx_kp_u_py, __pyx_k_py, sizeof(__pyx_k_py), 0, 1, 0, 0},
-  {&__pyx_n_s_pyaibox, __pyx_k_pyaibox, sizeof(__pyx_k_pyaibox), 0, 0, 1, 1},
-  {&__pyx_n_s_pyaibox_utils_docstr, __pyx_k_pyaibox_utils_docstr, sizeof(__pyx_k_pyaibox_utils_docstr), 0, 0, 1, 1},
-  {&__pyx_kp_s_pyaibox_utils_docstr_py, __pyx_k_pyaibox_utils_docstr_py, sizeof(__pyx_k_pyaibox_utils_docstr_py), 0, 0, 1, 0},
-  {&__pyx_n_s_pyfile, __pyx_k_pyfile, sizeof(__pyx_k_pyfile), 0, 0, 1, 1},
-  {&__pyx_kp_u_pyi, __pyx_k_pyi, sizeof(__pyx_k_pyi), 0, 1, 0, 0},
-  {&__pyx_n_s_pyifile, __pyx_k_pyifile, sizeof(__pyx_k_pyifile), 0, 0, 1, 1},
-  {&__pyx_n_u_r, __pyx_k_r, sizeof(__pyx_k_r), 0, 1, 0, 1},
-  {&__pyx_kp_u_r_2, __pyx_k_r_2, sizeof(__pyx_k_r_2), 0, 1, 0, 0},
-  {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
-  {&__pyx_n_s_readlines, __pyx_k_readlines, sizeof(__pyx_k_readlines), 0, 0, 1, 1},
-  {&__pyx_n_s_recursive, __pyx_k_recursive, sizeof(__pyx_k_recursive), 0, 0, 1, 1},
-  {&__pyx_n_s_remove, __pyx_k_remove, sizeof(__pyx_k_remove), 0, 0, 1, 1},
-  {&__pyx_n_s_rmcache, __pyx_k_rmcache, sizeof(__pyx_k_rmcache), 0, 0, 1, 1},
-  {&__pyx_n_s_startpos, __pyx_k_startpos, sizeof(__pyx_k_startpos), 0, 0, 1, 1},
+  {&__pyx_n_s_nbins, __pyx_k_nbins, sizeof(__pyx_k_nbins), 0, 0, 1, 1},
+  {&__pyx_n_s_normed, __pyx_k_normed, sizeof(__pyx_k_normed), 0, 0, 1, 1},
+  {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
+  {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
+  {&__pyx_n_s_odtype, __pyx_k_odtype, sizeof(__pyx_k_odtype), 0, 0, 1, 1},
+  {&__pyx_n_s_oimage, __pyx_k_oimage, sizeof(__pyx_k_oimage), 0, 0, 1, 1},
+  {&__pyx_n_s_order, __pyx_k_order, sizeof(__pyx_k_order), 0, 0, 1, 1},
+  {&__pyx_n_s_oshape, __pyx_k_oshape, sizeof(__pyx_k_oshape), 0, 0, 1, 1},
+  {&__pyx_n_s_outfile, __pyx_k_outfile, sizeof(__pyx_k_outfile), 0, 0, 1, 1},
+  {&__pyx_n_s_output_shape, __pyx_k_output_shape, sizeof(__pyx_k_output_shape), 0, 0, 1, 1},
+  {&__pyx_n_s_preserve_range, __pyx_k_preserve_range, sizeof(__pyx_k_preserve_range), 0, 0, 1, 1},
+  {&__pyx_n_s_pyaibox_utils_image, __pyx_k_pyaibox_utils_image, sizeof(__pyx_k_pyaibox_utils_image), 0, 0, 1, 1},
+  {&__pyx_kp_s_pyaibox_utils_image_py, __pyx_k_pyaibox_utils_image_py, sizeof(__pyx_k_pyaibox_utils_image_py), 0, 0, 1, 0},
+  {&__pyx_n_s_reshape, __pyx_k_reshape, sizeof(__pyx_k_reshape), 0, 0, 1, 1},
+  {&__pyx_n_s_resize, __pyx_k_resize, sizeof(__pyx_k_resize), 0, 0, 1, 1},
+  {&__pyx_kp_u_resize_image_to_oshape_see_func, __pyx_k_resize_image_to_oshape_see_func, sizeof(__pyx_k_resize_image_to_oshape_see_func), 0, 1, 0, 0},
+  {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
+  {&__pyx_n_s_skimage_io, __pyx_k_skimage_io, sizeof(__pyx_k_skimage_io), 0, 0, 1, 1},
+  {&__pyx_n_s_skimage_transform, __pyx_k_skimage_transform, sizeof(__pyx_k_skimage_transform), 0, 0, 1, 1},
+  {&__pyx_n_s_skimread, __pyx_k_skimread, sizeof(__pyx_k_skimread), 0, 0, 1, 1},
+  {&__pyx_n_s_skimresize, __pyx_k_skimresize, sizeof(__pyx_k_skimresize), 0, 0, 1, 1},
+  {&__pyx_n_s_skimsave, __pyx_k_skimsave, sizeof(__pyx_k_skimsave), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
-  {&__pyx_kp_u_version_py, __pyx_k_version_py, sizeof(__pyx_k_version_py), 0, 1, 0, 0},
-  {&__pyx_n_u_w, __pyx_k_w, sizeof(__pyx_k_w), 0, 1, 0, 1},
-  {&__pyx_n_s_write, __pyx_k_write, sizeof(__pyx_k_write), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 61, __pyx_L1_error)
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 66, __pyx_L1_error)
-  __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(0, 166, __pyx_L1_error)
   return 0;
-  __pyx_L1_error:;
-  return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "pyaibox/utils/docstr.py":78
- *                         if data[n+1][k] != ' ':
- *                             break
- *                     outstr.append(data[n][:-1] + data[n+1][k-1:])             # <<<<<<<<<<<<<<
- *                 continue
- *             compos = data[n].find('"' + '"' + '"')
+  /* "pyaibox/utils/image.py":50
+ *     cdf = 255.0 * cdf / cdf[-1]
+ *     #
+ *     img = np.interp(img.flatten(), bins[:-1], cdf)             # <<<<<<<<<<<<<<
+ *     return img.reshape(dshape)
+ * 
  */
-  __pyx_slice__3 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__3)) __PYX_ERR(0, 78, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__3);
-  __Pyx_GIVEREF(__pyx_slice__3);
+  __pyx_slice_ = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice_)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice_);
+  __Pyx_GIVEREF(__pyx_slice_);
 
-  /* "pyaibox/utils/docstr.py":166
+  /* "pyaibox/utils/image.py":36
+ * 
  * 
- *     if exts == '.py':
- *         raise TypeError("danger!")             # <<<<<<<<<<<<<<
+ * def imread(imgfile):             # <<<<<<<<<<<<<<
+ *     return skimread(imgfile)
  * 
- *     allcfiles = listxfile(pkgdir, exts=exts, recursive=True)
  */
-  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_u_danger); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 166, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__7);
-  __Pyx_GIVEREF(__pyx_tuple__7);
+  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_n_s_imgfile); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 36, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__2);
+  __Pyx_GIVEREF(__pyx_tuple__2);
+  __pyx_codeobj__3 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__2, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_utils_image_py, __pyx_n_s_imread, 36, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 36, __pyx_L1_error)
 
-  /* "pyaibox/utils/docstr.py":33
+  /* "pyaibox/utils/image.py":40
  * 
  * 
- * def gpyi(pkgdir, autoskip=True):             # <<<<<<<<<<<<<<
- *     r"""generates ``pyi`` files
+ * def imsave(outfile, img):             # <<<<<<<<<<<<<<
+ *     return skimsave(outfile, img, check_contrast=False)
  * 
  */
-  __pyx_tuple__8 = PyTuple_Pack(27, __pyx_n_s_pkgdir, __pyx_n_s_autoskip, __pyx_n_s_filetype, __pyx_n_s_dstfiletype, __pyx_n_s_allfiles, __pyx_n_s_dstfiles, __pyx_n_s_file, __pyx_n_s_pyfile, __pyx_n_s_pyifile, __pyx_n_s_fpy, __pyx_n_s_fpyi, __pyx_n_s_data, __pyx_n_s_cntcomflag, __pyx_n_s_outstr, __pyx_n_s_n, __pyx_n_s_defpos, __pyx_n_s_k, __pyx_n_s_compos, __pyx_n_s_finalstr, __pyx_n_s_N, __pyx_n_s_defpos1, __pyx_n_s_defpos2, __pyx_n_s_clspos1, __pyx_n_s_clspos2, __pyx_n_s_startpos, __pyx_n_s_endpos, __pyx_n_s_ostr); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 33, __pyx_L1_error)
+  __pyx_tuple__4 = PyTuple_Pack(2, __pyx_n_s_outfile, __pyx_n_s_img); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 40, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__4);
+  __Pyx_GIVEREF(__pyx_tuple__4);
+  __pyx_codeobj__5 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__4, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_utils_image_py, __pyx_n_s_imsave, 40, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__5)) __PYX_ERR(0, 40, __pyx_L1_error)
+
+  /* "pyaibox/utils/image.py":44
+ * 
+ * 
+ * def histeq(img, nbins=256):             # <<<<<<<<<<<<<<
+ *     dshape = img.shape
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)
+ */
+  __pyx_tuple__6 = PyTuple_Pack(6, __pyx_n_s_img, __pyx_n_s_nbins, __pyx_n_s_dshape, __pyx_n_s_imhist, __pyx_n_s_bins, __pyx_n_s_cdf); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__6);
+  __Pyx_GIVEREF(__pyx_tuple__6);
+  __pyx_codeobj__7 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__6, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_utils_image_py, __pyx_n_s_histeq, 44, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __pyx_tuple__8 = PyTuple_Pack(1, ((PyObject *)__pyx_int_256)); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 44, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
-  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(2, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__8, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_utils_docstr_py, __pyx_n_s_gpyi, 33, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 33, __pyx_L1_error)
-  __pyx_tuple__10 = PyTuple_Pack(1, ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 33, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__10);
-  __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "pyaibox/utils/docstr.py":154
- *     return 0
+  /* "pyaibox/utils/image.py":54
+ * 
  * 
- * def rmcache(pkgdir, exts='.c'):             # <<<<<<<<<<<<<<
- *     r"""remove cache files
+ * def imresize(img, oshape=None, odtype=None, order=1, mode='constant', cval=0, clip=True, preserve_range=False):             # <<<<<<<<<<<<<<
+ *     r"""resize image to oshape
  * 
  */
-  __pyx_tuple__11 = PyTuple_Pack(4, __pyx_n_s_pkgdir, __pyx_n_s_exts, __pyx_n_s_allcfiles, __pyx_n_s_file); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 154, __pyx_L1_error)
+  __pyx_tuple__9 = PyTuple_Pack(9, __pyx_n_s_img, __pyx_n_s_oshape, __pyx_n_s_odtype, __pyx_n_s_order, __pyx_n_s_mode, __pyx_n_s_cval, __pyx_n_s_clip, __pyx_n_s_preserve_range, __pyx_n_s_oimage); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__9);
+  __Pyx_GIVEREF(__pyx_tuple__9);
+  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(8, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__9, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_utils_image_py, __pyx_n_s_imresize, 54, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_tuple__11 = PyTuple_Pack(7, ((PyObject *)Py_None), ((PyObject *)Py_None), ((PyObject *)__pyx_int_1), ((PyObject*)__pyx_n_u_constant), ((PyObject *)__pyx_int_0), ((PyObject *)Py_True), ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__11);
   __Pyx_GIVEREF(__pyx_tuple__11);
-  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__11, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyaibox_utils_docstr_py, __pyx_n_s_rmcache, 154, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 154, __pyx_L1_error)
-  __pyx_tuple__13 = PyTuple_Pack(1, ((PyObject*)__pyx_kp_u_c)); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 154, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__13);
-  __Pyx_GIVEREF(__pyx_tuple__13);
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
   if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
+  __pyx_float_255_0 = PyFloat_FromDouble(255.0); if (unlikely(!__pyx_float_255_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_256 = PyInt_FromLong(256); if (unlikely(!__pyx_int_256)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(void); /*proto*/
@@ -3818,19 +2670,19 @@
 #else
 #define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC initdocstr(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC initdocstr(void)
+__Pyx_PyMODINIT_FUNC initimage(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC initimage(void)
 #else
-__Pyx_PyMODINIT_FUNC PyInit_docstr(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit_docstr(void)
+__Pyx_PyMODINIT_FUNC PyInit_image(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC PyInit_image(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
 static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
     #if PY_VERSION_HEX >= 0x030700A1
     static PY_INT64_T main_interpreter_id = -1;
@@ -3889,46 +2741,43 @@
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec_docstr(PyObject *__pyx_pyinit_module)
+static CYTHON_SMALL_CODE int __pyx_pymod_exec_image(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  int __pyx_t_3;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module 'docstr' has already been imported. Re-initialisation is not supported.");
+    PyErr_SetString(PyExc_RuntimeError, "Module 'image' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
   #elif PY_MAJOR_VERSION >= 3
   if (__pyx_m) return __Pyx_NewRef(__pyx_m);
   #endif
   #if CYTHON_REFNANNY
 __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
 if (!__Pyx_RefNanny) {
   PyErr_Clear();
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
   if (!__Pyx_RefNanny)
       Py_FatalError("failed to import 'refnanny' module");
 }
 #endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_docstr(void)", 0);
+  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_image(void)", 0);
   if (__Pyx_check_binary_version() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #ifdef __Pxy_PyFrame_Initialize_Offsets
   __Pxy_PyFrame_Initialize_Offsets();
   #endif
   __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -3957,15 +2806,15 @@
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("docstr", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("image", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   #endif
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
   Py_INCREF(__pyx_d);
@@ -3975,22 +2824,22 @@
   Py_INCREF(__pyx_cython_runtime);
   if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_pyaibox__utils__docstr) {
+  if (__pyx_module_is_main_pyaibox__utils__image) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "pyaibox.utils.docstr")) {
-      if (unlikely(PyDict_SetItemString(modules, "pyaibox.utils.docstr", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "pyaibox.utils.image")) {
+      if (unlikely(PyDict_SetItemString(modules, "pyaibox.utils.image", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -4003,154 +2852,163 @@
   (void)__Pyx_modinit_variable_import_code();
   (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
 
-  /* "pyaibox/utils/docstr.py":29
+  /* "pyaibox/utils/image.py":29
  * #
  * 
- * import os             # <<<<<<<<<<<<<<
- * from pyaibox import listxfile
- * 
+ * from skimage.io import imread as skimread             # <<<<<<<<<<<<<<
+ * from skimage.io import imsave as skimsave
+ * from skimage.transform import resize as skimresize
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_os, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_n_s_imread);
+  __Pyx_GIVEREF(__pyx_n_s_imread);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_imread);
+  __pyx_t_2 = __Pyx_Import(__pyx_n_s_skimage_io, __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_imread); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_os, __pyx_t_1) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_skimread, __pyx_t_1) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "pyaibox/utils/docstr.py":30
+  /* "pyaibox/utils/image.py":30
  * 
- * import os
- * from pyaibox import listxfile             # <<<<<<<<<<<<<<
+ * from skimage.io import imread as skimread
+ * from skimage.io import imsave as skimsave             # <<<<<<<<<<<<<<
+ * from skimage.transform import resize as skimresize
  * 
+ */
+  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(__pyx_n_s_imsave);
+  __Pyx_GIVEREF(__pyx_n_s_imsave);
+  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_imsave);
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_skimage_io, __pyx_t_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_imsave); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_skimsave, __pyx_t_2) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pyaibox/utils/image.py":31
+ * from skimage.io import imread as skimread
+ * from skimage.io import imsave as skimsave
+ * from skimage.transform import resize as skimresize             # <<<<<<<<<<<<<<
  * 
+ * import numpy as np
  */
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_n_s_listxfile);
-  __Pyx_GIVEREF(__pyx_n_s_listxfile);
-  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_listxfile);
-  __pyx_t_2 = __Pyx_Import(__pyx_n_s_pyaibox, __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_n_s_resize);
+  __Pyx_GIVEREF(__pyx_n_s_resize);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_resize);
+  __pyx_t_2 = __Pyx_Import(__pyx_n_s_skimage_transform, __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_listxfile); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_resize); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_listxfile, __pyx_t_1) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_skimresize, __pyx_t_1) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "pyaibox/utils/docstr.py":33
+  /* "pyaibox/utils/image.py":33
+ * from skimage.transform import resize as skimresize
  * 
+ * import numpy as np             # <<<<<<<<<<<<<<
  * 
- * def gpyi(pkgdir, autoskip=True):             # <<<<<<<<<<<<<<
- *     r"""generates ``pyi`` files
  * 
  */
-  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_5utils_6docstr_1gpyi, 0, __pyx_n_s_gpyi, NULL, __pyx_n_s_pyaibox_utils_docstr, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 33, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Import(__pyx_n_s_numpy, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_tuple__10);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_gpyi, __pyx_t_2) < 0) __PYX_ERR(0, 33, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_2) < 0) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "pyaibox/utils/docstr.py":154
- *     return 0
+  /* "pyaibox/utils/image.py":36
  * 
- * def rmcache(pkgdir, exts='.c'):             # <<<<<<<<<<<<<<
- *     r"""remove cache files
+ * 
+ * def imread(imgfile):             # <<<<<<<<<<<<<<
+ *     return skimread(imgfile)
  * 
  */
-  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_5utils_6docstr_3rmcache, 0, __pyx_n_s_rmcache, NULL, __pyx_n_s_pyaibox_utils_docstr, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 154, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_5utils_5image_1imread, 0, __pyx_n_s_imread, NULL, __pyx_n_s_pyaibox_utils_image, __pyx_d, ((PyObject *)__pyx_codeobj__3)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 36, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_tuple__13);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_rmcache, __pyx_t_2) < 0) __PYX_ERR(0, 154, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_imread, __pyx_t_2) < 0) __PYX_ERR(0, 36, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "pyaibox/utils/docstr.py":175
+  /* "pyaibox/utils/image.py":40
  * 
  * 
- * if __name__ == '__main__':             # <<<<<<<<<<<<<<
+ * def imsave(outfile, img):             # <<<<<<<<<<<<<<
+ *     return skimsave(outfile, img, check_contrast=False)
  * 
- *     pkgdir = '/mnt/e/ws/github/antsfamily/torchcs/torchcs/torchcs/'
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_name); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 175, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_5utils_5image_3imsave, 0, __pyx_n_s_imsave, NULL, __pyx_n_s_pyaibox_utils_image, __pyx_d, ((PyObject *)__pyx_codeobj__5)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 40, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_main, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 175, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_imsave, __pyx_t_2) < 0) __PYX_ERR(0, 40, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__pyx_t_3) {
-
-    /* "pyaibox/utils/docstr.py":177
- * if __name__ == '__main__':
- * 
- *     pkgdir = '/mnt/e/ws/github/antsfamily/torchcs/torchcs/torchcs/'             # <<<<<<<<<<<<<<
- *     # pkgdir = '/mnt/e/ws/github/antsfamily/pysparse/pysparse/pysparse/'
- * 
- */
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_pkgdir, __pyx_kp_u_mnt_e_ws_github_antsfamily_torc) < 0) __PYX_ERR(0, 177, __pyx_L1_error)
 
-    /* "pyaibox/utils/docstr.py":180
- *     # pkgdir = '/mnt/e/ws/github/antsfamily/pysparse/pysparse/pysparse/'
+  /* "pyaibox/utils/image.py":44
  * 
- *     gpyi(pkgdir, autoskip=True)             # <<<<<<<<<<<<<<
  * 
+ * def histeq(img, nbins=256):             # <<<<<<<<<<<<<<
+ *     dshape = img.shape
+ *     imhist, bins = np.histogram(img.flatten(), nbins, normed=True)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_gpyi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 180, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pkgdir); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
-    __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_autoskip, Py_True) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_5utils_5image_5histeq, 0, __pyx_n_s_histeq, NULL, __pyx_n_s_pyaibox_utils_image, __pyx_d, ((PyObject *)__pyx_codeobj__7)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_tuple__8);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_histeq, __pyx_t_2) < 0) __PYX_ERR(0, 44, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pyaibox/utils/docstr.py":175
+  /* "pyaibox/utils/image.py":54
  * 
  * 
- * if __name__ == '__main__':             # <<<<<<<<<<<<<<
+ * def imresize(img, oshape=None, odtype=None, order=1, mode='constant', cval=0, clip=True, preserve_range=False):             # <<<<<<<<<<<<<<
+ *     r"""resize image to oshape
  * 
- *     pkgdir = '/mnt/e/ws/github/antsfamily/torchcs/torchcs/torchcs/'
  */
-  }
+  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_7pyaibox_5utils_5image_7imresize, 0, __pyx_n_s_imresize, NULL, __pyx_n_s_pyaibox_utils_image, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_2, __pyx_tuple__11);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_imresize, __pyx_t_2) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "pyaibox/utils/docstr.py":1
+  /* "pyaibox/utils/image.py":1
  * #!/usr/bin/env python             # <<<<<<<<<<<<<<
  * #-*- coding: utf-8 -*-
- * # @file      : docstr.py
+ * # @file      : image.py
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_5) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_2, __pyx_kp_u_imresize_line_54, __pyx_kp_u_resize_image_to_oshape_see_func) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
   if (__pyx_m) {
     if (__pyx_d) {
-      __Pyx_AddTraceback("init pyaibox.utils.docstr", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init pyaibox.utils.image", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init pyaibox.utils.docstr");
+    PyErr_SetString(PyExc_ImportError, "init pyaibox.utils.image");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -4201,156 +3059,14 @@
 #else
             "name '%.200s' is not defined", PyString_AS_STRING(name));
 #endif
     }
     return result;
 }
 
-/* RaiseDoubleKeywords */
-static void __Pyx_RaiseDoubleKeywordsError(
-    const char* func_name,
-    PyObject* kw_name)
-{
-    PyErr_Format(PyExc_TypeError,
-        #if PY_MAJOR_VERSION >= 3
-        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
-        #else
-        "%s() got multiple values for keyword argument '%s'", func_name,
-        PyString_AsString(kw_name));
-        #endif
-}
-
-/* ParseKeywords */
-static int __Pyx_ParseOptionalKeywords(
-    PyObject *kwds,
-    PyObject **argnames[],
-    PyObject *kwds2,
-    PyObject *values[],
-    Py_ssize_t num_pos_args,
-    const char* function_name)
-{
-    PyObject *key = 0, *value = 0;
-    Py_ssize_t pos = 0;
-    PyObject*** name;
-    PyObject*** first_kw_arg = argnames + num_pos_args;
-    while (PyDict_Next(kwds, &pos, &key, &value)) {
-        name = first_kw_arg;
-        while (*name && (**name != key)) name++;
-        if (*name) {
-            values[name-argnames] = value;
-            continue;
-        }
-        name = first_kw_arg;
-        #if PY_MAJOR_VERSION < 3
-        if (likely(PyString_Check(key))) {
-            while (*name) {
-                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
-                        && _PyString_Eq(**name, key)) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    if ((**argname == key) || (
-                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
-                             && _PyString_Eq(**argname, key))) {
-                        goto arg_passed_twice;
-                    }
-                    argname++;
-                }
-            }
-        } else
-        #endif
-        if (likely(PyUnicode_Check(key))) {
-            while (*name) {
-                int cmp = (**name == key) ? 0 :
-                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                #endif
-                    PyUnicode_Compare(**name, key);
-                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                if (cmp == 0) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    int cmp = (**argname == key) ? 0 :
-                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                    #endif
-                        PyUnicode_Compare(**argname, key);
-                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                    if (cmp == 0) goto arg_passed_twice;
-                    argname++;
-                }
-            }
-        } else
-            goto invalid_keyword_type;
-        if (kwds2) {
-            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
-        } else {
-            goto invalid_keyword;
-        }
-    }
-    return 0;
-arg_passed_twice:
-    __Pyx_RaiseDoubleKeywordsError(function_name, key);
-    goto bad;
-invalid_keyword_type:
-    PyErr_Format(PyExc_TypeError,
-        "%.200s() keywords must be strings", function_name);
-    goto bad;
-invalid_keyword:
-    PyErr_Format(PyExc_TypeError,
-    #if PY_MAJOR_VERSION < 3
-        "%.200s() got an unexpected keyword argument '%.200s'",
-        function_name, PyString_AsString(key));
-    #else
-        "%s() got an unexpected keyword argument '%U'",
-        function_name, key);
-    #endif
-bad:
-    return -1;
-}
-
-/* RaiseArgTupleInvalid */
-static void __Pyx_RaiseArgtupleInvalid(
-    const char* func_name,
-    int exact,
-    Py_ssize_t num_min,
-    Py_ssize_t num_max,
-    Py_ssize_t num_found)
-{
-    Py_ssize_t num_expected;
-    const char *more_or_less;
-    if (num_found < num_min) {
-        num_expected = num_min;
-        more_or_less = "at least";
-    } else {
-        num_expected = num_max;
-        more_or_less = "at most";
-    }
-    if (exact) {
-        more_or_less = "exactly";
-    }
-    PyErr_Format(PyExc_TypeError,
-                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                 func_name, more_or_less, num_expected,
-                 (num_expected == 1) ? "" : "s", num_found);
-}
-
 /* PyDictVersioning */
 #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
 static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
     PyObject *dict = Py_TYPE(obj)->tp_dict;
     return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
 }
 static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
@@ -4404,34 +3120,14 @@
         return __Pyx_NewRef(result);
     }
     PyErr_Clear();
 #endif
     return __Pyx_GetBuiltinName(name);
 }
 
-/* PyObjectCall */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    PyObject *result;
-    ternaryfunc call = Py_TYPE(func)->tp_call;
-    if (unlikely(!call))
-        return PyObject_Call(func, arg, kw);
-    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
-        return NULL;
-    result = (*call)(func, arg, kw);
-    Py_LeaveRecursiveCall();
-    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
-        PyErr_SetString(
-            PyExc_SystemError,
-            "NULL result without error in PyObject_Call");
-    }
-    return result;
-}
-#endif
-
 /* PyCFunctionFastCall */
 #if CYTHON_FAST_PYCCALL
 static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
     PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
     PyCFunction meth = PyCFunction_GET_FUNCTION(func);
     PyObject *self = PyCFunction_GET_SELF(func);
     int flags = PyCFunction_GET_FLAGS(func);
@@ -4566,14 +3262,34 @@
 done:
     Py_LeaveRecursiveCall();
     return result;
 }
 #endif
 #endif
 
+/* PyObjectCall */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
+    PyObject *result;
+    ternaryfunc call = Py_TYPE(func)->tp_call;
+    if (unlikely(!call))
+        return PyObject_Call(func, arg, kw);
+    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
+        return NULL;
+    result = (*call)(func, arg, kw);
+    Py_LeaveRecursiveCall();
+    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
+        PyErr_SetString(
+            PyExc_SystemError,
+            "NULL result without error in PyObject_Call");
+    }
+    return result;
+}
+#endif
+
 /* PyObjectCall2Args */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
     PyObject *args, *result = NULL;
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(function)) {
         PyObject *args[2] = {arg1, arg2};
         return __Pyx_PyFunction_FastCall(function, args, 2);
@@ -4655,109 +3371,154 @@
     if (unlikely(!args)) return NULL;
     result = __Pyx_PyObject_Call(func, args, NULL);
     Py_DECREF(args);
     return result;
 }
 #endif
 
-/* SliceObject */
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(PyObject* obj,
-        Py_ssize_t cstart, Py_ssize_t cstop,
-        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
-        int has_cstart, int has_cstop, CYTHON_UNUSED int wraparound) {
-#if CYTHON_USE_TYPE_SLOTS
-    PyMappingMethods* mp;
-#if PY_MAJOR_VERSION < 3
-    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
-    if (likely(ms && ms->sq_slice)) {
-        if (!has_cstart) {
-            if (_py_start && (*_py_start != Py_None)) {
-                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
-                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
-            } else
-                cstart = 0;
-        }
-        if (!has_cstop) {
-            if (_py_stop && (*_py_stop != Py_None)) {
-                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
-                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
-            } else
-                cstop = PY_SSIZE_T_MAX;
+/* RaiseArgTupleInvalid */
+static void __Pyx_RaiseArgtupleInvalid(
+    const char* func_name,
+    int exact,
+    Py_ssize_t num_min,
+    Py_ssize_t num_max,
+    Py_ssize_t num_found)
+{
+    Py_ssize_t num_expected;
+    const char *more_or_less;
+    if (num_found < num_min) {
+        num_expected = num_min;
+        more_or_less = "at least";
+    } else {
+        num_expected = num_max;
+        more_or_less = "at most";
+    }
+    if (exact) {
+        more_or_less = "exactly";
+    }
+    PyErr_Format(PyExc_TypeError,
+                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
+                 func_name, more_or_less, num_expected,
+                 (num_expected == 1) ? "" : "s", num_found);
+}
+
+/* RaiseDoubleKeywords */
+static void __Pyx_RaiseDoubleKeywordsError(
+    const char* func_name,
+    PyObject* kw_name)
+{
+    PyErr_Format(PyExc_TypeError,
+        #if PY_MAJOR_VERSION >= 3
+        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
+        #else
+        "%s() got multiple values for keyword argument '%s'", func_name,
+        PyString_AsString(kw_name));
+        #endif
+}
+
+/* ParseKeywords */
+static int __Pyx_ParseOptionalKeywords(
+    PyObject *kwds,
+    PyObject **argnames[],
+    PyObject *kwds2,
+    PyObject *values[],
+    Py_ssize_t num_pos_args,
+    const char* function_name)
+{
+    PyObject *key = 0, *value = 0;
+    Py_ssize_t pos = 0;
+    PyObject*** name;
+    PyObject*** first_kw_arg = argnames + num_pos_args;
+    while (PyDict_Next(kwds, &pos, &key, &value)) {
+        name = first_kw_arg;
+        while (*name && (**name != key)) name++;
+        if (*name) {
+            values[name-argnames] = value;
+            continue;
         }
-        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
-            Py_ssize_t l = ms->sq_length(obj);
-            if (likely(l >= 0)) {
-                if (cstop < 0) {
-                    cstop += l;
-                    if (cstop < 0) cstop = 0;
+        name = first_kw_arg;
+        #if PY_MAJOR_VERSION < 3
+        if (likely(PyString_Check(key))) {
+            while (*name) {
+                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
+                        && _PyString_Eq(**name, key)) {
+                    values[name-argnames] = value;
+                    break;
                 }
-                if (cstart < 0) {
-                    cstart += l;
-                    if (cstart < 0) cstart = 0;
+                name++;
+            }
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    if ((**argname == key) || (
+                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
+                             && _PyString_Eq(**argname, key))) {
+                        goto arg_passed_twice;
+                    }
+                    argname++;
                 }
-            } else {
-                if (!PyErr_ExceptionMatches(PyExc_OverflowError))
-                    goto bad;
-                PyErr_Clear();
             }
-        }
-        return ms->sq_slice(obj, cstart, cstop);
-    }
-#endif
-    mp = Py_TYPE(obj)->tp_as_mapping;
-    if (likely(mp && mp->mp_subscript))
-#endif
-    {
-        PyObject* result;
-        PyObject *py_slice, *py_start, *py_stop;
-        if (_py_slice) {
-            py_slice = *_py_slice;
-        } else {
-            PyObject* owned_start = NULL;
-            PyObject* owned_stop = NULL;
-            if (_py_start) {
-                py_start = *_py_start;
-            } else {
-                if (has_cstart) {
-                    owned_start = py_start = PyInt_FromSsize_t(cstart);
-                    if (unlikely(!py_start)) goto bad;
-                } else
-                    py_start = Py_None;
+        } else
+        #endif
+        if (likely(PyUnicode_Check(key))) {
+            while (*name) {
+                int cmp = (**name == key) ? 0 :
+                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                #endif
+                    PyUnicode_Compare(**name, key);
+                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                if (cmp == 0) {
+                    values[name-argnames] = value;
+                    break;
+                }
+                name++;
             }
-            if (_py_stop) {
-                py_stop = *_py_stop;
-            } else {
-                if (has_cstop) {
-                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
-                    if (unlikely(!py_stop)) {
-                        Py_XDECREF(owned_start);
-                        goto bad;
-                    }
-                } else
-                    py_stop = Py_None;
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    int cmp = (**argname == key) ? 0 :
+                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                    #endif
+                        PyUnicode_Compare(**argname, key);
+                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                    if (cmp == 0) goto arg_passed_twice;
+                    argname++;
+                }
             }
-            py_slice = PySlice_New(py_start, py_stop, Py_None);
-            Py_XDECREF(owned_start);
-            Py_XDECREF(owned_stop);
-            if (unlikely(!py_slice)) goto bad;
-        }
-#if CYTHON_USE_TYPE_SLOTS
-        result = mp->mp_subscript(obj, py_slice);
-#else
-        result = PyObject_GetItem(obj, py_slice);
-#endif
-        if (!_py_slice) {
-            Py_DECREF(py_slice);
+        } else
+            goto invalid_keyword_type;
+        if (kwds2) {
+            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
+        } else {
+            goto invalid_keyword;
         }
-        return result;
     }
+    return 0;
+arg_passed_twice:
+    __Pyx_RaiseDoubleKeywordsError(function_name, key);
+    goto bad;
+invalid_keyword_type:
     PyErr_Format(PyExc_TypeError,
-        "'%.200s' object is unsliceable", Py_TYPE(obj)->tp_name);
+        "%.200s() keywords must be strings", function_name);
+    goto bad;
+invalid_keyword:
+    PyErr_Format(PyExc_TypeError,
+    #if PY_MAJOR_VERSION < 3
+        "%.200s() got an unexpected keyword argument '%.200s'",
+        function_name, PyString_AsString(key));
+    #else
+        "%s() got an unexpected keyword argument '%U'",
+        function_name, key);
+    #endif
 bad:
-    return NULL;
+    return -1;
 }
 
 /* PyObjectCallNoArg */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
 #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(func)) {
@@ -4774,14 +3535,74 @@
             return __Pyx_PyObject_CallMethO(func, NULL);
         }
     }
     return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
 }
 #endif
 
+/* RaiseTooManyValuesToUnpack */
+static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
+    PyErr_Format(PyExc_ValueError,
+                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
+}
+
+/* RaiseNeedMoreValuesToUnpack */
+static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
+    PyErr_Format(PyExc_ValueError,
+                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
+                 index, (index == 1) ? "" : "s");
+}
+
+/* IterFinish */
+static CYTHON_INLINE int __Pyx_IterFinish(void) {
+#if CYTHON_FAST_THREAD_STATE
+    PyThreadState *tstate = __Pyx_PyThreadState_Current;
+    PyObject* exc_type = tstate->curexc_type;
+    if (unlikely(exc_type)) {
+        if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) {
+            PyObject *exc_value, *exc_tb;
+            exc_value = tstate->curexc_value;
+            exc_tb = tstate->curexc_traceback;
+            tstate->curexc_type = 0;
+            tstate->curexc_value = 0;
+            tstate->curexc_traceback = 0;
+            Py_DECREF(exc_type);
+            Py_XDECREF(exc_value);
+            Py_XDECREF(exc_tb);
+            return 0;
+        } else {
+            return -1;
+        }
+    }
+    return 0;
+#else
+    if (unlikely(PyErr_Occurred())) {
+        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
+            PyErr_Clear();
+            return 0;
+        } else {
+            return -1;
+        }
+    }
+    return 0;
+#endif
+}
+
+/* UnpackItemEndCheck */
+static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
+    if (unlikely(retval)) {
+        Py_DECREF(retval);
+        __Pyx_RaiseTooManyValuesError(expected);
+        return -1;
+    } else {
+        return __Pyx_IterFinish();
+    }
+    return 0;
+}
+
 /* GetItemInt */
 static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
     PyObject *r;
     if (!j) return NULL;
     r = PyObject_GetItem(o, j);
     Py_DECREF(j);
     return r;
@@ -4861,694 +3682,110 @@
     if (is_list || PySequence_Check(o)) {
         return PySequence_GetItem(o, i);
     }
 #endif
     return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
 }
 
-/* ObjectGetItem */
+/* SliceObject */
+static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(PyObject* obj,
+        Py_ssize_t cstart, Py_ssize_t cstop,
+        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
+        int has_cstart, int has_cstop, CYTHON_UNUSED int wraparound) {
 #if CYTHON_USE_TYPE_SLOTS
-static PyObject *__Pyx_PyObject_GetIndex(PyObject *obj, PyObject* index) {
-    PyObject *runerr;
-    Py_ssize_t key_value;
-    PySequenceMethods *m = Py_TYPE(obj)->tp_as_sequence;
-    if (unlikely(!(m && m->sq_item))) {
-        PyErr_Format(PyExc_TypeError, "'%.200s' object is not subscriptable", Py_TYPE(obj)->tp_name);
-        return NULL;
-    }
-    key_value = __Pyx_PyIndex_AsSsize_t(index);
-    if (likely(key_value != -1 || !(runerr = PyErr_Occurred()))) {
-        return __Pyx_GetItemInt_Fast(obj, key_value, 0, 1, 1);
-    }
-    if (PyErr_GivenExceptionMatches(runerr, PyExc_OverflowError)) {
-        PyErr_Clear();
-        PyErr_Format(PyExc_IndexError, "cannot fit '%.200s' into an index-sized integer", Py_TYPE(index)->tp_name);
-    }
-    return NULL;
-}
-static PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject* key) {
-    PyMappingMethods *m = Py_TYPE(obj)->tp_as_mapping;
-    if (likely(m && m->mp_subscript)) {
-        return m->mp_subscript(obj, key);
-    }
-    return __Pyx_PyObject_GetIndex(obj, key);
-}
-#endif
-
-/* PyIntCompare */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED long inplace) {
-    if (op1 == op2) {
-        Py_RETURN_TRUE;
-    }
-    #if PY_MAJOR_VERSION < 3
-    if (likely(PyInt_CheckExact(op1))) {
-        const long b = intval;
-        long a = PyInt_AS_LONG(op1);
-        if (a == b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
-    }
-    #endif
-    #if CYTHON_USE_PYLONG_INTERNALS
-    if (likely(PyLong_CheckExact(op1))) {
-        int unequal;
-        unsigned long uintval;
-        Py_ssize_t size = Py_SIZE(op1);
-        const digit* digits = ((PyLongObject*)op1)->ob_digit;
-        if (intval == 0) {
-            if (size == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
-        } else if (intval < 0) {
-            if (size >= 0)
-                Py_RETURN_FALSE;
-            intval = -intval;
-            size = -size;
-        } else {
-            if (size <= 0)
-                Py_RETURN_FALSE;
+    PyMappingMethods* mp;
+#if PY_MAJOR_VERSION < 3
+    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
+    if (likely(ms && ms->sq_slice)) {
+        if (!has_cstart) {
+            if (_py_start && (*_py_start != Py_None)) {
+                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
+                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
+            } else
+                cstart = 0;
         }
-        uintval = (unsigned long) intval;
-#if PyLong_SHIFT * 4 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 4)) {
-            unequal = (size != 5) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[4] != ((uintval >> (4 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-#if PyLong_SHIFT * 3 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 3)) {
-            unequal = (size != 4) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-#if PyLong_SHIFT * 2 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 2)) {
-            unequal = (size != 3) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-#if PyLong_SHIFT * 1 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 1)) {
-            unequal = (size != 2) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-            unequal = (size != 1) || (((unsigned long) digits[0]) != (uintval & (unsigned long) PyLong_MASK));
-        if (unequal == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
-    }
-    #endif
-    if (PyFloat_CheckExact(op1)) {
-        const long b = intval;
-        double a = PyFloat_AS_DOUBLE(op1);
-        if ((double)a == (double)b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
-    }
-    return (
-        PyObject_RichCompare(op1, op2, Py_EQ));
-}
-
-/* PyIntBinop */
-#if !CYTHON_COMPILING_IN_PYPY
-static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, int inplace, int zerodivision_check) {
-    (void)inplace;
-    (void)zerodivision_check;
-    #if PY_MAJOR_VERSION < 3
-    if (likely(PyInt_CheckExact(op1))) {
-        const long b = intval;
-        long x;
-        long a = PyInt_AS_LONG(op1);
-            x = (long)((unsigned long)a + b);
-            if (likely((x^a) >= 0 || (x^b) >= 0))
-                return PyInt_FromLong(x);
-            return PyLong_Type.tp_as_number->nb_add(op1, op2);
-    }
-    #endif
-    #if CYTHON_USE_PYLONG_INTERNALS
-    if (likely(PyLong_CheckExact(op1))) {
-        const long b = intval;
-        long a, x;
-#ifdef HAVE_LONG_LONG
-        const PY_LONG_LONG llb = intval;
-        PY_LONG_LONG lla, llx;
-#endif
-        const digit* digits = ((PyLongObject*)op1)->ob_digit;
-        const Py_ssize_t size = Py_SIZE(op1);
-        if (likely(__Pyx_sst_abs(size) <= 1)) {
-            a = likely(size) ? digits[0] : 0;
-            if (size == -1) a = -a;
-        } else {
-            switch (size) {
-                case -2:
-                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
-                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
-                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case 2:
-                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
-                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
-                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case -3:
-                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
-                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
-                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case 3:
-                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
-                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
-                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case -4:
-                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
-                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
-                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case 4:
-                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
-                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
-                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                default: return PyLong_Type.tp_as_number->nb_add(op1, op2);
-            }
+        if (!has_cstop) {
+            if (_py_stop && (*_py_stop != Py_None)) {
+                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
+                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
+            } else
+                cstop = PY_SSIZE_T_MAX;
         }
-                x = a + b;
-            return PyLong_FromLong(x);
-#ifdef HAVE_LONG_LONG
-        long_long:
-                llx = lla + llb;
-            return PyLong_FromLongLong(llx);
-#endif
-        
-        
-    }
-    #endif
-    if (PyFloat_CheckExact(op1)) {
-        const long b = intval;
-        double a = PyFloat_AS_DOUBLE(op1);
-            double result;
-            PyFPE_START_PROTECT("add", return NULL)
-            result = ((double)a) + (double)b;
-            PyFPE_END_PROTECT(result)
-            return PyFloat_FromDouble(result);
-    }
-    return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
-}
-#endif
-
-/* BytesEquals */
-static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
-#if CYTHON_COMPILING_IN_PYPY
-    return PyObject_RichCompareBool(s1, s2, equals);
-#else
-    if (s1 == s2) {
-        return (equals == Py_EQ);
-    } else if (PyBytes_CheckExact(s1) & PyBytes_CheckExact(s2)) {
-        const char *ps1, *ps2;
-        Py_ssize_t length = PyBytes_GET_SIZE(s1);
-        if (length != PyBytes_GET_SIZE(s2))
-            return (equals == Py_NE);
-        ps1 = PyBytes_AS_STRING(s1);
-        ps2 = PyBytes_AS_STRING(s2);
-        if (ps1[0] != ps2[0]) {
-            return (equals == Py_NE);
-        } else if (length == 1) {
-            return (equals == Py_EQ);
-        } else {
-            int result;
-#if CYTHON_USE_UNICODE_INTERNALS && (PY_VERSION_HEX < 0x030B0000)
-            Py_hash_t hash1, hash2;
-            hash1 = ((PyBytesObject*)s1)->ob_shash;
-            hash2 = ((PyBytesObject*)s2)->ob_shash;
-            if (hash1 != hash2 && hash1 != -1 && hash2 != -1) {
-                return (equals == Py_NE);
+        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
+            Py_ssize_t l = ms->sq_length(obj);
+            if (likely(l >= 0)) {
+                if (cstop < 0) {
+                    cstop += l;
+                    if (cstop < 0) cstop = 0;
+                }
+                if (cstart < 0) {
+                    cstart += l;
+                    if (cstart < 0) cstart = 0;
+                }
+            } else {
+                if (!PyErr_ExceptionMatches(PyExc_OverflowError))
+                    goto bad;
+                PyErr_Clear();
             }
-#endif
-            result = memcmp(ps1, ps2, (size_t)length);
-            return (equals == Py_EQ) ? (result == 0) : (result != 0);
         }
-    } else if ((s1 == Py_None) & PyBytes_CheckExact(s2)) {
-        return (equals == Py_NE);
-    } else if ((s2 == Py_None) & PyBytes_CheckExact(s1)) {
-        return (equals == Py_NE);
-    } else {
-        int result;
-        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
-        if (!py_result)
-            return -1;
-        result = __Pyx_PyObject_IsTrue(py_result);
-        Py_DECREF(py_result);
-        return result;
-    }
-#endif
-}
-
-/* UnicodeEquals */
-static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals) {
-#if CYTHON_COMPILING_IN_PYPY
-    return PyObject_RichCompareBool(s1, s2, equals);
-#else
-#if PY_MAJOR_VERSION < 3
-    PyObject* owned_ref = NULL;
-#endif
-    int s1_is_unicode, s2_is_unicode;
-    if (s1 == s2) {
-        goto return_eq;
-    }
-    s1_is_unicode = PyUnicode_CheckExact(s1);
-    s2_is_unicode = PyUnicode_CheckExact(s2);
-#if PY_MAJOR_VERSION < 3
-    if ((s1_is_unicode & (!s2_is_unicode)) && PyString_CheckExact(s2)) {
-        owned_ref = PyUnicode_FromObject(s2);
-        if (unlikely(!owned_ref))
-            return -1;
-        s2 = owned_ref;
-        s2_is_unicode = 1;
-    } else if ((s2_is_unicode & (!s1_is_unicode)) && PyString_CheckExact(s1)) {
-        owned_ref = PyUnicode_FromObject(s1);
-        if (unlikely(!owned_ref))
-            return -1;
-        s1 = owned_ref;
-        s1_is_unicode = 1;
-    } else if (((!s2_is_unicode) & (!s1_is_unicode))) {
-        return __Pyx_PyBytes_Equals(s1, s2, equals);
+        return ms->sq_slice(obj, cstart, cstop);
     }
 #endif
-    if (s1_is_unicode & s2_is_unicode) {
-        Py_ssize_t length;
-        int kind;
-        void *data1, *data2;
-        if (unlikely(__Pyx_PyUnicode_READY(s1) < 0) || unlikely(__Pyx_PyUnicode_READY(s2) < 0))
-            return -1;
-        length = __Pyx_PyUnicode_GET_LENGTH(s1);
-        if (length != __Pyx_PyUnicode_GET_LENGTH(s2)) {
-            goto return_ne;
-        }
-#if CYTHON_USE_UNICODE_INTERNALS
-        {
-            Py_hash_t hash1, hash2;
-        #if CYTHON_PEP393_ENABLED
-            hash1 = ((PyASCIIObject*)s1)->hash;
-            hash2 = ((PyASCIIObject*)s2)->hash;
-        #else
-            hash1 = ((PyUnicodeObject*)s1)->hash;
-            hash2 = ((PyUnicodeObject*)s2)->hash;
-        #endif
-            if (hash1 != hash2 && hash1 != -1 && hash2 != -1) {
-                goto return_ne;
-            }
-        }
-#endif
-        kind = __Pyx_PyUnicode_KIND(s1);
-        if (kind != __Pyx_PyUnicode_KIND(s2)) {
-            goto return_ne;
-        }
-        data1 = __Pyx_PyUnicode_DATA(s1);
-        data2 = __Pyx_PyUnicode_DATA(s2);
-        if (__Pyx_PyUnicode_READ(kind, data1, 0) != __Pyx_PyUnicode_READ(kind, data2, 0)) {
-            goto return_ne;
-        } else if (length == 1) {
-            goto return_eq;
-        } else {
-            int result = memcmp(data1, data2, (size_t)(length * kind));
-            #if PY_MAJOR_VERSION < 3
-            Py_XDECREF(owned_ref);
-            #endif
-            return (equals == Py_EQ) ? (result == 0) : (result != 0);
-        }
-    } else if ((s1 == Py_None) & s2_is_unicode) {
-        goto return_ne;
-    } else if ((s2 == Py_None) & s1_is_unicode) {
-        goto return_ne;
-    } else {
-        int result;
-        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
-        #if PY_MAJOR_VERSION < 3
-        Py_XDECREF(owned_ref);
-        #endif
-        if (!py_result)
-            return -1;
-        result = __Pyx_PyObject_IsTrue(py_result);
-        Py_DECREF(py_result);
-        return result;
-    }
-return_eq:
-    #if PY_MAJOR_VERSION < 3
-    Py_XDECREF(owned_ref);
-    #endif
-    return (equals == Py_EQ);
-return_ne:
-    #if PY_MAJOR_VERSION < 3
-    Py_XDECREF(owned_ref);
-    #endif
-    return (equals == Py_NE);
+    mp = Py_TYPE(obj)->tp_as_mapping;
+    if (likely(mp && mp->mp_subscript))
 #endif
-}
-
-/* PyIntBinop */
-#if !CYTHON_COMPILING_IN_PYPY
-static PyObject* __Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, int inplace, int zerodivision_check) {
-    (void)inplace;
-    (void)zerodivision_check;
-    #if PY_MAJOR_VERSION < 3
-    if (likely(PyInt_CheckExact(op1))) {
-        const long b = intval;
-        long x;
-        long a = PyInt_AS_LONG(op1);
-            x = (long)((unsigned long)a - b);
-            if (likely((x^a) >= 0 || (x^~b) >= 0))
-                return PyInt_FromLong(x);
-            return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
-    }
-    #endif
-    #if CYTHON_USE_PYLONG_INTERNALS
-    if (likely(PyLong_CheckExact(op1))) {
-        const long b = intval;
-        long a, x;
-#ifdef HAVE_LONG_LONG
-        const PY_LONG_LONG llb = intval;
-        PY_LONG_LONG lla, llx;
-#endif
-        const digit* digits = ((PyLongObject*)op1)->ob_digit;
-        const Py_ssize_t size = Py_SIZE(op1);
-        if (likely(__Pyx_sst_abs(size) <= 1)) {
-            a = likely(size) ? digits[0] : 0;
-            if (size == -1) a = -a;
+    {
+        PyObject* result;
+        PyObject *py_slice, *py_start, *py_stop;
+        if (_py_slice) {
+            py_slice = *_py_slice;
         } else {
-            switch (size) {
-                case -2:
-                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
-                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
-                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case 2:
-                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
-                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
-                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case -3:
-                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
-                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
-                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case 3:
-                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
-                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
-                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case -4:
-                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
-                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
-                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
-                    }
-                    CYTHON_FALLTHROUGH;
-                case 4:
-                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
-                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
-                        break;
-#ifdef HAVE_LONG_LONG
-                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
-                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
-                        goto long_long;
-#endif
+            PyObject* owned_start = NULL;
+            PyObject* owned_stop = NULL;
+            if (_py_start) {
+                py_start = *_py_start;
+            } else {
+                if (has_cstart) {
+                    owned_start = py_start = PyInt_FromSsize_t(cstart);
+                    if (unlikely(!py_start)) goto bad;
+                } else
+                    py_start = Py_None;
+            }
+            if (_py_stop) {
+                py_stop = *_py_stop;
+            } else {
+                if (has_cstop) {
+                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
+                    if (unlikely(!py_stop)) {
+                        Py_XDECREF(owned_start);
+                        goto bad;
                     }
-                    CYTHON_FALLTHROUGH;
-                default: return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
+                } else
+                    py_stop = Py_None;
             }
+            py_slice = PySlice_New(py_start, py_stop, Py_None);
+            Py_XDECREF(owned_start);
+            Py_XDECREF(owned_stop);
+            if (unlikely(!py_slice)) goto bad;
         }
-                x = a - b;
-            return PyLong_FromLong(x);
-#ifdef HAVE_LONG_LONG
-        long_long:
-                llx = lla - llb;
-            return PyLong_FromLongLong(llx);
-#endif
-        
-        
-    }
-    #endif
-    if (PyFloat_CheckExact(op1)) {
-        const long b = intval;
-        double a = PyFloat_AS_DOUBLE(op1);
-            double result;
-            PyFPE_START_PROTECT("subtract", return NULL)
-            result = ((double)a) - (double)b;
-            PyFPE_END_PROTECT(result)
-            return PyFloat_FromDouble(result);
-    }
-    return (inplace ? PyNumber_InPlaceSubtract : PyNumber_Subtract)(op1, op2);
-}
-#endif
-
-/* None */
-static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
-    PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
-}
-
-/* PyErrFetchRestore */
-#if CYTHON_FAST_THREAD_STATE
-static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
-    PyObject *tmp_type, *tmp_value, *tmp_tb;
-    tmp_type = tstate->curexc_type;
-    tmp_value = tstate->curexc_value;
-    tmp_tb = tstate->curexc_traceback;
-    tstate->curexc_type = type;
-    tstate->curexc_value = value;
-    tstate->curexc_traceback = tb;
-    Py_XDECREF(tmp_type);
-    Py_XDECREF(tmp_value);
-    Py_XDECREF(tmp_tb);
-}
-static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
-    *type = tstate->curexc_type;
-    *value = tstate->curexc_value;
-    *tb = tstate->curexc_traceback;
-    tstate->curexc_type = 0;
-    tstate->curexc_value = 0;
-    tstate->curexc_traceback = 0;
-}
-#endif
-
-/* RaiseException */
-#if PY_MAJOR_VERSION < 3
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
-                        CYTHON_UNUSED PyObject *cause) {
-    __Pyx_PyThreadState_declare
-    Py_XINCREF(type);
-    if (!value || value == Py_None)
-        value = NULL;
-    else
-        Py_INCREF(value);
-    if (!tb || tb == Py_None)
-        tb = NULL;
-    else {
-        Py_INCREF(tb);
-        if (!PyTraceBack_Check(tb)) {
-            PyErr_SetString(PyExc_TypeError,
-                "raise: arg 3 must be a traceback or None");
-            goto raise_error;
-        }
-    }
-    if (PyType_Check(type)) {
-#if CYTHON_COMPILING_IN_PYPY
-        if (!value) {
-            Py_INCREF(Py_None);
-            value = Py_None;
-        }
+#if CYTHON_USE_TYPE_SLOTS
+        result = mp->mp_subscript(obj, py_slice);
+#else
+        result = PyObject_GetItem(obj, py_slice);
 #endif
-        PyErr_NormalizeException(&type, &value, &tb);
-    } else {
-        if (value) {
-            PyErr_SetString(PyExc_TypeError,
-                "instance exception may not have a separate value");
-            goto raise_error;
-        }
-        value = type;
-        type = (PyObject*) Py_TYPE(type);
-        Py_INCREF(type);
-        if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
-            PyErr_SetString(PyExc_TypeError,
-                "raise: exception class must be a subclass of BaseException");
-            goto raise_error;
-        }
-    }
-    __Pyx_PyThreadState_assign
-    __Pyx_ErrRestore(type, value, tb);
-    return;
-raise_error:
-    Py_XDECREF(value);
-    Py_XDECREF(type);
-    Py_XDECREF(tb);
-    return;
-}
-#else
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
-    PyObject* owned_instance = NULL;
-    if (tb == Py_None) {
-        tb = 0;
-    } else if (tb && !PyTraceBack_Check(tb)) {
-        PyErr_SetString(PyExc_TypeError,
-            "raise: arg 3 must be a traceback or None");
-        goto bad;
-    }
-    if (value == Py_None)
-        value = 0;
-    if (PyExceptionInstance_Check(type)) {
-        if (value) {
-            PyErr_SetString(PyExc_TypeError,
-                "instance exception may not have a separate value");
-            goto bad;
-        }
-        value = type;
-        type = (PyObject*) Py_TYPE(value);
-    } else if (PyExceptionClass_Check(type)) {
-        PyObject *instance_class = NULL;
-        if (value && PyExceptionInstance_Check(value)) {
-            instance_class = (PyObject*) Py_TYPE(value);
-            if (instance_class != type) {
-                int is_subclass = PyObject_IsSubclass(instance_class, type);
-                if (!is_subclass) {
-                    instance_class = NULL;
-                } else if (unlikely(is_subclass == -1)) {
-                    goto bad;
-                } else {
-                    type = instance_class;
-                }
-            }
-        }
-        if (!instance_class) {
-            PyObject *args;
-            if (!value)
-                args = PyTuple_New(0);
-            else if (PyTuple_Check(value)) {
-                Py_INCREF(value);
-                args = value;
-            } else
-                args = PyTuple_Pack(1, value);
-            if (!args)
-                goto bad;
-            owned_instance = PyObject_Call(type, args, NULL);
-            Py_DECREF(args);
-            if (!owned_instance)
-                goto bad;
-            value = owned_instance;
-            if (!PyExceptionInstance_Check(value)) {
-                PyErr_Format(PyExc_TypeError,
-                             "calling %R should have returned an instance of "
-                             "BaseException, not %R",
-                             type, Py_TYPE(value));
-                goto bad;
-            }
-        }
-    } else {
-        PyErr_SetString(PyExc_TypeError,
-            "raise: exception class must be a subclass of BaseException");
-        goto bad;
-    }
-    if (cause) {
-        PyObject *fixed_cause;
-        if (cause == Py_None) {
-            fixed_cause = NULL;
-        } else if (PyExceptionClass_Check(cause)) {
-            fixed_cause = PyObject_CallObject(cause, NULL);
-            if (fixed_cause == NULL)
-                goto bad;
-        } else if (PyExceptionInstance_Check(cause)) {
-            fixed_cause = cause;
-            Py_INCREF(fixed_cause);
-        } else {
-            PyErr_SetString(PyExc_TypeError,
-                            "exception causes must derive from "
-                            "BaseException");
-            goto bad;
-        }
-        PyException_SetCause(value, fixed_cause);
-    }
-    PyErr_SetObject(type, value);
-    if (tb) {
-#if CYTHON_COMPILING_IN_PYPY
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#else
-        PyThreadState *tstate = __Pyx_PyThreadState_Current;
-        PyObject* tmp_tb = tstate->curexc_traceback;
-        if (tb != tmp_tb) {
-            Py_INCREF(tb);
-            tstate->curexc_traceback = tb;
-            Py_XDECREF(tmp_tb);
+        if (!_py_slice) {
+            Py_DECREF(py_slice);
         }
-#endif
+        return result;
     }
+    PyErr_Format(PyExc_TypeError,
+        "'%.200s' object is unsliceable", Py_TYPE(obj)->tp_name);
 bad:
-    Py_XDECREF(owned_instance);
-    return;
+    return NULL;
 }
-#endif
 
 /* Import */
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
     PyObject *empty_list = 0;
     PyObject *module = 0;
     PyObject *global_dict = 0;
     PyObject *empty_dict = 0;
@@ -6284,14 +4521,38 @@
     );
     if (likely(op)) {
         PyObject_GC_Track(op);
     }
     return op;
 }
 
+/* PyErrFetchRestore */
+#if CYTHON_FAST_THREAD_STATE
+static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
+    PyObject *tmp_type, *tmp_value, *tmp_tb;
+    tmp_type = tstate->curexc_type;
+    tmp_value = tstate->curexc_value;
+    tmp_tb = tstate->curexc_traceback;
+    tstate->curexc_type = type;
+    tstate->curexc_value = value;
+    tstate->curexc_traceback = tb;
+    Py_XDECREF(tmp_type);
+    Py_XDECREF(tmp_value);
+    Py_XDECREF(tmp_tb);
+}
+static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
+    *type = tstate->curexc_type;
+    *value = tstate->curexc_value;
+    *tb = tstate->curexc_traceback;
+    tstate->curexc_type = 0;
+    tstate->curexc_value = 0;
+    tstate->curexc_traceback = 0;
+}
+#endif
+
 /* CLineInTraceback */
 #ifndef CYTHON_CLINE_IN_TRACEBACK
 static int __Pyx_CLineForTraceback(CYTHON_NCP_UNUSED PyThreadState *tstate, int c_line) {
     PyObject *use_cline;
     PyObject *ptype, *pvalue, *ptraceback;
 #if CYTHON_COMPILING_IN_CPYTHON
     PyObject **cython_runtime_dict;
```

### Comparing `pyaibox-1.1.20/pyaibox/utils/file.c` & `pyaibox-1.1.21/pyaibox/utils/file.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/file.py` & `pyaibox-1.1.21/pyaibox/utils/file.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/file.pyi` & `pyaibox-1.1.21/pyaibox/utils/file.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/image.py` & `pyaibox-1.1.21/pyaibox/utils/image.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/image.pyi` & `pyaibox-1.1.21/pyaibox/utils/image.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/ios.c` & `pyaibox-1.1.21/pyaibox/utils/ios.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/ios.py` & `pyaibox-1.1.21/pyaibox/utils/ios.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/ios.pyi` & `pyaibox-1.1.21/pyaibox/utils/ios.pyi`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/plot_show.c` & `pyaibox-1.1.21/pyaibox/utils/plot_show.c`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/plot_show.py` & `pyaibox-1.1.21/pyaibox/utils/plot_show.py`

 * *Files identical despite different names*

### Comparing `pyaibox-1.1.20/pyaibox/utils/plot_show.pyi` & `pyaibox-1.1.21/pyaibox/utils/plot_show.pyi`

 * *Files 5% similar despite different names*

```diff
@@ -3,14 +3,20 @@
 
 def plots(x, ydict, plotdir='./', xlabel='x', ylabel='y', title='', issave=False, isshow=True):
     ...
 
 class Plots:
     ...
 
+    def __init__(self, plotdir='./', xlabel='x', ylabel='y', title='', figname=None, issave=False, isshow=True):
+        ...
+
+    def __call__(self, x, ydict, figname=None):
+        ...
+
 def plot(Ys, nrows=None, ncols=None, styles=None, legends=None, grids=False, xlabels=None, ylabels=None, titles=None, figsize=None, outfile=None, **kwargs):
     r"""show images
 
     This function create an figure and show images in :math:`a` rows and :math:`b` columns.
 
     Parameters
     ----------
```

### Comparing `pyaibox-1.1.20/pyaibox/version.c` & `pyaibox-1.1.21/pyaibox/version.c`

 * *Files 0% similar despite different names*

```diff
@@ -1165,18 +1165,18 @@
 extern int __pyx_module_is_main_pyaibox__version;
 int __pyx_module_is_main_pyaibox__version = 0;
 
 /* Implementation of 'pyaibox.version' */
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_name[] = "__name__";
 static const char __pyx_k_test[] = "__test__";
-static const char __pyx_k_1_1_20[] = "1.1.20";
+static const char __pyx_k_1_1_21[] = "1.1.21";
 static const char __pyx_k_version[] = "__version__";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
-static PyObject *__pyx_kp_u_1_1_20;
+static PyObject *__pyx_kp_u_1_1_21;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_n_s_version;
 /* Late includes */
 
@@ -1222,15 +1222,15 @@
     #define CYTHON_SMALL_CODE __attribute__((cold))
 #else
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
-  {&__pyx_kp_u_1_1_20, __pyx_k_1_1_20, sizeof(__pyx_k_1_1_20), 0, 1, 0, 0},
+  {&__pyx_kp_u_1_1_21, __pyx_k_1_1_21, sizeof(__pyx_k_1_1_21), 0, 1, 0, 0},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_n_s_version, __pyx_k_version, sizeof(__pyx_k_version), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
@@ -1515,22 +1515,22 @@
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
 
   /* "pyaibox/version.py":3
  * # Copyright (c) 2015-2030, Zhi Liu.  All rights reserved.
  * 
- * __version__ = '1.1.20'             # <<<<<<<<<<<<<<
+ * __version__ = '1.1.21'             # <<<<<<<<<<<<<<
  */
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_version, __pyx_kp_u_1_1_20) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_version, __pyx_kp_u_1_1_21) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
 
   /* "pyaibox/version.py":1
  * # Copyright (c) 2015-2030, Zhi Liu.  All rights reserved.             # <<<<<<<<<<<<<<
  * 
- * __version__ = '1.1.20'
+ * __version__ = '1.1.21'
  */
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /*--- Wrapped vars code ---*/
```

### Comparing `pyaibox-1.1.20/pyaibox.egg-info/PKG-INFO` & `pyaibox-1.1.21/pyaibox.egg-info/PKG-INFO`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyaibox
-Version: 1.1.20
+Version: 1.1.21
 Summary: Python Library.
 Home-page: https://iridescent.ink/pyaibox/
 Download-URL: https://github.com/antsfamily/pyaibox/
 Author: Zhi Liu
 Author-email: zhiliu.mind@gmail.com
 License: MIT
 Keywords: Python,Library,Digital signal processing,Tool
```

### Comparing `pyaibox-1.1.20/pyaibox.egg-info/SOURCES.txt` & `pyaibox-1.1.21/pyaibox.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -191,14 +191,15 @@
 examples/misc/demo_sample_patch.py
 examples/misc/demo_shuffle_tensor.py
 examples/ml/demo_mnist_pca.py
 examples/summary/demo_loss_log.py
 examples/utils/demo_bin.py
 examples/utils/demo_colors.py
 examples/utils/demo_convert.py
+examples/utils/demo_delete_c_comments.py
 examples/utils/demo_docstring.py
 examples/utils/demo_file.py
 examples/utils/demo_ios.py
 examples/utils/demo_read_log.py
 examples/utils/demo_typevalue.py
 pyaibox/__init__.py
 pyaibox/version.c
```

### Comparing `pyaibox-1.1.20/setup.py` & `pyaibox-1.1.21/setup.py`

 * *Files identical despite different names*

