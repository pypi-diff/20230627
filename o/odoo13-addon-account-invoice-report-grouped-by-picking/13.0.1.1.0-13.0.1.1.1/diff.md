# Comparing `tmp/odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0-py3-none-any.whl.zip` & `tmp/odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,22 @@
-Zip file size: 29357 bytes, number of entries: 20
--rw-r--r--  2.0 unx     3667 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/README.rst
--rw-r--r--  2.0 unx       21 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/__init__.py
--rw-r--r--  2.0 unx      662 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/__manifest__.py
--rw-r--r--  2.0 unx     1431 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/i18n/account_invoice_report_grouped_by_picking.pot
--rw-r--r--  2.0 unx     1769 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/i18n/es.po
--rw-r--r--  2.0 unx     1669 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/i18n/pt.po
--rw-r--r--  2.0 unx       27 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/models/__init__.py
--rw-r--r--  2.0 unx     5775 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/models/account_move.py
--rw-r--r--  2.0 unx      195 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      317 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      338 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/readme/USAGE.rst
--rw-r--r--  2.0 unx     9455 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/static/description/icon.png
--rw-r--r--  2.0 unx    13122 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/static/description/index.html
--rw-r--r--  2.0 unx       49 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/tests/__init__.py
--rw-r--r--  2.0 unx    11251 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/tests/test_account_invoice_group_picking.py
--rw-r--r--  2.0 unx     5730 b- defN 23-May-17 19:30 odoo/addons/account_invoice_report_grouped_by_picking/views/report_invoice.xml
--rw-r--r--  2.0 unx     4312 b- defN 23-May-17 19:30 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-17 19:30 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-May-17 19:30 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2620 b- defN 23-May-17 19:30 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/RECORD
-20 files, 62507 bytes uncompressed, 24721 bytes compressed:  60.5%
+Zip file size: 29501 bytes, number of entries: 20
+-rw-r--r--  2.0 unx     3667 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/__init__.py
+-rw-r--r--  2.0 unx      662 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/__manifest__.py
+-rw-r--r--  2.0 unx     1431 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/i18n/account_invoice_report_grouped_by_picking.pot
+-rw-r--r--  2.0 unx     1769 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/i18n/es.po
+-rw-r--r--  2.0 unx     1669 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/i18n/pt.po
+-rw-r--r--  2.0 unx       27 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/models/__init__.py
+-rw-r--r--  2.0 unx     5893 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/models/account_move.py
+-rw-r--r--  2.0 unx      195 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      317 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      338 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/readme/USAGE.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/static/description/icon.png
+-rw-r--r--  2.0 unx    13122 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/static/description/index.html
+-rw-r--r--  2.0 unx       49 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/tests/__init__.py
+-rw-r--r--  2.0 unx    14152 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/tests/test_account_invoice_group_picking.py
+-rw-r--r--  2.0 unx     5730 b- defN 23-Jun-27 16:24 odoo/addons/account_invoice_report_grouped_by_picking/views/report_invoice.xml
+-rw-r--r--  2.0 unx     4312 b- defN 23-Jun-27 16:24 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-27 16:24 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-27 16:24 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2620 b- defN 23-Jun-27 16:24 odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/RECORD
+20 files, 65526 bytes uncompressed, 24865 bytes compressed:  62.1%
```

## zipnote {}

```diff
@@ -42,20 +42,20 @@
 
 Filename: odoo/addons/account_invoice_report_grouped_by_picking/tests/test_account_invoice_group_picking.py
 Comment: 
 
 Filename: odoo/addons/account_invoice_report_grouped_by_picking/views/report_invoice.xml
 Comment: 
 
-Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/METADATA
+Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/METADATA
 Comment: 
 
-Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/WHEEL
+Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/WHEEL
 Comment: 
 
-Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/top_level.txt
+Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/RECORD
+Filename: odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/account_invoice_report_grouped_by_picking/__manifest__.py

```diff
@@ -2,15 +2,15 @@
 # Copyright 2018 David Vidal <david.vidal@tecnativa.com>
 # Copyright 2018-2019 Tecnativa - Pedro M. Baeza
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 {
     "name": "Account Invoice Grouped by Picking",
     "summary": "Print invoice lines grouped by picking",
-    "version": "13.0.1.1.0",
+    "version": "13.0.1.1.1",
     "category": "Accounting & Finance",
     "website": "https://github.com/OCA/account-invoice-reporting",
     "author": "Tecnativa, " "Odoo Community Association (OCA)",
     "license": "AGPL-3",
     "depends": ["stock_picking_invoice_link"],
     "data": ["views/report_invoice.xml"],
 }
```

## odoo/addons/account_invoice_report_grouped_by_picking/models/account_move.py

```diff
@@ -103,31 +103,36 @@
                         )
                         picking_dict.setdefault(key, 0)
                         qty = so_line.product_uom_qty
                         picking_dict[key] += qty
                         remaining_qty -= qty
             elif not line.move_line_ids and not line.sale_line_ids:
                 key = (picking_obj, line)
+                self._process_section_note_lines_grouped(
+                    previous_section, previous_note, lines_dict
+                )
                 picking_dict.setdefault(key, 0)
                 qty = line.quantity
                 picking_dict[key] += qty
                 remaining_qty -= qty
             # To avoid to print duplicate lines because the invoice is a refund
             # without returned goods to refund.
-            if self.type == "out_refund" and not has_returned_qty and remaining_qty:
+            if (
+                self.type == "out_refund"
+                and not has_returned_qty
+                and remaining_qty
+                and line.product_id.type != "service"
+            ):
                 remaining_qty = 0.0
                 for key in picking_dict:
                     picking_dict[key] = abs(picking_dict[key])
             if not float_is_zero(
                 remaining_qty,
                 precision_rounding=line.product_id.uom_id.rounding or 0.01,
             ):
-                self._process_section_note_lines_grouped(
-                    previous_section, previous_note, lines_dict
-                )
                 lines_dict[line] = remaining_qty
         no_picking = [
             {"picking": picking_obj, "line": key, "quantity": value}
             for key, value in lines_dict.items()
         ]
         with_picking = [
             {"picking": key[0], "line": key[1], "quantity": value}
```

## odoo/addons/account_invoice_report_grouped_by_picking/tests/test_account_invoice_group_picking.py

```diff
@@ -23,14 +23,21 @@
         cls.service = cls.env["product.product"].create(
             {
                 "name": "Test service product",
                 "type": "service",
                 "invoice_policy": "order",
             }
         )
+        cls.service2 = cls.env["product.product"].create(
+            {
+                "name": "Test service product 2",
+                "type": "service",
+                "invoice_policy": "order",
+            }
+        )
         cls.partner = cls.env["res.partner"].create({"name": "Partner for test"})
         cls.sale = cls.env["sale.order"].create(
             {
                 "partner_id": cls.partner.id,
                 "order_line": [
                     (
                         0,
@@ -53,14 +60,43 @@
                             "product_uom": cls.service.uom_id.id,
                             "price_unit": 50.0,
                         },
                     ),
                 ],
             }
         )
+        cls.sale2 = cls.env["sale.order"].create(
+            {
+                "partner_id": cls.partner.id,
+                "order_line": [
+                    (
+                        0,
+                        0,
+                        {
+                            "name": cls.service2.name,
+                            "product_id": cls.service2.id,
+                            "product_uom_qty": 2,
+                            "product_uom": cls.service2.uom_id.id,
+                            "price_unit": 100.0,
+                        },
+                    ),
+                    (
+                        0,
+                        0,
+                        {
+                            "name": cls.service.name,
+                            "product_id": cls.service.id,
+                            "product_uom_qty": 3,
+                            "product_uom": cls.service.uom_id.id,
+                            "price_unit": 50.0,
+                        },
+                    ),
+                ],
+            }
+        )
 
     def get_return_picking_wizard(self, picking):
         stock_return_picking_form = Form(
             self.env["stock.return.picking"].with_context(
                 active_ids=picking.ids,
                 active_id=picking.ids[0],
                 active_model="stock.picking",
@@ -262,7 +298,43 @@
         tbody = [html.tostring(line, encoding="utf-8").strip() for line in tbody][
             0
         ].decode()
         # information about sales is printed
         self.assertEqual(tbody.count(self.sale.name), 1)
         # information about pickings is printed
         self.assertTrue(picking.name in tbody)
+
+    def test_account_invoice_group_picking_service_sale_reports_check(self):
+        self.sale2.action_confirm()
+        # invoice sales
+        invoice = self.sale2._create_invoices()
+        invoice.post()
+        # Test report
+        content = html.document_fromstring(
+            self.env.ref("account.account_invoices").render_qweb_html(invoice.id)[0]
+        )
+        tbody = content.xpath("//tbody[@class='invoice_tbody']")
+        tbody = [html.tostring(line, encoding="utf-8").strip() for line in tbody][
+            0
+        ].decode()
+        # check if service line is in report
+        self.assertTrue(self.sale2.order_line[0].name in tbody)
+        self.assertTrue(self.sale2.order_line[1].name in tbody)
+        # Refund invoice
+        wiz_invoice_refund = (
+            self.env["account.move.reversal"]
+            .with_context(active_model="account.move", active_ids=invoice.ids)
+            .create({"refund_method": "cancel", "reason": "test"})
+        )
+        wiz_invoice_refund.reverse_moves()
+        new_invoice = self.sale2.invoice_ids.filtered(lambda i: i.type == "out_refund")
+        # Test report
+        content = html.document_fromstring(
+            self.env.ref("account.account_invoices").render_qweb_html(new_invoice.id)[0]
+        )
+        tbody = content.xpath("//tbody[@class='invoice_tbody']")
+        tbody = [html.tostring(line, encoding="utf-8").strip() for line in tbody][
+            0
+        ].decode()
+        # check if service line is in report
+        self.assertTrue(self.sale2.order_line[0].name in tbody)
+        self.assertTrue(self.sale2.order_line[1].name in tbody)
```

## Comparing `odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/METADATA` & `odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo13-addon-account-invoice-report-grouped-by-picking
-Version: 13.0.1.1.0
+Version: 13.0.1.1.1
 Summary: Print invoice lines grouped by picking
 Home-page: https://github.com/OCA/account-invoice-reporting
 Author: Tecnativa, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/RECORD` & `odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 odoo/addons/account_invoice_report_grouped_by_picking/README.rst,sha256=wN3lz48naaZ-8mSA1JAh0bI_Cq5sBvzz2SCRCMtpwFE,3667
 odoo/addons/account_invoice_report_grouped_by_picking/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/account_invoice_report_grouped_by_picking/__manifest__.py,sha256=By5JOclttCd6gRjKaFPROcTmAD4K8vYlBGhEXIRWBZE,662
+odoo/addons/account_invoice_report_grouped_by_picking/__manifest__.py,sha256=S0EECzDcxfsny4qZfJoQ3dN2k8fJmjzebAWBb_Q3WDw,662
 odoo/addons/account_invoice_report_grouped_by_picking/i18n/account_invoice_report_grouped_by_picking.pot,sha256=_Zyc1WzPKjEQiEtcccj8p5FBLvgrlnzjY_OjN0HgAd8,1431
 odoo/addons/account_invoice_report_grouped_by_picking/i18n/es.po,sha256=tWIIC7fuSUQIm8Q3Du38rjrZa8KrDY-rNM3lINjAaBY,1769
 odoo/addons/account_invoice_report_grouped_by_picking/i18n/pt.po,sha256=1yCepiwTze3bcYsS4ssl-0auHPSkUeLw9HFJmiCY0NI,1669
 odoo/addons/account_invoice_report_grouped_by_picking/models/__init__.py,sha256=9829nnQdRNsJmZEDfsGtCQQqM2W0JuYarPptYP2zJzU,27
-odoo/addons/account_invoice_report_grouped_by_picking/models/account_move.py,sha256=irk_qgertb8NxEWrcECaqBGOlNxTtH9HPveDb4LZCVA,5775
+odoo/addons/account_invoice_report_grouped_by_picking/models/account_move.py,sha256=e-HgCQUArKIVjUD-gn7RfwPyXpVmPz_VDX_4iC4rsQY,5893
 odoo/addons/account_invoice_report_grouped_by_picking/readme/CONTRIBUTORS.rst,sha256=u7X_KF1L48uBB4czzdfJyQvXGELnX32MpbPIBcY8KnY,195
 odoo/addons/account_invoice_report_grouped_by_picking/readme/DESCRIPTION.rst,sha256=82ARWU3EdaEvvajAt1n6cV9n3Lke6HhMP3nep_Xx7Z0,317
 odoo/addons/account_invoice_report_grouped_by_picking/readme/USAGE.rst,sha256=L6CqrUPpcgpp71pKB3LiOzilAaj2ZDiuNB_fFxBAjuM,338
 odoo/addons/account_invoice_report_grouped_by_picking/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/account_invoice_report_grouped_by_picking/static/description/index.html,sha256=sWMpK1RCLUcQTnIXwq6Lma-ah4onqR1JlEcT-DGISIo,13122
 odoo/addons/account_invoice_report_grouped_by_picking/tests/__init__.py,sha256=NNnN1-zIGuye0p_0vys1VmOZrygIGrrve7EVeFdEofY,49
-odoo/addons/account_invoice_report_grouped_by_picking/tests/test_account_invoice_group_picking.py,sha256=la2TofCEORkxZo0rDcCccFI2LEKBMP5n3FjWqnQGxws,11251
+odoo/addons/account_invoice_report_grouped_by_picking/tests/test_account_invoice_group_picking.py,sha256=8-eAFtWPCpTz_TWAA7QcmtJ3c9Fc8SA-P5ymZA01r4E,14152
 odoo/addons/account_invoice_report_grouped_by_picking/views/report_invoice.xml,sha256=q6cEpoH3ha8eWaCDr4riuMVjAQXsckFTSNLeD2GZ-gY,5730
-odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/METADATA,sha256=b1zZEDPldsPK9ERUDT3kmrjvgRIdu2vzpsO5h92GVAs,4312
-odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.0.dist-info/RECORD,,
+odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/METADATA,sha256=9riStuKuTvEphjgkP8Mlem-bn0_ZHKtJi1N2Hl44VVE,4312
+odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo13_addon_account_invoice_report_grouped_by_picking-13.0.1.1.1.dist-info/RECORD,,
```

