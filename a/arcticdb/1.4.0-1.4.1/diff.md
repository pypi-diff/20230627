# Comparing `tmp/arcticdb-1.4.0-cp39-cp39-win_amd64.whl.zip` & `tmp/arcticdb-1.4.1-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,73 +1,73 @@
-Zip file size: 6204545 bytes, number of entries: 71
--rw-rw-rw-  2.0 fat 22064128 b- defN 23-Jun-23 11:08 arcticdb_ext.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat       66 b- defN 23-Jun-23 10:35 arcticc/__init__.py
--rw-rw-rw-  2.0 fat      583 b- defN 23-Jun-23 10:35 arcticc/pb2/__init__.py
--rw-rw-rw-  2.0 fat      424 b- defN 23-Jun-23 10:35 arcticdb/__init__.py
--rw-rw-rw-  2.0 fat      447 b- defN 23-Jun-23 10:35 arcticdb/_msgpack_compat.py
--rw-rw-rw-  2.0 fat    11446 b- defN 23-Jun-23 10:35 arcticdb/arctic.py
--rw-rw-rw-  2.0 fat     7524 b- defN 23-Jun-23 10:35 arcticdb/config.py
--rw-rw-rw-  2.0 fat      765 b- defN 23-Jun-23 10:35 arcticdb/exceptions.py
--rw-rw-rw-  2.0 fat     9361 b- defN 23-Jun-23 10:35 arcticdb/flattener.py
--rw-rw-rw-  2.0 fat     1810 b- defN 23-Jun-23 10:35 arcticdb/log.py
--rw-rw-rw-  2.0 fat     6476 b- defN 23-Jun-23 10:35 arcticdb/options.py
--rw-rw-rw-  2.0 fat      519 b- defN 23-Jun-23 10:35 arcticdb/preconditions.py
--rw-rw-rw-  2.0 fat     1612 b- defN 23-Jun-23 10:35 arcticdb/supported_types.py
--rw-rw-rw-  2.0 fat     3150 b- defN 23-Jun-23 10:35 arcticdb/tools.py
--rw-rw-rw-  2.0 fat      138 b- defN 23-Jun-23 10:35 arcticdb/adapters/__init__.py
--rw-rw-rw-  2.0 fat     2349 b- defN 23-Jun-23 10:35 arcticdb/adapters/arctic_library_adapter.py
--rw-rw-rw-  2.0 fat     2534 b- defN 23-Jun-23 10:35 arcticdb/adapters/lmdb_library_adapter.py
--rw-rw-rw-  2.0 fat     7550 b- defN 23-Jun-23 10:35 arcticdb/adapters/s3_library_adapter.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-23 10:35 arcticdb/authorization/__init__.py
--rw-rw-rw-  2.0 fat      969 b- defN 23-Jun-23 10:35 arcticdb/authorization/permissions.py
--rw-rw-rw-  2.0 fat     8935 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/config_pb2.py
--rw-rw-rw-  2.0 fat    96954 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/descriptors_pb2.py
--rw-rw-rw-  2.0 fat    28646 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/encoding_pb2.py
--rw-rw-rw-  2.0 fat    13225 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/generation_pb2.py
--rw-rw-rw-  2.0 fat     1990 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/in_memory_storage_pb2.py
--rw-rw-rw-  2.0 fat     4634 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/lmdb_storage_pb2.py
--rw-rw-rw-  2.0 fat    24224 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/logger_pb2.py
--rw-rw-rw-  2.0 fat     2931 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/mongo_storage_pb2.py
--rw-rw-rw-  2.0 fat     6878 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/nfs_backed_storage_pb2.py
--rw-rw-rw-  2.0 fat     3821 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/processors_pb2.py
--rw-rw-rw-  2.0 fat    49227 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/request_pb2.py
--rw-rw-rw-  2.0 fat     6729 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/s3_storage_pb2.py
--rw-rw-rw-  2.0 fat    67292 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/storage_pb2.py
--rw-rw-rw-  2.0 fat    12621 b- defN 23-Jun-23 10:45 arcticdb/proto/3/arcticc/pb2/utils_pb2.py
--rw-rw-rw-  2.0 fat     2413 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/config_pb2.py
--rw-rw-rw-  2.0 fat    15753 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/descriptors_pb2.py
--rw-rw-rw-  2.0 fat     5202 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/encoding_pb2.py
--rw-rw-rw-  2.0 fat     3113 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/generation_pb2.py
--rw-rw-rw-  2.0 fat     1081 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/in_memory_storage_pb2.py
--rw-rw-rw-  2.0 fat     1434 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/lmdb_storage_pb2.py
--rw-rw-rw-  2.0 fat     4397 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/logger_pb2.py
--rw-rw-rw-  2.0 fat     1262 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/mongo_storage_pb2.py
--rw-rw-rw-  2.0 fat     1560 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/nfs_backed_storage_pb2.py
--rw-rw-rw-  2.0 fat     1326 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/processors_pb2.py
--rw-rw-rw-  2.0 fat     7300 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/request_pb2.py
--rw-rw-rw-  2.0 fat     1539 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/s3_storage_pb2.py
--rw-rw-rw-  2.0 fat    10526 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/storage_pb2.py
--rw-rw-rw-  2.0 fat     2449 b- defN 23-Jun-23 10:45 arcticdb/proto/4/arcticc/pb2/utils_pb2.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-23 10:35 arcticdb/toolbox/__init__.py
--rw-rw-rw-  2.0 fat     6102 b- defN 23-Jun-23 10:35 arcticdb/toolbox/library_tool.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-23 10:35 arcticdb/util/__init__.py
--rw-rw-rw-  2.0 fat     2705 b- defN 23-Jun-23 10:35 arcticdb/util/errors.py
--rw-rw-rw-  2.0 fat     8775 b- defN 23-Jun-23 10:35 arcticdb/util/hypothesis.py
--rw-rw-rw-  2.0 fat      719 b- defN 23-Jun-23 10:35 arcticdb/util/memory.py
--rw-rw-rw-  2.0 fat     6013 b- defN 23-Jun-23 10:35 arcticdb/util/tasks.py
--rw-rw-rw-  2.0 fat    18249 b- defN 23-Jun-23 10:35 arcticdb/util/test.py
--rw-rw-rw-  2.0 fat      131 b- defN 23-Jun-23 10:35 arcticdb/version_store/__init__.py
--rw-rw-rw-  2.0 fat     7189 b- defN 23-Jun-23 10:35 arcticdb/version_store/_common.py
--rw-rw-rw-  2.0 fat     4193 b- defN 23-Jun-23 10:35 arcticdb/version_store/_custom_normalizers.py
--rw-rw-rw-  2.0 fat    52659 b- defN 23-Jun-23 10:35 arcticdb/version_store/_normalization.py
--rw-rw-rw-  2.0 fat   113724 b- defN 23-Jun-23 10:35 arcticdb/version_store/_store.py
--rw-rw-rw-  2.0 fat    11129 b- defN 23-Jun-23 10:35 arcticdb/version_store/helper.py
--rw-rw-rw-  2.0 fat    59545 b- defN 23-Jun-23 10:35 arcticdb/version_store/library.py
--rw-rw-rw-  2.0 fat    24370 b- defN 23-Jun-23 10:35 arcticdb/version_store/processing.py
--rw-rw-rw-  2.0 fat      603 b- defN 23-Jun-23 10:35 arcticdb/version_store/read_result.py
--rw-rw-rw-  2.0 fat     4851 b- defN 23-Jun-23 11:08 arcticdb-1.4.0.dist-info/LICENSE.txt
--rw-rw-rw-  2.0 fat     8557 b- defN 23-Jun-23 11:08 arcticdb-1.4.0.dist-info/METADATA
--rw-rw-rw-  2.0 fat    18186 b- defN 23-Jun-23 11:08 arcticdb-1.4.0.dist-info/NOTICE.txt
--rw-rw-rw-  2.0 fat      100 b- defN 23-Jun-23 11:08 arcticdb-1.4.0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       30 b- defN 23-Jun-23 11:08 arcticdb-1.4.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     6530 b- defN 23-Jun-23 11:08 arcticdb-1.4.0.dist-info/RECORD
-71 files, 22863673 bytes uncompressed, 6194049 bytes compressed:  72.9%
+Zip file size: 6211234 bytes, number of entries: 71
+-rw-rw-rw-  2.0 fat 22111744 b- defN 23-Jun-27 14:58 arcticdb_ext.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat      302 b- defN 23-Jun-27 14:39 arcticc/__init__.py
+-rw-rw-rw-  2.0 fat      583 b- defN 23-Jun-27 14:39 arcticc/pb2/__init__.py
+-rw-rw-rw-  2.0 fat      424 b- defN 23-Jun-27 14:39 arcticdb/__init__.py
+-rw-rw-rw-  2.0 fat      447 b- defN 23-Jun-27 14:39 arcticdb/_msgpack_compat.py
+-rw-rw-rw-  2.0 fat    11446 b- defN 23-Jun-27 14:39 arcticdb/arctic.py
+-rw-rw-rw-  2.0 fat     7524 b- defN 23-Jun-27 14:39 arcticdb/config.py
+-rw-rw-rw-  2.0 fat      765 b- defN 23-Jun-27 14:39 arcticdb/exceptions.py
+-rw-rw-rw-  2.0 fat     9361 b- defN 23-Jun-27 14:39 arcticdb/flattener.py
+-rw-rw-rw-  2.0 fat     1810 b- defN 23-Jun-27 14:39 arcticdb/log.py
+-rw-rw-rw-  2.0 fat     6476 b- defN 23-Jun-27 14:39 arcticdb/options.py
+-rw-rw-rw-  2.0 fat      519 b- defN 23-Jun-27 14:39 arcticdb/preconditions.py
+-rw-rw-rw-  2.0 fat     1612 b- defN 23-Jun-27 14:39 arcticdb/supported_types.py
+-rw-rw-rw-  2.0 fat     3150 b- defN 23-Jun-27 14:39 arcticdb/tools.py
+-rw-rw-rw-  2.0 fat      138 b- defN 23-Jun-27 14:39 arcticdb/adapters/__init__.py
+-rw-rw-rw-  2.0 fat     2349 b- defN 23-Jun-27 14:39 arcticdb/adapters/arctic_library_adapter.py
+-rw-rw-rw-  2.0 fat     2534 b- defN 23-Jun-27 14:39 arcticdb/adapters/lmdb_library_adapter.py
+-rw-rw-rw-  2.0 fat     7550 b- defN 23-Jun-27 14:39 arcticdb/adapters/s3_library_adapter.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-27 14:39 arcticdb/authorization/__init__.py
+-rw-rw-rw-  2.0 fat      969 b- defN 23-Jun-27 14:39 arcticdb/authorization/permissions.py
+-rw-rw-rw-  2.0 fat     8935 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/config_pb2.py
+-rw-rw-rw-  2.0 fat    96954 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/descriptors_pb2.py
+-rw-rw-rw-  2.0 fat    28646 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/encoding_pb2.py
+-rw-rw-rw-  2.0 fat    13225 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/generation_pb2.py
+-rw-rw-rw-  2.0 fat     1990 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/in_memory_storage_pb2.py
+-rw-rw-rw-  2.0 fat     4634 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/lmdb_storage_pb2.py
+-rw-rw-rw-  2.0 fat    24224 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/logger_pb2.py
+-rw-rw-rw-  2.0 fat     2931 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/mongo_storage_pb2.py
+-rw-rw-rw-  2.0 fat     6878 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/nfs_backed_storage_pb2.py
+-rw-rw-rw-  2.0 fat     3821 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/processors_pb2.py
+-rw-rw-rw-  2.0 fat    49227 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/request_pb2.py
+-rw-rw-rw-  2.0 fat     6729 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/s3_storage_pb2.py
+-rw-rw-rw-  2.0 fat    67292 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/storage_pb2.py
+-rw-rw-rw-  2.0 fat    12621 b- defN 23-Jun-27 14:49 arcticdb/proto/3/arcticc/pb2/utils_pb2.py
+-rw-rw-rw-  2.0 fat     2413 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/config_pb2.py
+-rw-rw-rw-  2.0 fat    15753 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/descriptors_pb2.py
+-rw-rw-rw-  2.0 fat     5202 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/encoding_pb2.py
+-rw-rw-rw-  2.0 fat     3113 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/generation_pb2.py
+-rw-rw-rw-  2.0 fat     1081 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/in_memory_storage_pb2.py
+-rw-rw-rw-  2.0 fat     1434 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/lmdb_storage_pb2.py
+-rw-rw-rw-  2.0 fat     4397 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/logger_pb2.py
+-rw-rw-rw-  2.0 fat     1262 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/mongo_storage_pb2.py
+-rw-rw-rw-  2.0 fat     1560 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/nfs_backed_storage_pb2.py
+-rw-rw-rw-  2.0 fat     1326 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/processors_pb2.py
+-rw-rw-rw-  2.0 fat     7300 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/request_pb2.py
+-rw-rw-rw-  2.0 fat     1539 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/s3_storage_pb2.py
+-rw-rw-rw-  2.0 fat    10526 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/storage_pb2.py
+-rw-rw-rw-  2.0 fat     2449 b- defN 23-Jun-27 14:49 arcticdb/proto/4/arcticc/pb2/utils_pb2.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-27 14:39 arcticdb/toolbox/__init__.py
+-rw-rw-rw-  2.0 fat     6102 b- defN 23-Jun-27 14:39 arcticdb/toolbox/library_tool.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-27 14:39 arcticdb/util/__init__.py
+-rw-rw-rw-  2.0 fat     2705 b- defN 23-Jun-27 14:39 arcticdb/util/errors.py
+-rw-rw-rw-  2.0 fat     8775 b- defN 23-Jun-27 14:39 arcticdb/util/hypothesis.py
+-rw-rw-rw-  2.0 fat      719 b- defN 23-Jun-27 14:39 arcticdb/util/memory.py
+-rw-rw-rw-  2.0 fat     6013 b- defN 23-Jun-27 14:39 arcticdb/util/tasks.py
+-rw-rw-rw-  2.0 fat    18249 b- defN 23-Jun-27 14:39 arcticdb/util/test.py
+-rw-rw-rw-  2.0 fat      131 b- defN 23-Jun-27 14:39 arcticdb/version_store/__init__.py
+-rw-rw-rw-  2.0 fat     7189 b- defN 23-Jun-27 14:39 arcticdb/version_store/_common.py
+-rw-rw-rw-  2.0 fat     4193 b- defN 23-Jun-27 14:39 arcticdb/version_store/_custom_normalizers.py
+-rw-rw-rw-  2.0 fat    52659 b- defN 23-Jun-27 14:39 arcticdb/version_store/_normalization.py
+-rw-rw-rw-  2.0 fat   114256 b- defN 23-Jun-27 14:39 arcticdb/version_store/_store.py
+-rw-rw-rw-  2.0 fat    11129 b- defN 23-Jun-27 14:39 arcticdb/version_store/helper.py
+-rw-rw-rw-  2.0 fat    59901 b- defN 23-Jun-27 14:39 arcticdb/version_store/library.py
+-rw-rw-rw-  2.0 fat    24370 b- defN 23-Jun-27 14:39 arcticdb/version_store/processing.py
+-rw-rw-rw-  2.0 fat      603 b- defN 23-Jun-27 14:39 arcticdb/version_store/read_result.py
+-rw-rw-rw-  2.0 fat     4851 b- defN 23-Jun-27 14:58 arcticdb-1.4.1.dist-info/LICENSE.txt
+-rw-rw-rw-  2.0 fat     8557 b- defN 23-Jun-27 14:58 arcticdb-1.4.1.dist-info/METADATA
+-rw-rw-rw-  2.0 fat    18186 b- defN 23-Jun-27 14:58 arcticdb-1.4.1.dist-info/NOTICE.txt
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Jun-27 14:58 arcticdb-1.4.1.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       30 b- defN 23-Jun-27 14:58 arcticdb-1.4.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     6531 b- defN 23-Jun-27 14:58 arcticdb-1.4.1.dist-info/RECORD
+71 files, 22912414 bytes uncompressed, 6200738 bytes compressed:  72.9%
```

## zipnote {}

```diff
@@ -189,26 +189,26 @@
 
 Filename: arcticdb/version_store/processing.py
 Comment: 
 
 Filename: arcticdb/version_store/read_result.py
 Comment: 
 
-Filename: arcticdb-1.4.0.dist-info/LICENSE.txt
+Filename: arcticdb-1.4.1.dist-info/LICENSE.txt
 Comment: 
 
-Filename: arcticdb-1.4.0.dist-info/METADATA
+Filename: arcticdb-1.4.1.dist-info/METADATA
 Comment: 
 
-Filename: arcticdb-1.4.0.dist-info/NOTICE.txt
+Filename: arcticdb-1.4.1.dist-info/NOTICE.txt
 Comment: 
 
-Filename: arcticdb-1.4.0.dist-info/WHEEL
+Filename: arcticdb-1.4.1.dist-info/WHEEL
 Comment: 
 
-Filename: arcticdb-1.4.0.dist-info/top_level.txt
+Filename: arcticdb-1.4.1.dist-info/top_level.txt
 Comment: 
 
-Filename: arcticdb-1.4.0.dist-info/RECORD
+Filename: arcticdb-1.4.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## arcticc/__init__.py

```diff
@@ -1 +1,9 @@
+# file from ArcticDB
 __path__ = __import__("pkgutil").extend_path(__path__, __name__)
+
+# Use Man's API backwards compatibility layer if it is installed.
+# This will not do anything outside of Man Group systems.
+try:
+    from man.arcticdb.arcticdb_renamer import *
+except ImportError:
+    pass
```

## arcticdb/__init__.py

```diff
@@ -7,8 +7,8 @@
 from arcticdb.version_store.processing import QueryBuilder
 import arcticdb.version_store.library as library
 from arcticdb.options import LibraryOptions
 from arcticdb.tools import set_config_from_env_vars
 
 set_config_from_env_vars(_os.environ)
 
-__version__ = "1.4.0"
+__version__ = "1.4.1"
```

## arcticdb/version_store/_store.py

```diff
@@ -2229,16 +2229,34 @@
 
         Returns
         -------
         `bool`
             True if the symbol is pickled, False otherwise.
         """
         version_query = self._get_version_query(as_of, **kwargs)
-        _, desc = self.version_store.read_descriptor(symbol, version_query)
-        return self.is_pickled_descriptor(desc)
+        dit = self.version_store.read_descriptor(symbol, version_query)
+        return self.is_pickled_descriptor(dit.timeseries_descriptor)
+
+    def _get_time_range_from_ts(self, desc, min_ts, max_ts):
+        if min_ts == None or max_ts == None:
+            return datetime64("nat"), datetime64("nat")
+        input_type = desc.normalization.WhichOneof("input_type")
+        tz = None
+        if input_type == "df":
+            index_metadata = desc.normalization.df.common
+            tz = get_timezone_from_metadata(index_metadata)
+        if tz:
+            # If tz is provided, it is stored in UTC - hence needs to be localized to UTC before
+            # converting to the given tz
+            return (
+                _from_tz_timestamp(min_ts, "UTC").astimezone(pytz.timezone(tz)),
+                _from_tz_timestamp(max_ts, "UTC").astimezone(pytz.timezone(tz)),
+            )
+        else:
+            return _from_tz_timestamp(min_ts, None), _from_tz_timestamp(max_ts, None)
 
     def get_timerange_for_symbol(
         self, symbol: str, version: Optional[VersionQueryInput] = None
     ) -> Tuple[datetime, datetime]:
         """
         Query the earliest and latest timestamp in the index of the specified revision of the symbol.
 
@@ -2261,31 +2279,17 @@
         frame_data = ReadResult(*i).frame_data
         index_data = FrameData.from_cpp(frame_data).data
         if len(index_data[0]) == 0:
             return datetime64("nat"), datetime64("nat")
 
         start_indices, end_indices = index_data[0], index_data[1]
         min_ts, max_ts = min(start_indices), max(end_indices)
-
         # to get timezone info
-        _, desc = self.version_store.read_descriptor(symbol, version_query)
-        input_type = desc.normalization.WhichOneof("input_type")
-        tz = None
-        if input_type == "df":
-            index_metadata = desc.normalization.df.common
-            tz = get_timezone_from_metadata(index_metadata)
-        if tz:
-            # If tz is provided, it is stored in UTC - hence needs to be localized to UTC before
-            # converting to the given tz
-            return (
-                _from_tz_timestamp(min_ts, "UTC").astimezone(pytz.timezone(tz)),
-                _from_tz_timestamp(max_ts, "UTC").astimezone(pytz.timezone(tz)),
-            )
-        else:
-            return _from_tz_timestamp(min_ts, None), _from_tz_timestamp(max_ts, None)
+        dit = self.version_store.read_descriptor(symbol, version_query)
+        return self._get_time_range_from_ts(dit.timeseries_descriptor, min_ts, max_ts)
 
     def name(self):
         return self._lib_cfg.lib_desc.name
 
     def get_num_rows(self, symbol: str, as_of: Optional[VersionQueryInput] = None) -> int:
         """
         Query the number of rows in the specified revision of the symbol.
@@ -2299,36 +2303,37 @@
 
         Returns
         -------
         `int`
             The number of rows in the specified revision of the symbol.
         """
         version_query = self._get_version_query(as_of)
-        vit, desc = self.version_store.read_descriptor(symbol, version_query)
-        return desc.total_rows
+        dit = self.version_store.read_descriptor(symbol, version_query)
+        return dit.timeseries_descriptor.total_rows
 
     def lib_cfg(self):
         return self._lib_cfg
 
     def open_mode(self):
         return self._open_mode
 
-    def _process_info(self, symbol: str, vit, desc, as_of: Optional[VersionQueryInput] = None) -> Dict[str, Any]:
-        columns = [f.name for f in desc.stream_descriptor.fields]
-        dtypes = [f.type_desc for f in desc.stream_descriptor.fields]
+    def _process_info(self, symbol: str, dit, as_of: Optional[VersionQueryInput] = None) -> Dict[str, Any]:
+        timeseries_descriptor = dit.timeseries_descriptor
+        columns = [f.name for f in timeseries_descriptor.stream_descriptor.fields]
+        dtypes = [f.type_desc for f in timeseries_descriptor.stream_descriptor.fields]
         index = []
         index_dtype = []
-        input_type = desc.normalization.WhichOneof("input_type")
+        input_type = timeseries_descriptor.normalization.WhichOneof("input_type")
         index_type = "NA"
         if input_type == "df":
-            index_type = desc.normalization.df.common.WhichOneof("index_type")
+            index_type = timeseries_descriptor.normalization.df.common.WhichOneof("index_type")
             if index_type == "index":
-                index_metadata = desc.normalization.df.common.index
+                index_metadata = timeseries_descriptor.normalization.df.common.index
             else:
-                index_metadata = desc.normalization.df.common.multi_index
+                index_metadata = timeseries_descriptor.normalization.df.common.multi_index
 
             if index_type == "multi_index" or (index_type == "index" and index_metadata.is_not_range_index):
                 index_name_from_store = columns.pop(0)
                 has_fake_name = (
                     0 in index_metadata.fake_field_pos if index_type == "multi_index" else index_metadata.fake_name
                 )
                 if has_fake_name:
@@ -2352,28 +2357,30 @@
                     index_name = columns.pop(0)
                     if i in index_metadata.fake_field_pos:
                         index_name = None
                     else:
                         index_name = index_name[_IDX_PREFIX_LEN:]
                     index.append(index_name)
                     index_dtype.append(dtypes.pop(0))
-            if desc.normalization.df.has_synthetic_columns:
+            if timeseries_descriptor.normalization.df.has_synthetic_columns:
                 columns = pd.RangeIndex(0, len(columns))
 
+        date_range = self._get_time_range_from_ts(timeseries_descriptor, dit.start_index, dit.end_index)
+        last_update = datetime64(dit.creation_ts, "ns")
         return {
             "col_names": {"columns": columns, "index": index, "index_dtype": index_dtype},
             "dtype": dtypes,
-            "rows": desc.total_rows,
-            "last_update": self.update_time(symbol, as_of),
+            "rows": timeseries_descriptor.total_rows,
+            "last_update": last_update,
             "input_type": input_type,
             "index_type": index_type,
-            "normalization_metadata": desc.normalization,
-            "type": self.get_arctic_style_type_info_for_norm(desc),
-            "date_range": self.get_timerange_for_symbol(symbol, vit.version),
-            "sorted": SortedValue.Name(desc.stream_descriptor.sorted),
+            "normalization_metadata": timeseries_descriptor.normalization,
+            "type": self.get_arctic_style_type_info_for_norm(timeseries_descriptor),
+            "date_range": date_range,
+            "sorted": SortedValue.Name(timeseries_descriptor.stream_descriptor.sorted),
         }
 
     def get_info(self, symbol: str, version: Optional[VersionQueryInput] = None) -> Dict[str, Any]:
         """
         Returns descriptive data for `symbol`.
 
         Parameters
@@ -2395,16 +2402,16 @@
             - input_type, `str`
             - index_type, `index_type`
             - normalization_metadata,
             - type, `str`
             - date_range, `tuple`
         """
         version_query = self._get_version_query(version)
-        vit, desc = self.version_store.read_descriptor(symbol, version_query)
-        return self._process_info(symbol, vit, desc, version)
+        dit = self.version_store.read_descriptor(symbol, version_query)
+        return self._process_info(symbol, dit, version)
 
     def batch_get_info(
         self, symbols: List[str], as_ofs: Optional[List[VersionQueryInput]] = None
     ) -> List[Dict[str, Any]]:
         """
         Returns descriptive data for a list of `symbols`.
 
@@ -2440,18 +2447,16 @@
 
         version_queries = []
         for as_of in as_ofs_lists:
             version_queries.append(self._get_version_query(as_of))
         list_descriptors = self.version_store.batch_read_descriptor(symbols, version_queries)
         args_list = list(zip(list_descriptors, symbols, version_queries, as_ofs_lists))
         list_infos = []
-        for descriptor, symbol, version_query, as_of in args_list:
-            vit = descriptor[0]
-            desc = descriptor[1]
-            list_infos.append(self._process_info(symbol, vit, desc, as_of))
+        for dit, symbol, version_query, as_of in args_list:
+            list_infos.append(self._process_info(symbol, dit, as_of))
         return list_infos
 
     def write_metadata(
         self, symbol: str, metadata: Any, prune_previous_version: Optional[bool] = None
     ) -> VersionedItem:
         """
         Write 'metadata' under the specified 'symbol' name to this library.
```

## arcticdb/version_store/library.py

```diff
@@ -1337,16 +1337,20 @@
         SymbolDescription
             For documentation on each field.
         """
         info = self._nvs.get_info(symbol, as_of)
         last_update_time = pd.to_datetime(info["last_update"], utc=True)
         columns = tuple(NameWithDType(n, t) for n, t in zip(info["col_names"]["columns"], info["dtype"]))
         index = NameWithDType(info["col_names"]["index"], info["col_names"]["index_dtype"])
-        date_range = tuple(map(lambda x: x.replace(tzinfo=datetime.timezone.utc), info["date_range"]))
-
+        date_range = tuple(
+            map(
+                lambda x: x.replace(tzinfo=datetime.timezone.utc) if not np.isnat(np.datetime64(x)) else x,
+                info["date_range"],
+            )
+        )
         return SymbolDescription(
             columns=columns,
             index=index,
             row_count=info["rows"],
             last_update_time=last_update_time,
             index_type=info["index_type"],
             date_range=date_range,
@@ -1393,26 +1397,31 @@
                     f"Unsupported item in the symbols argument s=[{s}] type(s)=[{type(s)}]. Only [str] and"
                     " [ReadInfoRequest] are supported."
                 )
 
         infos = self._nvs.batch_get_info(symbol_strings, as_ofs)
         list_descriptions = []
         for info in infos:
-            last_update_time = pd.to_datetime(info["last_update"])
+            last_update_time = pd.to_datetime(info["last_update"], utc=True)
             columns = tuple(NameWithDType(n, t) for n, t in zip(info["col_names"]["columns"], info["dtype"]))
             index = NameWithDType(info["col_names"]["index"], info["col_names"]["index_dtype"])
-
+            date_range = tuple(
+                map(
+                    lambda x: x.replace(tzinfo=datetime.timezone.utc) if not np.isnat(np.datetime64(x)) else x,
+                    info["date_range"],
+                )
+            )
             list_descriptions.append(
                 SymbolDescription(
                     columns=columns,
                     index=index,
                     row_count=info["rows"],
                     last_update_time=last_update_time,
                     index_type=info["index_type"],
-                    date_range=info["date_range"],
+                    date_range=date_range,
                 )
             )
         return list_descriptions
 
     def reload_symbol_list(self):
         """
         Forces the symbol list cache to be reloaded.
```

## Comparing `arcticdb-1.4.0.dist-info/LICENSE.txt` & `arcticdb-1.4.1.dist-info/LICENSE.txt`

 * *Files identical despite different names*

## Comparing `arcticdb-1.4.0.dist-info/METADATA` & `arcticdb-1.4.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: arcticdb
-Version: 1.4.0
+Version: 1.4.1
 Summary: ArcticDB DataFrame Database
 Home-page: https://github.com/man-group/arcticdb
 Author: Man Alpha Technology
 Author-email: arcticdb@man.com
 License: Business Source License 1.1 (See LICENSE.txt)
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: POSIX :: Linux
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: arcticdb Version: 1.4.0 Summary: ArcticDB DataFrame
+Metadata-Version: 2.1 Name: arcticdb Version: 1.4.1 Summary: ArcticDB DataFrame
 Database Home-page: https://github.com/man-group/arcticdb Author: Man Alpha
 Technology Author-email: arcticdb@man.com License: Business Source License 1.1
 (See LICENSE.txt) Classifier: Programming Language :: Python :: 3 Classifier:
 Operating System :: POSIX :: Linux Classifier: Operating System :: Microsoft ::
 Windows Classifier: Topic :: Database Classifier: Topic :: Database :: Database
 Engines/Servers Description-Content-Type: text/markdown License-File:
 LICENSE.txt License-File: NOTICE.txt Requires-Dist: numpy Requires-Dist: pandas
```

## Comparing `arcticdb-1.4.0.dist-info/NOTICE.txt` & `arcticdb-1.4.1.dist-info/NOTICE.txt`

 * *Files identical despite different names*

## Comparing `arcticdb-1.4.0.dist-info/RECORD` & `arcticdb-1.4.1.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,11 +1,11 @@
-arcticdb_ext.cp39-win_amd64.pyd,sha256=HgI2gbvkUS1octHTiQOtEyALwRkJi_-e1bKcZtqveVQ,22064128
-arcticc/__init__.py,sha256=5t8gAo_NnZ269q7FPcp6PwmUczF2UFmS8Zz1KAVbiL0,66
+arcticdb_ext.cp39-win_amd64.pyd,sha256=35xbwUpYm90dO0mUOLrgdYrUu1R-RglIxJU5_iRGlcw,22111744
+arcticc/__init__.py,sha256=TgMgqqJDwst6cvC4-whG_3DQOzyry3fRe8HxvE_jrPM,302
 arcticc/pb2/__init__.py,sha256=pfsson0mxPSudMCFd_HpaUTeFROIFD4yA_XQgqAYMiU,583
-arcticdb/__init__.py,sha256=R5F8RKrEOz0ZSGEG83JO3Egr9gDWpuFbsdAn_A1tGbQ,424
+arcticdb/__init__.py,sha256=9Cy27VTA9zuQFOYe4F9TSd5UD5hqy9021iqQKaluiVY,424
 arcticdb/_msgpack_compat.py,sha256=i_3HluY89KVSXFnxC-UjcdK0zNsIcSBLmY3YpKFeLl8,447
 arcticdb/arctic.py,sha256=bkJFxPLqc_jup_u65Tpc-tUrsyKmdTDvHGU5-gT8dxY,11446
 arcticdb/config.py,sha256=ozc4oNPIDue4JoRTpsTJeBuhEXGCbgt27qux2nsao7E,7524
 arcticdb/exceptions.py,sha256=ArcFJwbH8PKD5CfC5Aq5LEKwcjIx-ftsocuGtwZjUrU,765
 arcticdb/flattener.py,sha256=u-rdlqaavqzcMUtyMycjaa9MjUdd-6xcVedkCjW8nJ8,9361
 arcticdb/log.py,sha256=-jhGsvGmwEyv7cvQMwEkVM9RMy2Ddm4JEGP7AcfxZOI,1810
 arcticdb/options.py,sha256=euSyeMVFtvqgGFSEPyw-3d4n0NzwCe3uJ5iwjDXktz8,6476
@@ -54,18 +54,18 @@
 arcticdb/util/memory.py,sha256=-YYUz_ATxFGPov8mAOWsvwgulxZng1hgEB4xkAvUkPg,719
 arcticdb/util/tasks.py,sha256=aXNt_CDW9F0rtXCOwQaWIuoG69OMXajmy7NDUtwgJ2w,6013
 arcticdb/util/test.py,sha256=X0Vaz0kSoj585aaNTI9aj1d-iT2fgbAuoI2-vEknttI,18249
 arcticdb/version_store/__init__.py,sha256=uGAsgCsoyGmR-F7zvOx8GuMs1QdnVHdg5l7RSm6XiBY,131
 arcticdb/version_store/_common.py,sha256=V8eruObk6XhIabaGtFibt7jmzpf0V3nByNOdfb1ftGg,7189
 arcticdb/version_store/_custom_normalizers.py,sha256=EKqxg39qV8BJPjeSCZ9BEOnZkixCXJW796F91bR8wws,4193
 arcticdb/version_store/_normalization.py,sha256=l0QU6VKuRcI7ZtH4E8-A4Pa_LBP58z3CP0Wrbzegnbw,52659
-arcticdb/version_store/_store.py,sha256=0Ar0IZDKA1Gg8Jc5SsXcd-w5VZpld1Au2PWklA28ZII,113724
+arcticdb/version_store/_store.py,sha256=Pld8WI0NvvOCwiqTsqOi_urCHxipY97_BCjwivdj-iw,114256
 arcticdb/version_store/helper.py,sha256=RxtIpUlBKMuWDFu4jqJdtj35k3L9l6t1hfqmvTAZXlo,11129
-arcticdb/version_store/library.py,sha256=2U5nYYgy8defceN6TNo84CQpm-SED274oQiWAxkgv0k,59545
+arcticdb/version_store/library.py,sha256=V3rI6H9XvQhSN8n4zCFwKp533pe6wiTTSXK1OUE8blI,59901
 arcticdb/version_store/processing.py,sha256=POVL_b4wwNgam5ETgyuTzlnt_wngZ29gFEUbGurXTDA,24370
 arcticdb/version_store/read_result.py,sha256=5HhAJ0Wh01f111qA5XvWqOXABO-2H0jZ78kx-iiQzOk,603
-arcticdb-1.4.0.dist-info/LICENSE.txt,sha256=ruvCXWZm0cgyb-XAEjFcfdJkJ_nGbv9gsYNeps514Ys,4851
-arcticdb-1.4.0.dist-info/METADATA,sha256=RX5Xlfe9smQ9HxtvcNTUoqwU6l57p9-220Qo6EybN1Q,8557
-arcticdb-1.4.0.dist-info/NOTICE.txt,sha256=TsVpAVXueJjRq_zV86A3v_TqJRsXCQtYjrEvycwyaaY,18186
-arcticdb-1.4.0.dist-info/WHEEL,sha256=J_4V_gB-O6Y7Pn6lk91K27JaIhI-q07YM5J8Ufzqla4,100
-arcticdb-1.4.0.dist-info/top_level.txt,sha256=jDxz3uFaLYFuxxPf3h6-sqPQqEFbMkWGP-9vE8Dbi1w,30
-arcticdb-1.4.0.dist-info/RECORD,,
+arcticdb-1.4.1.dist-info/LICENSE.txt,sha256=ruvCXWZm0cgyb-XAEjFcfdJkJ_nGbv9gsYNeps514Ys,4851
+arcticdb-1.4.1.dist-info/METADATA,sha256=PGwBPUWkV8BAbpXO6LCRsz9ZMGSfQszyTJD5D19eip8,8557
+arcticdb-1.4.1.dist-info/NOTICE.txt,sha256=TsVpAVXueJjRq_zV86A3v_TqJRsXCQtYjrEvycwyaaY,18186
+arcticdb-1.4.1.dist-info/WHEEL,sha256=J_4V_gB-O6Y7Pn6lk91K27JaIhI-q07YM5J8Ufzqla4,100
+arcticdb-1.4.1.dist-info/top_level.txt,sha256=jDxz3uFaLYFuxxPf3h6-sqPQqEFbMkWGP-9vE8Dbi1w,30
+arcticdb-1.4.1.dist-info/RECORD,,
```

